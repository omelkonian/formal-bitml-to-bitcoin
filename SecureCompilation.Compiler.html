<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Compiler</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">----------------------------------------------------------------------------</a>
<a id="78" class="Comment">-- Compiler from BitML to Bitcoin transactions (see BitML paper, Section 7).</a>
<a id="155" class="Comment">----------------------------------------------------------------------------</a>

<a id="233" class="Keyword">open</a> <a id="238" class="Keyword">import</a> <a id="245" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="254" class="Symbol">as</a> <a id="257" class="Module">Fin</a> <a id="261" class="Keyword">using</a> <a id="267" class="Symbol">(</a><a id="268" href="Data.Fin.Base.html#2272" class="Function">raise</a><a id="273" class="Symbol">;</a> <a id="275" href="Data.Fin.Base.html#2858" class="Function">inject+</a><a id="282" class="Symbol">;</a> <a id="284" href="Data.Fin.Base.html#1192" class="Function">toℕ</a><a id="287" class="Symbol">)</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="321" class="Keyword">using</a> <a id="327" class="Symbol">(</a><a id="328" href="Data.Nat.Properties.html#3725" class="Function">≤-refl</a><a id="334" class="Symbol">;</a> <a id="336" href="Data.Nat.Properties.html#8037" class="Function">&lt;-trans</a><a id="343" class="Symbol">;</a> <a id="345" href="Data.Nat.Properties.html#10043" class="Function">n&lt;1+n</a><a id="350" class="Symbol">)</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Data.List.Membership.Setoid.Properties.html" class="Module">Data.List.Membership.Setoid.Properties</a>         <a id="469" class="Keyword">using</a> <a id="475" class="Symbol">(</a><a id="476" href="Data.List.Membership.Setoid.Properties.html#4081" class="Function">length-mapWith∈</a><a id="491" class="Symbol">)</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a>                   <a id="552" class="Keyword">using</a> <a id="558" class="Symbol">(</a><a id="559" href="Data.List.Relation.Unary.Any.html#1909" class="Function">index</a><a id="564" class="Symbol">)</a>
<a id="566" class="Keyword">open</a> <a id="571" class="Keyword">import</a> <a id="578" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a>                   <a id="625" class="Keyword">using</a> <a id="631" class="Symbol">(</a><a id="632" href="Data.List.Relation.Unary.All.html#5949" class="Function">lookup</a><a id="638" class="Symbol">)</a>
<a id="640" class="Keyword">open</a> <a id="645" class="Keyword">import</a> <a id="652" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html" class="Module">Data.List.Relation.Binary.Subset.Propositional.Properties</a> <a id="710" class="Keyword">using</a> <a id="716" class="Symbol">(</a><a id="717" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html#1761" class="Function">⊆-refl</a><a id="723" class="Symbol">)</a>

<a id="726" class="Keyword">open</a> <a id="731" class="Keyword">import</a> <a id="738" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="776" class="Keyword">using</a> <a id="782" class="Symbol">(</a><a id="783" href="Relation.Binary.PropositionalEquality.html#2283" class="Function">setoid</a><a id="789" class="Symbol">)</a>

<a id="792" class="Keyword">open</a> <a id="797" class="Keyword">import</a> <a id="804" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="817" class="Keyword">open</a> <a id="822" class="Keyword">import</a> <a id="829" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="845" class="Keyword">open</a> <a id="850" class="Keyword">import</a> <a id="857" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="871" class="Keyword">open</a> <a id="876" class="Keyword">import</a> <a id="883" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="897" class="Keyword">open</a> <a id="902" class="Keyword">import</a> <a id="909" href="Prelude.Set%2527.html" class="Module">Prelude.Set&#39;</a>
<a id="922" class="Keyword">open</a> <a id="927" class="Keyword">import</a> <a id="934" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>

<a id="955" class="Comment">-- Bitcoin</a>
<a id="966" class="Keyword">open</a> <a id="971" class="Keyword">import</a> <a id="978" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>
  <a id="999" class="Keyword">using</a> <a id="1005" class="Symbol">(</a><a id="1006" href="Bitcoin.BasicTypes.html#266" class="Function">HashId</a><a id="1012" class="Symbol">)</a>
<a id="1014" class="Keyword">open</a> <a id="1019" class="Keyword">import</a> <a id="1026" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a>
  <a id="1043" class="Keyword">using</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a><a id="1057" class="Symbol">)</a>
<a id="1059" class="Keyword">open</a> <a id="1064" class="Keyword">import</a> <a id="1071" href="Bitcoin.Script.Base.html" class="Module">Bitcoin.Script.Base</a>
  <a id="1093" class="Keyword">using</a> <a id="1099" class="Symbol">(</a> <a id="1101" href="Bitcoin.Script.Base.html#651" class="Generalizable">ty</a><a id="1103" class="Symbol">;</a> <a id="1105" href="Bitcoin.Script.Base.html#499" class="Datatype">ScriptType</a><a id="1115" class="Symbol">;</a> <a id="1117" href="Bitcoin.Script.Base.html#524" class="InductiveConstructor">`Bool</a><a id="1122" class="Symbol">;</a> <a id="1124" href="Bitcoin.Script.Base.html#530" class="InductiveConstructor">`ℤ</a>
        <a id="1135" class="Symbol">;</a> <a id="1137" href="Bitcoin.Script.Base.html#624" class="Generalizable">ctx</a><a id="1140" class="Symbol">;</a> <a id="1142" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a><a id="1145" class="Symbol">;</a> <a id="1147" href="Bitcoin.Script.Base.html#323" class="Datatype">ScriptContext</a>
        <a id="1169" class="Symbol">;</a> <a id="1171" href="Bitcoin.Script.Base.html#822" class="InductiveConstructor">var</a><a id="1174" class="Symbol">;</a> <a id="1176" href="Bitcoin.Script.Base.html#893" class="InductiveConstructor">`</a><a id="1177" class="Symbol">;</a> <a id="1179" href="Bitcoin.Script.Base.html#920" class="InductiveConstructor Operator">_`+_</a><a id="1183" class="Symbol">;</a> <a id="1185" href="Bitcoin.Script.Base.html#975" class="InductiveConstructor Operator">_`-_</a><a id="1189" class="Symbol">;</a> <a id="1191" href="Bitcoin.Script.Base.html#1030" class="InductiveConstructor Operator">_`=_</a><a id="1195" class="Symbol">;</a> <a id="1197" href="Bitcoin.Script.Base.html#1088" class="InductiveConstructor Operator">_`&lt;_</a><a id="1201" class="Symbol">;</a> <a id="1203" href="Bitcoin.Script.Base.html#1174" class="InductiveConstructor Operator">`if_then_else_</a><a id="1217" class="Symbol">;</a> <a id="1219" href="Bitcoin.Script.Base.html#1321" class="InductiveConstructor">hash</a><a id="1223" class="Symbol">;</a> <a id="1225" href="Bitcoin.Script.Base.html#1389" class="InductiveConstructor">versig</a><a id="1231" class="Symbol">;</a> <a id="1233" href="Bitcoin.Script.Base.html#1478" class="InductiveConstructor Operator">absAfter_⇒_</a><a id="1244" class="Symbol">;</a> <a id="1246" href="Bitcoin.Script.Base.html#1531" class="InductiveConstructor Operator">relAfter_⇒_</a><a id="1257" class="Symbol">;</a> <a id="1259" href="Bitcoin.Script.Base.html#677" class="Datatype">Script</a>
        <a id="1274" class="Symbol">;</a> <a id="1276" href="Bitcoin.Script.Base.html#1816" class="Function Operator">_`∧_</a><a id="1280" class="Symbol">;</a> <a id="1282" href="Bitcoin.Script.Base.html#1763" class="Function">`true</a><a id="1287" class="Symbol">;</a> <a id="1289" href="Bitcoin.Script.Base.html#1915" class="Function Operator">_`∨_</a><a id="1293" class="Symbol">;</a> <a id="1295" href="Bitcoin.Script.Base.html#1708" class="Function">`false</a><a id="1301" class="Symbol">;</a> <a id="1303" href="Bitcoin.Script.Base.html#2013" class="Function">`not</a>
        <a id="1316" class="Symbol">;</a> <a id="1318" href="Bitcoin.Script.Base.html#2150" class="InductiveConstructor Operator">ƛ_</a><a id="1320" class="Symbol">;</a> <a id="1322" href="Bitcoin.Script.Base.html#2100" class="Datatype">BitcoinScript</a><a id="1335" class="Symbol">;</a> <a id="1337" href="Bitcoin.Script.Base.html#2263" class="Function">∃BitcoinScript</a>
        <a id="1360" class="Symbol">;</a> <a id="1362" class="Comment">{-∣_∣;-}</a> <a id="1371" href="Bitcoin.Script.Base.html#3442" class="Function">⋁</a><a id="1372" class="Symbol">;</a> <a id="1374" href="Bitcoin.Script.Base.html#3705" class="Function">⋀</a> <a id="1376" class="Symbol">)</a>
<a id="1378" class="Keyword">open</a> <a id="1383" class="Keyword">import</a> <a id="1390" href="Bitcoin.Tx.Base.html" class="Module">Bitcoin.Tx.Base</a>
  <a id="1408" class="Keyword">using</a> <a id="1414" class="Symbol">(</a> <a id="1416" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">_at_</a><a id="1420" class="Symbol">;</a> <a id="1422" href="Bitcoin.Tx.Base.html#343" class="Record">TxInput</a>
        <a id="1438" class="Symbol">;</a> <a id="1440" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a><a id="1442" class="Symbol">;</a> <a id="1444" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="1456" class="Symbol">;</a> <a id="1458" href="Bitcoin.Tx.Base.html#828" class="Function">Witness</a><a id="1465" class="Symbol">;</a> <a id="1467" href="Bitcoin.Tx.Base.html#867" class="Function">∃Witness</a> <a id="1476" class="Symbol">)</a>
<a id="1478" class="Keyword">open</a> <a id="1483" class="Keyword">import</a> <a id="1490" href="Bitcoin.Tx.Crypto.html" class="Module">Bitcoin.Tx.Crypto</a>
  <a id="1510" class="Keyword">using</a> <a id="1516" class="Symbol">(</a><a id="1517" href="Bitcoin.Tx.Crypto.html#720" class="Function">hashTx</a><a id="1523" class="Symbol">;</a> <a id="1525" href="Bitcoin.Tx.Crypto.html#1043" class="Function">sig⋆</a><a id="1529" class="Symbol">;</a> <a id="1531" href="Bitcoin.Tx.Crypto.html#552" class="Function">wit⊥</a><a id="1535" class="Symbol">)</a>

<a id="1538" class="Keyword">module</a> <a id="1545" href="SecureCompilation.Compiler.html" class="Module">SecureCompilation.Compiler</a>

  <a id="1575" class="Comment">-- BitML parameters</a>
  <a id="1597" class="Symbol">(</a><a id="1598" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a> <a id="1610" class="Symbol">:</a> <a id="1612" class="PrimitiveType">Set</a><a id="1615" class="Symbol">)</a>
  <a id="1619" class="Symbol">{{</a><a id="1621" href="SecureCompilation.Compiler.html#1621" class="Bound">_</a> <a id="1623" class="Symbol">:</a> <a id="1625" href="Prelude.DecEq.html#553" class="Record">DecEq</a> <a id="1631" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a><a id="1642" class="Symbol">}}</a>
  <a id="1647" class="Symbol">(</a><a id="1648" href="SecureCompilation.Compiler.html#1648" class="Bound">Honest</a> <a id="1655" class="Symbol">:</a> <a id="1657" href="Data.List.NonEmpty.html#1318" class="Record">List⁺</a> <a id="1663" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a><a id="1674" class="Symbol">)</a>

  <a id="1679" class="Comment">-- Compilation parameters</a>
  <a id="1707" class="Symbol">(</a><a id="1708" href="SecureCompilation.Compiler.html#1708" class="Bound">η</a> <a id="1710" class="Symbol">:</a> <a id="1712" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1713" class="Symbol">)</a> <a id="1715" class="Comment">-- public security nonce η, ensures adversaries cannot guess</a>
  <a id="1778" class="Keyword">where</a>

<a id="1785" class="Comment">-- BitML</a>
<a id="1794" class="Keyword">open</a> <a id="1799" class="Keyword">import</a> <a id="1806" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a>
  <a id="1825" class="Keyword">using</a> <a id="1831" class="Symbol">(</a> <a id="1833" href="BitML.BasicTypes.html#261" class="Function">Secret</a><a id="1839" class="Symbol">;</a> <a id="1841" href="BitML.BasicTypes.html#382" class="Function">Time</a><a id="1845" class="Symbol">;</a> <a id="1847" href="BitML.BasicTypes.html#229" class="Function">Value</a><a id="1852" class="Symbol">;</a> <a id="1854" href="BitML.BasicTypes.html#240" class="Function">Values</a><a id="1860" class="Symbol">;</a> <a id="1862" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="1864" class="Symbol">;</a> <a id="1866" href="BitML.BasicTypes.html#314" class="Function">Ids</a><a id="1869" class="Symbol">;</a> <a id="1871" href="BitML.BasicTypes.html#333" class="Function">Name</a><a id="1875" class="Symbol">;</a> <a id="1877" href="BitML.BasicTypes.html#363" class="Function">Names</a>
        <a id="1891" class="Symbol">;</a> <a id="1893" class="Comment">{-variables-}</a> <a id="1907" href="BitML.BasicTypes.html#412" class="Generalizable">v</a><a id="1908" class="Symbol">;</a> <a id="1910" href="BitML.BasicTypes.html#482" class="Generalizable">x</a><a id="1911" class="Symbol">;</a> <a id="1913" href="BitML.BasicTypes.html#504" class="Generalizable">xs</a><a id="1915" class="Symbol">;</a> <a id="1917" href="BitML.BasicTypes.html#462" class="Generalizable">as</a><a id="1919" class="Symbol">;</a> <a id="1921" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="1923" class="Symbol">)</a>
<a id="1925" class="Keyword">open</a> <a id="1930" class="Keyword">import</a> <a id="1937" href="BitML.Predicate.html" class="Module">BitML.Predicate</a>
  <a id="1955" class="Keyword">using</a> <a id="1961" class="Symbol">(</a> <a id="1963" href="BitML.Predicate.html#682" class="Datatype">Predicate</a><a id="1972" class="Symbol">;</a> <a id="1974" href="BitML.Predicate.html#492" class="Datatype">Arith</a>
        <a id="1988" class="Symbol">;</a> <a id="1990" class="Comment">{-variables-}</a> <a id="2004" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="2006" class="Symbol">)</a>
<a id="2008" class="Keyword">open</a> <a id="2013" class="Keyword">import</a> <a id="2020" href="BitML.Contracts.Types.html" class="Module">BitML.Contracts.Types</a> <a id="2042" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a> <a id="2054" href="SecureCompilation.Compiler.html#1648" class="Bound">Honest</a>
  <a id="2063" class="Keyword">using</a> <a id="2069" class="Symbol">(</a> Contract<a id="2079" class="Symbol">;</a> Contracts<a id="2090" class="Symbol">;</a> VContracts
        <a id="2111" class="Symbol">;</a> put_&amp;reveal_if_⇒_<a id="2130" class="Symbol">;</a> withdraw<a id="2140" class="Symbol">;</a> split<a id="2147" class="Symbol">;</a> _⇒_<a id="2152" class="Symbol">;</a> after_⇒_
        <a id="2171" class="Symbol">;</a> Precondition
        <a id="2194" class="Symbol">;</a> ⟨_⟩_<a id="2200" class="Symbol">;</a> Advertisement<a id="2215" class="Symbol">;</a> G
        <a id="2227" class="Symbol">;</a> <a id="2229" class="Comment">{-variables-}</a> A<a id="2244" class="Symbol">;</a> g<a id="2247" class="Symbol">;</a> d<a id="2250" class="Symbol">;</a> d′<a id="2254" class="Symbol">;</a> ds<a id="2258" class="Symbol">;</a> ds′<a id="2263" class="Symbol">;</a> vcs <a id="2269" class="Symbol">)</a>
<a id="2271" class="Keyword">open</a> <a id="2276" class="Keyword">import</a> <a id="2283" href="BitML.Contracts.Helpers.html" class="Module">BitML.Contracts.Helpers</a> <a id="2307" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a> <a id="2319" href="SecureCompilation.Compiler.html#1648" class="Bound">Honest</a>
<a id="2326" class="Keyword">open</a> <a id="2331" class="Keyword">import</a> <a id="2338" href="BitML.Contracts.Induction.html" class="Module">BitML.Contracts.Induction</a> <a id="2364" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a> <a id="2376" href="SecureCompilation.Compiler.html#1648" class="Bound">Honest</a>
<a id="2383" class="Keyword">open</a> <a id="2388" class="Keyword">import</a> <a id="2395" href="BitML.Contracts.Validity.html" class="Module">BitML.Contracts.Validity</a> <a id="2420" href="SecureCompilation.Compiler.html#1598" class="Bound">Participant</a> <a id="2432" href="SecureCompilation.Compiler.html#1648" class="Bound">Honest</a>

<a id="bitml-compiler"></a><a id="2440" href="SecureCompilation.Compiler.html#2440" class="Function">bitml-compiler</a> <a id="2455" class="Symbol">:</a>
    <a id="2461" class="Comment">-- the input contract &amp; precondition (only compile valid advertisements)</a>
    <a id="2538" href="BitML.Contracts.Validity.html#885" class="Function">ValidAdvertisement</a> <a id="2557" class="Symbol">(</a><a id="2558" href="BitML.Contracts.Types.html#2348" class="InductiveConstructor Operator">⟨</a> <a id="2560" href="BitML.Contracts.Types.html#2187" class="Generalizable">g</a> <a id="2562" href="BitML.Contracts.Types.html#2348" class="InductiveConstructor Operator">⟩</a> <a id="2564" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="2566" class="Symbol">)</a>
    <a id="2572" class="Comment">-- sechash: maps secrets in G to the corresponding committed hashes</a>
  <a id="2642" class="Symbol">→</a> <a id="2644" class="Symbol">(</a><a id="2645" href="SecureCompilation.Compiler.html#2645" class="Bound">sechash</a> <a id="2653" class="Symbol">:</a> <a id="2655" href="BitML.Contracts.Helpers.html#903" class="Function">namesˡ</a> <a id="2662" href="BitML.Contracts.Types.html#2187" class="Generalizable">g</a> <a id="2664" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="2666" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="2667" class="Symbol">)</a>
    <a id="2673" class="Comment">-- txout: maps deposits in G to *pre-existing* transactions with the corresponding value</a>
  <a id="2764" class="Symbol">→</a> <a id="2766" class="Symbol">(</a><a id="2767" href="SecureCompilation.Compiler.html#2767" class="Bound">txout</a> <a id="2773" class="Symbol">:</a> <a id="2775" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="2782" href="BitML.Contracts.Types.html#2187" class="Generalizable">g</a> <a id="2784" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="2786" href="Bitcoin.Tx.Base.html#343" class="Record">TxInput</a><a id="2793" class="Symbol">)</a>
    <a id="2799" class="Comment">-- Exchanged keypairs K(A) and K(D,A)</a>
  <a id="2839" class="Symbol">→</a> <a id="2841" class="Keyword">let</a> <a id="2845" href="SecureCompilation.Compiler.html#2845" class="Bound">partG</a> <a id="2851" class="Symbol">=</a> <a id="2853" href="BitML.Contracts.Helpers.html#1238" class="Function">nub-participants</a> <a id="2870" href="BitML.Contracts.Types.html#2187" class="Generalizable">g</a> <a id="2872" class="Keyword">in</a>
    <a id="2879" class="Symbol">(</a><a id="2880" href="SecureCompilation.Compiler.html#2880" class="Bound">K</a> <a id="2882" class="Symbol">:</a> <a id="2884" href="SecureCompilation.Compiler.html#2845" class="Bound">partG</a> <a id="2890" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="2892" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a><a id="2899" class="Symbol">)</a>
  <a id="2903" class="Symbol">→</a> <a id="2905" class="Symbol">(</a><a id="2906" href="SecureCompilation.Compiler.html#2906" class="Bound">K²</a> <a id="2909" class="Symbol">:</a> <a id="2911" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="2921" class="Symbol">(</a><a id="2922" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="2925" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="2927" class="Symbol">)</a> <a id="2929" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="2931" class="Symbol">(</a><a id="2932" href="SecureCompilation.Compiler.html#2845" class="Bound">partG</a> <a id="2938" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="2940" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a><a id="2947" class="Symbol">))</a>
    <a id="2954" class="Comment">-- a set of transactions to be submitted</a>
  <a id="2997" class="Symbol">→</a> <a id="2999" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a> <a id="3003" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3005" class="Symbol">(</a><a id="3006" href="BitML.Contracts.Helpers.html#10077" class="Function">subterms⁺</a> <a id="3016" class="Symbol">(</a><a id="3017" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="3020" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="3022" class="Symbol">)</a> <a id="3024" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="3026" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a><a id="3029" class="Symbol">)</a>
<a id="3031" href="SecureCompilation.Compiler.html#2440" class="Function">bitml-compiler</a> <a id="3046" class="Symbol">{</a><a id="3047" class="Argument">g</a> <a id="3049" class="Symbol">=</a> <a id="3051" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="3053" class="Symbol">}</a> <a id="3055" class="Symbol">{</a><a id="3056" class="Argument">ds</a> <a id="3059" class="Symbol">=</a> <a id="3061" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a><a id="3063" class="Symbol">}</a> <a id="3065" class="Symbol">(_</a> <a id="3068" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3070" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a> <a id="3077" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3079" href="SecureCompilation.Compiler.html#3079" class="Bound">putComponents⊆</a> <a id="3094" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3096" href="SecureCompilation.Compiler.html#3096" class="Bound">part⊆</a><a id="3101" class="Symbol">)</a> <a id="3103" href="SecureCompilation.Compiler.html#3103" class="Bound">sechash₀</a> <a id="3112" href="SecureCompilation.Compiler.html#3112" class="Bound">txout₀</a> <a id="3119" href="SecureCompilation.Compiler.html#3119" class="Bound">K</a> <a id="3121" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a>
  <a id="3126" class="Symbol">=</a> <a id="3128" href="SecureCompilation.Compiler.html#6336" class="Function">Tᵢₙᵢₜ</a> <a id="3134" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3136" class="Symbol">(</a><a id="3137" href="BitML.Contracts.Induction.html#1419" class="Function">≺-rec</a> <a id="3143" class="Symbol">_</a> <a id="3145" href="SecureCompilation.Compiler.html#9141" class="Function">go</a><a id="3147" class="Symbol">)</a> <a id="3149" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a> <a id="3153" class="Keyword">record</a>
      <a id="3166" class="Symbol">{</a> <a id="3168" href="SecureCompilation.Compiler.html#6836" class="Field">T,o</a>     <a id="3176" class="Symbol">=</a> <a id="3178" href="SecureCompilation.Compiler.html#6682" class="Function">Tᵢₙᵢₜ♯</a> <a id="3185" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">at</a> <a id="3188" class="Number">0</a>
      <a id="3196" class="Symbol">;</a> <a id="3198" href="SecureCompilation.Compiler.html#6859" class="Field">curV</a>    <a id="3206" class="Symbol">=</a> <a id="3208" href="SecureCompilation.Compiler.html#3633" class="Function">V₀</a>
      <a id="3217" class="Symbol">;</a> <a id="3219" href="SecureCompilation.Compiler.html#6880" class="Field">P</a>       <a id="3227" class="Symbol">=</a> <a id="3229" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="3235" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3237" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html#1761" class="Function">⊆-refl</a>
      <a id="3250" class="Symbol">;</a> <a id="3252" href="SecureCompilation.Compiler.html#6908" class="Field">curT</a>    <a id="3260" class="Symbol">=</a> <a id="3262" class="Number">0</a>
      <a id="3270" class="Symbol">;</a> <a id="3272" href="SecureCompilation.Compiler.html#6929" class="Field">p⊆</a>      <a id="3280" class="Symbol">=</a> <a id="3282" href="Prelude.DecEq.html#3377" class="Function">nub-⊆⁺</a> <a id="3289" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3291" href="SecureCompilation.Compiler.html#3696" class="Function">p⊆₀</a>
      <a id="3301" class="Symbol">;</a> <a id="3303" href="SecureCompilation.Compiler.html#7076" class="Field">s⊆</a>      <a id="3311" class="Symbol">=</a> <a id="3313" href="Function.Base.html#615" class="Function">id</a>
      <a id="3322" class="Symbol">;</a> <a id="3324" href="SecureCompilation.Compiler.html#7117" class="Field">∃s</a>      <a id="3332" class="Symbol">=</a> <a id="3334" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
      <a id="3343" class="Symbol">;</a> <a id="3345" href="SecureCompilation.Compiler.html#7182" class="Field">sechash</a> <a id="3353" class="Symbol">=</a> <a id="3355" href="SecureCompilation.Compiler.html#3103" class="Bound">sechash₀</a> <a id="3364" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3366" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="3377" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="3384" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a>
      <a id="3397" class="Symbol">;</a> <a id="3399" href="SecureCompilation.Compiler.html#7213" class="Field">txout</a>   <a id="3407" class="Symbol">=</a> <a id="3409" href="SecureCompilation.Compiler.html#3112" class="Bound">txout₀</a> <a id="3416" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3418" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="3429" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="3436" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a>
      <a id="3449" class="Symbol">;</a> <a id="3451" href="SecureCompilation.Compiler.html#7250" class="Field">part</a>    <a id="3459" class="Symbol">=</a> <a id="3461" href="SecureCompilation.Compiler.html#3873" class="Function">part₀</a> <a id="3467" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3469" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="3480" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="3487" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a>
      <a id="3500" class="Symbol">;</a> <a id="3502" href="SecureCompilation.Compiler.html#7292" class="Field">val</a>     <a id="3510" class="Symbol">=</a> <a id="3512" href="SecureCompilation.Compiler.html#4044" class="Function">val₀</a> <a id="3517" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3519" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="3530" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="3537" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a> <a id="3544" class="Symbol">}</a>
  <a id="3548" class="Keyword">where</a>
    <a id="3558" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a>   <a id="3564" class="Symbol">=</a> <a id="3566" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="3569" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a>
    <a id="3576" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="3582" class="Symbol">=</a> <a id="3584" href="BitML.Contracts.Helpers.html#1238" class="Function">nub-participants</a> <a id="3601" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a>
    <a id="3608" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a>     <a id="3614" class="Symbol">=</a> <a id="3616" href="Data.List.Base.html#4297" class="Function">length</a> <a id="3623" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a>
    <a id="3633" href="SecureCompilation.Compiler.html#3633" class="Function">V₀</a>    <a id="3639" class="Symbol">=</a> <a id="3641" href="Data.List.Base.html#4217" class="Function">sum</a> <a id="3645" class="Symbol">(</a><a id="3646" href="Data.List.Base.html#1497" class="Function">map</a> <a id="3650" class="Symbol">(</a><a id="3651" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3657" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3659" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="3664" class="Symbol">)</a> <a id="3666" class="Symbol">(</a><a id="3667" href="BitML.Contracts.Helpers.html#6283" class="Function">persistentDeposits</a> <a id="3686" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="3688" class="Symbol">))</a>

    <a id="3696" href="SecureCompilation.Compiler.html#3696" class="Function">p⊆₀</a> <a id="3700" class="Symbol">:</a> <a id="3702" href="BitML.Contracts.Helpers.html#1225" class="Function">participants</a> <a id="3715" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a> <a id="3718" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="3720" href="BitML.Contracts.Helpers.html#1225" class="Function">participants</a> <a id="3733" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a>
    <a id="3740" href="SecureCompilation.Compiler.html#3696" class="Function">p⊆₀</a> <a id="3744" class="Symbol">=</a> <a id="3746" href="BitML.Contracts.Helpers.html#6742" class="Function">persistent⊆</a> <a id="3758" class="Symbol">{</a><a id="3759" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="3761" class="Symbol">}</a> <a id="3763" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3765" href="SecureCompilation.Compiler.html#3096" class="Bound">part⊆</a> <a id="3771" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3773" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="3780" class="Symbol">(</a><a id="3781" href="BitML.Contracts.Helpers.html#1225" class="Function">participants</a> <a id="3794" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="3796" class="Symbol">)</a>

    <a id="3803" class="Comment">-- part: maps deposit names in G to the corresponding participant</a>
    <a id="3873" href="SecureCompilation.Compiler.html#3873" class="Function">part₀</a> <a id="3879" class="Symbol">:</a> <a id="3881" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="3888" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a> <a id="3891" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="3893" href="Data.Product.html#1369" class="Function">∃</a> <a id="3895" class="Symbol">(</a><a id="3896" href="Data.List.Membership.Setoid.html#882" class="Function Operator">_∈</a> <a id="3899" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a><a id="3904" class="Symbol">)</a>
    <a id="3910" href="SecureCompilation.Compiler.html#3873" class="Function">part₀</a> <a id="3916" href="SecureCompilation.Compiler.html#3916" class="Bound">x∈</a> <a id="3919" class="Symbol">=</a> <a id="3921" class="Symbol">_</a> <a id="3923" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3925" href="Prelude.Set%2527.html#8514" class="Function">∈-nub⁺</a> <a id="3932" class="Symbol">(</a><a id="3933" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3939" class="Symbol">(</a><a id="3940" href="BitML.Contracts.Helpers.html#7030" class="Function">getDeposit</a> <a id="3951" class="Symbol">{</a><a id="3952" class="Argument">g</a> <a id="3954" class="Symbol">=</a> <a id="3956" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="3958" class="Symbol">}</a> <a id="3960" href="SecureCompilation.Compiler.html#3916" class="Bound">x∈</a><a id="3962" class="Symbol">))</a>

    <a id="3970" class="Comment">-- val: maps deposit names in G to the value contained in the deposit</a>
    <a id="4044" href="SecureCompilation.Compiler.html#4044" class="Function">val₀</a> <a id="4049" class="Symbol">:</a> <a id="4051" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="4058" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a> <a id="4061" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="4063" href="BitML.BasicTypes.html#229" class="Function">Value</a>
    <a id="4073" href="SecureCompilation.Compiler.html#4044" class="Function">val₀</a> <a id="4078" class="Symbol">=</a> <a id="4080" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4086" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4088" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4094" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4096" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4102" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4104" href="BitML.Contracts.Helpers.html#7030" class="Function">getDeposit</a> <a id="4115" class="Symbol">{</a><a id="4116" class="Argument">g</a> <a id="4118" class="Symbol">=</a> <a id="4120" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a><a id="4122" class="Symbol">}</a>

    <a id="4129" class="Comment">-- Bout:</a>
    <a id="4142" href="SecureCompilation.Compiler.html#4142" class="Function">Bout</a> <a id="4147" class="Symbol">:</a> <a id="4149" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="4159" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a> <a id="4163" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="4165" class="Symbol">(</a><a id="4166" href="Data.Product.html#1788" class="Function">∃[</a> <a id="4169" href="SecureCompilation.Compiler.html#4169" class="Bound">ctx</a> <a id="4173" href="Data.Product.html#1788" class="Function">]</a> <a id="4175" href="Bitcoin.Script.Base.html#677" class="Datatype">Script</a> <a id="4182" href="SecureCompilation.Compiler.html#4169" class="Bound">ctx</a> <a id="4186" href="Bitcoin.Script.Base.html#524" class="InductiveConstructor">`Bool</a><a id="4191" class="Symbol">)</a>
    <a id="4197" href="SecureCompilation.Compiler.html#4142" class="Function">Bout</a> <a id="4202" class="Symbol">{</a><a id="4203" href="SecureCompilation.Compiler.html#4203" class="Bound">D</a><a id="4204" class="Symbol">}</a> <a id="4206" href="SecureCompilation.Compiler.html#4206" class="Bound">D∈</a> <a id="4209" class="Keyword">with</a> <a id="4214" href="BitML.Contracts.Helpers.html#8544" class="Function">removeTopDecorations</a> <a id="4235" href="SecureCompilation.Compiler.html#4203" class="Bound">D</a> <a id="4237" class="Symbol">|</a> <a id="4239" href="Relation.Binary.PropositionalEquality.html#3845" class="Function">inspect</a> <a id="4247" href="BitML.Contracts.Helpers.html#8544" class="Function">removeTopDecorations</a> <a id="4268" href="SecureCompilation.Compiler.html#4203" class="Bound">D</a>
    <a id="4274" class="Symbol">...</a> <a id="4278" class="Symbol">|</a> <a id="4280" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="4284" href="SecureCompilation.Compiler.html#4284" class="Bound">zs</a> <a id="4287" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="4295" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="4298" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="4301" href="SecureCompilation.Compiler.html#4301" class="Bound">p</a> <a id="4303" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="4305" class="Symbol">_</a> <a id="4307" class="Symbol">|</a> <a id="4309" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">≡[</a> <a id="4312" href="SecureCompilation.Compiler.html#4312" class="Bound">eq</a> <a id="4315" href="Relation.Binary.PropositionalEquality.html#3819" class="InductiveConstructor Operator">]</a>
        <a id="4325" class="Symbol">=</a> <a id="4327" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a> <a id="4331" class="Symbol">(</a><a id="4332" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="4334" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="4336" href="SecureCompilation.Compiler.html#4701" class="Function">m</a><a id="4337" class="Symbol">)</a> <a id="4339" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4341" class="Symbol">(</a> <a id="4343" href="Bitcoin.Script.Base.html#1389" class="InductiveConstructor">versig</a> <a id="4350" class="Symbol">(</a><a id="4351" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="4360" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="4366" class="Symbol">(</a><a id="4367" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a> <a id="4370" class="Bound">D∈</a><a id="4372" class="Symbol">))</a> <a id="4375" class="Symbol">(</a><a id="4376" href="Data.List.Base.html#1497" class="Function">map</a> <a id="4380" class="Symbol">(</a><a id="4381" href="Data.Fin.Base.html#2858" class="Function">inject+</a> <a id="4389" href="SecureCompilation.Compiler.html#4701" class="Function">m</a><a id="4390" class="Symbol">)</a> <a id="4392" class="Symbol">(</a><a id="4393" href="Data.List.Base.html#5754" class="Function">allFin</a> <a id="4400" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a><a id="4401" class="Symbol">))</a>
                     <a id="4425" href="Bitcoin.Script.Base.html#1816" class="Function Operator">`∧</a> <a id="4428" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="4432" href="SecureCompilation.Compiler.html#4301" class="Bound">p</a> <a id="4434" href="SecureCompilation.Compiler.html#5065" class="Function">p⊆as</a>
                     <a id="4460" href="Bitcoin.Script.Base.html#1816" class="Function Operator">`∧</a> <a id="4463" href="Bitcoin.Script.Base.html#3705" class="Function">⋀</a> <a id="4465" class="Symbol">(</a><a id="4466" href="Prelude.Lists.html#3960" class="Function">mapEnumWith∈</a> <a id="4479" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="4482" class="Symbol">(λ</a> <a id="4485" href="SecureCompilation.Compiler.html#4485" class="Bound">i</a> <a id="4487" href="SecureCompilation.Compiler.html#4487" class="Bound">a</a> <a id="4489" href="SecureCompilation.Compiler.html#4489" class="Bound">a∈</a> <a id="4492" class="Symbol">→</a>
                             <a id="4523" class="Keyword">let</a> <a id="4527" href="SecureCompilation.Compiler.html#4527" class="Bound">bi</a> <a id="4530" class="Symbol">=</a> <a id="4532" href="Bitcoin.Script.Base.html#822" class="InductiveConstructor">var</a> <a id="4536" class="Symbol">(</a><a id="4537" href="Data.Fin.Base.html#2272" class="Function">raise</a> <a id="4543" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="4545" href="SecureCompilation.Compiler.html#4485" class="Bound">i</a><a id="4546" class="Symbol">)</a>
                             <a id="4577" class="Keyword">in</a> <a id="4580" class="Symbol">(</a><a id="4581" href="Bitcoin.Script.Base.html#1321" class="InductiveConstructor">hash</a> <a id="4586" href="SecureCompilation.Compiler.html#4527" class="Bound">bi</a> <a id="4589" href="Bitcoin.Script.Base.html#1030" class="InductiveConstructor Operator">`=</a> <a id="4592" href="Bitcoin.Script.Base.html#893" class="InductiveConstructor">`</a> <a id="4594" class="Symbol">(</a><a id="4595" href="SecureCompilation.Compiler.html#3103" class="Bound">sechash₀</a> <a id="4604" class="Symbol">(</a><a id="4605" href="SecureCompilation.Compiler.html#5159" class="Function">as⊆</a> <a id="4609" href="SecureCompilation.Compiler.html#4489" class="Bound">a∈</a><a id="4611" class="Symbol">)))</a> <a id="4615" href="Bitcoin.Script.Base.html#1816" class="Function Operator">`∧</a> <a id="4618" class="Symbol">(</a><a id="4619" href="Bitcoin.Script.Base.html#893" class="InductiveConstructor">`</a> <a id="4621" class="Symbol">(</a><a id="4622" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="4624" href="SecureCompilation.Compiler.html#1708" class="Bound">η</a><a id="4625" class="Symbol">)</a> <a id="4627" href="Bitcoin.Script.Base.html#1088" class="InductiveConstructor Operator">`&lt;</a> <a id="4630" href="Bitcoin.Script.Base.html#1269" class="InductiveConstructor Operator">Script.∣</a> <a id="4639" href="SecureCompilation.Compiler.html#4527" class="Bound">bi</a> <a id="4642" href="Bitcoin.Script.Base.html#1269" class="InductiveConstructor Operator">∣</a><a id="4643" class="Symbol">)))</a>
                        <a id="4671" class="Symbol">)</a>
          <a id="4683" class="Keyword">where</a>
            <a id="4701" href="SecureCompilation.Compiler.html#4701" class="Function">m</a> <a id="4703" class="Symbol">:</a> <a id="4705" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
            <a id="4719" href="SecureCompilation.Compiler.html#4701" class="Function">m</a> <a id="4721" class="Symbol">=</a> <a id="4723" href="Data.List.Base.html#4297" class="Function">length</a> <a id="4730" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a>

            <a id="4746" href="SecureCompilation.Compiler.html#4746" class="Function">p⊆</a> <a id="4749" class="Symbol">:</a> <a id="4751" href="BitML.Contracts.Helpers.html#1368" class="Function">putComponents</a> <a id="4765" class="Bound">D</a> <a id="4767" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="4769" href="BitML.Contracts.Helpers.html#1368" class="Function">putComponents</a> <a id="4783" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a>
            <a id="4798" href="SecureCompilation.Compiler.html#4746" class="Function">p⊆</a> <a id="4801" class="Symbol">=</a> <a id="4803" href="BitML.Contracts.Helpers.html#11704" class="Function">subterms′-collect⊆ᶜˢ</a> <a id="4824" class="Symbol">{</a><a id="4825" class="Argument">ds</a> <a id="4828" class="Symbol">=</a> <a id="4830" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a><a id="4832" class="Symbol">}</a> <a id="4834" class="Bound">D∈</a>

            <a id="4850" href="SecureCompilation.Compiler.html#4850" class="Function">n⊆</a> <a id="4853" class="Symbol">:</a> <a id="4855" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="4861" class="Bound">D</a> <a id="4863" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="4865" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="4871" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a>
            <a id="4886" href="SecureCompilation.Compiler.html#4850" class="Function">n⊆</a> <a id="4889" class="Symbol">=</a> <a id="4891" href="BitML.Contracts.Helpers.html#11704" class="Function">subterms′-collect⊆ᶜˢ</a> <a id="4912" class="Symbol">{</a><a id="4913" class="Argument">d</a> <a id="4915" class="Symbol">=</a> <a id="4917" class="Bound">D</a><a id="4918" class="Symbol">}</a> <a id="4920" class="Symbol">{</a><a id="4921" class="Argument">ds</a> <a id="4924" class="Symbol">=</a> <a id="4926" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a><a id="4928" class="Symbol">}</a> <a id="4930" class="Bound">D∈</a>

            <a id="4946" href="SecureCompilation.Compiler.html#4946" class="Function">put∈</a> <a id="4951" class="Symbol">:</a> <a id="4953" class="Symbol">(</a><a id="4954" href="SecureCompilation.Compiler.html#4284" class="Bound">zs</a> <a id="4957" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4959" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="4962" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4964" href="SecureCompilation.Compiler.html#4301" class="Bound">p</a><a id="4965" class="Symbol">)</a> <a id="4967" href="Data.List.Membership.Setoid.html#882" class="Function Operator">∈</a> <a id="4969" href="BitML.Contracts.Helpers.html#1368" class="Function">putComponents</a> <a id="4983" class="Bound">D</a>
            <a id="4997" href="SecureCompilation.Compiler.html#4946" class="Function">put∈</a> <a id="5002" class="Keyword">rewrite</a> <a id="5010" href="BitML.Contracts.Helpers.html#8747" class="Function">remove-putComponents</a> <a id="5031" class="Symbol">{</a><a id="5032" class="Bound">D</a><a id="5033" class="Symbol">}</a> <a id="5035" class="Symbol">|</a> <a id="5037" href="SecureCompilation.Compiler.html#4312" class="Bound">eq</a> <a id="5040" class="Symbol">=</a> <a id="5042" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="5047" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

            <a id="5065" href="SecureCompilation.Compiler.html#5065" class="Function">p⊆as</a> <a id="5070" class="Symbol">:</a> <a id="5072" href="BitML.Contracts.Helpers.html#1148" class="Function">secrets</a> <a id="5080" href="SecureCompilation.Compiler.html#4301" class="Bound">p</a> <a id="5082" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="5084" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a>
            <a id="5099" href="SecureCompilation.Compiler.html#5065" class="Function">p⊆as</a> <a id="5104" class="Symbol">=</a> <a id="5106" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="5112" class="Symbol">(</a><a id="5113" href="Data.List.Relation.Unary.All.html#5949" class="Function">lookup</a> <a id="5120" href="SecureCompilation.Compiler.html#3079" class="Bound">putComponents⊆</a> <a id="5135" class="Symbol">(</a><a id="5136" href="SecureCompilation.Compiler.html#4746" class="Function">p⊆</a> <a id="5139" href="SecureCompilation.Compiler.html#4946" class="Function">put∈</a><a id="5143" class="Symbol">))</a>

            <a id="5159" href="SecureCompilation.Compiler.html#5159" class="Function">as⊆</a> <a id="5163" class="Symbol">:</a> <a id="5165" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="5168" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="5170" href="BitML.Contracts.Helpers.html#903" class="Function">namesˡ</a> <a id="5177" href="SecureCompilation.Compiler.html#3051" class="Bound">G₀</a>
            <a id="5192" href="SecureCompilation.Compiler.html#5159" class="Function">as⊆</a> <a id="5196" class="Symbol">=</a> <a id="5198" class="Symbol">(λ</a> <a id="5201" href="SecureCompilation.Compiler.html#5201" class="Bound">x</a> <a id="5203" class="Symbol">→</a> <a id="5205" href="Prelude.Lists.html#16997" class="Function">∈-mapMaybe⁺</a> <a id="5217" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="5224" href="SecureCompilation.Compiler.html#5201" class="Bound">x</a> <a id="5226" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5230" class="Symbol">)</a> <a id="5232" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5234" href="SecureCompilation.Compiler.html#3070" class="Bound">names⊆</a> <a id="5241" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5243" href="SecureCompilation.Compiler.html#4850" class="Function">n⊆</a> <a id="5246" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5248" href="SecureCompilation.Compiler.html#5303" class="Function">as⊆′</a> <a id="5253" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5255" href="Data.List.Membership.Propositional.Properties.html#3315" class="Function">∈-map⁺</a> <a id="5262" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a>
              <a id="5281" class="Keyword">where</a>
                <a id="5303" href="SecureCompilation.Compiler.html#5303" class="Function">as⊆′</a> <a id="5308" class="Symbol">:</a> <a id="5310" href="Data.List.Base.html#1497" class="Function">map</a> <a id="5314" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="5319" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="5322" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="5324" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="5330" class="Bound">D</a>
                <a id="5348" href="SecureCompilation.Compiler.html#5303" class="Function">as⊆′</a> <a id="5353" class="Keyword">rewrite</a> <a id="5361" href="BitML.Contracts.Helpers.html#9145" class="Function">remove-names</a> <a id="5374" class="Symbol">{</a><a id="5375" class="Bound">D</a><a id="5376" class="Symbol">}</a> <a id="5378" class="Symbol">|</a> <a id="5380" href="SecureCompilation.Compiler.html#4312" class="Bound">eq</a> <a id="5383" class="Symbol">=</a> <a id="5385" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="5392" class="Symbol">(</a><a id="5393" href="Data.List.Base.html#1497" class="Function">map</a> <a id="5397" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="5402" href="SecureCompilation.Compiler.html#4284" class="Bound">zs</a><a id="5404" class="Symbol">)</a> <a id="5406" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5408" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a>

            <a id="5428" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5432" class="Symbol">:</a> <a id="5434" class="Symbol">(</a><a id="5435" href="SecureCompilation.Compiler.html#5435" class="Bound">e</a> <a id="5437" class="Symbol">:</a> <a id="5439" href="BitML.Predicate.html#492" class="Datatype">Arith</a><a id="5444" class="Symbol">)</a> <a id="5446" class="Symbol">→</a> <a id="5448" href="BitML.Contracts.Helpers.html#1148" class="Function">secrets</a> <a id="5456" href="SecureCompilation.Compiler.html#5435" class="Bound">e</a> <a id="5458" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="5460" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="5463" class="Symbol">→</a> <a id="5465" href="Bitcoin.Script.Base.html#677" class="Datatype">Script</a> <a id="5472" class="Symbol">(</a><a id="5473" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a> <a id="5477" class="Symbol">(</a><a id="5478" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="5480" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5482" href="SecureCompilation.Compiler.html#4701" class="Function">m</a><a id="5483" class="Symbol">))</a> <a id="5486" href="Bitcoin.Script.Base.html#530" class="InductiveConstructor">`ℤ</a>
            <a id="5501" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5505" class="Symbol">(</a><a id="5506" href="BitML.Predicate.html#512" class="InductiveConstructor">Arith.`</a> <a id="5514" href="SecureCompilation.Compiler.html#5514" class="Bound">x</a><a id="5515" class="Symbol">)</a>    <a id="5520" class="Symbol">_</a>   <a id="5524" class="Symbol">=</a> <a id="5526" href="Bitcoin.Script.Base.html#893" class="InductiveConstructor">`</a> <a id="5528" href="SecureCompilation.Compiler.html#5514" class="Bound">x</a>
            <a id="5542" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5546" class="Symbol">(</a><a id="5547" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">Arith.∣</a> <a id="5555" href="SecureCompilation.Compiler.html#5555" class="Bound">s</a> <a id="5557" href="BitML.Predicate.html#531" class="InductiveConstructor Operator">∣</a><a id="5558" class="Symbol">)</a>  <a id="5561" href="SecureCompilation.Compiler.html#5561" class="Bound">⊆as</a> <a id="5565" class="Symbol">=</a> <a id="5567" href="Bitcoin.Script.Base.html#1269" class="InductiveConstructor Operator">Script.∣</a> <a id="5576" href="Bitcoin.Script.Base.html#822" class="InductiveConstructor">var</a> <a id="5580" class="Symbol">(</a><a id="5581" href="Data.Fin.Base.html#2272" class="Function">raise</a> <a id="5587" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="5589" class="Symbol">(</a><a id="5590" href="Data.List.Relation.Unary.Any.html#1909" class="Function">index</a> <a id="5596" class="Symbol">(</a><a id="5597" href="SecureCompilation.Compiler.html#5561" class="Bound">⊆as</a> <a id="5601" class="Symbol">(</a><a id="5602" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="5607" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="5611" class="Symbol">))))</a> <a id="5616" href="Bitcoin.Script.Base.html#1269" class="InductiveConstructor Operator">∣</a> <a id="5618" href="Bitcoin.Script.Base.html#975" class="InductiveConstructor Operator">`-</a> <a id="5621" href="Bitcoin.Script.Base.html#893" class="InductiveConstructor">`</a> <a id="5623" class="Symbol">(</a><a id="5624" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="5626" href="SecureCompilation.Compiler.html#1708" class="Bound">η</a><a id="5627" class="Symbol">)</a>
            <a id="5641" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5645" class="Symbol">(</a><a id="5646" href="SecureCompilation.Compiler.html#5646" class="Bound">x</a> <a id="5648" href="BitML.Predicate.html#555" class="InductiveConstructor Operator">Arith.`+</a> <a id="5657" href="SecureCompilation.Compiler.html#5657" class="Bound">y</a><a id="5658" class="Symbol">)</a> <a id="5660" href="SecureCompilation.Compiler.html#5660" class="Bound">⊆as</a> <a id="5664" class="Symbol">=</a> <a id="5666" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5670" href="SecureCompilation.Compiler.html#5646" class="Bound">x</a> <a id="5672" class="Symbol">(</a><a id="5673" href="SecureCompilation.Compiler.html#5660" class="Bound">⊆as</a> <a id="5677" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5679" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a><a id="5685" class="Symbol">)</a> <a id="5687" href="Bitcoin.Script.Base.html#920" class="InductiveConstructor Operator">`+</a> <a id="5690" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5694" href="SecureCompilation.Compiler.html#5657" class="Bound">y</a> <a id="5696" class="Symbol">(</a><a id="5697" href="SecureCompilation.Compiler.html#5660" class="Bound">⊆as</a> <a id="5701" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5703" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="5710" class="Symbol">_)</a>
            <a id="5725" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5729" class="Symbol">(</a><a id="5730" href="SecureCompilation.Compiler.html#5730" class="Bound">x</a> <a id="5732" href="BitML.Predicate.html#586" class="InductiveConstructor Operator">Arith.`-</a> <a id="5741" href="SecureCompilation.Compiler.html#5741" class="Bound">y</a><a id="5742" class="Symbol">)</a> <a id="5744" href="SecureCompilation.Compiler.html#5744" class="Bound">⊆as</a> <a id="5748" class="Symbol">=</a> <a id="5750" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5754" href="SecureCompilation.Compiler.html#5730" class="Bound">x</a> <a id="5756" class="Symbol">(</a><a id="5757" href="SecureCompilation.Compiler.html#5744" class="Bound">⊆as</a> <a id="5761" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5763" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a><a id="5769" class="Symbol">)</a> <a id="5771" href="Bitcoin.Script.Base.html#975" class="InductiveConstructor Operator">`-</a> <a id="5774" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="5778" href="SecureCompilation.Compiler.html#5741" class="Bound">y</a> <a id="5780" class="Symbol">(</a><a id="5781" href="SecureCompilation.Compiler.html#5744" class="Bound">⊆as</a> <a id="5785" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5787" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="5794" class="Symbol">_)</a>

            <a id="5810" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="5814" class="Symbol">:</a> <a id="5816" class="Symbol">(</a><a id="5817" href="SecureCompilation.Compiler.html#5817" class="Bound">e</a> <a id="5819" class="Symbol">:</a> <a id="5821" href="BitML.Predicate.html#682" class="Datatype">Predicate</a><a id="5830" class="Symbol">)</a> <a id="5832" class="Symbol">→</a> <a id="5834" href="BitML.Contracts.Helpers.html#1148" class="Function">secrets</a> <a id="5842" href="SecureCompilation.Compiler.html#5817" class="Bound">e</a> <a id="5844" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="5846" href="SecureCompilation.Compiler.html#4295" class="Bound">as</a> <a id="5849" class="Symbol">→</a> <a id="5851" href="Bitcoin.Script.Base.html#677" class="Datatype">Script</a> <a id="5858" class="Symbol">(</a><a id="5859" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a> <a id="5863" class="Symbol">(</a><a id="5864" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="5866" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5868" href="SecureCompilation.Compiler.html#4701" class="Function">m</a><a id="5869" class="Symbol">))</a> <a id="5872" href="Bitcoin.Script.Base.html#524" class="InductiveConstructor">`Bool</a>
            <a id="5890" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="5894" href="BitML.Predicate.html#706" class="InductiveConstructor">Predicate.`true</a>     <a id="5914" class="Symbol">_</a>   <a id="5918" class="Symbol">=</a> <a id="5920" href="Bitcoin.Script.Base.html#1763" class="Function">`true</a>
            <a id="5938" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="5942" class="Symbol">(</a><a id="5943" href="SecureCompilation.Compiler.html#5943" class="Bound">p</a> <a id="5945" href="BitML.Predicate.html#726" class="InductiveConstructor Operator">Predicate.`∧</a> <a id="5958" href="SecureCompilation.Compiler.html#5958" class="Bound">p′</a><a id="5960" class="Symbol">)</a> <a id="5962" href="SecureCompilation.Compiler.html#5962" class="Bound">⊆as</a> <a id="5966" class="Symbol">=</a> <a id="5968" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="5972" href="SecureCompilation.Compiler.html#5943" class="Bound">p</a> <a id="5974" class="Symbol">(</a><a id="5975" href="SecureCompilation.Compiler.html#5962" class="Bound">⊆as</a> <a id="5979" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5981" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a><a id="5987" class="Symbol">)</a> <a id="5989" href="Bitcoin.Script.Base.html#1816" class="Function Operator">`∧</a> <a id="5992" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="5996" href="SecureCompilation.Compiler.html#5958" class="Bound">p′</a> <a id="5999" class="Symbol">(</a><a id="6000" href="SecureCompilation.Compiler.html#5962" class="Bound">⊆as</a> <a id="6004" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6006" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="6013" class="Symbol">_)</a>
            <a id="6028" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="6032" class="Symbol">(</a><a id="6033" href="BitML.Predicate.html#770" class="InductiveConstructor Operator">Predicate.`¬</a> <a id="6046" href="SecureCompilation.Compiler.html#6046" class="Bound">p</a><a id="6047" class="Symbol">)</a>    <a id="6052" href="SecureCompilation.Compiler.html#6052" class="Bound">⊆as</a> <a id="6056" class="Symbol">=</a> <a id="6058" href="Bitcoin.Script.Base.html#2013" class="Function">`not</a> <a id="6063" class="Symbol">(</a><a id="6064" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="6068" href="SecureCompilation.Compiler.html#6046" class="Bound">p</a> <a id="6070" href="SecureCompilation.Compiler.html#6052" class="Bound">⊆as</a><a id="6073" class="Symbol">)</a>
            <a id="6087" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="6091" class="Symbol">(</a><a id="6092" href="SecureCompilation.Compiler.html#6092" class="Bound">x</a> <a id="6094" href="BitML.Predicate.html#802" class="InductiveConstructor Operator">Predicate.`=</a> <a id="6107" href="SecureCompilation.Compiler.html#6107" class="Bound">y</a><a id="6108" class="Symbol">)</a>  <a id="6111" href="SecureCompilation.Compiler.html#6111" class="Bound">⊆as</a> <a id="6115" class="Symbol">=</a> <a id="6117" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="6121" href="SecureCompilation.Compiler.html#6092" class="Bound">x</a> <a id="6123" class="Symbol">(</a><a id="6124" href="SecureCompilation.Compiler.html#6111" class="Bound">⊆as</a> <a id="6128" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6130" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a><a id="6136" class="Symbol">)</a> <a id="6138" href="Bitcoin.Script.Base.html#1030" class="InductiveConstructor Operator">`=</a> <a id="6141" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="6145" href="SecureCompilation.Compiler.html#6107" class="Bound">y</a> <a id="6147" class="Symbol">(</a><a id="6148" href="SecureCompilation.Compiler.html#6111" class="Bound">⊆as</a> <a id="6152" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6154" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="6161" class="Symbol">_)</a>
            <a id="6176" href="SecureCompilation.Compiler.html#5810" class="Function">Bᵖʳ</a> <a id="6180" class="Symbol">(</a><a id="6181" href="SecureCompilation.Compiler.html#6181" class="Bound">x</a> <a id="6183" href="BitML.Predicate.html#838" class="InductiveConstructor Operator">Predicate.`&lt;</a> <a id="6196" href="SecureCompilation.Compiler.html#6196" class="Bound">y</a><a id="6197" class="Symbol">)</a>  <a id="6200" href="SecureCompilation.Compiler.html#6200" class="Bound">⊆as</a> <a id="6204" class="Symbol">=</a> <a id="6206" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="6210" href="SecureCompilation.Compiler.html#6181" class="Bound">x</a> <a id="6212" class="Symbol">(</a><a id="6213" href="SecureCompilation.Compiler.html#6200" class="Bound">⊆as</a> <a id="6217" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6219" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a><a id="6225" class="Symbol">)</a> <a id="6227" href="Bitcoin.Script.Base.html#1088" class="InductiveConstructor Operator">`&lt;</a> <a id="6230" href="SecureCompilation.Compiler.html#5428" class="Function">Bᵃʳ</a> <a id="6234" href="SecureCompilation.Compiler.html#6196" class="Bound">y</a> <a id="6236" class="Symbol">(</a><a id="6237" href="SecureCompilation.Compiler.html#6200" class="Bound">⊆as</a> <a id="6241" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6243" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="6250" class="Symbol">_)</a>
    <a id="6257" class="CatchallClause Symbol">...</a><a id="6260" class="CatchallClause"> </a><a id="6261" class="CatchallClause Symbol">|</a><a id="6262" class="CatchallClause"> </a><a id="6263" class="CatchallClause Symbol">_</a><a id="6264" class="CatchallClause"> </a><a id="6265" class="CatchallClause Symbol">|</a><a id="6266" class="CatchallClause"> </a><a id="6267" class="CatchallClause Symbol">_</a>
        <a id="6277" class="Symbol">=</a> <a id="6279" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a> <a id="6283" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a> <a id="6285" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6287" href="Bitcoin.Script.Base.html#1389" class="InductiveConstructor">versig</a> <a id="6294" class="Symbol">(</a><a id="6295" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="6304" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="6310" class="Symbol">(</a><a id="6311" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a> <a id="6314" class="Bound">D∈</a><a id="6316" class="Symbol">))</a> <a id="6319" class="Symbol">(</a><a id="6320" href="Data.List.Base.html#5754" class="Function">allFin</a> <a id="6327" href="SecureCompilation.Compiler.html#3608" class="Function">ς</a><a id="6328" class="Symbol">)</a>


    <a id="6336" href="SecureCompilation.Compiler.html#6336" class="Function">Tᵢₙᵢₜ</a> <a id="6342" class="Symbol">:</a> <a id="6344" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
    <a id="6352" href="SecureCompilation.Compiler.html#6336" class="Function">Tᵢₙᵢₜ</a> <a id="6358" class="Symbol">=</a> <a id="6360" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="6363" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="6366" class="Keyword">record</a>
      <a id="6379" class="Symbol">{</a> <a id="6381" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="6389" class="Symbol">=</a> <a id="6391" href="Data.Vec.Base.html#7501" class="Function">V.fromList</a> <a id="6402" class="Symbol">(</a><a id="6403" href="Prelude.Lists.html#10366" class="Function">codom</a> <a id="6409" href="SecureCompilation.Compiler.html#3112" class="Bound">txout₀</a><a id="6415" class="Symbol">)</a>
      <a id="6423" class="Symbol">;</a> <a id="6425" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="6433" class="Symbol">=</a> <a id="6435" href="Bitcoin.Tx.Crypto.html#552" class="Function">wit⊥</a>
      <a id="6446" class="Symbol">;</a> <a id="6448" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="6456" class="Symbol">=</a> <a id="6458" href="Data.Vec.Base.html#5745" class="Function">V.replicate</a> <a id="6470" class="Number">0</a>
      <a id="6478" class="Symbol">;</a> <a id="6480" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="6488" class="Symbol">=</a> <a id="6490" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="6494" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="6497" class="Keyword">record</a> <a id="6504" class="Symbol">{</a> <a id="6506" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="6512" class="Symbol">=</a> <a id="6514" href="SecureCompilation.Compiler.html#3633" class="Function">V₀</a> <a id="6517" class="Symbol">;</a> <a id="6519" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="6529" class="Symbol">=</a> <a id="6531" href="Bitcoin.Script.Base.html#2150" class="InductiveConstructor Operator">ƛ</a> <a id="6533" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6539" class="Symbol">(</a><a id="6540" href="Bitcoin.Script.Base.html#3442" class="Function">⋁</a> <a id="6542" class="Symbol">(</a><a id="6543" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="6552" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a> <a id="6555" class="Symbol">(</a><a id="6556" href="SecureCompilation.Compiler.html#4142" class="Function">Bout</a> <a id="6561" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="6563" href="SecureCompilation.Compiler.html#6616" class="Function">cs⊆</a><a id="6566" class="Symbol">)))</a> <a id="6570" class="Symbol">}</a> <a id="6572" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
      <a id="6580" class="Symbol">;</a> <a id="6582" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="6590" class="Symbol">=</a> <a id="6592" class="Number">0</a> <a id="6594" class="Symbol">}</a>
      <a id="6602" class="Keyword">where</a>
        <a id="6616" href="SecureCompilation.Compiler.html#6616" class="Function">cs⊆</a> <a id="6620" class="Symbol">:</a> <a id="6622" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a> <a id="6625" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="6627" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="6637" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a>
        <a id="6649" href="SecureCompilation.Compiler.html#6616" class="Function">cs⊆</a> <a id="6653" class="Symbol">=</a> <a id="6655" href="BitML.Contracts.Helpers.html#11283" class="Function">subterms⊆ᶜˢ</a> <a id="6667" class="Symbol">{</a><a id="6668" class="Argument">ds</a> <a id="6671" class="Symbol">=</a> <a id="6673" href="SecureCompilation.Compiler.html#3061" class="Bound">C₀</a><a id="6675" class="Symbol">}</a>

    <a id="6682" href="SecureCompilation.Compiler.html#6682" class="Function">Tᵢₙᵢₜ♯</a> <a id="6689" class="Symbol">=</a> <a id="6691" href="Bitcoin.Tx.Crypto.html#720" class="Function">hashTx</a> <a id="6698" href="SecureCompilation.Compiler.html#6336" class="Function">Tᵢₙᵢₜ</a>

    <a id="6709" class="Keyword">infix</a> <a id="6715" class="Number">0</a> <a id="6717" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_</a>
    <a id="6743" class="Keyword">record</a> <a id="6750" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="6756" class="Symbol">(</a><a id="6757" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="6759" class="Symbol">:</a> <a id="6761" href="BitML.Contracts.Induction.html#377" class="Datatype">ℂ</a><a id="6762" class="Symbol">)</a> <a id="6764" class="Symbol">:</a> <a id="6766" class="PrimitiveType">Set</a> <a id="6770" class="Keyword">where</a>
      <a id="6782" class="Keyword">constructor</a> <a id="6794" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_&amp;_</a>
      <a id="6822" class="Keyword">field</a>
        <a id="6836" href="SecureCompilation.Compiler.html#6836" class="Field">T,o</a>  <a id="6841" class="Symbol">:</a> <a id="6843" href="Bitcoin.Tx.Base.html#343" class="Record">TxInput</a>
        <a id="6859" href="SecureCompilation.Compiler.html#6859" class="Field">curV</a> <a id="6864" class="Symbol">:</a> <a id="6866" href="BitML.BasicTypes.html#229" class="Function">Value</a>
        <a id="6880" href="SecureCompilation.Compiler.html#6880" class="Field">P</a>    <a id="6885" class="Symbol">:</a> <a id="6887" href="Data.Product.html#1369" class="Function">∃</a> <a id="6889" class="Symbol">(</a><a id="6890" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">_⊆</a> <a id="6893" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a><a id="6898" class="Symbol">)</a>
        <a id="6908" href="SecureCompilation.Compiler.html#6908" class="Field">curT</a> <a id="6913" class="Symbol">:</a> <a id="6915" href="BitML.BasicTypes.html#382" class="Function">Time</a>

        <a id="6929" href="SecureCompilation.Compiler.html#6929" class="Field">p⊆</a> <a id="6932" class="Symbol">:</a> <a id="6934" href="BitML.Contracts.Helpers.html#1225" class="Function">participants</a> <a id="6947" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="6949" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="6951" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a>

        <a id="6966" class="Comment">-- Bout : subterms′ c ↦ (∃[ ctx ] Script ctx `Bool)</a>
        <a id="7026" class="Comment">-- K²   : subterms′ c ↦ (partG ↦ KeyPair)</a>
        <a id="7076" href="SecureCompilation.Compiler.html#7076" class="Field">s⊆</a> <a id="7079" class="Symbol">:</a> <a id="7081" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="7091" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7093" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="7095" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="7105" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a>
        <a id="7117" href="SecureCompilation.Compiler.html#7117" class="Field">∃s</a> <a id="7120" class="Symbol">:</a> <a id="7122" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="7127" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7129" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="7132" class="Symbol">λ{</a> <a id="7135" class="Symbol">(</a><a id="7136" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="7138" class="Symbol">_)</a> <a id="7141" class="Symbol">→</a> <a id="7143" href="Data.Product.html#1369" class="Function">∃</a> <a id="7145" class="Symbol">(</a><a id="7146" href="Data.List.Membership.Setoid.html#882" class="Function Operator">_∈</a> <a id="7149" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="7159" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a><a id="7162" class="Symbol">)</a> <a id="7164" class="Symbol">;</a> <a id="7166" class="CatchallClause Symbol">_</a> <a id="7168" class="Symbol">→</a> <a id="7170" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="7171" class="Symbol">}</a>

        <a id="7182" href="SecureCompilation.Compiler.html#7182" class="Field">sechash</a> <a id="7190" class="Symbol">:</a> <a id="7192" href="BitML.Contracts.Helpers.html#903" class="Function">namesˡ</a> <a id="7199" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7201" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="7203" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
        <a id="7213" href="SecureCompilation.Compiler.html#7213" class="Field">txout</a>   <a id="7221" class="Symbol">:</a> <a id="7223" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="7230" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7232" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="7234" href="Bitcoin.Tx.Base.html#343" class="Record">TxInput</a>
        <a id="7250" href="SecureCompilation.Compiler.html#7250" class="Field">part</a>    <a id="7258" class="Symbol">:</a> <a id="7260" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="7267" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7269" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="7271" href="Data.Product.html#1369" class="Function">∃</a> <a id="7273" class="Symbol">(</a><a id="7274" href="Data.List.Membership.Setoid.html#882" class="Function Operator">_∈</a> <a id="7277" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a><a id="7282" class="Symbol">)</a>
        <a id="7292" href="SecureCompilation.Compiler.html#7292" class="Field">val</a>     <a id="7300" class="Symbol">:</a> <a id="7302" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="7309" href="SecureCompilation.Compiler.html#6757" class="Bound">c</a> <a id="7311" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="7313" href="BitML.BasicTypes.html#229" class="Function">Value</a>
    <a id="7323" class="Keyword">open</a> <a id="7328" href="SecureCompilation.Compiler.html#6750" class="Module">State</a>

    <a id="7339" href="SecureCompilation.Compiler.html#7339" class="Function">Return</a> <a id="7346" class="Symbol">:</a> <a id="7348" href="BitML.Contracts.Induction.html#377" class="Datatype">ℂ</a> <a id="7350" class="Symbol">→</a> <a id="7352" class="PrimitiveType">Set</a>
    <a id="7360" href="SecureCompilation.Compiler.html#7339" class="Function">Return</a> <a id="7367" href="SecureCompilation.Compiler.html#7367" class="Bound">c</a> <a id="7369" class="Symbol">=</a> <a id="7371" href="BitML.Contracts.Helpers.html#10077" class="Function">subterms⁺</a> <a id="7381" href="SecureCompilation.Compiler.html#7367" class="Bound">c</a> <a id="7383" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="7385" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>

    <a id="7394" href="SecureCompilation.Compiler.html#7394" class="Function">↓</a> <a id="7396" class="Symbol">:</a> <a id="7398" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="7404" class="Symbol">(</a><a id="7405" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="7408" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a><a id="7410" class="Symbol">)</a> <a id="7412" class="Symbol">→</a> <a id="7414" href="BitML.Contracts.Types.html#1261" class="Generalizable">ds</a> <a id="7417" href="Prelude.Lists.html#10128" class="Function Operator">↦′</a> <a id="7420" class="Symbol">(</a><a id="7421" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="7427" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7429" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a><a id="7430" class="Symbol">)</a>
    <a id="7436" href="SecureCompilation.Compiler.html#7394" class="Function">↓</a> <a id="7438" class="Symbol">{</a><a id="7439" class="Argument">ds</a> <a id="7442" class="Symbol">=</a> <a id="7444" href="SecureCompilation.Compiler.html#7444" class="Bound">d</a> <a id="7446" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7448" href="SecureCompilation.Compiler.html#7448" class="Bound">ds</a><a id="7450" class="Symbol">}</a> <a id="7452" class="Symbol">(</a><a id="7453" href="SecureCompilation.Compiler.html#7453" class="Bound">T,o</a> <a id="7457" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7459" href="SecureCompilation.Compiler.html#7459" class="Bound">v</a> <a id="7461" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7463" href="SecureCompilation.Compiler.html#7463" class="Bound">P⊆</a> <a id="7466" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7468" href="SecureCompilation.Compiler.html#7468" class="Bound">t</a> <a id="7470" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7472" href="SecureCompilation.Compiler.html#7472" class="Bound">p⊆</a> <a id="7475" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7477" href="SecureCompilation.Compiler.html#7477" class="Bound">s⊆</a> <a id="7480" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7482" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="7485" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7487" href="SecureCompilation.Compiler.html#7487" class="Bound">sechash</a> <a id="7495" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7497" href="SecureCompilation.Compiler.html#7497" class="Bound">txout</a> <a id="7503" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7505" href="SecureCompilation.Compiler.html#7505" class="Bound">part</a> <a id="7510" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7512" href="SecureCompilation.Compiler.html#7512" class="Bound">val</a><a id="7515" class="Symbol">)</a> <a id="7517" class="Symbol">(</a><a id="7518" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="7523" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7527" class="Symbol">)</a>
      <a id="7535" class="Symbol">=</a> <a id="7537" href="SecureCompilation.Compiler.html#7453" class="Bound">T,o</a> <a id="7541" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7543" href="SecureCompilation.Compiler.html#7459" class="Bound">v</a> <a id="7545" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7547" href="SecureCompilation.Compiler.html#7463" class="Bound">P⊆</a> <a id="7550" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7552" href="SecureCompilation.Compiler.html#7468" class="Bound">t</a> <a id="7554" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7556" href="SecureCompilation.Compiler.html#7472" class="Bound">p⊆</a> <a id="7559" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7561" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a> <a id="7568" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7570" href="SecureCompilation.Compiler.html#7811" class="Function">s⊆′</a> <a id="7574" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7576" class="Symbol">(</a><a id="7577" href="SecureCompilation.Compiler.html#7444" class="Bound">d</a> <a id="7579" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7581" href="SecureCompilation.Compiler.html#7477" class="Bound">s⊆</a> <a id="7584" class="Symbol">(</a><a id="7585" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="7590" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="7594" class="Symbol">))</a>
      <a id="7603" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7605" href="SecureCompilation.Compiler.html#7487" class="Bound">sechash</a> <a id="7613" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7615" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="7626" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="7633" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a> <a id="7636" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7638" href="SecureCompilation.Compiler.html#7497" class="Bound">txout</a> <a id="7644" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7646" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="7657" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="7664" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a>
      <a id="7673" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7675" href="SecureCompilation.Compiler.html#7505" class="Bound">part</a> <a id="7680" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7682" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="7693" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="7700" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a> <a id="7703" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7705" href="SecureCompilation.Compiler.html#7512" class="Bound">val</a> <a id="7709" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7711" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="7722" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="7729" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a>
      <a id="7738" class="Keyword">where</a>
        <a id="7752" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a> <a id="7755" class="Symbol">:</a> <a id="7757" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="7763" href="SecureCompilation.Compiler.html#7444" class="Bound">d</a> <a id="7765" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="7767" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="7773" class="Symbol">(</a><a id="7774" href="SecureCompilation.Compiler.html#7444" class="Bound">d</a> <a id="7776" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7778" href="SecureCompilation.Compiler.html#7448" class="Bound">ds</a><a id="7780" class="Symbol">)</a>
        <a id="7790" href="SecureCompilation.Compiler.html#7752" class="Function">n⊆</a> <a id="7793" class="Symbol">=</a> <a id="7795" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a>

        <a id="7811" href="SecureCompilation.Compiler.html#7811" class="Function">s⊆′</a> <a id="7815" class="Symbol">:</a> <a id="7817" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="7827" class="Symbol">(</a><a id="7828" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="7830" href="SecureCompilation.Compiler.html#7444" class="Bound">d</a><a id="7831" class="Symbol">)</a> <a id="7833" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="7835" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="7845" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a>
        <a id="7857" href="SecureCompilation.Compiler.html#7811" class="Function">s⊆′</a> <a id="7861" class="Symbol">=</a> <a id="7863" href="SecureCompilation.Compiler.html#7477" class="Bound">s⊆</a> <a id="7866" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7868" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="7874" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7876" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a>
    <a id="7887" href="SecureCompilation.Compiler.html#7394" class="Function">↓</a> <a id="7889" class="Symbol">{</a><a id="7890" class="Argument">ds</a> <a id="7893" class="Symbol">=</a> <a id="7895" href="SecureCompilation.Compiler.html#7895" class="Bound">d</a> <a id="7897" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7899" href="SecureCompilation.Compiler.html#7899" class="Bound">ds</a><a id="7901" class="Symbol">}</a> <a id="7903" class="Symbol">(</a><a id="7904" href="SecureCompilation.Compiler.html#7904" class="Bound">T,o</a> <a id="7908" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7910" href="SecureCompilation.Compiler.html#7910" class="Bound">v</a> <a id="7912" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7914" href="SecureCompilation.Compiler.html#7914" class="Bound">P⊆</a> <a id="7917" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7919" href="SecureCompilation.Compiler.html#7919" class="Bound">t</a> <a id="7921" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7923" href="SecureCompilation.Compiler.html#7923" class="Bound">p⊆</a> <a id="7926" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7928" href="SecureCompilation.Compiler.html#7928" class="Bound">s⊆</a> <a id="7931" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7933" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="7936" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7938" href="SecureCompilation.Compiler.html#7938" class="Bound">sechash</a> <a id="7946" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7948" href="SecureCompilation.Compiler.html#7948" class="Bound">txout</a> <a id="7954" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7956" href="SecureCompilation.Compiler.html#7956" class="Bound">part</a> <a id="7961" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="7963" href="SecureCompilation.Compiler.html#7963" class="Bound">val</a><a id="7966" class="Symbol">)</a> <a id="7968" class="Symbol">(</a><a id="7969" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="7975" href="SecureCompilation.Compiler.html#7975" class="Bound">x∈</a><a id="7977" class="Symbol">)</a>
      <a id="7985" class="Symbol">=</a> <a id="7987" href="SecureCompilation.Compiler.html#7394" class="Function">↓</a> <a id="7989" class="Symbol">{</a><a id="7990" class="Argument">ds</a> <a id="7993" class="Symbol">=</a> <a id="7995" href="SecureCompilation.Compiler.html#7899" class="Bound">ds</a><a id="7997" class="Symbol">}</a> <a id="7999" class="Symbol">(</a><a id="8000" href="SecureCompilation.Compiler.html#7904" class="Bound">T,o</a> <a id="8004" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8006" href="SecureCompilation.Compiler.html#7910" class="Bound">v</a> <a id="8008" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8010" href="SecureCompilation.Compiler.html#7914" class="Bound">P⊆</a> <a id="8013" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8015" href="SecureCompilation.Compiler.html#7919" class="Bound">t</a>
      <a id="8023" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8025" href="SecureCompilation.Compiler.html#7923" class="Bound">p⊆</a> <a id="8028" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8030" class="Symbol">(</a><a id="8031" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="8038" class="Symbol">_)</a> <a id="8041" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8043" href="SecureCompilation.Compiler.html#7928" class="Bound">s⊆</a> <a id="8046" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8048" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="8055" class="Symbol">_</a> <a id="8057" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8059" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
      <a id="8068" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8070" href="SecureCompilation.Compiler.html#7938" class="Bound">sechash</a> <a id="8078" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8080" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8091" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="8098" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a> <a id="8101" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8103" href="SecureCompilation.Compiler.html#7948" class="Bound">txout</a> <a id="8109" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8111" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8122" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8129" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a>
      <a id="8138" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8140" href="SecureCompilation.Compiler.html#7956" class="Bound">part</a> <a id="8145" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8147" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8158" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8165" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a> <a id="8168" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8170" href="SecureCompilation.Compiler.html#7963" class="Bound">val</a> <a id="8174" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8176" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8187" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8194" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a><a id="8196" class="Symbol">)</a> <a id="8198" href="SecureCompilation.Compiler.html#7975" class="Bound">x∈</a>
      <a id="8207" class="Keyword">where</a>
        <a id="8221" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a> <a id="8224" class="Symbol">:</a> <a id="8226" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="8232" href="SecureCompilation.Compiler.html#7899" class="Bound">ds</a> <a id="8235" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="8237" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="8243" class="Symbol">(</a><a id="8244" href="SecureCompilation.Compiler.html#7895" class="Bound">d</a> <a id="8246" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8248" href="SecureCompilation.Compiler.html#7899" class="Bound">ds</a><a id="8250" class="Symbol">)</a>
        <a id="8260" href="SecureCompilation.Compiler.html#8221" class="Function">n⊆</a> <a id="8263" class="Symbol">=</a> <a id="8265" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="8272" class="Symbol">_</a>

    <a id="8279" href="SecureCompilation.Compiler.html#8279" class="Function">↓ᵛ</a> <a id="8282" class="Symbol">:</a> <a id="8284" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="8290" class="Symbol">(</a><a id="8291" href="BitML.Contracts.Induction.html#436" class="InductiveConstructor">VCS</a> <a id="8295" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a><a id="8298" class="Symbol">)</a> <a id="8300" class="Symbol">→</a> <a id="8302" href="Data.List.Base.html#1497" class="Function">map</a> <a id="8306" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8312" href="BitML.Contracts.Types.html#1287" class="Generalizable">vcs</a> <a id="8316" href="Prelude.Lists.html#10128" class="Function Operator">↦′</a> <a id="8319" class="Symbol">(</a><a id="8320" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="8326" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8328" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a><a id="8330" class="Symbol">)</a>
    <a id="8336" href="SecureCompilation.Compiler.html#8279" class="Function">↓ᵛ</a> <a id="8339" class="Symbol">{</a><a id="8340" class="Argument">vcs</a> <a id="8344" class="Symbol">=</a> <a id="8346" class="Symbol">(</a><a id="8347" href="SecureCompilation.Compiler.html#8347" class="Bound">v</a> <a id="8349" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8351" href="SecureCompilation.Compiler.html#8351" class="Bound">cs</a><a id="8353" class="Symbol">)</a> <a id="8355" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8357" href="SecureCompilation.Compiler.html#8357" class="Bound">vcs</a><a id="8360" class="Symbol">}</a> <a id="8362" class="Symbol">(</a><a id="8363" href="SecureCompilation.Compiler.html#8363" class="Bound">T,o</a> <a id="8367" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8369" class="Symbol">_</a> <a id="8371" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8373" href="SecureCompilation.Compiler.html#8373" class="Bound">P⊆</a> <a id="8376" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8378" href="SecureCompilation.Compiler.html#8378" class="Bound">t</a> <a id="8380" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8382" href="SecureCompilation.Compiler.html#8382" class="Bound">p⊆</a> <a id="8385" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8387" href="SecureCompilation.Compiler.html#8387" class="Bound">s⊆</a> <a id="8390" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8392" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="8395" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8397" href="SecureCompilation.Compiler.html#8397" class="Bound">sechash</a> <a id="8405" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8407" href="SecureCompilation.Compiler.html#8407" class="Bound">txout</a> <a id="8413" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8415" href="SecureCompilation.Compiler.html#8415" class="Bound">part</a> <a id="8420" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8422" href="SecureCompilation.Compiler.html#8422" class="Bound">val</a><a id="8425" class="Symbol">)</a> <a id="8427" class="Symbol">(</a><a id="8428" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="8433" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8437" class="Symbol">)</a>
      <a id="8445" class="Symbol">=</a> <a id="8447" href="SecureCompilation.Compiler.html#8363" class="Bound">T,o</a> <a id="8451" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8453" href="SecureCompilation.Compiler.html#8347" class="Bound">v</a> <a id="8455" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8457" href="SecureCompilation.Compiler.html#8373" class="Bound">P⊆</a> <a id="8460" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8462" href="SecureCompilation.Compiler.html#8378" class="Bound">t</a> <a id="8464" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8466" href="SecureCompilation.Compiler.html#8382" class="Bound">p⊆</a> <a id="8469" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8471" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a> <a id="8478" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8480" href="SecureCompilation.Compiler.html#8387" class="Bound">s⊆</a> <a id="8483" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8485" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a> <a id="8492" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8494" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
      <a id="8503" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8505" href="SecureCompilation.Compiler.html#8397" class="Bound">sechash</a> <a id="8513" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8515" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8526" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="8533" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a> <a id="8536" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8538" href="SecureCompilation.Compiler.html#8407" class="Bound">txout</a> <a id="8544" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8546" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8557" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8564" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a>
      <a id="8573" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8575" href="SecureCompilation.Compiler.html#8415" class="Bound">part</a> <a id="8580" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8582" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8593" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8600" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a> <a id="8603" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8605" href="SecureCompilation.Compiler.html#8422" class="Bound">val</a> <a id="8609" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8611" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8622" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8629" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a>
      <a id="8638" class="Keyword">where</a>
        <a id="8652" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a> <a id="8655" class="Symbol">:</a> <a id="8657" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="8663" href="SecureCompilation.Compiler.html#8351" class="Bound">cs</a> <a id="8666" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="8668" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="8674" class="Symbol">((</a><a id="8676" href="SecureCompilation.Compiler.html#8347" class="Bound">v</a> <a id="8678" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8680" href="SecureCompilation.Compiler.html#8351" class="Bound">cs</a><a id="8682" class="Symbol">)</a> <a id="8684" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8686" href="SecureCompilation.Compiler.html#8357" class="Bound">vcs</a><a id="8689" class="Symbol">)</a>
        <a id="8699" href="SecureCompilation.Compiler.html#8652" class="Function">n⊆</a> <a id="8702" class="Symbol">=</a> <a id="8704" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a>
    <a id="8715" href="SecureCompilation.Compiler.html#8279" class="Function">↓ᵛ</a> <a id="8718" class="Symbol">{</a><a id="8719" class="Argument">vcs</a> <a id="8723" class="Symbol">=</a> <a id="8725" class="Symbol">(</a><a id="8726" href="SecureCompilation.Compiler.html#8726" class="Bound">v</a> <a id="8728" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8730" href="SecureCompilation.Compiler.html#8730" class="Bound">cs</a><a id="8732" class="Symbol">)</a> <a id="8734" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8736" href="SecureCompilation.Compiler.html#8736" class="Bound">vcs</a><a id="8739" class="Symbol">}</a> <a id="8741" class="Symbol">((</a><a id="8743" href="SecureCompilation.Compiler.html#8743" class="Bound">T</a> <a id="8745" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">at</a> <a id="8748" href="SecureCompilation.Compiler.html#8748" class="Bound">o</a><a id="8749" class="Symbol">)</a> <a id="8751" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8753" class="Symbol">_</a> <a id="8755" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8757" href="SecureCompilation.Compiler.html#8757" class="Bound">P⊆</a> <a id="8760" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8762" href="SecureCompilation.Compiler.html#8762" class="Bound">t</a> <a id="8764" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8766" href="SecureCompilation.Compiler.html#8766" class="Bound">p⊆</a> <a id="8769" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8771" href="SecureCompilation.Compiler.html#8771" class="Bound">s⊆</a> <a id="8774" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8776" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="8779" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8781" href="SecureCompilation.Compiler.html#8781" class="Bound">sechash</a> <a id="8789" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8791" href="SecureCompilation.Compiler.html#8791" class="Bound">txout</a> <a id="8797" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8799" href="SecureCompilation.Compiler.html#8799" class="Bound">part</a> <a id="8804" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8806" href="SecureCompilation.Compiler.html#8806" class="Bound">val</a><a id="8809" class="Symbol">)</a> <a id="8811" class="Symbol">(</a><a id="8812" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="8818" href="SecureCompilation.Compiler.html#8818" class="Bound">x∈</a><a id="8820" class="Symbol">)</a>
      <a id="8828" class="Symbol">=</a> <a id="8830" href="SecureCompilation.Compiler.html#8279" class="Function">↓ᵛ</a> <a id="8833" class="Symbol">{</a><a id="8834" class="Argument">vcs</a> <a id="8838" class="Symbol">=</a> <a id="8840" href="SecureCompilation.Compiler.html#8736" class="Bound">vcs</a><a id="8843" class="Symbol">}</a> <a id="8845" class="Symbol">((</a><a id="8847" href="SecureCompilation.Compiler.html#8743" class="Bound">T</a> <a id="8849" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">at</a> <a id="8852" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="8856" href="SecureCompilation.Compiler.html#8748" class="Bound">o</a><a id="8857" class="Symbol">)</a> <a id="8859" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8861" href="SecureCompilation.Compiler.html#8726" class="Bound">v</a> <a id="8863" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8865" href="SecureCompilation.Compiler.html#8757" class="Bound">P⊆</a> <a id="8868" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8870" href="SecureCompilation.Compiler.html#8762" class="Bound">t</a>
      <a id="8878" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8880" href="SecureCompilation.Compiler.html#8766" class="Bound">p⊆</a> <a id="8883" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8885" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="8892" class="Symbol">_</a> <a id="8894" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8896" href="SecureCompilation.Compiler.html#8771" class="Bound">s⊆</a> <a id="8899" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8901" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="8908" class="Symbol">_</a> <a id="8910" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8912" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
      <a id="8921" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8923" href="SecureCompilation.Compiler.html#8781" class="Bound">sechash</a> <a id="8931" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8933" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8944" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="8951" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a> <a id="8954" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8956" href="SecureCompilation.Compiler.html#8791" class="Bound">txout</a> <a id="8962" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8964" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="8975" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="8982" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a>
      <a id="8991" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="8993" href="SecureCompilation.Compiler.html#8799" class="Bound">part</a> <a id="8998" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9000" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="9011" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="9018" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a> <a id="9021" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9023" href="SecureCompilation.Compiler.html#8806" class="Bound">val</a> <a id="9027" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9029" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="9040" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="9047" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a><a id="9049" class="Symbol">)</a> <a id="9051" href="SecureCompilation.Compiler.html#8818" class="Bound">x∈</a>
      <a id="9060" class="Keyword">where</a>
        <a id="9074" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a> <a id="9077" class="Symbol">:</a> <a id="9079" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="9085" href="SecureCompilation.Compiler.html#8736" class="Bound">vcs</a> <a id="9089" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="9091" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="9097" class="Symbol">((</a><a id="9099" href="SecureCompilation.Compiler.html#8726" class="Bound">v</a> <a id="9101" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9103" href="SecureCompilation.Compiler.html#8730" class="Bound">cs</a><a id="9105" class="Symbol">)</a> <a id="9107" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="9109" href="SecureCompilation.Compiler.html#8736" class="Bound">vcs</a><a id="9112" class="Symbol">)</a>
        <a id="9122" href="SecureCompilation.Compiler.html#9074" class="Function">n⊆</a> <a id="9125" class="Symbol">=</a> <a id="9127" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="9134" class="Symbol">_</a>

    <a id="9141" href="SecureCompilation.Compiler.html#9141" class="Function">go</a> <a id="9144" class="Symbol">:</a> <a id="9146" class="Symbol">∀</a> <a id="9148" href="SecureCompilation.Compiler.html#9148" class="Bound">c</a> <a id="9150" class="Symbol">→</a> <a id="9152" class="Symbol">(∀</a> <a id="9155" href="SecureCompilation.Compiler.html#9155" class="Bound">c′</a> <a id="9158" class="Symbol">→</a> <a id="9160" href="SecureCompilation.Compiler.html#9155" class="Bound">c′</a> <a id="9163" href="BitML.Contracts.Induction.html#463" class="Datatype Operator">≺</a> <a id="9165" href="SecureCompilation.Compiler.html#9148" class="Bound">c</a> <a id="9167" class="Symbol">→</a> <a id="9169" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="9175" href="SecureCompilation.Compiler.html#9155" class="Bound">c′</a> <a id="9178" class="Symbol">→</a> <a id="9180" href="SecureCompilation.Compiler.html#7339" class="Function">Return</a> <a id="9187" href="SecureCompilation.Compiler.html#9155" class="Bound">c′</a><a id="9189" class="Symbol">)</a> <a id="9191" class="Symbol">→</a> <a id="9193" href="SecureCompilation.Compiler.html#6750" class="Record">State</a> <a id="9199" href="SecureCompilation.Compiler.html#9148" class="Bound">c</a> <a id="9201" class="Symbol">→</a> <a id="9203" href="SecureCompilation.Compiler.html#7339" class="Function">Return</a> <a id="9210" href="SecureCompilation.Compiler.html#9148" class="Bound">c</a>
    <a id="9216" href="SecureCompilation.Compiler.html#9141" class="Function">go</a> <a id="9219" class="Symbol">(</a><a id="9220" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="9222" href="SecureCompilation.Compiler.html#9222" class="Bound">c</a><a id="9223" class="Symbol">)</a> <a id="9225" href="SecureCompilation.Compiler.html#9225" class="Bound">f</a> <a id="9227" class="Symbol">(</a><a id="9228" href="SecureCompilation.Compiler.html#9228" class="Bound">T,o</a> <a id="9232" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9234" href="SecureCompilation.Compiler.html#9234" class="Bound">v</a> <a id="9236" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9238" class="Symbol">(</a><a id="9239" href="SecureCompilation.Compiler.html#9239" class="Bound">P</a> <a id="9241" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9243" href="SecureCompilation.Compiler.html#9243" class="Bound">P⊆</a><a id="9245" class="Symbol">)</a> <a id="9247" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9249" href="SecureCompilation.Compiler.html#9249" class="Bound">t</a> <a id="9251" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9253" href="SecureCompilation.Compiler.html#9253" class="Bound">p⊆</a> <a id="9256" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9258" href="SecureCompilation.Compiler.html#9258" class="Bound">s⊆</a> <a id="9261" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9263" href="SecureCompilation.Compiler.html#9263" class="Bound">∃s</a><a id="9265" class="Symbol">@(</a><a id="9267" href="SecureCompilation.Compiler.html#9267" class="Bound">Dₚ</a> <a id="9270" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9272" href="SecureCompilation.Compiler.html#9272" class="Bound">Dₚ∈</a><a id="9275" class="Symbol">)</a> <a id="9277" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9279" href="SecureCompilation.Compiler.html#9279" class="Bound">sechash</a> <a id="9287" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9289" href="SecureCompilation.Compiler.html#9289" class="Bound">txout</a> <a id="9295" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9297" href="SecureCompilation.Compiler.html#9297" class="Bound">part</a> <a id="9302" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9304" href="SecureCompilation.Compiler.html#9304" class="Bound">val</a><a id="9307" class="Symbol">)</a>
      <a id="9315" class="Keyword">with</a> <a id="9320" href="SecureCompilation.Compiler.html#9222" class="Bound">c</a>
    <a id="9326" class="Comment">-- Bd</a>
    <a id="9336" class="Symbol">...</a> <a id="9340" class="Symbol">|</a> <a id="9342" href="BitML.Contracts.Types.html#886" class="InductiveConstructor">withdraw</a> <a id="9351" href="SecureCompilation.Compiler.html#9351" class="Bound">A</a> <a id="9353" class="Symbol">=</a> <a id="9355" class="Symbol">λ</a>
      <a id="9363" class="Symbol">{(</a><a id="9365" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="9370" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="9374" class="Symbol">)</a> <a id="9376" class="Symbol">→</a>
        <a id="9386" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="9389" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="9392" href="Bitcoin.Tx.Crypto.html#1043" class="Function">sig⋆</a> <a id="9397" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="9401" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="9410" class="Bound">P</a> <a id="9412" class="Symbol">(</a><a id="9413" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a> <a id="9416" class="Bound">Dₚ∈</a> <a id="9420" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9422" class="Bound">P⊆</a><a id="9424" class="Symbol">)</a> <a id="9426" href="Data.Vec.Base.html#5711" class="Function Operator">]</a> <a id="9428" class="Keyword">record</a>
          <a id="9445" class="Symbol">{</a> <a id="9447" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="9455" class="Symbol">=</a> <a id="9457" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="9461" class="Bound">T,o</a> <a id="9465" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
          <a id="9477" class="Symbol">;</a> <a id="9479" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="9487" class="Symbol">=</a> <a id="9489" href="Bitcoin.Tx.Crypto.html#552" class="Function">wit⊥</a>
          <a id="9504" class="Symbol">;</a> <a id="9506" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="9514" class="Symbol">=</a> <a id="9516" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="9520" class="Number">0</a> <a id="9522" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
          <a id="9534" class="Symbol">;</a> <a id="9536" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="9544" class="Symbol">=</a> <a id="9546" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="9550" href="Bitcoin.Script.Base.html#351" class="InductiveConstructor">Ctx</a> <a id="9554" class="Number">1</a> <a id="9556" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9558" class="Keyword">record</a> <a id="9565" class="Symbol">{</a> <a id="9567" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="9573" class="Symbol">=</a> <a id="9575" class="Bound">v</a> <a id="9577" class="Symbol">;</a> <a id="9579" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="9589" class="Symbol">=</a> <a id="9591" href="Bitcoin.Script.Base.html#2150" class="InductiveConstructor Operator">ƛ</a> <a id="9593" href="Bitcoin.Script.Base.html#1389" class="InductiveConstructor">versig</a> <a id="9600" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="9602" href="SecureCompilation.Compiler.html#3119" class="Bound">K</a> <a id="9604" class="Symbol">{</a><a id="9605" href="SecureCompilation.Compiler.html#9351" class="Bound">A</a><a id="9606" class="Symbol">}</a> <a id="9608" class="Symbol">(</a><a id="9609" class="Bound">p⊆</a> <a id="9612" class="Symbol">(</a><a id="9613" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="9618" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="9622" class="Symbol">))</a> <a id="9625" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="9627" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="9629" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a> <a id="9632" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="9634" class="Symbol">}</a> <a id="9636" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
          <a id="9648" class="Symbol">;</a> <a id="9650" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="9658" class="Symbol">=</a> <a id="9660" class="Bound">t</a> <a id="9662" class="Symbol">}</a>
      <a id="9670" class="Symbol">}</a>
    <a id="9676" class="Symbol">...</a> <a id="9680" class="Symbol">|</a> <a id="9682" href="SecureCompilation.Compiler.html#9682" class="Bound">A</a> <a id="9684" href="BitML.Contracts.Types.html#1021" class="InductiveConstructor Operator">⇒</a> <a id="9686" href="SecureCompilation.Compiler.html#9686" class="Bound">d</a>
        <a id="9696" class="Symbol">=</a> <a id="9698" class="Bound">f</a> <a id="9700" class="Symbol">(</a><a id="9701" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="9703" href="SecureCompilation.Compiler.html#9686" class="Bound">d</a><a id="9704" class="Symbol">)</a> <a id="9706" href="BitML.Contracts.Induction.html#630" class="InductiveConstructor">≺-auth</a> <a id="9713" class="Symbol">(</a><a id="9714" class="Bound">T,o</a> <a id="9718" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9720" class="Bound">v</a> <a id="9722" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9724" class="Symbol">(</a><a id="9725" class="Bound">P</a> <a id="9727" href="Prelude.Set%2527.html#3343" class="Function Operator">\\</a> <a id="9730" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="9732" href="SecureCompilation.Compiler.html#9682" class="Bound">A</a> <a id="9734" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="9736" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9738" class="Bound">P⊆</a> <a id="9741" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9743" href="Prelude.Set%2527.html#8128" class="Postulate">\\-⊆</a><a id="9747" class="Symbol">)</a> <a id="9749" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9751" class="Bound">t</a> <a id="9753" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9755" class="Bound">p⊆</a> <a id="9758" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9760" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="9766" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9768" class="Bound">s⊆</a> <a id="9771" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9773" class="Bound">∃s</a> <a id="9776" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9778" class="Bound">sechash</a> <a id="9786" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9788" class="Bound">txout</a> <a id="9794" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9796" class="Bound">part</a> <a id="9801" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9803" class="Bound">val</a><a id="9806" class="Symbol">)</a>
    <a id="9812" class="Symbol">...</a> <a id="9816" class="Symbol">|</a> <a id="9818" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">after</a> <a id="9824" href="SecureCompilation.Compiler.html#9824" class="Bound">t′</a> <a id="9827" href="BitML.Contracts.Types.html#1094" class="InductiveConstructor Operator">⇒</a> <a id="9829" href="SecureCompilation.Compiler.html#9829" class="Bound">d</a>
        <a id="9839" class="Symbol">=</a> <a id="9841" class="Bound">f</a> <a id="9843" class="Symbol">(</a><a id="9844" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="9846" href="SecureCompilation.Compiler.html#9829" class="Bound">d</a><a id="9847" class="Symbol">)</a> <a id="9849" href="BitML.Contracts.Induction.html#660" class="InductiveConstructor">≺-after</a> <a id="9857" class="Symbol">(</a><a id="9858" class="Bound">T,o</a> <a id="9862" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9864" class="Bound">v</a> <a id="9866" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9868" class="Symbol">(</a><a id="9869" class="Bound">P</a> <a id="9871" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9873" class="Bound">P⊆</a><a id="9875" class="Symbol">)</a> <a id="9877" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9879" class="Bound">t</a> <a id="9881" href="Data.Nat.Base.html#1640" class="Function Operator">⊔</a> <a id="9883" href="SecureCompilation.Compiler.html#9824" class="Bound">t′</a> <a id="9886" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9888" class="Bound">p⊆</a> <a id="9891" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9893" class="Bound">s⊆</a> <a id="9896" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9898" class="Bound">∃s</a> <a id="9901" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9903" class="Bound">sechash</a> <a id="9911" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9913" class="Bound">txout</a> <a id="9919" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9921" class="Bound">part</a> <a id="9926" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="9928" class="Bound">val</a><a id="9931" class="Symbol">)</a>
    <a id="9937" class="Comment">-- Bc</a>
    <a id="9947" class="Symbol">...</a> <a id="9951" class="Symbol">|</a> <a id="9953" href="SecureCompilation.Compiler.html#9953" class="Bound">c′</a><a id="9955" class="Symbol">@(</a><a id="9957" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">put</a> <a id="9961" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="9964" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">&amp;reveal</a> <a id="9972" href="SecureCompilation.Compiler.html#9972" class="Bound">as</a> <a id="9975" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">if</a> <a id="9978" href="SecureCompilation.Compiler.html#9978" class="Bound">p</a> <a id="9980" href="BitML.Contracts.Types.html#771" class="InductiveConstructor Operator">⇒</a> <a id="9982" href="SecureCompilation.Compiler.html#9982" class="Bound">cs</a><a id="9984" class="Symbol">)</a> <a id="9986" class="Symbol">=</a> <a id="9988" class="Symbol">λ</a>
      <a id="9996" class="Symbol">{</a> <a id="9998" class="Symbol">(</a><a id="9999" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="10004" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10008" class="Symbol">)</a> <a id="10010" class="Symbol">→</a> <a id="10012" href="SecureCompilation.Compiler.html#10978" class="Function">Tc</a>
      <a id="10021" class="Symbol">;</a> <a id="10023" class="Symbol">(</a><a id="10024" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="10030" href="SecureCompilation.Compiler.html#10030" class="Bound">x∈</a><a id="10032" class="Symbol">)</a>  <a id="10035" class="Symbol">→</a> <a id="10037" class="Bound">f</a> <a id="10039" class="Symbol">(</a><a id="10040" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="10043" href="SecureCompilation.Compiler.html#9982" class="Bound">cs</a><a id="10045" class="Symbol">)</a> <a id="10047" href="BitML.Contracts.Induction.html#576" class="InductiveConstructor">≺-put</a>
          <a id="10063" class="Symbol">((</a><a id="10065" href="SecureCompilation.Compiler.html#11295" class="Function">Tc♯</a> <a id="10069" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">at</a> <a id="10072" class="Number">0</a><a id="10073" class="Symbol">)</a> <a id="10075" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10077" class="Bound">v</a> <a id="10079" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10081" class="Symbol">(</a><a id="10082" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="10088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10090" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html#1761" class="Function">⊆-refl</a><a id="10096" class="Symbol">)</a> <a id="10098" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10100" class="Number">0</a>
          <a id="10112" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10114" class="Bound">p⊆</a> <a id="10117" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10119" class="Bound">s⊆</a> <a id="10122" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10124" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
          <a id="10137" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10139" class="Bound">sechash</a> <a id="10147" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10149" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="10160" href="Data.Sum.html#734" class="Function">isInj₁</a> <a id="10167" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a> <a id="10170" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10172" class="Bound">txout</a> <a id="10178" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10180" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="10191" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="10198" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a>
          <a id="10211" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10213" class="Bound">part</a> <a id="10218" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10220" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="10231" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="10238" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a> <a id="10241" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="10243" class="Bound">val</a> <a id="10247" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10249" href="Prelude.Lists.html#17269" class="Function">mapMaybe-⊆</a> <a id="10260" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="10267" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a><a id="10269" class="Symbol">)</a>
          <a id="10281" href="SecureCompilation.Compiler.html#10030" class="Bound">x∈</a>
      <a id="10290" class="Symbol">}</a>
      <a id="10298" class="Keyword">where</a>
        <a id="10312" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a> <a id="10315" class="Symbol">:</a> <a id="10317" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="10323" href="SecureCompilation.Compiler.html#9982" class="Bound">cs</a> <a id="10326" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="10328" href="BitML.Contracts.Helpers.html#847" class="Function">names</a> <a id="10334" href="SecureCompilation.Compiler.html#9953" class="Bound">c′</a>
        <a id="10345" href="SecureCompilation.Compiler.html#10312" class="Function">n⊆</a> <a id="10348" class="Symbol">=</a> <a id="10350" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="10357" class="Symbol">(</a><a id="10358" href="Data.List.Base.html#1497" class="Function">map</a> <a id="10362" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a> <a id="10367" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a><a id="10369" class="Symbol">)</a> <a id="10371" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10373" href="Data.List.Membership.Propositional.Properties.html#3992" class="Function">∈-++⁺ʳ</a> <a id="10380" class="Symbol">(</a><a id="10381" href="Data.List.Base.html#1497" class="Function">map</a> <a id="10385" href="Data.Sum.Base.html#778" class="InductiveConstructor">inj₁</a> <a id="10390" href="SecureCompilation.Compiler.html#9972" class="Bound">as</a><a id="10392" class="Symbol">)</a>

        <a id="10403" href="SecureCompilation.Compiler.html#10403" class="Function">cs⊆</a> <a id="10407" class="Symbol">:</a> <a id="10409" href="SecureCompilation.Compiler.html#9982" class="Bound">cs</a> <a id="10412" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="10414" href="BitML.Contracts.Helpers.html#10725" class="Function">subterms′</a> <a id="10424" href="SecureCompilation.Compiler.html#3558" class="Function">CS₀</a>
        <a id="10436" href="SecureCompilation.Compiler.html#10403" class="Function">cs⊆</a> <a id="10440" class="Symbol">=</a> <a id="10442" class="Bound">s⊆</a> <a id="10445" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10447" href="BitML.Contracts.Helpers.html#11283" class="Function">subterms⊆ᶜˢ</a>

        <a id="10468" href="SecureCompilation.Compiler.html#10468" class="Function">zs⊆</a> <a id="10472" class="Symbol">:</a> <a id="10474" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10477" href="Data.List.Relation.Binary.Subset.Setoid.html#692" class="Function Operator">⊆</a> <a id="10479" href="BitML.Contracts.Helpers.html#984" class="Function">namesʳ</a> <a id="10486" href="SecureCompilation.Compiler.html#9953" class="Bound">c′</a>
        <a id="10497" href="SecureCompilation.Compiler.html#10468" class="Function">zs⊆</a> <a id="10501" class="Symbol">=</a> <a id="10503" class="Symbol">(λ</a> <a id="10506" href="SecureCompilation.Compiler.html#10506" class="Bound">x∈</a> <a id="10509" class="Symbol">→</a> <a id="10511" href="Prelude.Lists.html#16997" class="Function">∈-mapMaybe⁺</a> <a id="10523" href="Data.Sum.html#817" class="Function">isInj₂</a> <a id="10530" href="SecureCompilation.Compiler.html#10506" class="Bound">x∈</a> <a id="10533" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10537" class="Symbol">)</a> <a id="10539" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10541" href="Data.List.Membership.Propositional.Properties.html#3903" class="Function">∈-++⁺ˡ</a> <a id="10548" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10550" href="Data.List.Membership.Propositional.Properties.html#3315" class="Function">∈-map⁺</a> <a id="10557" href="Data.Sum.Base.html#803" class="InductiveConstructor">inj₂</a>

        <a id="10571" href="SecureCompilation.Compiler.html#10571" class="Function">k</a> <a id="10573" class="Symbol">=</a> <a id="10575" href="Data.List.Base.html#4297" class="Function">length</a> <a id="10582" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a>

        <a id="10594" href="SecureCompilation.Compiler.html#10594" class="Function">ins</a> <a id="10598" class="Symbol">:</a> <a id="10600" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="10604" href="Bitcoin.Tx.Base.html#343" class="Record">TxInput</a> <a id="10612" href="SecureCompilation.Compiler.html#10571" class="Function">k</a>
        <a id="10622" href="SecureCompilation.Compiler.html#10594" class="Function">ins</a> <a id="10626" class="Keyword">rewrite</a> <a id="10634" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="10638" class="Symbol">(</a><a id="10639" href="Data.List.Membership.Setoid.Properties.html#4081" class="Function">length-mapWith∈</a> <a id="10655" class="Symbol">(</a><a id="10656" href="Relation.Binary.PropositionalEquality.html#2283" class="Function">setoid</a> <a id="10663" class="Symbol">_)</a> <a id="10666" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10669" class="Symbol">{</a><a id="10670" class="Argument">f</a> <a id="10672" class="Symbol">=</a> <a id="10674" class="Bound">txout</a> <a id="10680" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10682" href="SecureCompilation.Compiler.html#10468" class="Function">zs⊆</a><a id="10685" class="Symbol">})</a>
                  <a id="10706" class="Symbol">=</a> <a id="10708" href="Data.Vec.Base.html#7501" class="Function">V.fromList</a> <a id="10719" class="Symbol">(</a><a id="10720" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="10729" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10732" class="Symbol">(</a><a id="10733" class="Bound">txout</a> <a id="10739" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10741" href="SecureCompilation.Compiler.html#10468" class="Function">zs⊆</a><a id="10744" class="Symbol">))</a>

        <a id="10756" href="SecureCompilation.Compiler.html#10756" class="Function">K⋆</a> <a id="10759" class="Symbol">:</a> <a id="10761" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10764" href="Prelude.Lists.html#10250" class="Function Operator">↦</a> <a id="10766" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10771" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a>
        <a id="10787" href="SecureCompilation.Compiler.html#10756" class="Function">K⋆</a> <a id="10790" class="Symbol">=</a> <a id="10792" href="Data.List.Base.html#4458" class="Function Operator">[_]</a> <a id="10796" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10798" href="SecureCompilation.Compiler.html#3119" class="Bound">K</a> <a id="10800" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10802" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10808" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10810" class="Bound">part</a> <a id="10815" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="10817" href="SecureCompilation.Compiler.html#10468" class="Function">zs⊆</a>

        <a id="10830" href="SecureCompilation.Compiler.html#10830" class="Function">wits</a> <a id="10835" class="Symbol">:</a> <a id="10837" href="Data.Vec.Base.html#959" class="Datatype">Vec</a> <a id="10841" class="Symbol">(</a><a id="10842" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10847" href="Bitcoin.Crypto.html#321" class="Record">KeyPair</a><a id="10854" class="Symbol">)</a> <a id="10856" href="SecureCompilation.Compiler.html#10571" class="Function">k</a>
        <a id="10866" href="SecureCompilation.Compiler.html#10830" class="Function">wits</a> <a id="10871" class="Keyword">rewrite</a> <a id="10879" href="Relation.Binary.PropositionalEquality.Core.html#980" class="Function">sym</a> <a id="10883" class="Symbol">(</a><a id="10884" href="Data.List.Membership.Setoid.Properties.html#4081" class="Function">length-mapWith∈</a> <a id="10900" class="Symbol">(</a><a id="10901" href="Relation.Binary.PropositionalEquality.html#2283" class="Function">setoid</a> <a id="10908" class="Symbol">_)</a> <a id="10911" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10914" class="Symbol">{</a><a id="10915" href="SecureCompilation.Compiler.html#10756" class="Function">K⋆</a><a id="10917" class="Symbol">})</a>
                   <a id="10939" class="Symbol">=</a> <a id="10941" href="Data.Vec.Base.html#7501" class="Function">V.fromList</a> <a id="10952" class="Symbol">(</a><a id="10953" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="10962" href="SecureCompilation.Compiler.html#9961" class="Bound">zs</a> <a id="10965" href="SecureCompilation.Compiler.html#10756" class="Function">K⋆</a><a id="10967" class="Symbol">)</a>

        <a id="10978" href="SecureCompilation.Compiler.html#10978" class="Function">Tc</a> <a id="10981" class="Symbol">:</a> <a id="10983" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="10995" href="SecureCompilation.Compiler.html#10978" class="Function">Tc</a> <a id="10998" class="Symbol">=</a> <a id="11000" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="11004" href="SecureCompilation.Compiler.html#10571" class="Function">k</a> <a id="11006" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11008" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="11011" href="Bitcoin.Tx.Crypto.html#1043" class="Function">sig⋆</a> <a id="11016" class="Symbol">(</a><a id="11017" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="11026" class="Bound">P</a> <a id="11028" class="Symbol">(</a><a id="11029" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a> <a id="11032" class="Bound">Dₚ∈</a> <a id="11036" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="11038" class="Bound">P⊆</a><a id="11040" class="Symbol">)</a> <a id="11042" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">V.∷</a> <a id="11046" href="SecureCompilation.Compiler.html#10830" class="Function">wits</a><a id="11050" class="Symbol">)</a> <a id="11052" class="Keyword">record</a>
          <a id="11069" class="Symbol">{</a> <a id="11071" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="11079" class="Symbol">=</a> <a id="11081" class="Bound">T,o</a> <a id="11085" href="Data.Vec.Base.html#1014" class="InductiveConstructor Operator">V.∷</a> <a id="11089" href="SecureCompilation.Compiler.html#10594" class="Function">ins</a>
          <a id="11103" class="Symbol">;</a> <a id="11105" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="11113" class="Symbol">=</a> <a id="11115" href="Bitcoin.Tx.Crypto.html#552" class="Function">wit⊥</a>
          <a id="11130" class="Symbol">;</a> <a id="11132" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="11140" class="Symbol">=</a> <a id="11142" href="Data.Vec.Base.html#5745" class="Function">V.replicate</a> <a id="11154" class="Number">0</a>
          <a id="11166" class="Symbol">;</a> <a id="11168" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="11176" class="Symbol">=</a> <a id="11178" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="11182" class="Symbol">_</a> <a id="11184" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11186" class="Keyword">record</a> <a id="11193" class="Symbol">{</a> <a id="11195" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="11201" class="Symbol">=</a> <a id="11203" class="Bound">v</a><a id="11204" class="Symbol">;</a> <a id="11206" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="11216" class="Symbol">=</a> <a id="11218" href="Bitcoin.Script.Base.html#2150" class="InductiveConstructor Operator">ƛ</a> <a id="11220" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="11226" class="Symbol">(</a><a id="11227" href="Bitcoin.Script.Base.html#3442" class="Function">⋁</a> <a id="11229" class="Symbol">(</a><a id="11230" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="11239" href="SecureCompilation.Compiler.html#9982" class="Bound">cs</a> <a id="11242" class="Symbol">(</a><a id="11243" href="SecureCompilation.Compiler.html#4142" class="Function">Bout</a> <a id="11248" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="11250" href="SecureCompilation.Compiler.html#10403" class="Function">cs⊆</a><a id="11253" class="Symbol">)))</a> <a id="11257" class="Symbol">}</a> <a id="11259" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
          <a id="11271" class="Symbol">;</a> <a id="11273" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="11281" class="Symbol">=</a> <a id="11283" class="Bound">t</a> <a id="11285" class="Symbol">}</a>
        <a id="11295" href="SecureCompilation.Compiler.html#11295" class="Function">Tc♯</a> <a id="11299" class="Symbol">=</a> <a id="11301" href="Bitcoin.Tx.Crypto.html#720" class="Function">hashTx</a> <a id="11308" href="SecureCompilation.Compiler.html#10978" class="Function">Tc</a>
    <a id="11315" class="Comment">-- Bpar</a>
    <a id="11327" class="Symbol">...</a> <a id="11331" class="Symbol">|</a> <a id="11333" href="SecureCompilation.Compiler.html#11333" class="Bound">c′</a><a id="11335" class="Symbol">@(</a><a id="11337" href="BitML.Contracts.Types.html#946" class="InductiveConstructor">split</a> <a id="11343" href="SecureCompilation.Compiler.html#11343" class="Bound">vcs</a><a id="11346" class="Symbol">)</a> <a id="11348" class="Symbol">=</a> <a id="11350" class="Symbol">λ</a>
      <a id="11358" class="Symbol">{</a> <a id="11360" class="Symbol">(</a><a id="11361" href="Data.List.Relation.Unary.Any.html#1174" class="InductiveConstructor">here</a> <a id="11366" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="11370" class="Symbol">)</a> <a id="11372" class="Symbol">→</a> <a id="11374" href="SecureCompilation.Compiler.html#11731" class="Function">Tc</a>
      <a id="11383" class="Symbol">;</a> <a id="11385" class="Symbol">(</a><a id="11386" href="Data.List.Relation.Unary.Any.html#1227" class="InductiveConstructor">there</a> <a id="11392" href="SecureCompilation.Compiler.html#11392" class="Bound">x∈</a><a id="11394" class="Symbol">)</a>  <a id="11397" class="Symbol">→</a> <a id="11399" class="Bound">f</a> <a id="11401" class="Symbol">(</a><a id="11402" href="BitML.Contracts.Induction.html#436" class="InductiveConstructor">VCS</a> <a id="11406" href="SecureCompilation.Compiler.html#11343" class="Bound">vcs</a><a id="11409" class="Symbol">)</a> <a id="11411" href="BitML.Contracts.Induction.html#696" class="InductiveConstructor">≺-split</a>
          <a id="11429" class="Symbol">((</a><a id="11431" href="SecureCompilation.Compiler.html#12076" class="Function">Tc♯</a> <a id="11435" href="Bitcoin.Tx.Base.html#377" class="InductiveConstructor Operator">at</a> <a id="11438" class="Number">0</a><a id="11439" class="Symbol">)</a> <a id="11441" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11443" class="Bound">v</a> <a id="11445" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11447" class="Symbol">(</a><a id="11448" href="SecureCompilation.Compiler.html#3576" class="Function">partG</a> <a id="11454" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11456" href="Data.List.Relation.Binary.Subset.Propositional.Properties.html#1761" class="Function">⊆-refl</a><a id="11462" class="Symbol">)</a> <a id="11464" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11466" class="Number">0</a>
          <a id="11478" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11480" class="Bound">p⊆</a> <a id="11483" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11485" class="Bound">s⊆</a> <a id="11488" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11490" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
          <a id="11503" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11505" class="Bound">sechash</a> <a id="11513" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11515" class="Bound">txout</a> <a id="11521" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11523" class="Bound">part</a> <a id="11528" href="SecureCompilation.Compiler.html#6794" class="InductiveConstructor Operator">&amp;</a> <a id="11530" class="Bound">val</a><a id="11533" class="Symbol">)</a>
          <a id="11545" href="SecureCompilation.Compiler.html#11392" class="Bound">x∈</a>
      <a id="11554" class="Symbol">}</a>
      <a id="11562" class="Keyword">where</a>
        <a id="11576" href="SecureCompilation.Compiler.html#11576" class="Function">eᵢⱼ</a> <a id="11580" class="Symbol">:</a> <a id="11582" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="11587" class="Symbol">(</a><a id="11588" href="BitML.BasicTypes.html#229" class="Function">Value</a> <a id="11594" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="11596" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="11601" class="Symbol">(</a><a id="11602" href="Data.Product.html#1788" class="Function">∃[</a> <a id="11605" href="SecureCompilation.Compiler.html#11605" class="Bound">ctx</a> <a id="11609" href="Data.Product.html#1788" class="Function">]</a> <a id="11611" href="Bitcoin.Script.Base.html#677" class="Datatype">Script</a> <a id="11618" href="SecureCompilation.Compiler.html#11605" class="Bound">ctx</a> <a id="11622" href="Bitcoin.Script.Base.html#524" class="InductiveConstructor">`Bool</a><a id="11627" class="Symbol">))</a>
        <a id="11638" href="SecureCompilation.Compiler.html#11576" class="Function">eᵢⱼ</a> <a id="11642" class="Symbol">=</a> <a id="11644" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="11653" href="SecureCompilation.Compiler.html#11343" class="Bound">vcs</a> <a id="11657" class="Symbol">λ{</a> <a id="11660" class="Symbol">{</a><a id="11661" href="SecureCompilation.Compiler.html#11661" class="Bound">v</a> <a id="11663" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11665" href="SecureCompilation.Compiler.html#11665" class="Bound">Cᵢ</a><a id="11667" class="Symbol">}</a> <a id="11669" href="SecureCompilation.Compiler.html#11669" class="Bound">x∈</a> <a id="11672" class="Symbol">→</a> <a id="11674" href="SecureCompilation.Compiler.html#11661" class="Bound">v</a> <a id="11676" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11678" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="11687" href="SecureCompilation.Compiler.html#11665" class="Bound">Cᵢ</a> <a id="11690" class="Symbol">(</a><a id="11691" href="SecureCompilation.Compiler.html#4142" class="Function">Bout</a> <a id="11696" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="11698" class="Bound">s⊆</a> <a id="11701" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="11703" href="BitML.Contracts.Helpers.html#11461" class="Function">subterms⊆ᵛᶜˢ</a> <a id="11716" href="SecureCompilation.Compiler.html#11669" class="Bound">x∈</a><a id="11718" class="Symbol">)</a> <a id="11720" class="Symbol">}</a>

        <a id="11731" href="SecureCompilation.Compiler.html#11731" class="Function">Tc</a> <a id="11734" class="Symbol">:</a> <a id="11736" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="11748" href="SecureCompilation.Compiler.html#11731" class="Function">Tc</a> <a id="11751" class="Symbol">=</a> <a id="11753" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="11756" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="11759" href="Bitcoin.Tx.Crypto.html#1043" class="Function">sig⋆</a> <a id="11764" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="11768" href="Data.List.Membership.Setoid.html#1123" class="Function">mapWith∈</a> <a id="11777" class="Bound">P</a> <a id="11779" class="Symbol">(</a><a id="11780" href="SecureCompilation.Compiler.html#3121" class="Bound">K²</a> <a id="11783" class="Bound">Dₚ∈</a> <a id="11787" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="11789" class="Bound">P⊆</a><a id="11791" class="Symbol">)</a> <a id="11793" href="Data.Vec.Base.html#5711" class="Function Operator">]</a> <a id="11795" class="Keyword">record</a>
          <a id="11812" class="Symbol">{</a> <a id="11814" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="11822" class="Symbol">=</a> <a id="11824" href="Data.Vec.Base.html#5711" class="Function Operator">V.[</a> <a id="11828" class="Bound">T,o</a> <a id="11832" href="Data.Vec.Base.html#5711" class="Function Operator">]</a>
          <a id="11844" class="Symbol">;</a> <a id="11846" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="11854" class="Symbol">=</a> <a id="11856" href="Bitcoin.Tx.Crypto.html#552" class="Function">wit⊥</a>
          <a id="11871" class="Symbol">;</a> <a id="11873" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="11881" class="Symbol">=</a> <a id="11883" href="Data.Vec.Base.html#5745" class="Function">V.replicate</a> <a id="11895" class="Number">0</a>
          <a id="11907" class="Symbol">;</a> <a id="11909" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="11917" class="Symbol">=</a> <a id="11919" href="Data.Vec.Base.html#2541" class="Function">V.map</a> <a id="11925" class="Symbol">(λ{</a> <a id="11929" class="Symbol">(</a><a id="11930" href="SecureCompilation.Compiler.html#11930" class="Bound">vᵢ</a> <a id="11933" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11935" href="SecureCompilation.Compiler.html#11935" class="Bound">eᵢ</a><a id="11937" class="Symbol">)</a> <a id="11939" class="Symbol">→</a> <a id="11941" href="Data.Product.html#2196" class="Function Operator">-,</a> <a id="11944" class="Keyword">record</a> <a id="11951" class="Symbol">{</a> <a id="11953" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="11959" class="Symbol">=</a> <a id="11961" href="SecureCompilation.Compiler.html#11930" class="Bound">vᵢ</a> <a id="11964" class="Symbol">;</a> <a id="11966" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="11976" class="Symbol">=</a> <a id="11978" href="Bitcoin.Script.Base.html#2150" class="InductiveConstructor Operator">ƛ</a> <a id="11980" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="11986" class="Symbol">(</a><a id="11987" href="Bitcoin.Script.Base.html#3442" class="Function">⋁</a> <a id="11989" href="SecureCompilation.Compiler.html#11935" class="Bound">eᵢ</a><a id="11991" class="Symbol">)</a> <a id="11993" class="Symbol">}})</a>
                            <a id="12025" class="Symbol">(</a><a id="12026" href="Data.Vec.Base.html#7501" class="Function">V.fromList</a> <a id="12037" href="SecureCompilation.Compiler.html#11576" class="Function">eᵢⱼ</a><a id="12040" class="Symbol">)</a>
          <a id="12052" class="Symbol">;</a> <a id="12054" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="12062" class="Symbol">=</a> <a id="12064" class="Bound">t</a> <a id="12066" class="Symbol">}</a>
        <a id="12076" href="SecureCompilation.Compiler.html#12076" class="Function">Tc♯</a> <a id="12080" class="Symbol">=</a> <a id="12082" href="Bitcoin.Tx.Crypto.html#720" class="Function">hashTx</a> <a id="12089" href="SecureCompilation.Compiler.html#11731" class="Function">Tc</a>

    <a id="12097" href="SecureCompilation.Compiler.html#9141" class="Function">go</a> <a id="12100" class="Symbol">(</a><a id="12101" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="12104" href="SecureCompilation.Compiler.html#12104" class="Bound">x</a><a id="12105" class="Symbol">)</a> <a id="12107" href="SecureCompilation.Compiler.html#12107" class="Bound">f</a>  <a id="12110" href="SecureCompilation.Compiler.html#12110" class="Bound">st</a> <a id="12113" class="Symbol">=</a> <a id="12115" href="BitML.Contracts.Helpers.html#12612" class="Function">↦-∈</a>  <a id="12120" class="Symbol">λ</a> <a id="12122" class="Symbol">{</a><a id="12123" href="SecureCompilation.Compiler.html#12123" class="Bound">d</a><a id="12124" class="Symbol">}</a>  <a id="12127" href="SecureCompilation.Compiler.html#12127" class="Bound">d∈</a>  <a id="12131" class="Symbol">→</a> <a id="12133" href="SecureCompilation.Compiler.html#12107" class="Bound">f</a> <a id="12135" class="Symbol">(</a><a id="12136" href="BitML.Contracts.Induction.html#393" class="InductiveConstructor">C</a> <a id="12138" href="SecureCompilation.Compiler.html#12123" class="Bound">d</a><a id="12139" class="Symbol">)</a>   <a id="12143" class="Symbol">(</a><a id="12144" href="BitML.Contracts.Induction.html#487" class="InductiveConstructor">≺-∈</a> <a id="12148" href="SecureCompilation.Compiler.html#12127" class="Bound">d∈</a><a id="12150" class="Symbol">)</a>   <a id="12154" class="Symbol">(</a><a id="12155" href="SecureCompilation.Compiler.html#7394" class="Function">↓</a> <a id="12157" href="SecureCompilation.Compiler.html#12110" class="Bound">st</a> <a id="12160" href="SecureCompilation.Compiler.html#12127" class="Bound">d∈</a><a id="12162" class="Symbol">)</a>
    <a id="12168" href="SecureCompilation.Compiler.html#9141" class="Function">go</a> <a id="12171" class="Symbol">(</a><a id="12172" href="BitML.Contracts.Induction.html#436" class="InductiveConstructor">VCS</a> <a id="12176" href="SecureCompilation.Compiler.html#12176" class="Bound">x</a><a id="12177" class="Symbol">)</a> <a id="12179" href="SecureCompilation.Compiler.html#12179" class="Bound">f</a> <a id="12181" href="SecureCompilation.Compiler.html#12181" class="Bound">st</a> <a id="12184" class="Symbol">=</a> <a id="12186" href="BitML.Contracts.Helpers.html#12829" class="Function">↦-∈ᵛ</a> <a id="12191" class="Symbol">λ</a> <a id="12193" class="Symbol">{</a><a id="12194" href="SecureCompilation.Compiler.html#12194" class="Bound">cs</a><a id="12196" class="Symbol">}</a> <a id="12198" href="SecureCompilation.Compiler.html#12198" class="Bound">cs∈</a> <a id="12202" class="Symbol">→</a> <a id="12204" href="SecureCompilation.Compiler.html#12179" class="Bound">f</a> <a id="12206" class="Symbol">(</a><a id="12207" href="BitML.Contracts.Induction.html#414" class="InductiveConstructor">CS</a> <a id="12210" href="SecureCompilation.Compiler.html#12194" class="Bound">cs</a><a id="12212" class="Symbol">)</a> <a id="12214" class="Symbol">(</a><a id="12215" href="BitML.Contracts.Induction.html#517" class="InductiveConstructor">≺-∈ᵛ</a> <a id="12220" href="SecureCompilation.Compiler.html#12198" class="Bound">cs∈</a><a id="12223" class="Symbol">)</a> <a id="12225" class="Symbol">(</a><a id="12226" href="SecureCompilation.Compiler.html#8279" class="Function">↓ᵛ</a> <a id="12229" href="SecureCompilation.Compiler.html#12181" class="Bound">st</a> <a id="12232" href="SecureCompilation.Compiler.html#12198" class="Bound">cs∈</a><a id="12235" class="Symbol">)</a>
</pre></body></html>