<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Bitcoin.Script.Base</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Basic Script datatype.</a>
<a id="100" class="Comment">------------------------------------------------------------------------</a>
<a id="173" class="Keyword">module</a> <a id="180" href="Bitcoin.Script.Base.html" class="Module">Bitcoin.Script.Base</a> <a id="200" class="Keyword">where</a>

<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Function.html" class="Module">Function</a> <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" href="Function.Base.html#1193" class="Function">flip</a><a id="239" class="Symbol">)</a>

<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Data.Bool.html" class="Module">Data.Bool</a>           <a id="274" class="Keyword">using</a> <a id="280" class="Symbol">(</a><a id="281" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="285" class="Symbol">)</a>
<a id="287" class="Keyword">open</a> <a id="292" class="Keyword">import</a> <a id="299" href="Data.Product.html" class="Module">Data.Product</a>        <a id="319" class="Keyword">using</a> <a id="325" class="Symbol">(</a><a id="326" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="334" class="Symbol">;</a> <a id="336" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="339" class="Symbol">)</a>
<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Data.List.html" class="Module">Data.List</a>           <a id="373" class="Keyword">using</a> <a id="379" class="Symbol">(</a><a id="380" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="384" class="Symbol">;</a> <a id="386" href="Data.List.Base.html#9701" class="InductiveConstructor">[]</a><a id="388" class="Symbol">;</a> <a id="390" href="Data.List.Base.html#4458" class="Function Operator">[_]</a><a id="393" class="Symbol">;</a> <a id="395" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="398" class="Symbol">;</a> <a id="400" href="Data.List.Base.html#1497" class="Function">map</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.List.Base.html#3625" class="Function">foldr</a><a id="410" class="Symbol">)</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Data.Fin.html" class="Module">Data.Fin</a>            <a id="444" class="Keyword">using</a> <a id="450" class="Symbol">(</a><a id="451" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a><a id="454" class="Symbol">;</a> <a id="456" href="Data.Fin.Base.html#3060" class="Function">inject≤</a><a id="463" class="Symbol">)</a>
<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Data.Fin.Patterns.html" class="Module">Data.Fin.Patterns</a>   <a id="497" class="Keyword">using</a> <a id="503" class="Symbol">(</a><a id="504" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="506" class="Symbol">;</a> <a id="508" href="Data.Fin.Patterns.html#408" class="InductiveConstructor">1F</a><a id="510" class="Symbol">)</a>
<a id="512" class="Keyword">open</a> <a id="517" class="Keyword">import</a> <a id="524" href="Data.Integer.html" class="Module">Data.Integer</a>        <a id="544" class="Keyword">using</a> <a id="550" class="Symbol">(</a><a id="551" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="552" class="Symbol">;</a> <a id="554" href="Agda.Builtin.Int.html#264" class="InductiveConstructor">+_</a><a id="556" class="Symbol">)</a>
<a id="558" class="Keyword">open</a> <a id="563" class="Keyword">import</a> <a id="570" href="Data.Nat.html" class="Module">Data.Nat</a>            <a id="590" class="Keyword">using</a> <a id="596" class="Symbol">(</a><a id="597" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="598" class="Symbol">;</a> <a id="600" href="Data.Nat.Base.html#937" class="Datatype Operator">_≤_</a><a id="603" class="Symbol">;</a> <a id="605" href="Data.Nat.Properties.html#4678" class="Function Operator">_≤?_</a><a id="609" class="Symbol">)</a>
<a id="611" class="Keyword">open</a> <a id="616" class="Keyword">import</a> <a id="623" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="643" class="Keyword">using</a> <a id="649" class="Symbol">(</a><a id="650" href="Data.Nat.Properties.html#7060" class="Function">≰⇒≥</a><a id="653" class="Symbol">)</a>

<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Relation.Nullary.html" class="Module">Relation.Nullary</a> <a id="685" class="Keyword">using</a> <a id="691" class="Symbol">(</a><a id="692" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a><a id="695" class="Symbol">;</a> <a id="697" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a><a id="699" class="Symbol">)</a>

<a id="702" class="Keyword">open</a> <a id="707" class="Keyword">import</a> <a id="714" href="Bitcoin.BasicTypes.html" class="Module">Bitcoin.BasicTypes</a>
<a id="733" class="Keyword">open</a> <a id="738" class="Keyword">import</a> <a id="745" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a>

<a id="761" class="Keyword">data</a> <a id="ScriptContext"></a><a id="766" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a> <a id="780" class="Symbol">:</a> <a id="782" class="PrimitiveType">Set</a> <a id="786" class="Keyword">where</a>
  <a id="ScriptContext.Ctx"></a><a id="794" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="798" class="Symbol">:</a> <a id="800" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="802" class="Symbol">→</a> <a id="804" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a>

<a id="ctxToℕ"></a><a id="819" href="Bitcoin.Script.Base.html#819" class="Function">ctxToℕ</a> <a id="826" class="Symbol">:</a> <a id="828" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a> <a id="842" class="Symbol">→</a> <a id="844" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="846" href="Bitcoin.Script.Base.html#819" class="Function">ctxToℕ</a> <a id="853" class="Symbol">(</a><a id="854" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="858" href="Bitcoin.Script.Base.html#858" class="Bound">n</a><a id="859" class="Symbol">)</a> <a id="861" class="Symbol">=</a> <a id="863" href="Bitcoin.Script.Base.html#858" class="Bound">n</a>

<a id="866" class="Keyword">data</a> <a id="ScriptType"></a><a id="871" href="Bitcoin.Script.Base.html#871" class="Datatype">ScriptType</a> <a id="882" class="Symbol">:</a> <a id="884" class="PrimitiveType">Set</a> <a id="888" class="Keyword">where</a>
  <a id="ScriptType.`Bool"></a><a id="896" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="ScriptType.`ℤ"></a><a id="902" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="905" class="Symbol">:</a> <a id="907" href="Bitcoin.Script.Base.html#871" class="Datatype">ScriptType</a>

<a id="919" class="Keyword">variable</a>
  <a id="930" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="934" href="Bitcoin.Script.Base.html#934" class="Generalizable">ctx′</a> <a id="939" class="Symbol">:</a> <a id="941" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a>
  <a id="957" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="960" href="Bitcoin.Script.Base.html#960" class="Generalizable">ty′</a> <a id="964" class="Symbol">:</a> <a id="966" href="Bitcoin.Script.Base.html#871" class="Datatype">ScriptType</a>

<a id="978" class="Keyword">data</a> <a id="Script"></a><a id="983" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="990" class="Symbol">:</a> <a id="992" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a>  <a id="1007" class="Comment">-- size of the environment/context</a>
            <a id="1054" class="Symbol">→</a> <a id="1056" href="Bitcoin.Script.Base.html#871" class="Datatype">ScriptType</a>     <a id="1071" class="Comment">-- result type</a>
            <a id="1098" class="Symbol">→</a> <a id="1100" class="PrimitiveType">Set</a> <a id="1104" class="Keyword">where</a>

  <a id="1113" class="Comment">-- Variables</a>
  <a id="Script.var"></a><a id="1128" href="Bitcoin.Script.Base.html#1128" class="InductiveConstructor">var</a>  <a id="1133" class="Symbol">:</a> <a id="1135" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a> <a id="1139" href="Bitcoin.BasicTypes.html#380" class="Generalizable">n</a> <a id="1141" class="Symbol">→</a> <a id="1143" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="1155" href="Bitcoin.BasicTypes.html#380" class="Generalizable">n</a><a id="1156" class="Symbol">)</a> <a id="1158" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>

  <a id="1164" class="Comment">-- Arithmetic/boolean operations</a>
  <a id="Script.`"></a><a id="1199" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a>    <a id="1204" class="Symbol">:</a> <a id="1206" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1208" class="Symbol">→</a> <a id="1210" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1217" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1221" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>
  <a id="Script._`+_"></a><a id="1226" href="Bitcoin.Script.Base.html#1226" class="InductiveConstructor Operator">_`+_</a> <a id="1231" class="Symbol">:</a> <a id="1233" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1240" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1244" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1256" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1260" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1263" class="Symbol">→</a> <a id="1265" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1272" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1276" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>
  <a id="Script._`-_"></a><a id="1281" href="Bitcoin.Script.Base.html#1281" class="InductiveConstructor Operator">_`-_</a> <a id="1286" class="Symbol">:</a> <a id="1288" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1295" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1299" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1302" class="Symbol">→</a> <a id="1304" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1311" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1315" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1318" class="Symbol">→</a> <a id="1320" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1327" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1331" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>
  <a id="Script._`=_"></a><a id="1336" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">_`=_</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1350" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1354" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1357" class="Symbol">→</a> <a id="1359" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1366" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1370" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1373" class="Symbol">→</a> <a id="1375" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1382" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1386" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
  <a id="Script._`&lt;_"></a><a id="1394" href="Bitcoin.Script.Base.html#1394" class="InductiveConstructor Operator">_`&lt;_</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1408" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1412" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1415" class="Symbol">→</a> <a id="1417" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1424" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1428" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1431" class="Symbol">→</a> <a id="1433" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1440" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1444" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>

  <a id="1453" class="Comment">-- Conditional statement</a>
  <a id="Script.`if_then_else_"></a><a id="1480" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if_then_else_</a> <a id="1495" class="Symbol">:</a> <a id="1497" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1504" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1508" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1523" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1527" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="1530" class="Symbol">→</a> <a id="1532" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1539" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1543" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="1546" class="Symbol">→</a> <a id="1548" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1555" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1559" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a>

  <a id="1565" class="Comment">-- Size</a>
  <a id="Script.∣_∣"></a><a id="1575" href="Bitcoin.Script.Base.html#1575" class="InductiveConstructor Operator">∣_∣</a> <a id="1579" class="Symbol">:</a> <a id="1581" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1588" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1592" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1595" class="Symbol">→</a> <a id="1597" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1604" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1608" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>

  <a id="1614" class="Comment">-- Hashing</a>
  <a id="Script.hash"></a><a id="1627" href="Bitcoin.Script.Base.html#1627" class="InductiveConstructor">hash</a> <a id="1632" class="Symbol">:</a> <a id="1634" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1641" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1645" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a> <a id="1648" class="Symbol">→</a> <a id="1650" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1657" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1661" href="Bitcoin.Script.Base.html#902" class="InductiveConstructor">`ℤ</a>

  <a id="1667" class="Comment">-- Signature verification</a>
  <a id="Script.versig"></a><a id="1695" href="Bitcoin.Script.Base.html#1695" class="InductiveConstructor">versig</a> <a id="1702" class="Symbol">:</a> <a id="1704" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1709" href="Bitcoin.Crypto.html#320" class="Record">KeyPair</a> <a id="1717" class="Symbol">→</a> <a id="1719" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1724" class="Symbol">(</a><a id="1725" href="Data.Fin.Base.html#1066" class="Datatype">Fin</a> <a id="1729" href="Bitcoin.BasicTypes.html#380" class="Generalizable">n</a><a id="1730" class="Symbol">)</a> <a id="1732" class="Symbol">→</a> <a id="1734" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1741" class="Symbol">(</a><a id="1742" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="1746" href="Bitcoin.BasicTypes.html#380" class="Generalizable">n</a><a id="1747" class="Symbol">)</a> <a id="1749" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>

  <a id="1758" class="Comment">-- Temporal constraints</a>
  <a id="Script.absAfter_⇒_"></a><a id="1784" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">absAfter_⇒_</a> <a id="1796" class="Symbol">:</a> <a id="1798" href="Bitcoin.BasicTypes.html#309" class="Function">Time</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1812" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1816" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="1819" class="Symbol">→</a> <a id="1821" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1828" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1832" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a>
  <a id="Script.relAfter_⇒_"></a><a id="1837" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">relAfter_⇒_</a> <a id="1849" class="Symbol">:</a> <a id="1851" href="Bitcoin.BasicTypes.html#309" class="Function">Time</a> <a id="1856" class="Symbol">→</a> <a id="1858" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1865" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1869" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="1872" class="Symbol">→</a> <a id="1874" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1881" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1885" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a>

<a id="∃Script"></a><a id="1889" href="Bitcoin.Script.Base.html#1889" class="Function">∃Script</a> <a id="1897" class="Symbol">=</a> <a id="1899" href="Data.Product.html#1788" class="Function">∃[</a> <a id="1902" href="Bitcoin.Script.Base.html#1902" class="Bound">ctx</a> <a id="1906" href="Data.Product.html#1788" class="Function">]</a> <a id="1908" href="Data.Product.html#1788" class="Function">∃[</a> <a id="1911" href="Bitcoin.Script.Base.html#1911" class="Bound">ty</a> <a id="1914" href="Data.Product.html#1788" class="Function">]</a> <a id="1916" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1923" href="Bitcoin.Script.Base.html#1902" class="Bound">ctx</a> <a id="1927" href="Bitcoin.Script.Base.html#1911" class="Bound">ty</a>

<a id="`false"></a><a id="1931" href="Bitcoin.Script.Base.html#1931" class="Function">`false</a> <a id="1938" class="Symbol">:</a> <a id="1940" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="1947" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="1951" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="1957" href="Bitcoin.Script.Base.html#1931" class="Function">`false</a> <a id="1964" class="Symbol">=</a> <a id="1966" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="1968" class="Symbol">(</a><a id="1969" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="1971" class="Number">1</a><a id="1972" class="Symbol">)</a> <a id="1974" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">`=</a> <a id="1977" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="1979" class="Symbol">(</a><a id="1980" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="1982" class="Number">0</a><a id="1983" class="Symbol">)</a>

<a id="`true"></a><a id="1986" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a> <a id="1992" class="Symbol">:</a> <a id="1994" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2001" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2005" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="2011" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a> <a id="2017" class="Symbol">=</a> <a id="2019" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="2021" class="Symbol">(</a><a id="2022" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="2024" class="Number">1</a><a id="2025" class="Symbol">)</a> <a id="2027" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">`=</a> <a id="2030" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="2032" class="Symbol">(</a><a id="2033" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">+</a> <a id="2035" class="Number">1</a><a id="2036" class="Symbol">)</a>

<a id="_`∧_"></a><a id="2039" href="Bitcoin.Script.Base.html#2039" class="Function Operator">_`∧_</a> <a id="2044" class="Symbol">:</a> <a id="2046" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2053" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2057" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2063" class="Symbol">→</a> <a id="2065" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2072" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2076" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2082" class="Symbol">→</a> <a id="2084" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2091" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2095" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="2101" href="Bitcoin.Script.Base.html#2101" class="Bound">e</a> <a id="2103" href="Bitcoin.Script.Base.html#2039" class="Function Operator">`∧</a> <a id="2106" href="Bitcoin.Script.Base.html#2106" class="Bound">e′</a> <a id="2109" class="Symbol">=</a> <a id="2111" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if</a> <a id="2115" href="Bitcoin.Script.Base.html#2101" class="Bound">e</a> <a id="2117" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">then</a> <a id="2122" href="Bitcoin.Script.Base.html#2106" class="Bound">e′</a> <a id="2125" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">else</a> <a id="2130" href="Bitcoin.Script.Base.html#1931" class="Function">`false</a>

<a id="_`∨_"></a><a id="2138" href="Bitcoin.Script.Base.html#2138" class="Function Operator">_`∨_</a> <a id="2143" class="Symbol">:</a> <a id="2145" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2152" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2156" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2162" class="Symbol">→</a> <a id="2164" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2171" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2175" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2181" class="Symbol">→</a> <a id="2183" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2190" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2194" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="2200" href="Bitcoin.Script.Base.html#2200" class="Bound">e</a> <a id="2202" href="Bitcoin.Script.Base.html#2138" class="Function Operator">`∨</a> <a id="2205" href="Bitcoin.Script.Base.html#2205" class="Bound">e′</a> <a id="2208" class="Symbol">=</a> <a id="2210" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if</a> <a id="2214" href="Bitcoin.Script.Base.html#2200" class="Bound">e</a> <a id="2216" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">then</a> <a id="2221" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a> <a id="2227" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">else</a> <a id="2232" href="Bitcoin.Script.Base.html#2205" class="Bound">e′</a>

<a id="`not"></a><a id="2236" href="Bitcoin.Script.Base.html#2236" class="Function">`not</a> <a id="2241" class="Symbol">:</a> <a id="2243" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2250" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2254" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2260" class="Symbol">→</a> <a id="2262" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2269" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="2273" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="2279" href="Bitcoin.Script.Base.html#2236" class="Function">`not</a> <a id="2284" href="Bitcoin.Script.Base.html#2284" class="Bound">e</a> <a id="2286" class="Symbol">=</a> <a id="2288" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if</a> <a id="2292" href="Bitcoin.Script.Base.html#2284" class="Bound">e</a> <a id="2294" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">then</a> <a id="2299" href="Bitcoin.Script.Base.html#1931" class="Function">`false</a> <a id="2306" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">else</a> <a id="2311" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a>

<a id="2318" class="Keyword">data</a> <a id="BitcoinScript"></a><a id="2323" href="Bitcoin.Script.Base.html#2323" class="Datatype">BitcoinScript</a> <a id="2337" class="Symbol">(</a><a id="2338" href="Bitcoin.Script.Base.html#2338" class="Bound">ctx</a> <a id="2342" class="Symbol">:</a> <a id="2344" href="Bitcoin.Script.Base.html#766" class="Datatype">ScriptContext</a><a id="2357" class="Symbol">)</a> <a id="2359" class="Symbol">:</a> <a id="2361" class="PrimitiveType">Set</a> <a id="2365" class="Keyword">where</a>
  <a id="BitcoinScript.ƛ_"></a><a id="2373" href="Bitcoin.Script.Base.html#2373" class="InductiveConstructor Operator">ƛ_</a> <a id="2376" class="Symbol">:</a> <a id="2378" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2385" href="Bitcoin.Script.Base.html#2338" class="Bound">ctx</a> <a id="2389" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a> <a id="2395" class="Symbol">→</a> <a id="2397" href="Bitcoin.Script.Base.html#2323" class="Datatype">BitcoinScript</a> <a id="2411" href="Bitcoin.Script.Base.html#2338" class="Bound">ctx</a>

<a id="∃BitcoinScript"></a><a id="2416" href="Bitcoin.Script.Base.html#2416" class="Function">∃BitcoinScript</a> <a id="2431" class="Symbol">=</a> <a id="2433" href="Data.Product.html#1788" class="Function">∃[</a> <a id="2436" href="Bitcoin.Script.Base.html#2436" class="Bound">ctx</a> <a id="2440" href="Data.Product.html#1788" class="Function">]</a> <a id="2442" href="Bitcoin.Script.Base.html#2323" class="Datatype">BitcoinScript</a> <a id="2456" href="Bitcoin.Script.Base.html#2436" class="Bound">ctx</a>

<a id="2461" class="Comment">-- operators&#39; precedence</a>
<a id="2486" class="Keyword">infix</a>  <a id="2493" class="Number">5</a> <a id="2495" href="Bitcoin.Script.Base.html#1226" class="InductiveConstructor Operator">_`+_</a>
<a id="2500" class="Keyword">infix</a>  <a id="2507" class="Number">5</a> <a id="2509" href="Bitcoin.Script.Base.html#1281" class="InductiveConstructor Operator">_`-_</a>
<a id="2514" class="Keyword">infix</a>  <a id="2521" class="Number">4</a> <a id="2523" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">_`=_</a>
<a id="2528" class="Keyword">infix</a>  <a id="2535" class="Number">4</a> <a id="2537" href="Bitcoin.Script.Base.html#1394" class="InductiveConstructor Operator">_`&lt;_</a>
<a id="2542" class="Keyword">infixr</a> <a id="2549" class="Number">3</a> <a id="2551" href="Bitcoin.Script.Base.html#2138" class="Function Operator">_`∨_</a>
<a id="2556" class="Keyword">infixr</a> <a id="2563" class="Number">3</a> <a id="2565" href="Bitcoin.Script.Base.html#2039" class="Function Operator">_`∧_</a>
<a id="2570" class="Keyword">infix</a>  <a id="2577" class="Number">2</a> <a id="2579" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if_then_else_</a>
<a id="2594" class="Keyword">infix</a>  <a id="2601" class="Number">2</a> <a id="2603" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">absAfter_⇒_</a>
<a id="2615" class="Keyword">infix</a>  <a id="2622" class="Number">2</a> <a id="2624" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">relAfter_⇒_</a>
<a id="2636" class="Keyword">infix</a>  <a id="2643" class="Number">1</a> <a id="2645" href="Bitcoin.Script.Base.html#2373" class="InductiveConstructor Operator">ƛ_</a>

<a id="2649" href="Bitcoin.Script.Base.html#2649" class="Function">_</a> <a id="2651" class="Symbol">:</a> <a id="2653" href="Bitcoin.Script.Base.html#2323" class="Datatype">BitcoinScript</a> <a id="2667" class="Symbol">(</a><a id="2668" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="2672" class="Number">2</a><a id="2673" class="Symbol">)</a>
<a id="2675" class="Symbol">_</a> <a id="2677" class="Symbol">=</a> <a id="2679" href="Bitcoin.Script.Base.html#2373" class="InductiveConstructor Operator">ƛ</a> <a id="2681" href="Bitcoin.Script.Base.html#1695" class="InductiveConstructor">versig</a> <a id="2688" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2691" href="Data.List.Base.html#4458" class="Function Operator">[</a> <a id="2693" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a> <a id="2696" href="Data.List.Base.html#4458" class="Function Operator">]</a> <a id="2698" href="Bitcoin.Script.Base.html#2039" class="Function Operator">`∧</a> <a id="2701" class="Symbol">(</a><a id="2702" href="Bitcoin.Script.Base.html#1627" class="InductiveConstructor">hash</a> <a id="2707" class="Symbol">(</a><a id="2708" href="Bitcoin.Script.Base.html#1128" class="InductiveConstructor">var</a> <a id="2712" href="Data.Fin.Patterns.html#408" class="InductiveConstructor">1F</a><a id="2714" class="Symbol">)</a> <a id="2716" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">`=</a> <a id="2719" href="Bitcoin.Script.Base.html#1627" class="InductiveConstructor">hash</a> <a id="2724" class="Symbol">(</a><a id="2725" href="Bitcoin.Script.Base.html#1128" class="InductiveConstructor">var</a> <a id="2729" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="2731" class="Symbol">))</a>

<a id="2735" class="Comment">-- Combining scripts</a>
<a id="mapFin"></a><a id="2756" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2763" class="Symbol">:</a> <a id="2765" class="Symbol">∀</a> <a id="2767" class="Symbol">{</a><a id="2768" href="Bitcoin.Script.Base.html#2768" class="Bound">n</a> <a id="2770" href="Bitcoin.Script.Base.html#2770" class="Bound">m</a><a id="2771" class="Symbol">}</a> <a id="2773" class="Symbol">→</a> <a id="2775" href="Bitcoin.Script.Base.html#2768" class="Bound">n</a> <a id="2777" href="Data.Nat.Base.html#937" class="Datatype Operator">≤</a> <a id="2779" href="Bitcoin.Script.Base.html#2770" class="Bound">m</a> <a id="2781" class="Symbol">→</a> <a id="2783" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="2795" href="Bitcoin.Script.Base.html#2768" class="Bound">n</a><a id="2796" class="Symbol">)</a> <a id="2798" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a> <a id="2801" class="Symbol">→</a> <a id="2803" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="2810" class="Symbol">(</a><a id="2811" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="2815" href="Bitcoin.Script.Base.html#2770" class="Bound">m</a><a id="2816" class="Symbol">)</a> <a id="2818" href="Bitcoin.Script.Base.html#957" class="Generalizable">ty</a>
<a id="2821" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2828" href="Bitcoin.Script.Base.html#2828" class="Bound">n≤m</a> <a id="2832" class="Symbol">(</a><a id="2833" href="Bitcoin.Script.Base.html#1128" class="InductiveConstructor">var</a> <a id="2837" href="Bitcoin.Script.Base.html#2837" class="Bound">x</a><a id="2838" class="Symbol">)</a>                 <a id="2856" class="Symbol">=</a> <a id="2858" href="Bitcoin.Script.Base.html#1128" class="InductiveConstructor">var</a> <a id="2862" class="Symbol">(</a><a id="2863" href="Data.Fin.Base.html#3060" class="Function">inject≤</a> <a id="2871" href="Bitcoin.Script.Base.html#2837" class="Bound">x</a> <a id="2873" href="Bitcoin.Script.Base.html#2828" class="Bound">n≤m</a><a id="2876" class="Symbol">)</a>
<a id="2878" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2885" href="Bitcoin.Script.Base.html#2885" class="Bound">n≤m</a> <a id="2889" class="Symbol">(</a><a id="2890" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="2892" href="Bitcoin.Script.Base.html#2892" class="Bound">x</a><a id="2893" class="Symbol">)</a>                   <a id="2913" class="Symbol">=</a> <a id="2915" href="Bitcoin.Script.Base.html#1199" class="InductiveConstructor">`</a> <a id="2917" href="Bitcoin.Script.Base.html#2892" class="Bound">x</a>
<a id="2919" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2926" href="Bitcoin.Script.Base.html#2926" class="Bound">n≤m</a> <a id="2930" class="Symbol">(</a><a id="2931" href="Bitcoin.Script.Base.html#2931" class="Bound">s</a> <a id="2933" href="Bitcoin.Script.Base.html#1226" class="InductiveConstructor Operator">`+</a> <a id="2936" href="Bitcoin.Script.Base.html#2936" class="Bound">s₁</a><a id="2938" class="Symbol">)</a>               <a id="2954" class="Symbol">=</a> <a id="2956" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2963" href="Bitcoin.Script.Base.html#2926" class="Bound">n≤m</a> <a id="2967" href="Bitcoin.Script.Base.html#2931" class="Bound">s</a> <a id="2969" href="Bitcoin.Script.Base.html#1226" class="InductiveConstructor Operator">`+</a> <a id="2972" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2979" href="Bitcoin.Script.Base.html#2926" class="Bound">n≤m</a> <a id="2983" href="Bitcoin.Script.Base.html#2936" class="Bound">s₁</a>
<a id="2986" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="2993" href="Bitcoin.Script.Base.html#2993" class="Bound">n≤m</a> <a id="2997" class="Symbol">(</a><a id="2998" href="Bitcoin.Script.Base.html#2998" class="Bound">s</a> <a id="3000" href="Bitcoin.Script.Base.html#1281" class="InductiveConstructor Operator">`-</a> <a id="3003" href="Bitcoin.Script.Base.html#3003" class="Bound">s₁</a><a id="3005" class="Symbol">)</a>               <a id="3021" class="Symbol">=</a> <a id="3023" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3030" href="Bitcoin.Script.Base.html#2993" class="Bound">n≤m</a> <a id="3034" href="Bitcoin.Script.Base.html#2998" class="Bound">s</a> <a id="3036" href="Bitcoin.Script.Base.html#1281" class="InductiveConstructor Operator">`-</a> <a id="3039" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3046" href="Bitcoin.Script.Base.html#2993" class="Bound">n≤m</a> <a id="3050" href="Bitcoin.Script.Base.html#3003" class="Bound">s₁</a>
<a id="3053" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3060" href="Bitcoin.Script.Base.html#3060" class="Bound">n≤m</a> <a id="3064" class="Symbol">(</a><a id="3065" href="Bitcoin.Script.Base.html#3065" class="Bound">s</a> <a id="3067" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">`=</a> <a id="3070" href="Bitcoin.Script.Base.html#3070" class="Bound">s₁</a><a id="3072" class="Symbol">)</a>               <a id="3088" class="Symbol">=</a> <a id="3090" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3097" href="Bitcoin.Script.Base.html#3060" class="Bound">n≤m</a> <a id="3101" href="Bitcoin.Script.Base.html#3065" class="Bound">s</a> <a id="3103" href="Bitcoin.Script.Base.html#1336" class="InductiveConstructor Operator">`=</a> <a id="3106" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3113" href="Bitcoin.Script.Base.html#3060" class="Bound">n≤m</a> <a id="3117" href="Bitcoin.Script.Base.html#3070" class="Bound">s₁</a>
<a id="3120" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3127" href="Bitcoin.Script.Base.html#3127" class="Bound">n≤m</a> <a id="3131" class="Symbol">(</a><a id="3132" href="Bitcoin.Script.Base.html#3132" class="Bound">s</a> <a id="3134" href="Bitcoin.Script.Base.html#1394" class="InductiveConstructor Operator">`&lt;</a> <a id="3137" href="Bitcoin.Script.Base.html#3137" class="Bound">s₁</a><a id="3139" class="Symbol">)</a>               <a id="3155" class="Symbol">=</a> <a id="3157" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3164" href="Bitcoin.Script.Base.html#3127" class="Bound">n≤m</a> <a id="3168" href="Bitcoin.Script.Base.html#3132" class="Bound">s</a> <a id="3170" href="Bitcoin.Script.Base.html#1394" class="InductiveConstructor Operator">`&lt;</a> <a id="3173" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3180" href="Bitcoin.Script.Base.html#3127" class="Bound">n≤m</a> <a id="3184" href="Bitcoin.Script.Base.html#3137" class="Bound">s₁</a>
<a id="3187" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3194" href="Bitcoin.Script.Base.html#3194" class="Bound">n≤m</a> <a id="3198" class="Symbol">(</a><a id="3199" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if</a> <a id="3203" href="Bitcoin.Script.Base.html#3203" class="Bound">s</a> <a id="3205" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">then</a> <a id="3210" href="Bitcoin.Script.Base.html#3210" class="Bound">s₁</a> <a id="3213" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">else</a> <a id="3218" href="Bitcoin.Script.Base.html#3218" class="Bound">s₂</a><a id="3220" class="Symbol">)</a> <a id="3222" class="Symbol">=</a> <a id="3224" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">`if</a> <a id="3228" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3235" href="Bitcoin.Script.Base.html#3194" class="Bound">n≤m</a> <a id="3239" href="Bitcoin.Script.Base.html#3203" class="Bound">s</a> <a id="3241" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">then</a> <a id="3246" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3253" href="Bitcoin.Script.Base.html#3194" class="Bound">n≤m</a> <a id="3257" href="Bitcoin.Script.Base.html#3210" class="Bound">s₁</a> <a id="3260" href="Bitcoin.Script.Base.html#1480" class="InductiveConstructor Operator">else</a> <a id="3265" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3272" href="Bitcoin.Script.Base.html#3194" class="Bound">n≤m</a> <a id="3276" href="Bitcoin.Script.Base.html#3218" class="Bound">s₂</a>
<a id="3279" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3286" href="Bitcoin.Script.Base.html#3286" class="Bound">n≤m</a> <a id="3290" href="Bitcoin.Script.Base.html#1575" class="InductiveConstructor Operator">∣</a> <a id="3292" href="Bitcoin.Script.Base.html#3292" class="Bound">s</a> <a id="3294" href="Bitcoin.Script.Base.html#1575" class="InductiveConstructor Operator">∣</a>                   <a id="3314" class="Symbol">=</a> <a id="3316" href="Bitcoin.Script.Base.html#1575" class="InductiveConstructor Operator">∣</a> <a id="3318" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3325" href="Bitcoin.Script.Base.html#3286" class="Bound">n≤m</a> <a id="3329" href="Bitcoin.Script.Base.html#3292" class="Bound">s</a> <a id="3331" href="Bitcoin.Script.Base.html#1575" class="InductiveConstructor Operator">∣</a>
<a id="3333" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3340" href="Bitcoin.Script.Base.html#3340" class="Bound">n≤m</a> <a id="3344" class="Symbol">(</a><a id="3345" href="Bitcoin.Script.Base.html#1627" class="InductiveConstructor">hash</a> <a id="3350" href="Bitcoin.Script.Base.html#3350" class="Bound">s</a><a id="3351" class="Symbol">)</a>                <a id="3368" class="Symbol">=</a> <a id="3370" href="Bitcoin.Script.Base.html#1627" class="InductiveConstructor">hash</a> <a id="3375" class="Symbol">(</a><a id="3376" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3383" href="Bitcoin.Script.Base.html#3340" class="Bound">n≤m</a> <a id="3387" href="Bitcoin.Script.Base.html#3350" class="Bound">s</a><a id="3388" class="Symbol">)</a>
<a id="3390" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3397" href="Bitcoin.Script.Base.html#3397" class="Bound">n≤m</a> <a id="3401" class="Symbol">(</a><a id="3402" href="Bitcoin.Script.Base.html#1695" class="InductiveConstructor">versig</a> <a id="3409" href="Bitcoin.Script.Base.html#3409" class="Bound">x</a> <a id="3411" href="Bitcoin.Script.Base.html#3411" class="Bound">x₁</a><a id="3413" class="Symbol">)</a>           <a id="3425" class="Symbol">=</a> <a id="3427" href="Bitcoin.Script.Base.html#1695" class="InductiveConstructor">versig</a> <a id="3434" href="Bitcoin.Script.Base.html#3409" class="Bound">x</a> <a id="3436" class="Symbol">(</a><a id="3437" href="Data.List.Base.html#1497" class="Function">map</a> <a id="3441" class="Symbol">(</a><a id="3442" href="Function.Base.html#1193" class="Function">flip</a> <a id="3447" href="Data.Fin.Base.html#3060" class="Function">inject≤</a> <a id="3455" href="Bitcoin.Script.Base.html#3397" class="Bound">n≤m</a><a id="3458" class="Symbol">)</a> <a id="3460" href="Bitcoin.Script.Base.html#3411" class="Bound">x₁</a><a id="3462" class="Symbol">)</a>
<a id="3464" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3471" href="Bitcoin.Script.Base.html#3471" class="Bound">n≤m</a> <a id="3475" class="Symbol">(</a><a id="3476" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">absAfter</a> <a id="3485" href="Bitcoin.Script.Base.html#3485" class="Bound">x</a> <a id="3487" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">⇒</a> <a id="3489" href="Bitcoin.Script.Base.html#3489" class="Bound">s</a><a id="3490" class="Symbol">)</a>        <a id="3499" class="Symbol">=</a> <a id="3501" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">absAfter</a> <a id="3510" href="Bitcoin.Script.Base.html#3485" class="Bound">x</a> <a id="3512" href="Bitcoin.Script.Base.html#1784" class="InductiveConstructor Operator">⇒</a> <a id="3514" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3521" href="Bitcoin.Script.Base.html#3471" class="Bound">n≤m</a> <a id="3525" href="Bitcoin.Script.Base.html#3489" class="Bound">s</a>
<a id="3527" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3534" href="Bitcoin.Script.Base.html#3534" class="Bound">n≤m</a> <a id="3538" class="Symbol">(</a><a id="3539" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">relAfter</a> <a id="3548" href="Bitcoin.Script.Base.html#3548" class="Bound">x</a> <a id="3550" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">⇒</a> <a id="3552" href="Bitcoin.Script.Base.html#3552" class="Bound">s</a><a id="3553" class="Symbol">)</a>        <a id="3562" class="Symbol">=</a> <a id="3564" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">relAfter</a> <a id="3573" href="Bitcoin.Script.Base.html#3548" class="Bound">x</a> <a id="3575" href="Bitcoin.Script.Base.html#1837" class="InductiveConstructor Operator">⇒</a> <a id="3577" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3584" href="Bitcoin.Script.Base.html#3534" class="Bound">n≤m</a> <a id="3588" href="Bitcoin.Script.Base.html#3552" class="Bound">s</a>

<a id="⋁"></a><a id="3591" href="Bitcoin.Script.Base.html#3591" class="Function">⋁</a> <a id="3593" class="Symbol">:</a> <a id="3595" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3600" class="Symbol">(</a><a id="3601" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3604" href="Bitcoin.Script.Base.html#3604" class="Bound">ctx</a> <a id="3608" href="Data.Product.html#1788" class="Function">]</a> <a id="3610" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="3617" href="Bitcoin.Script.Base.html#3604" class="Bound">ctx</a> <a id="3621" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a><a id="3626" class="Symbol">)</a> <a id="3628" class="Symbol">→</a> <a id="3630" href="Data.Product.html#1788" class="Function">∃[</a> <a id="3633" href="Bitcoin.Script.Base.html#3633" class="Bound">ctx′</a> <a id="3638" href="Data.Product.html#1788" class="Function">]</a> <a id="3640" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="3647" href="Bitcoin.Script.Base.html#3633" class="Bound">ctx′</a> <a id="3652" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="3658" href="Bitcoin.Script.Base.html#3591" class="Function">⋁</a> <a id="3660" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="3669" class="Symbol">=</a> <a id="3671" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="3675" class="Number">0</a> <a id="3677" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3679" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a>
<a id="3685" href="Bitcoin.Script.Base.html#3591" class="Function">⋁</a> <a id="3687" class="Symbol">(</a><a id="3688" href="Bitcoin.Script.Base.html#3688" class="Bound">s</a> <a id="3690" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3692" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3694" class="Symbol">)</a> <a id="3696" class="Symbol">=</a> <a id="3698" href="Bitcoin.Script.Base.html#3688" class="Bound">s</a>
<a id="3700" href="Bitcoin.Script.Base.html#3591" class="CatchallClause Function">⋁</a><a id="3701" class="CatchallClause"> </a><a id="3702" class="CatchallClause Symbol">((</a><a id="3704" href="Bitcoin.Script.Base.html#794" class="CatchallClause InductiveConstructor">Ctx</a><a id="3707" class="CatchallClause"> </a><a id="3708" href="Bitcoin.Script.Base.html#3708" class="CatchallClause Bound">n</a><a id="3709" class="CatchallClause"> </a><a id="3710" href="Agda.Builtin.Sigma.html#236" class="CatchallClause InductiveConstructor Operator">,</a><a id="3711" class="CatchallClause"> </a><a id="3712" href="Bitcoin.Script.Base.html#3712" class="CatchallClause Bound">x</a><a id="3713" class="CatchallClause Symbol">)</a><a id="3714" class="CatchallClause"> </a><a id="3715" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3716" class="CatchallClause"> </a><a id="3717" href="Bitcoin.Script.Base.html#3717" class="CatchallClause Bound">xs</a><a id="3719" class="CatchallClause Symbol">)</a>
  <a id="3723" class="Keyword">with</a> <a id="3728" href="Bitcoin.Script.Base.html#3591" class="Function">⋁</a> <a id="3730" href="Bitcoin.Script.Base.html#3717" class="Bound">xs</a>
<a id="3733" class="Symbol">...</a> <a id="3737" class="Symbol">|</a> <a id="3739" href="Bitcoin.Script.Base.html#794" class="InductiveConstructor">Ctx</a> <a id="3743" href="Bitcoin.Script.Base.html#3743" class="Bound">m</a> <a id="3745" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3747" href="Bitcoin.Script.Base.html#3747" class="Bound">y</a>
  <a id="3751" class="Keyword">with</a> <a id="3756" class="Bound">n</a> <a id="3758" href="Data.Nat.Properties.html#4678" class="Function Operator">≤?</a> <a id="3761" href="Bitcoin.Script.Base.html#3743" class="Bound">m</a>
<a id="3763" class="Symbol">...</a> <a id="3767" class="Symbol">|</a> <a id="3769" href="Relation.Nullary.html#1645" class="InductiveConstructor">yes</a> <a id="3773" href="Bitcoin.Script.Base.html#3773" class="Bound">n≤m</a> <a id="3777" class="Symbol">=</a> <a id="3779" class="Symbol">_</a> <a id="3781" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3783" class="Symbol">(</a><a id="3784" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3791" href="Bitcoin.Script.Base.html#3773" class="Bound">n≤m</a> <a id="3795" class="Bound">x</a> <a id="3797" href="Bitcoin.Script.Base.html#2138" class="Function Operator">`∨</a> <a id="3800" class="Bound">y</a><a id="3801" class="Symbol">)</a>
<a id="3803" class="Symbol">...</a> <a id="3807" class="Symbol">|</a> <a id="3809" href="Relation.Nullary.html#1682" class="InductiveConstructor">no</a>  <a id="3813" href="Bitcoin.Script.Base.html#3813" class="Bound">n≰m</a> <a id="3817" class="Symbol">=</a> <a id="3819" class="Symbol">_</a> <a id="3821" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3823" class="Symbol">(</a><a id="3824" class="Bound">x</a> <a id="3826" href="Bitcoin.Script.Base.html#2138" class="Function Operator">`∨</a> <a id="3829" href="Bitcoin.Script.Base.html#2756" class="Function">mapFin</a> <a id="3836" class="Symbol">(</a><a id="3837" href="Data.Nat.Properties.html#7060" class="Function">≰⇒≥</a> <a id="3841" href="Bitcoin.Script.Base.html#3813" class="Bound">n≰m</a><a id="3844" class="Symbol">)</a> <a id="3846" class="Bound">y</a><a id="3847" class="Symbol">)</a>

<a id="⋀"></a><a id="3850" href="Bitcoin.Script.Base.html#3850" class="Function">⋀</a> <a id="3852" class="Symbol">:</a> <a id="3854" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3859" class="Symbol">(</a><a id="3860" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="3867" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="3871" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a><a id="3876" class="Symbol">)</a> <a id="3878" class="Symbol">→</a> <a id="3880" href="Bitcoin.Script.Base.html#983" class="Datatype">Script</a> <a id="3887" href="Bitcoin.Script.Base.html#930" class="Generalizable">ctx</a> <a id="3891" href="Bitcoin.Script.Base.html#896" class="InductiveConstructor">`Bool</a>
<a id="3897" class="Comment">-- ⋀ = foldr _`∧_ `true</a>
<a id="3921" href="Bitcoin.Script.Base.html#3850" class="Function">⋀</a> <a id="3923" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="3932" class="Symbol">=</a> <a id="3934" href="Bitcoin.Script.Base.html#1986" class="Function">`true</a>
<a id="3940" href="Bitcoin.Script.Base.html#3850" class="Function">⋀</a> <a id="3942" class="Symbol">(</a><a id="3943" href="Bitcoin.Script.Base.html#3943" class="Bound">s</a> <a id="3945" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3947" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="3949" class="Symbol">)</a> <a id="3951" class="Symbol">=</a> <a id="3953" href="Bitcoin.Script.Base.html#3943" class="Bound">s</a>
<a id="3955" href="Bitcoin.Script.Base.html#3850" class="CatchallClause Function">⋀</a><a id="3956" class="CatchallClause"> </a><a id="3957" class="CatchallClause Symbol">(</a><a id="3958" href="Bitcoin.Script.Base.html#3958" class="CatchallClause Bound">s</a><a id="3959" class="CatchallClause"> </a><a id="3960" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3961" class="CatchallClause"> </a><a id="3962" href="Bitcoin.Script.Base.html#3962" class="CatchallClause Bound">ss</a><a id="3964" class="CatchallClause Symbol">)</a> <a id="3966" class="Symbol">=</a> <a id="3968" href="Bitcoin.Script.Base.html#3958" class="Bound">s</a> <a id="3970" href="Bitcoin.Script.Base.html#2039" class="Function Operator">`∧</a> <a id="3973" href="Bitcoin.Script.Base.html#3850" class="Function">⋀</a> <a id="3975" href="Bitcoin.Script.Base.html#3962" class="Bound">ss</a>
</pre></body></html>