<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Coherence</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="26" class="Keyword">hiding</a> <a id="33" class="Symbol">(</a><a id="34" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="35" class="Symbol">)</a>
<a id="37" class="Keyword">open</a> <a id="42" href="Prelude.Init.html#6387" class="Module">L.Mem</a>
<a id="48" class="Keyword">open</a> <a id="53" class="Keyword">import</a> <a id="60" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>

<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>

<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="442" class="Keyword">open</a> <a id="447" class="Keyword">import</a> <a id="454" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="467" class="Keyword">open</a> <a id="472" class="Keyword">import</a> <a id="479" href="Prelude.Apartness.html" class="Module">Prelude.Apartness</a>

<a id="498" class="Keyword">import</a> <a id="505" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="520" class="Symbol">as</a> <a id="523" class="Module">BTC</a>

<a id="528" class="Keyword">module</a> <a id="535" href="SecureCompilation.Coherence.html" class="Module">SecureCompilation.Coherence</a>
  <a id="565" class="Symbol">(</a><a id="566" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="578" class="Symbol">:</a> <a id="580" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="583" class="Symbol">)</a>
  <a id="587" class="Symbol">‚¶É</a> <a id="589" href="SecureCompilation.Coherence.html#589" class="Bound">_</a> <a id="591" class="Symbol">:</a> <a id="593" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="599" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="611" class="Symbol">‚¶Ñ</a>
  <a id="615" class="Symbol">(</a><a id="616" href="SecureCompilation.Coherence.html#616" class="Bound">Honest</a> <a id="623" class="Symbol">:</a> <a id="625" href="Data.List.NonEmpty.Base.html#1079" class="Record">List‚Å∫</a> <a id="631" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a><a id="642" class="Symbol">)</a>

  <a id="647" class="Symbol">(</a><a id="648" href="SecureCompilation.Coherence.html#648" class="Bound">finPart</a> <a id="656" class="Symbol">:</a> <a id="658" href="Prelude.Lists.html#2284" class="Function">Finite</a> <a id="665" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a><a id="676" class="Symbol">)</a>
  <a id="680" class="Symbol">(</a><a id="681" href="SecureCompilation.Coherence.html#681" class="Bound">keypairs</a> <a id="690" class="Symbol">:</a> <a id="692" class="Symbol">‚àÄ</a> <a id="694" class="Symbol">(</a><a id="695" href="SecureCompilation.Coherence.html#695" class="Bound">A</a> <a id="697" class="Symbol">:</a> <a id="699" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a><a id="710" class="Symbol">)</a> <a id="712" class="Symbol">‚Üí</a> <a id="714" href="Bitcoin.Crypto.html#345" class="Record">BTC.KeyPair</a> <a id="726" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="728" href="Bitcoin.Crypto.html#345" class="Record">BTC.KeyPair</a><a id="739" class="Symbol">)</a>

  <a id="744" class="Symbol">(</a><a id="745" href="SecureCompilation.Coherence.html#745" class="Bound">Œ∑</a> <a id="747" class="Symbol">:</a> <a id="749" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a><a id="750" class="Symbol">)</a> <a id="752" class="Comment">-- security parameter</a>
  <a id="776" class="Keyword">where</a>

<a id="783" class="Keyword">open</a> <a id="788" class="Keyword">import</a> <a id="795" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="809" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="821" href="SecureCompilation.Coherence.html#616" class="Bound">Honest</a> as <a id="S"></a><a id="831" href="SecureCompilation.Coherence.html#831" class="Module">S</a>
  <a id="835" class="Keyword">hiding</a> <a id="842" class="Symbol">(</a><a id="843" href="Prelude.Closures.html#5608" class="InductiveConstructor Operator">_‚àé</a><a id="845" class="Symbol">;</a> <a id="847" href="Prelude.Closures.html#5506" class="InductiveConstructor Operator">begin_</a><a id="853" class="Symbol">;</a> <a id="855" href="BitML.Contracts.Types.html#1319" class="Generalizable">d</a><a id="856" class="Symbol">)</a>

<a id="859" class="Keyword">open</a> <a id="864" class="Keyword">import</a> <a id="871" href="ComputationalModel.html" class="Module">ComputationalModel</a> <a id="890" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="902" href="SecureCompilation.Coherence.html#616" class="Bound">Honest</a> <a id="909" href="SecureCompilation.Coherence.html#648" class="Bound">finPart</a> <a id="917" href="SecureCompilation.Coherence.html#681" class="Bound">keypairs</a> as <a id="C"></a><a id="929" href="SecureCompilation.Coherence.html#929" class="Module">C</a>
  <a id="933" class="Keyword">hiding</a> <a id="940" class="Symbol">(</a><a id="941" href="ComputationalModel.Strategy.html#607" class="Function">Hon</a><a id="944" class="Symbol">;</a> <a id="946" href="ComputationalModel.Strategy.html#2346" class="Function">Initial</a><a id="953" class="Symbol">;</a> <a id="955" href="ComputationalModel.Strategy.html#4178" class="Field">Œ£</a>
         <a id="966" class="Symbol">;</a> <a id="968" href="Bitcoin.BasicTypes.html#313" class="Generalizable">t</a><a id="969" class="Symbol">;</a> <a id="971" href="Bitcoin.BasicTypes.html#315" class="Generalizable">t‚Ä≤</a><a id="973" class="Symbol">;</a> <a id="975" href="Bitcoin.Script.Base.html#917" class="InductiveConstructor">`</a><a id="976" class="Symbol">;</a> <a id="978" href="Bitcoin.Script.Base.html#1293" class="InductiveConstructor Operator">‚à£_‚à£</a><a id="981" class="Symbol">;</a> <a id="983" href="Bitcoin.BasicTypes.html#302" class="Generalizable">n</a><a id="984" class="Symbol">)</a>

<a id="987" class="Keyword">open</a> <a id="992" class="Keyword">import</a> <a id="999" href="SecureCompilation.Compiler.html" class="Module">SecureCompilation.Compiler</a> <a id="1026" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="1038" href="SecureCompilation.Coherence.html#616" class="Bound">Honest</a> <a id="1045" href="SecureCompilation.Coherence.html#745" class="Bound">Œ∑</a>

<a id="1048" class="Keyword">private</a> <a id="1056" class="Keyword">variable</a>
  <a id="1067" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="1072" href="SecureCompilation.Coherence.html#1072" class="Generalizable">‚ü®G‚ü©C‚Ä≤</a> <a id="1078" href="SecureCompilation.Coherence.html#1078" class="Generalizable">‚ü®G‚ü©C‚Ä≥</a> <a id="1084" class="Symbol">:</a> <a id="1086" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a>
  <a id="1091" href="SecureCompilation.Coherence.html#1091" class="Generalizable">T</a> <a id="1093" href="SecureCompilation.Coherence.html#1093" class="Generalizable">T‚Ä≤</a> <a id="1096" class="Symbol">:</a> <a id="1098" href="Bitcoin.Tx.Base.html#1255" class="Function">‚àÉTx</a>
  <a id="1104" href="SecureCompilation.Coherence.html#1104" class="Generalizable">ùï£</a>  <a id="1107" class="Symbol">:</a> <a id="1109" href="SymbolicModel.Mappings.Base.html#1144" class="Function">‚Ñù</a> <a id="1111" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a>

<a id="1115" class="Keyword">postulate</a>
  <a id="encode"></a><a id="1127" href="SecureCompilation.Coherence.html#1127" class="Postulate">encode</a> <a id="1134" class="Symbol">:</a> <a id="1136" href="SymbolicModel.Mappings.Base.html#538" class="Function">Txout</a> <a id="1142" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="1145" class="Symbol">‚Üí</a> <a id="1147" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a> <a id="1150" class="Symbol">‚Üí</a> <a id="1152" href="ComputationalModel.Strategy.html#812" class="Function">Message</a>
  <a id="1162" class="Comment">-- ^ encode {G}C as a bitstring, representing each x in it as txout(x)</a>

  <a id="SIG·µñ"></a><a id="1236" href="SecureCompilation.Coherence.html#1236" class="Postulate">SIG·µñ</a> <a id="1241" class="Symbol">:</a> <a id="1243" class="Symbol">‚àÄ</a> <a id="1245" class="Symbol">{</a><a id="1246" href="SecureCompilation.Coherence.html#1246" class="Bound">A</a> <a id="1248" class="Symbol">:</a> <a id="1250" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1253" class="Symbol">}</a> <a id="1255" class="Symbol">‚Üí</a> <a id="1257" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a> <a id="1259" class="Comment">{- public key -}</a> <a id="1276" class="Symbol">‚Üí</a> <a id="1278" href="SecureCompilation.Coherence.html#1246" class="Bound">A</a> <a id="1280" class="Symbol">‚Üí</a> <a id="1282" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a>

  <a id="‚à£_‚à£·∂ª"></a><a id="1287" href="SecureCompilation.Coherence.html#1287" class="Postulate Operator">‚à£_‚à£·∂ª</a> <a id="1292" class="Symbol">:</a> <a id="1294" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a> <a id="1296" class="Symbol">‚Üí</a> <a id="1298" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a>
  <a id="‚à£_‚à£·µê"></a><a id="1302" href="SecureCompilation.Coherence.html#1302" class="Postulate Operator">‚à£_‚à£·µê</a> <a id="1307" class="Symbol">:</a> <a id="1309" href="ComputationalModel.Strategy.html#812" class="Function">Message</a> <a id="1317" class="Symbol">‚Üí</a> <a id="1319" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a>

<a id="_-redeemableWith-_"></a><a id="1322" href="SecureCompilation.Coherence.html#1322" class="Function Operator">_-redeemableWith-_</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="1351" class="Symbol">‚Üí</a> <a id="1353" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1361" class="Symbol">‚Üí</a> <a id="1363" href="Bitcoin.Tx.Base.html#793" class="Function">‚àÉTxOutput</a>
<a id="1373" href="SecureCompilation.Coherence.html#1373" class="Bound">v</a> <a id="1375" href="SecureCompilation.Coherence.html#1322" class="Function Operator">-redeemableWith-</a> <a id="1392" href="SecureCompilation.Coherence.html#1392" class="Bound">k</a> <a id="1394" class="Symbol">=</a> <a id="1396" href="Bitcoin.Script.Base.html#375" class="InductiveConstructor">Ctx</a> <a id="1400" class="Number">1</a> <a id="1402" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1404" class="Keyword">record</a> <a id="1411" class="Symbol">{</a><a id="1412" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="1418" class="Symbol">=</a> <a id="1420" href="SecureCompilation.Coherence.html#1373" class="Bound">v</a><a id="1421" class="Symbol">;</a>  <a id="1424" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="1434" class="Symbol">=</a> <a id="1436" href="Bitcoin.Script.Base.html#2174" class="InductiveConstructor Operator">∆õ</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Bitcoin.Script.Base.html#1413" class="InductiveConstructor">versig</a> <a id="1446" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1448" href="SecureCompilation.Coherence.html#1392" class="Bound">k</a> <a id="1450" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1452" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1454" href="Data.Fin.html#730" class="Function Operator">#</a> <a id="1456" class="Number">0</a> <a id="1458" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="1459" class="Symbol">)}</a>

<a id="1463" class="Comment">-- T0D0: redefine Message ‚âà ‚Ñ§ ??</a>
<a id="SIG·µê"></a><a id="1496" href="SecureCompilation.Coherence.html#1496" class="Function">SIG·µê</a> <a id="1501" class="Symbol">:</a> <a id="1503" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1511" class="Symbol">‚Üí</a> <a id="1513" href="ComputationalModel.Strategy.html#812" class="Function">Message</a> <a id="1521" class="Symbol">‚Üí</a> <a id="1523" href="ComputationalModel.Strategy.html#812" class="Function">Message</a>
<a id="1531" href="SecureCompilation.Coherence.html#1496" class="Function">SIG·µê</a> <a id="1536" href="SecureCompilation.Coherence.html#1536" class="Bound">k</a> <a id="1538" class="Symbol">=</a> <a id="1540" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1544" class="Symbol">(</a><a id="1545" href="Bitcoin.Crypto.html#654" class="Function">SIG</a> <a id="1549" href="SecureCompilation.Coherence.html#1536" class="Bound">k</a><a id="1550" class="Symbol">)</a>

<a id="1553" class="Comment">-- Convenient wrapper for calling the BitML compiler.</a>
<a id="COMPILE"></a><a id="1607" href="SecureCompilation.Coherence.html#1607" class="Function">COMPILE</a> <a id="1615" class="Symbol">:</a> <a id="1617" href="SymbolicModel.Mappings.Base.html#1578" class="Function">ùîæ</a> <a id="1619" href="BitML.Contracts.Types.html#2640" class="Generalizable">ad</a> <a id="1622" class="Symbol">‚Üí</a> <a id="1624" href="SecureCompilation.Compiler.html#1858" class="Function">‚àÉTx¬π</a> <a id="1629" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="1631" class="Symbol">(</a><a id="1632" href="BitML.Contracts.Helpers.html#17424" class="Function">subterms·µÉ‚Ä≤</a> <a id="1643" href="BitML.Contracts.Types.html#2640" class="Generalizable">ad</a> <a id="1646" href="Prelude.Lists.Mappings.html#586" class="Function Operator">‚Ü¶‚Ä≤</a> <a id="1649" href="SecureCompilation.Compiler.html#2044" class="Function">‚àÉTx·∂ú</a> <a id="1654" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="1656" href="BitML.Contracts.Helpers.html#841" class="Function">removeTopDecorations</a><a id="1676" class="Symbol">)</a>
<a id="1678" href="SecureCompilation.Coherence.html#1607" class="Function">COMPILE</a> <a id="1686" class="Symbol">{</a><a id="1687" class="Argument">ad</a> <a id="1690" class="Symbol">=</a> <a id="1692" href="SecureCompilation.Coherence.html#1692" class="Bound">ad</a><a id="1694" class="Symbol">}</a> <a id="1696" class="Symbol">(</a><a id="1697" href="SecureCompilation.Coherence.html#1697" class="Bound">vad</a> <a id="1701" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1703" href="SecureCompilation.Coherence.html#1703" class="Bound">txout‚ÇÄ</a> <a id="1710" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1712" href="SecureCompilation.Coherence.html#1712" class="Bound">sechash‚ÇÄ</a> <a id="1721" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1723" href="SecureCompilation.Coherence.html#1723" class="Bound">Œ∫‚ÇÄ</a><a id="1725" class="Symbol">)</a> <a id="1727" class="Symbol">=</a>
  <a id="1731" class="Keyword">let</a>
    <a id="1739" href="SecureCompilation.Coherence.html#1739" class="Bound">K</a> <a id="1741" class="Symbol">:</a> <a id="1743" href="SymbolicModel.Mappings.Base.html#663" class="Function">ùïÇ</a> <a id="1745" class="Symbol">(</a><a id="1746" href="SecureCompilation.Coherence.html#1692" class="Bound">ad</a> <a id="1749" class="Symbol">.</a><a id="1750" href="BitML.Contracts.Types.html#2457" class="Field">G</a><a id="1751" class="Symbol">)</a>
    <a id="1757" href="SecureCompilation.Coherence.html#1739" class="Bound">K</a> <a id="1759" class="Symbol">{</a><a id="1760" href="SecureCompilation.Coherence.html#1760" class="Bound">p</a><a id="1761" class="Symbol">}</a> <a id="1763" class="Symbol">_</a> <a id="1765" class="Symbol">=</a> <a id="1767" href="ComputationalModel.KeyPairs.html#297" class="Function">KÃÇ</a> <a id="1770" href="SecureCompilation.Coherence.html#1760" class="Bound">p</a>

    <a id="1777" href="SecureCompilation.Coherence.html#1777" class="Bound">T</a> <a id="1779" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1781" href="SecureCompilation.Coherence.html#1781" class="Bound">‚àÄd</a> <a id="1784" class="Symbol">=</a> <a id="1786" href="SecureCompilation.Compiler.html#2109" class="Function">bitml-compiler</a> <a id="1801" class="Symbol">{</a><a id="1802" class="Argument">ad</a> <a id="1805" class="Symbol">=</a> <a id="1807" href="SecureCompilation.Coherence.html#1692" class="Bound">ad</a><a id="1809" class="Symbol">}</a> <a id="1811" href="SecureCompilation.Coherence.html#1697" class="Bound">vad</a> <a id="1815" href="SecureCompilation.Coherence.html#1712" class="Bound">sechash‚ÇÄ</a> <a id="1824" href="SecureCompilation.Coherence.html#1703" class="Bound">txout‚ÇÄ</a> <a id="1831" href="SecureCompilation.Coherence.html#1739" class="Bound">K</a> <a id="1833" href="SecureCompilation.Coherence.html#1723" class="Bound">Œ∫‚ÇÄ</a>
  <a id="1838" class="Keyword">in</a>
    <a id="1845" href="SecureCompilation.Coherence.html#1777" class="Bound">T</a> <a id="1847" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1849" class="Symbol">(</a><a id="1850" href="SecureCompilation.Coherence.html#1781" class="Bound">‚àÄd</a> <a id="1853" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="1855" href="BitML.Contracts.Helpers.html#19768" class="Function">h-sub·∂ú</a> <a id="1862" class="Symbol">{</a><a id="1863" class="Argument">ds</a> <a id="1866" class="Symbol">=</a> <a id="1868" href="SecureCompilation.Coherence.html#1692" class="Bound">ad</a> <a id="1871" class="Symbol">.</a><a id="1872" href="BitML.Contracts.Types.html#2478" class="Field">C</a><a id="1873" class="Symbol">})</a>

<a id="1877" class="Comment">-- * Inductive case 1</a>
<a id="1899" class="Keyword">data</a> <a id="_~‚ÇÅ‚ÇÅ_"></a><a id="1904" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">_~‚ÇÅ‚ÇÅ_</a> <a id="1910" class="Symbol">:</a> <a id="1912" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="1915" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="1918" class="Symbol">‚Üí</a> <a id="1920" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="1926" class="Symbol">‚Üí</a> <a id="1928" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1932" class="Keyword">where</a>

  <a id="1941" class="Comment">-- ** Stipulation: advertisting a contract</a>
  <a id="_~‚ÇÅ‚ÇÅ_.[1]"></a><a id="1986" href="SecureCompilation.Coherence.html#1986" class="InductiveConstructor">[1]</a> <a id="1990" class="Symbol">:</a> <a id="1992" class="Symbol">‚àÄ</a> <a id="1994" class="Symbol">{</a><a id="1995" href="SecureCompilation.Coherence.html#1995" class="Bound">RÀ¢</a><a id="1997" class="Symbol">}</a> <a id="1999" class="Symbol">{</a><a id="2000" href="SecureCompilation.Coherence.html#2000" class="Bound">ùï£‚àó</a> <a id="2003" class="Symbol">:</a> <a id="2005" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="2008" href="SecureCompilation.Coherence.html#1995" class="Bound">RÀ¢</a><a id="2010" class="Symbol">}</a> <a id="2012" class="Symbol">‚Üí</a> <a id="2014" class="Keyword">let</a> <a id="2018" href="SecureCompilation.Coherence.html#2018" class="Bound">ùï£</a> <a id="2020" class="Symbol">=</a> <a id="2022" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="2027" href="SecureCompilation.Coherence.html#2000" class="Bound">ùï£‚àó</a><a id="2029" class="Symbol">;</a> <a id="2031" class="Keyword">open</a> <a id="2036" href="SymbolicModel.Mappings.Base.html#1169" class="Module">‚Ñù</a> <a id="2038" href="SecureCompilation.Coherence.html#2018" class="Bound">ùï£</a> <a id="2040" class="Keyword">in</a>
      <a id="2049" class="Keyword">let</a>
        <a id="2061" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü®</a> <a id="2063" href="SecureCompilation.Coherence.html#2063" class="Bound">G</a> <a id="2065" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü©</a> <a id="2067" href="SecureCompilation.Coherence.html#2067" class="Bound">C</a> <a id="2069" class="Symbol">=</a> <a id="2071" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="2076" class="Symbol">;</a> <a id="2078" href="SecureCompilation.Coherence.html#2078" class="Bound">partG</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="BitML.Contracts.Helpers.html#3379" class="Function">nub-participants</a> <a id="2103" href="SecureCompilation.Coherence.html#2063" class="Bound">G</a>
        <a id="2113" href="SecureCompilation.Coherence.html#2113" class="Bound">Œì‚Çú</a> <a id="2116" class="Symbol">=</a> <a id="2118" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Œì</a> <a id="2120" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="2123" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
      <a id="2131" class="Keyword">in</a>
      <a id="2140" class="Symbol">(</a><a id="2141" href="SecureCompilation.Coherence.html#2141" class="Bound">R‚âà</a> <a id="2144" class="Symbol">:</a> <a id="2146" href="SecureCompilation.Coherence.html#1995" class="Bound">RÀ¢</a> <a id="2149" href="SymbolicModel.Run.Base.html#2053" class="Function Operator">‚âà‚ãØ</a> <a id="2152" href="SecureCompilation.Coherence.html#2113" class="Bound">Œì‚Çú</a><a id="2154" class="Symbol">)</a>
    <a id="2160" class="Symbol">‚Üí</a> <a id="2162" class="Keyword">let</a>
        <a id="2174" href="SecureCompilation.Coherence.html#2174" class="Bound">Œ±</a>   <a id="2178" class="Symbol">=</a> <a id="2180" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">advertise‚¶Ö</a> <a id="2191" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="2196" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">‚¶Ü</a>
        <a id="2206" href="SecureCompilation.Coherence.html#2206" class="Bound">Œì‚Ä≤</a>  <a id="2210" class="Symbol">=</a> <a id="2212" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="2214" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="2219" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="2221" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Œì</a>
        <a id="2231" href="SecureCompilation.Coherence.html#2231" class="Bound">t‚Ä≤</a>  <a id="2235" class="Symbol">=</a> <a id="2237" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
        <a id="2247" href="SecureCompilation.Coherence.html#2247" class="Bound">Œì‚Çú‚Ä≤</a> <a id="2251" class="Symbol">=</a> <a id="2253" href="SecureCompilation.Coherence.html#2206" class="Bound">Œì‚Ä≤</a> <a id="2256" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="2259" href="SecureCompilation.Coherence.html#2231" class="Bound">t‚Ä≤</a>

        <a id="2271" href="SecureCompilation.Coherence.html#2271" class="Bound">C</a>  <a id="2274" class="Symbol">=</a> <a id="2276" href="SecureCompilation.Coherence.html#1127" class="Postulate">encode</a> <a id="2283" class="Symbol">{</a><a id="2284" href="SecureCompilation.Coherence.html#1995" class="Bound">RÀ¢</a><a id="2286" class="Symbol">}</a> <a id="2288" href="SymbolicModel.Mappings.Base.html#1224" class="Function">txout‚Ä≤</a> <a id="2295" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a>
        <a id="2308" href="SecureCompilation.Coherence.html#2308" class="Bound">Œª·∂ú</a> <a id="2311" class="Symbol">=</a> <a id="2313" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="2315" href="ComputationalModel.Strategy.html#878" class="InductiveConstructor Operator">‚Üí‚àó‚à∂</a> <a id="2319" href="SecureCompilation.Coherence.html#2271" class="Bound">C</a>
      <a id="2327" class="Keyword">in</a>
      <a id="2336" class="Symbol">(</a><a id="2337" href="SecureCompilation.Coherence.html#2337" class="Bound">‚àÉŒì‚âà</a> <a id="2341" class="Symbol">:</a> <a id="2343" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="2345" class="Symbol">(</a><a id="2346" href="SymbolicModel.Helpers.html#1359" class="Function Operator">_‚âà·∂ú</a> <a id="2350" href="SecureCompilation.Coherence.html#2206" class="Bound">Œì‚Ä≤</a><a id="2352" class="Symbol">))</a> <a id="2355" class="Symbol">‚Üí</a> <a id="2357" class="Keyword">let</a> <a id="2361" href="SecureCompilation.Coherence.html#2361" class="Bound">Œì‚Çú‚Ä≥</a> <a id="2365" class="Symbol">=</a> <a id="2367" href="SecureCompilation.Coherence.html#2337" class="Bound">‚àÉŒì‚âà</a> <a id="2371" class="Symbol">.</a><a id="2372" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="2378" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="2381" href="SecureCompilation.Coherence.html#2231" class="Bound">t‚Ä≤</a> <a id="2384" class="Keyword">in</a>
      <a id="2393" class="Comment">-- Hypotheses from [C-Advertise]</a>
      <a id="2432" class="Symbol">(</a><a id="2433" href="SecureCompilation.Coherence.html#2433" class="Bound">vad</a> <a id="2437" class="Symbol">:</a> <a id="2439" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="2445" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a><a id="2449" class="Symbol">)</a>
      <a id="2457" class="Symbol">(</a><a id="2458" href="SecureCompilation.Coherence.html#2458" class="Bound">hon</a> <a id="2462" class="Symbol">:</a> <a id="2464" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Data.List.Membership.Setoid.html#887" class="Function Operator">_‚àà</a> <a id="2472" href="BitML.Contracts.Types.html#482" class="Function">Hon</a><a id="2475" class="Symbol">)</a> <a id="2477" href="SecureCompilation.Coherence.html#2078" class="Bound">partG</a><a id="2482" class="Symbol">)</a>
      <a id="2490" class="Symbol">(</a><a id="2491" href="SecureCompilation.Coherence.html#2491" class="Bound">d‚äÜ</a>  <a id="2495" class="Symbol">:</a> <a id="2497" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="2502" href="Prelude.Collections.html#1041" class="Function Operator">‚äÜ‚¶Ö</a> <a id="2505" href="BitML.Contracts.Helpers.html#6639" class="Function">deposits</a> <a id="2514" href="Prelude.Collections.html#1041" class="Function Operator">‚¶Ü</a> <a id="2516" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Œì</a><a id="2517" class="Symbol">)</a>
    <a id="2523" class="Symbol">‚Üí</a> <a id="2525" class="Keyword">let</a>
        <a id="2537" href="SecureCompilation.Coherence.html#2537" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="2542" class="Symbol">:</a> <a id="2544" href="SecureCompilation.Coherence.html#2113" class="Bound">Œì‚Çú</a> <a id="2547" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">‚Äî[</a> <a id="2550" href="SecureCompilation.Coherence.html#2174" class="Bound">Œ±</a> <a id="2552" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">]‚Üí‚Çú</a> <a id="2556" href="SecureCompilation.Coherence.html#2247" class="Bound">Œì‚Çú‚Ä≤</a>
        <a id="2568" href="SecureCompilation.Coherence.html#2537" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="2573" class="Symbol">=</a> <a id="2575" href="BitML.Semantics.InferenceRules.html#9121" class="InductiveConstructor">[Action]</a> <a id="2584" class="Symbol">(</a><a id="2585" href="BitML.Semantics.InferenceRules.html#3863" class="InductiveConstructor">[C-Advertise]</a> <a id="2599" href="SecureCompilation.Coherence.html#2433" class="Bound">vad</a> <a id="2603" href="SecureCompilation.Coherence.html#2458" class="Bound">hon</a> <a id="2607" href="SecureCompilation.Coherence.html#2491" class="Bound">d‚äÜ</a><a id="2609" class="Symbol">)</a> <a id="2611" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="2625" class="Comment">-- txout‚Ä≤ = txout, sechash‚Ä≤ = sechash, Œ∫‚Ä≤ = Œ∫</a>
        <a id="2679" class="Keyword">open</a> <a id="2684" href="SymbolicModel.Helpers.html#6661" class="Module">H‚ÇÅ</a> <a id="2687" href="SecureCompilation.Coherence.html#2018" class="Bound">ùï£</a> <a id="2689" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="2691" href="SecureCompilation.Coherence.html#2174" class="Bound">Œ±</a> <a id="2693" href="SecureCompilation.Coherence.html#2231" class="Bound">t‚Ä≤</a> <a id="2696" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Œì</a> <a id="2698" href="SecureCompilation.Coherence.html#2141" class="Bound">R‚âà</a> <a id="2701" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="2706" href="SecureCompilation.Coherence.html#2537" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="2711" href="SecureCompilation.Coherence.html#2337" class="Bound">‚àÉŒì‚âà</a> <a id="2715" class="Keyword">using</a> <a id="2721" class="Symbol">(</a><a id="2722" href="SymbolicModel.Helpers.html#7101" class="Function">ŒªÀ¢</a><a id="2724" class="Symbol">)</a>
      <a id="2732" class="Keyword">in</a>
      <a id="2741" href="Prelude.InferenceRules.html#42919" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
      <a id="2800" class="Symbol">(</a><a id="2801" href="SecureCompilation.Coherence.html#2361" class="Bound">Œì‚Çú‚Ä≥</a> <a id="2805" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="2807" href="SecureCompilation.Coherence.html#2000" class="Bound">ùï£‚àó</a> <a id="2810" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="2812" href="SymbolicModel.Helpers.html#7101" class="Function">ŒªÀ¢</a> <a id="2815" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="2816" class="Symbol">)</a> <a id="2818" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">~‚ÇÅ‚ÇÅ</a> <a id="2822" class="Symbol">(</a><a id="2823" href="SecureCompilation.Coherence.html#2308" class="Bound">Œª·∂ú</a> <a id="2826" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="2828" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="2830" class="Symbol">)</a>

  <a id="2835" class="Comment">-- ** Stipulation: committing secrets</a>
  <a id="_~‚ÇÅ‚ÇÅ_.[2]"></a><a id="2875" href="SecureCompilation.Coherence.html#2875" class="InductiveConstructor">[2]</a> <a id="2879" class="Symbol">:</a> <a id="2881" class="Symbol">‚àÄ</a> <a id="2883" class="Symbol">{</a><a id="2884" href="SecureCompilation.Coherence.html#2884" class="Bound">RÀ¢</a><a id="2886" class="Symbol">}</a> <a id="2888" class="Symbol">{</a><a id="2889" href="SecureCompilation.Coherence.html#2889" class="Bound">ùï£‚àó</a> <a id="2892" class="Symbol">:</a> <a id="2894" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="2897" href="SecureCompilation.Coherence.html#2884" class="Bound">RÀ¢</a><a id="2899" class="Symbol">}</a> <a id="2901" class="Symbol">‚Üí</a> <a id="2903" class="Keyword">let</a> <a id="2907" href="SecureCompilation.Coherence.html#2907" class="Bound">ùï£</a> <a id="2909" class="Symbol">=</a> <a id="2911" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="2916" href="SecureCompilation.Coherence.html#2889" class="Bound">ùï£‚àó</a><a id="2918" class="Symbol">;</a> <a id="2920" class="Keyword">open</a> <a id="2925" href="SymbolicModel.Mappings.Base.html#1169" class="Module">‚Ñù</a> <a id="2927" href="SecureCompilation.Coherence.html#2907" class="Bound">ùï£</a> <a id="2929" class="Keyword">in</a>
        <a id="2940" class="Symbol">‚àÄ</a> <a id="2942" class="Symbol">{</a><a id="2943" href="SecureCompilation.Coherence.html#2943" class="Bound">Œî√óhÃÖ</a> <a id="2948" class="Symbol">:</a> <a id="2950" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2955" class="Symbol">(</a><a id="2956" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="2963" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="2965" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="2971" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a> <a id="2973" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="2975" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a><a id="2976" class="Symbol">)}</a> <a id="2979" class="Symbol">{</a><a id="2980" href="SecureCompilation.Coherence.html#2980" class="Bound">k‚Éó</a> <a id="2983" class="Symbol">:</a> <a id="2985" href="SymbolicModel.Mappings.Base.html#722" class="Function">ùïÇ¬≤‚Ä≤</a> <a id="2989" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a><a id="2993" class="Symbol">}</a>

    <a id="3000" class="Symbol">‚Üí</a> <a id="3002" class="Keyword">let</a>
        <a id="3014" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü®</a> <a id="3016" href="SecureCompilation.Coherence.html#3016" class="Bound">G</a> <a id="3018" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü©</a> <a id="3020" href="SecureCompilation.Coherence.html#3020" class="Bound">C</a> <a id="3022" class="Symbol">=</a> <a id="3024" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a>
        <a id="3037" href="SecureCompilation.Coherence.html#3037" class="Bound">Œì</a> <a id="3039" class="Symbol">=</a> <a id="3041" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="3043" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="3048" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="3050" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Œì‚ÇÄ</a>
        <a id="3061" href="SecureCompilation.Coherence.html#3061" class="Bound">Œì‚Çú</a> <a id="3064" class="Symbol">=</a> <a id="3066" href="SecureCompilation.Coherence.html#3037" class="Bound">Œì</a> <a id="3068" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="3071" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
      <a id="3079" class="Keyword">in</a>
      <a id="3088" class="Symbol">(</a><a id="3089" href="SecureCompilation.Coherence.html#3089" class="Bound">R‚âà</a> <a id="3092" class="Symbol">:</a> <a id="3094" href="SecureCompilation.Coherence.html#2884" class="Bound">RÀ¢</a> <a id="3097" href="SymbolicModel.Run.Base.html#2053" class="Function Operator">‚âà‚ãØ</a> <a id="3100" href="SecureCompilation.Coherence.html#3061" class="Bound">Œì‚Çú</a><a id="3102" class="Symbol">)</a>
    <a id="3108" class="Symbol">‚Üí</a> <a id="3110" class="Keyword">let</a>
        <a id="3122" href="SecureCompilation.Coherence.html#3122" class="Bound">C</a> <a id="3124" class="Symbol">:</a> <a id="3126" href="ComputationalModel.Strategy.html#812" class="Function">Message</a>
        <a id="3142" href="SecureCompilation.Coherence.html#3122" class="Bound">C</a> <a id="3144" class="Symbol">=</a> <a id="3146" href="SecureCompilation.Coherence.html#1127" class="Postulate">encode</a> <a id="3153" class="Symbol">{</a><a id="3154" href="SecureCompilation.Coherence.html#2884" class="Bound">RÀ¢</a><a id="3156" class="Symbol">}</a> <a id="3158" href="SymbolicModel.Mappings.Base.html#1224" class="Function">txout‚Ä≤</a> <a id="3165" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a>

        <a id="3179" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a> <a id="3181" class="Symbol">:</a> <a id="3183" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3188" class="Symbol">(</a><a id="3189" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="3196" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="3198" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="3204" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a><a id="3205" class="Symbol">)</a>
        <a id="3215" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a> <a id="3217" class="Symbol">=</a> <a id="3219" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3223" class="Symbol">(Œª{</a> <a id="3227" class="Symbol">(</a><a id="3228" href="SecureCompilation.Coherence.html#3228" class="Bound">s</a> <a id="3230" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3232" href="SecureCompilation.Coherence.html#3232" class="Bound">mn</a> <a id="3235" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3237" class="Symbol">_)</a> <a id="3240" class="Symbol">‚Üí</a> <a id="3242" href="SecureCompilation.Coherence.html#3228" class="Bound">s</a> <a id="3244" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3246" href="SecureCompilation.Coherence.html#3232" class="Bound">mn</a> <a id="3249" class="Symbol">})</a> <a id="3252" href="SecureCompilation.Coherence.html#2943" class="Bound">Œî√óhÃÖ</a>

        <a id="3266" class="Comment">-- [BUG] leads to internal error</a>
        <a id="3307" class="Comment">-- (unsolved meta after serialization, c.f. issue #5584)</a>
        <a id="3372" class="Comment">-- (as , ms) = unzip Œî</a>
        <a id="3403" href="SecureCompilation.Coherence.html#3403" class="Bound">as</a> <a id="3406" class="Symbol">=</a> <a id="3408" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="3414" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3416" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="3422" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a>
        <a id="3432" href="SecureCompilation.Coherence.html#3432" class="Bound">ms</a> <a id="3435" class="Symbol">=</a> <a id="3437" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a> <a id="3443" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3445" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="3451" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a>

        <a id="3462" href="SecureCompilation.Coherence.html#3462" class="Bound">Œî·∂ú</a> <a id="3465" class="Symbol">:</a> <a id="3467" href="BitML.Semantics.Configurations.Types.html#2076" class="Function">Cfg</a>
        <a id="3479" href="SecureCompilation.Coherence.html#3462" class="Bound">Œî·∂ú</a> <a id="3482" class="Symbol">=</a> <a id="3484" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="3487" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3491" class="Symbol">(</a><a id="3492" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="3500" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">‚ü®</a> <a id="3502" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="3504" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">‚à∂_‚ôØ_‚ü©</a><a id="3509" class="Symbol">)</a> <a id="3511" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a>

        <a id="3522" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a> <a id="3525" class="Symbol">:</a> <a id="3527" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3532" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a> <a id="3534" class="Comment">-- ‚âà Message</a>
        <a id="3555" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a> <a id="3558" class="Symbol">=</a> <a id="3560" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3564" class="Symbol">(</a><a id="3565" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a> <a id="3571" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="3573" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a><a id="3578" class="Symbol">)</a> <a id="3580" href="SecureCompilation.Coherence.html#2943" class="Bound">Œî√óhÃÖ</a>

        <a id="3594" href="SecureCompilation.Coherence.html#3594" class="Bound">kÃÖ</a> <a id="3597" class="Symbol">:</a> <a id="3599" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3604" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a> <a id="3606" class="Comment">-- ‚âà Message</a>
        <a id="3627" href="SecureCompilation.Coherence.html#3594" class="Bound">kÃÖ</a> <a id="3630" class="Symbol">=</a> <a id="3632" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="3642" class="Symbol">(</a><a id="3643" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3647" href="Bitcoin.Crypto.html#377" class="Field">pub</a> <a id="3651" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="3653" href="Prelude.Lists.Mappings.html#824" class="Function">codom</a><a id="3658" class="Symbol">)</a> <a id="3660" class="Symbol">(</a><a id="3661" href="Prelude.Lists.Mappings.html#824" class="Function">codom</a> <a id="3667" href="SecureCompilation.Coherence.html#2980" class="Bound">k‚Éó</a><a id="3669" class="Symbol">)</a>

        <a id="3680" href="SecureCompilation.Coherence.html#3680" class="Bound">C,hÃÖ,kÃÖ</a> <a id="3688" class="Symbol">:</a> <a id="3690" href="ComputationalModel.Strategy.html#812" class="Function">Message</a>
        <a id="3706" href="SecureCompilation.Coherence.html#3680" class="Bound">C,hÃÖ,kÃÖ</a> <a id="3714" class="Symbol">=</a> <a id="3716" href="SecureCompilation.Coherence.html#3122" class="Bound">C</a> <a id="3718" href="Prelude.Semigroup.html#158" class="Field Operator">‚óá</a> <a id="3720" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a> <a id="3723" href="Prelude.Semigroup.html#158" class="Field Operator">‚óá</a> <a id="3725" href="SecureCompilation.Coherence.html#3594" class="Bound">kÃÖ</a>

        <a id="3737" href="SecureCompilation.Coherence.html#3737" class="Bound">C,hÃÖ,kÃÖ‚Çê</a> <a id="3746" class="Symbol">:</a> <a id="3748" href="ComputationalModel.Strategy.html#812" class="Function">Message</a>
        <a id="3764" href="SecureCompilation.Coherence.html#3737" class="Bound">C,hÃÖ,kÃÖ‚Çê</a> <a id="3773" class="Symbol">=</a> <a id="3775" href="SecureCompilation.Coherence.html#1496" class="Function">SIG·µê</a> <a id="3780" class="Symbol">(</a><a id="3781" href="ComputationalModel.KeyPairs.html#249" class="Function">K</a> <a id="3783" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="3784" class="Symbol">)</a> <a id="3786" href="SecureCompilation.Coherence.html#3680" class="Bound">C,hÃÖ,kÃÖ</a>

        <a id="3803" href="SecureCompilation.Coherence.html#3803" class="Bound">Œ±</a>   <a id="3807" class="Symbol">=</a> <a id="3809" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commit‚¶Ö</a> <a id="3822" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="3824" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="3826" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="3831" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="3833" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a> <a id="3835" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">‚¶Ü</a>
        <a id="3845" href="SecureCompilation.Coherence.html#3845" class="Bound">Œì‚Ä≤</a>  <a id="3849" class="Symbol">=</a> <a id="3851" href="SecureCompilation.Coherence.html#3037" class="Bound">Œì</a> <a id="3853" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="3855" href="SecureCompilation.Coherence.html#3462" class="Bound">Œî·∂ú</a> <a id="3858" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="3860" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="3862" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="3868" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">‚ôØ‚ñ∑</a> <a id="3871" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="3876" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a>
        <a id="3886" href="SecureCompilation.Coherence.html#3886" class="Bound">t‚Ä≤</a>  <a id="3890" class="Symbol">=</a> <a id="3892" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
        <a id="3902" href="SecureCompilation.Coherence.html#3902" class="Bound">Œì‚Çú‚Ä≤</a> <a id="3906" class="Symbol">=</a> <a id="3908" href="SecureCompilation.Coherence.html#3845" class="Bound">Œì‚Ä≤</a> <a id="3911" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="3914" href="SecureCompilation.Coherence.html#3886" class="Bound">t‚Ä≤</a>
        <a id="3925" href="SecureCompilation.Coherence.html#3925" class="Bound">Œª·∂ú</a>  <a id="3929" class="Symbol">=</a> <a id="3931" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="3933" href="ComputationalModel.Strategy.html#878" class="InductiveConstructor Operator">‚Üí‚àó‚à∂</a> <a id="3937" href="SecureCompilation.Coherence.html#3737" class="Bound">C,hÃÖ,kÃÖ‚Çê</a>
      <a id="3952" class="Keyword">in</a>
      <a id="3961" class="Symbol">(</a><a id="3962" href="SecureCompilation.Coherence.html#3962" class="Bound">‚àÉŒì‚âà</a> <a id="3966" class="Symbol">:</a> <a id="3968" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="3970" class="Symbol">(</a><a id="3971" href="SymbolicModel.Helpers.html#1359" class="Function Operator">_‚âà·∂ú</a> <a id="3975" href="SecureCompilation.Coherence.html#3845" class="Bound">Œì‚Ä≤</a><a id="3977" class="Symbol">))</a> <a id="3980" class="Symbol">‚Üí</a> <a id="3982" class="Keyword">let</a> <a id="3986" href="SecureCompilation.Coherence.html#3986" class="Bound">Œì‚Çú‚Ä≥</a> <a id="3990" class="Symbol">=</a> <a id="3992" href="SecureCompilation.Coherence.html#3962" class="Bound">‚àÉŒì‚âà</a> <a id="3996" class="Symbol">.</a><a id="3997" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="4003" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="4006" href="SecureCompilation.Coherence.html#3886" class="Bound">t‚Ä≤</a> <a id="4009" class="Keyword">in</a>
      <a id="4018" class="Comment">-- Hypotheses from [C-AuthCommit]</a>
      <a id="4058" class="Symbol">(</a><a id="4059" href="SecureCompilation.Coherence.html#4059" class="Bound">as‚â°</a> <a id="4063" class="Symbol">:</a> <a id="4065" href="SecureCompilation.Coherence.html#3403" class="Bound">as</a> <a id="4068" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="4070" href="BitML.Contracts.Helpers.html#7414" class="Function">secretsOf·µñ</a> <a id="4081" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4083" href="SecureCompilation.Coherence.html#3016" class="Bound">G</a><a id="4084" class="Symbol">)</a>
      <a id="4092" class="Symbol">(</a><a id="4093" href="SecureCompilation.Coherence.html#4093" class="Bound">All‚àâ</a> <a id="4098" class="Symbol">:</a> <a id="4100" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="4104" class="Symbol">(</a><a id="4105" href="Data.List.Membership.Setoid.html#936" class="Function Operator">_‚àâ</a> <a id="4108" href="BitML.Semantics.Configurations.Helpers.html#11252" class="Function">secretsOf·∂ú·∂†</a> <a id="4120" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4122" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Œì‚ÇÄ</a><a id="4124" class="Symbol">)</a> <a id="4126" href="SecureCompilation.Coherence.html#3403" class="Bound">as</a><a id="4128" class="Symbol">)</a>
      <a id="4136" class="Symbol">(</a><a id="4137" href="SecureCompilation.Coherence.html#4137" class="Bound">Hon‚áí</a> <a id="4142" class="Symbol">:</a> <a id="4144" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4146" href="Data.List.Membership.Setoid.html#887" class="Function Operator">‚àà</a> <a id="4148" href="BitML.Contracts.Types.html#482" class="Function">Hon</a> <a id="4152" class="Symbol">‚Üí</a> <a id="4154" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="4158" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="4166" href="SecureCompilation.Coherence.html#3432" class="Bound">ms</a><a id="4168" class="Symbol">)</a>
    <a id="4174" class="Symbol">‚Üí</a> <a id="4176" class="Keyword">let</a>
        <a id="4188" href="SecureCompilation.Coherence.html#4188" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="4193" class="Symbol">:</a> <a id="4195" href="SecureCompilation.Coherence.html#3061" class="Bound">Œì‚Çú</a> <a id="4198" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">‚Äî[</a> <a id="4201" href="SecureCompilation.Coherence.html#3803" class="Bound">Œ±</a> <a id="4203" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">]‚Üí‚Çú</a> <a id="4207" href="SecureCompilation.Coherence.html#3902" class="Bound">Œì‚Çú‚Ä≤</a>
        <a id="4219" href="SecureCompilation.Coherence.html#4188" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="4224" class="Symbol">=</a> <a id="4226" href="BitML.Semantics.InferenceRules.html#9121" class="InductiveConstructor">[Action]</a> <a id="4235" class="Symbol">(</a><a id="4236" href="BitML.Semantics.InferenceRules.html#4244" class="InductiveConstructor">[C-AuthCommit]</a> <a id="4251" href="SecureCompilation.Coherence.html#4059" class="Bound">as‚â°</a> <a id="4255" href="SecureCompilation.Coherence.html#4093" class="Bound">All‚àâ</a> <a id="4260" href="SecureCompilation.Coherence.html#4137" class="Bound">Hon‚áí</a><a id="4264" class="Symbol">)</a> <a id="4266" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="4280" class="Comment">-- (v) txout = txout‚Ä≤ (vi) extend sechash‚Ä≤ (vii) extend Œ∫‚Ä≤</a>
        <a id="4347" href="SecureCompilation.Coherence.html#4347" class="Bound">sechash‚Å∫</a> <a id="4356" class="Symbol">:</a> <a id="4358" href="SecureCompilation.Coherence.html#3403" class="Bound">as</a> <a id="4361" href="Prelude.Lists.Mappings.html#708" class="Function Operator">‚Ü¶</a> <a id="4363" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a>
        <a id="4373" href="SecureCompilation.Coherence.html#4347" class="Bound">sechash‚Å∫</a> <a id="4382" href="SecureCompilation.Coherence.html#4382" class="Bound">a‚àà</a> <a id="4385" class="Symbol">=</a>
          <a id="4397" class="Keyword">let</a> <a id="4401" class="Symbol">_</a> <a id="4403" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4405" href="SecureCompilation.Coherence.html#4405" class="Bound">a√óm‚àà</a> <a id="4410" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4412" class="Symbol">_</a>    <a id="4417" class="Symbol">=</a> <a id="4419" href="Prelude.Lists.Core.html#1008" class="Function">‚àà-unzip‚ÅªÀ°</a> <a id="4429" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a> <a id="4431" href="SecureCompilation.Coherence.html#4382" class="Bound">a‚àà</a>
              <a id="4448" class="Symbol">(_</a> <a id="4451" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4453" class="Symbol">_</a> <a id="4455" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4457" href="SecureCompilation.Coherence.html#4457" class="Bound">z</a><a id="4458" class="Symbol">)</a> <a id="4460" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4462" class="Symbol">_</a> <a id="4464" class="Symbol">=</a> <a id="4466" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">‚àà-map‚Åª</a> <a id="4473" class="Symbol">(Œª{</a> <a id="4477" class="Symbol">(</a><a id="4478" href="SecureCompilation.Coherence.html#4478" class="Bound">s</a> <a id="4480" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4482" href="SecureCompilation.Coherence.html#4482" class="Bound">mn</a> <a id="4485" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4487" class="Symbol">_)</a> <a id="4490" class="Symbol">‚Üí</a> <a id="4492" href="SecureCompilation.Coherence.html#4478" class="Bound">s</a> <a id="4494" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4496" href="SecureCompilation.Coherence.html#4482" class="Bound">mn</a> <a id="4499" class="Symbol">})</a> <a id="4502" href="SecureCompilation.Coherence.html#4405" class="Bound">a√óm‚àà</a>
          <a id="4517" class="Keyword">in</a> <a id="4520" href="SecureCompilation.Coherence.html#4457" class="Bound">z</a>

        <a id="4531" class="Keyword">open</a> <a id="4536" href="SymbolicModel.Helpers.html#8393" class="Module">H‚ÇÇ</a> <a id="4539" class="Symbol">{</a><a id="4540" href="SecureCompilation.Coherence.html#2884" class="Bound">RÀ¢</a><a id="4542" class="Symbol">}</a> <a id="4544" href="SecureCompilation.Coherence.html#2907" class="Bound">ùï£</a> <a id="4546" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="4548" href="SecureCompilation.Coherence.html#3803" class="Bound">Œ±</a> <a id="4550" href="SecureCompilation.Coherence.html#3886" class="Bound">t‚Ä≤</a> <a id="4553" href="SecureCompilation.Coherence.html#3037" class="Bound">Œì</a> <a id="4555" href="SecureCompilation.Coherence.html#3089" class="Bound">R‚âà</a> <a id="4558" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4560" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4562" href="SecureCompilation.Coherence.html#1067" class="Generalizable">‚ü®G‚ü©C</a> <a id="4567" href="SecureCompilation.Coherence.html#3179" class="Bound">Œî</a> <a id="4569" href="SecureCompilation.Coherence.html#4347" class="Bound">sechash‚Å∫</a> <a id="4578" href="SecureCompilation.Coherence.html#2980" class="Bound">k‚Éó</a> <a id="4581" href="SecureCompilation.Coherence.html#4188" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="4586" href="SecureCompilation.Coherence.html#3962" class="Bound">‚àÉŒì‚âà</a> <a id="4590" class="Keyword">using</a> <a id="4596" class="Symbol">(</a><a id="4597" href="SymbolicModel.Helpers.html#12895" class="Function">ŒªÀ¢</a><a id="4599" class="Symbol">)</a>
      <a id="4607" class="Keyword">in</a>
      <a id="4616" class="Comment">-- (i) ‚ü®G‚ü©C has been previously advertised in R·∂ú</a>
      <a id="4671" class="Comment">-- T0D0: make sure it is the first occurrence of such a broadcast in R·∂ú</a>
    <a id="4747" href="Prelude.InferenceRules.html#56094" class="Function Operator">‚àô</a> <a id="4749" class="Symbol">(</a><a id="4750" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="4752" class="Symbol">Œª</a> <a id="4754" href="SecureCompilation.Coherence.html#4754" class="Bound">B</a> <a id="4756" class="Symbol">‚Üí</a> <a id="4758" class="Symbol">(</a><a id="4759" href="SecureCompilation.Coherence.html#4754" class="Bound">B</a> <a id="4761" href="ComputationalModel.Strategy.html#878" class="InductiveConstructor Operator">‚Üí‚àó‚à∂</a> <a id="4765" href="SecureCompilation.Coherence.html#3122" class="Bound">C</a><a id="4766" class="Symbol">)</a> <a id="4768" href="Data.List.Membership.Setoid.html#887" class="Function Operator">‚àà</a> <a id="4770" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="4772" class="Symbol">)</a>

      <a id="4781" class="Comment">-- (ii) broadcast message in R·∂ú</a>
      <a id="4819" class="Comment">-- T0D0: make sure that Œª·∂ú is the first occurrence of such a message after C in R·∂ú</a>
    <a id="4906" class="Comment">-- ‚Üí ‚àÉ Œª B ‚Üí Œª·∂ú ‚â° B ‚Üí‚àó‚à∂ C,hÃÖ,kÃÖ‚Çê</a>
    <a id="4943" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="4945" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="4949" class="Symbol">(Œª</a> <a id="4952" href="SecureCompilation.Coherence.html#4952" class="Bound">h·µ¢</a> <a id="4955" class="Symbol">‚Üí</a> <a id="4957" href="SecureCompilation.Coherence.html#1287" class="Postulate Operator">‚à£</a> <a id="4959" href="SecureCompilation.Coherence.html#4952" class="Bound">h·µ¢</a> <a id="4962" href="SecureCompilation.Coherence.html#1287" class="Postulate Operator">‚à£·∂ª</a> <a id="4965" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="4967" href="SecureCompilation.Coherence.html#745" class="Bound">Œ∑</a><a id="4968" class="Symbol">)</a> <a id="4970" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a>

      <a id="4980" class="Comment">-- (iii) each h·µ¢ is obtained by querying the oracle, otherwise we have a dishonestly chosen secret</a>
    <a id="5083" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="5085" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="5089" class="Symbol">(Œª{</a> <a id="5093" class="Symbol">(_</a> <a id="5096" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5098" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="5103" href="SecureCompilation.Coherence.html#5103" class="Bound">N·µ¢</a> <a id="5106" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5108" href="SecureCompilation.Coherence.html#5108" class="Bound">h·µ¢</a><a id="5110" class="Symbol">)</a>
            <a id="5124" class="Symbol">‚Üí</a> <a id="5126" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="5128" class="Symbol">Œª</a> <a id="5130" href="SecureCompilation.Coherence.html#5130" class="Bound">B</a> <a id="5132" class="Symbol">‚Üí</a> <a id="5134" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="5136" class="Symbol">Œª</a> <a id="5138" href="SecureCompilation.Coherence.html#5138" class="Bound">m·µ¢</a> <a id="5141" class="Symbol">‚Üí</a> <a id="5143" class="Symbol">((</a><a id="5145" href="SecureCompilation.Coherence.html#5130" class="Bound">B</a> <a id="5147" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5149" href="SecureCompilation.Coherence.html#5138" class="Bound">m·µ¢</a> <a id="5152" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5154" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="5156" href="SecureCompilation.Coherence.html#5108" class="Bound">h·µ¢</a> <a id="5159" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="5160" class="Symbol">)</a> <a id="5162" href="Data.List.Membership.Setoid.html#887" class="Function Operator">‚àà</a> <a id="5164" href="ComputationalModel.Strategy.html#3224" class="Function">oracleInteractions</a> <a id="5183" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="5185" class="Symbol">)</a> <a id="5187" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="5189" class="Symbol">(</a><a id="5190" href="SecureCompilation.Coherence.html#1302" class="Postulate Operator">‚à£</a> <a id="5192" href="SecureCompilation.Coherence.html#5138" class="Bound">m·µ¢</a> <a id="5195" href="SecureCompilation.Coherence.html#1302" class="Postulate Operator">‚à£·µê</a> <a id="5198" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="5200" href="SecureCompilation.Coherence.html#745" class="Bound">Œ∑</a> <a id="5202" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="5204" href="SecureCompilation.Coherence.html#5103" class="Bound">N·µ¢</a><a id="5206" class="Symbol">)</a>
            <a id="5220" class="Symbol">;</a> <a id="5222" class="Symbol">(_</a> <a id="5225" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5227" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="5235" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5237" href="SecureCompilation.Coherence.html#5237" class="Bound">h·µ¢</a><a id="5239" class="Symbol">)</a>
            <a id="5253" class="Symbol">‚Üí</a> <a id="5255" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="5257" href="SecureCompilation.Coherence.html#5237" class="Bound">h·µ¢</a> <a id="5260" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="5262" href="Data.List.Membership.Setoid.html#936" class="Function Operator">‚àâ</a> <a id="5264" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5268" class="Symbol">(</a><a id="5269" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a> <a id="5275" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="5277" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a><a id="5282" class="Symbol">)</a> <a id="5284" class="Symbol">(</a><a id="5285" href="Data.List.Base.html#8092" class="Function">filter</a> <a id="5292" class="Symbol">((</a><a id="5294" href="SecureCompilation.Coherence.html#745" class="Bound">Œ∑</a> <a id="5296" href="Prelude.Ord.html#487" class="Function Operator">‚â§?_</a><a id="5299" class="Symbol">)</a> <a id="5301" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="5303" href="SecureCompilation.Coherence.html#1302" class="Postulate Operator">‚à£_‚à£·µê</a> <a id="5308" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="5310" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="5316" href="Function.Base.html#1031" class="Function Operator">‚àò</a> <a id="5318" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a><a id="5323" class="Symbol">)</a> <a id="5325" class="Symbol">(</a><a id="5326" href="ComputationalModel.Strategy.html#3224" class="Function">oracleInteractions</a> <a id="5345" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="5347" class="Symbol">))</a>
            <a id="5362" class="Symbol">})</a> <a id="5365" href="SecureCompilation.Coherence.html#2943" class="Bound">Œî√óhÃÖ</a>

      <a id="5377" class="Comment">-- (iv) no hash is reused</a>
    <a id="5407" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="5409" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="5416" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a>
    <a id="5423" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="5425" href="Data.List.Relation.Binary.Disjoint.Setoid.html#842" class="Function">Disjoint</a> <a id="5434" href="SecureCompilation.Coherence.html#3522" class="Bound">hÃÖ</a> <a id="5437" class="Symbol">(</a><a id="5438" href="Prelude.Lists.Mappings.html#824" class="Function">codom</a> <a id="5444" href="SymbolicModel.Mappings.Base.html#1243" class="Function">sechash‚Ä≤</a><a id="5452" class="Symbol">)</a>
      <a id="5460" href="Prelude.InferenceRules.html#12771" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
      <a id="5519" class="Symbol">(</a><a id="5520" href="SecureCompilation.Coherence.html#3986" class="Bound">Œì‚Çú‚Ä≥</a> <a id="5524" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="5526" href="SecureCompilation.Coherence.html#2889" class="Bound">ùï£‚àó</a> <a id="5529" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="5531" href="SymbolicModel.Helpers.html#12895" class="Function">ŒªÀ¢</a> <a id="5534" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="5535" class="Symbol">)</a> <a id="5537" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">~‚ÇÅ‚ÇÅ</a> <a id="5541" class="Symbol">(</a><a id="5542" href="SecureCompilation.Coherence.html#3925" class="Bound">Œª·∂ú</a> <a id="5545" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="5547" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="5549" class="Symbol">)</a>
<a id="5551" class="Comment">{-
  -- ** Stipulation: authorizing deposits
  [3] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
        let ‚ü® G ‚ü© C = ‚ü®G‚ü©C ; partG = G ‚àôpartG in
        let Œì = ` ‚ü®G‚ü©C ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-init‚¶Ö A , ‚ü®G‚ü©C , x ‚¶Ü
        Œì‚Ä≤  = Œì ‚à£ A auth[ x ‚ñ∑À¢ ‚ü®G‚ü©C ]
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [C-AuthInit]
      (committedA : partG ‚äÜ committedParticipants ‚ü®G‚ü©C Œì‚ÇÄ)
      (A‚ààper : (A , v , x) ‚àà persistentDeposits G)
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([C-AuthInit] committedA A‚ààper) refl

        -- (iv) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÉ {RÀ¢} ùï£ t Œ± t‚Ä≤ ‚ü®G‚ü©C Œì‚ÇÄ A x R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢; Lift·∂ú)

        -- invoke compiler
        T : ‚àÉTx
        T = let (_ , T·µ¢‚Çô·µ¢‚Çú) , _ = COMPILE (Lift·∂ú committedA)
            in -, -, T·µ¢‚Çô·µ¢‚Çú

        -- (i) broadcast T·µ¢‚Çô·µ¢‚Çú , signed with A&#39;s private key
        m = [ SIG (KÃÇ A) T ]
        Œª·∂ú = B ‚Üí‚àó‚à∂ m

      in
      -- (ii) T·µ¢‚Çô·µ¢‚Çú occurs as a message in R·∂ú
      (‚àÉ Œª B ‚Üí (B ‚Üí‚àó‚à∂ [ T ‚ôØ ]) ‚àà R·∂ú)

      -- (iii) broadcast message in R·∂ú
      -- T0D0: make sure that Œª·∂ú is the first occurrence of such a message after Tinit in R·∂ú
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Stipulation: activating the contract
  [4] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
      let
        ‚ü® G ‚ü© C = ‚ü®G‚ü©C; partG = G ‚àôpartG
        toSpend = persistentDeposits G
        vs      = map select‚ÇÇ toSpend
        xs      = map select‚ÇÉ toSpend
        v       = sum vs

        Œì = ` ‚ü®G‚ü©C ‚à£ Œì‚ÇÄ
          ‚à£ || map (Œª{ (A·µ¢ , v·µ¢ , x·µ¢) ‚Üí ‚ü® A·µ¢ has v·µ¢ ‚ü©at x·µ¢ ‚à£ A·µ¢ auth[ x·µ¢ ‚ñ∑À¢ ‚ü®G‚ü©C ] }) toSpend
          ‚à£ || map (_auth[ ‚ôØ‚ñ∑ ‚ü®G‚ü©C ]) partG
        Œì‚Çú = Œì at t
      in
      -- (i) consume {G}C and its persistent deposits from RÀ¢
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = init‚¶Ö G , C ‚¶Ü
        Œì‚Ä≤  = ‚ü® C , v ‚ü©at z ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [C-Init]
      (fresh-z : z ‚àâ xs ++ ids Œì‚ÇÄ) ‚Üí
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([C-Init] fresh-z) refl

        open H‚ÇÑ {RÀ¢} ùï£ t Œ± t‚Ä≤ ‚ü®G‚ü©C Œì‚ÇÄ toSpend v z R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (module H‚ÇÑ‚Ä≤; Lift·∂ú)

        -- invoke compiler
        T : ‚àÉTx
        T = let (_ , T·µ¢‚Çô·µ¢‚Çú) , _ = COMPILE Lift·∂ú
            in -, -, T·µ¢‚Çô·µ¢‚Çú

        -- (ii) append T·µ¢‚Çô·µ¢‚Çú to the blockchain
        Œª·∂ú = submit T

        -- (iii) sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤, txout extends txout‚Ä≤ with (z ‚Ü¶ T·µ¢‚Çô·µ¢‚Çú)
        open H‚ÇÑ‚Ä≤ (T at 0F)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Contract actions: authorize control
  [5] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
        ‚àÄ {i : Index c} ‚Üí let open ‚à£SELECT c i in
        let Œì = ‚ü® c , v ‚ü©at x ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in
        ‚àÄ {A} ‚Üí -- [T0D0] fixed in Agda-HEAD, see issue #5683

      -- D ‚â° A ‚à∂ D‚Ä≤
      (D‚â°A:D‚Ä≤ : A ‚àà authDecorations d)
      -- (i) RÀ¢ contains ‚ü®C , v‚ü©‚Çì with C = D + ‚àë·µ¢ D·µ¢
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-control‚¶Ö A , x ‚ñ∑ d ‚¶Ü
        Œì‚Ä≤  = ‚ü® c , v ‚ü©at x ‚à£ A auth[ x ‚ñ∑ d ] ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [C-AuthControl], already in hypothesis `D‚â°A:D‚Ä≤`
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([C-AuthControl] D‚â°A:D‚Ä≤) refl

        -- (iv) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÖ {RÀ¢} ùï£ t Œ± t‚Ä≤ c v x Œì‚ÇÄ A i R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢; Lift·∂ú)

        -- (ii) {G}C is the ancestor of ‚ü®C, v‚ü©‚Çì in RÀ¢
        ‚ü®G‚ü©C , vad , ad‚àà , c‚äÜ , anc = ANCESTOR {R = RÀ¢} {Œì = Œì} R‚âà (here refl)
        ‚ü® G ‚ü© C = ‚ü®G‚ü©C; partG = G ‚àôpartG

        d‚àà : d ‚àà subterms·µÉ‚Ä≤ ‚ü®G‚ü©C
        d‚àà = c‚äÜ (L.Mem.‚àà-lookup i)

        A‚àà : A ‚àà partG
        A‚àà = ‚àà-nub‚Å∫ $ subterms‚Ä≤-part‚äÜ·µÉ vad d‚àà $ auth‚äÜpart {d = d} D‚â°A:D‚Ä≤

        T : ‚àÉTx
        T = let _ , ‚àÄd‚àó = COMPILE (Lift·∂ú anc)
                _ , T·µà = ‚àÄd‚àó d‚àà
            in -, -, T·µà

        Œª·∂ú = B ‚Üí‚àó‚à∂ [ SIG·µñ (Œ∫‚Ä≤ ad‚àà d‚àà {A} A‚àà .pub) T ]
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)
-}</a>
  <a id="9911" class="Comment">-- ** Contract actions: put</a>
  <a id="_~‚ÇÅ‚ÇÅ_.[6]"></a><a id="9941" href="SecureCompilation.Coherence.html#9941" class="InductiveConstructor">[6]</a> <a id="9945" class="Symbol">:</a> <a id="9947" class="Symbol">‚àÄ</a> <a id="9949" class="Symbol">{</a><a id="9950" href="SecureCompilation.Coherence.html#9950" class="Bound">RÀ¢</a><a id="9952" class="Symbol">}</a> <a id="9954" class="Symbol">{</a><a id="9955" href="SecureCompilation.Coherence.html#9955" class="Bound">ùï£‚àó</a> <a id="9958" class="Symbol">:</a> <a id="9960" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="9963" href="SecureCompilation.Coherence.html#9950" class="Bound">RÀ¢</a><a id="9965" class="Symbol">}</a> <a id="9967" class="Symbol">‚Üí</a> <a id="9969" class="Keyword">let</a> <a id="9973" href="SecureCompilation.Coherence.html#9973" class="Bound">ùï£</a> <a id="9975" class="Symbol">=</a> <a id="9977" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="9982" href="SecureCompilation.Coherence.html#9955" class="Bound">ùï£‚àó</a><a id="9984" class="Symbol">;</a> <a id="9986" class="Keyword">open</a> <a id="9991" href="SymbolicModel.Mappings.Base.html#1169" class="Module">‚Ñù</a> <a id="9993" href="SecureCompilation.Coherence.html#9973" class="Bound">ùï£</a> <a id="9995" class="Keyword">in</a>
        <a id="10006" class="Symbol">‚àÄ</a> <a id="10008" class="Symbol">{</a><a id="10009" href="SecureCompilation.Coherence.html#10009" class="Bound">ds</a> <a id="10012" class="Symbol">:</a> <a id="10014" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10019" class="Symbol">(</a><a id="10020" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="10032" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="10034" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="10042" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="10044" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="10046" class="Symbol">)}</a> <a id="10049" class="Symbol">{</a><a id="10050" href="SecureCompilation.Coherence.html#10050" class="Bound">ss</a> <a id="10053" class="Symbol">:</a> <a id="10055" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10060" class="Symbol">(</a><a id="10061" href="SecureCompilation.Coherence.html#566" class="Bound">Participant</a> <a id="10073" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="10075" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="10082" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="10084" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a><a id="10085" class="Symbol">)}</a> <a id="10088" class="Symbol">‚Üí</a>
        <a id="10098" class="Symbol">‚àÄ</a> <a id="10100" class="Symbol">{</a><a id="10101" href="SecureCompilation.Coherence.html#10101" class="Bound">i</a> <a id="10103" class="Symbol">:</a> <a id="10105" href="Prelude.Lists.Indexed.html#457" class="Function">Index</a> <a id="10111" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a><a id="10112" class="Symbol">}</a> <a id="10114" class="Symbol">‚Üí</a> <a id="10116" class="Keyword">let</a> <a id="10120" class="Keyword">open</a> <a id="10125" href="BitML.Contracts.Helpers.html#1460" class="Module">‚à£SELECT</a> <a id="10133" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="10135" href="SecureCompilation.Coherence.html#10101" class="Bound">i</a><a id="10136" class="Symbol">;</a> <a id="10138" href="SecureCompilation.Coherence.html#10138" class="Bound">As</a> <a id="10141" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10143" href="SecureCompilation.Coherence.html#10143" class="Bound">ts</a> <a id="10146" class="Symbol">=</a> <a id="10148" href="BitML.Contracts.Helpers.html#13722" class="Function">decorations</a> <a id="10160" href="BitML.Contracts.Helpers.html#1506" class="Function">d</a> <a id="10162" class="Keyword">in</a>
        <a id="10173" class="Symbol">‚àÄ</a> <a id="10175" class="Symbol">{</a><a id="10176" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="10178" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a><a id="10179" class="Symbol">}</a> <a id="10181" class="Symbol">‚Üí</a> <a id="10183" class="Comment">-- [T0D0] fixed in Agda-HEAD, see issue #5683</a>
      <a id="10235" class="Keyword">let</a>
        <a id="10247" class="Comment">-- (i) xs = x‚ÇÅ‚ãØx‚Çñ</a>
        <a id="10273" class="Symbol">(_</a> <a id="10276" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10278" href="SecureCompilation.Coherence.html#10278" class="Bound">vs</a> <a id="10281" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10283" href="SecureCompilation.Coherence.html#10283" class="Bound">xs</a><a id="10285" class="Symbol">)</a> <a id="10287" class="Symbol">=</a> <a id="10289" href="Prelude.Lists.Core.html#1320" class="Function">unzip‚ÇÉ</a> <a id="10296" href="SecureCompilation.Coherence.html#10009" class="Bound">ds</a>
        <a id="10307" class="Symbol">(_</a> <a id="10310" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10312" href="SecureCompilation.Coherence.html#10312" class="Bound">as</a> <a id="10315" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10317" class="Symbol">_)</a>  <a id="10321" class="Symbol">=</a> <a id="10323" href="Prelude.Lists.Core.html#1320" class="Function">unzip‚ÇÉ</a> <a id="10330" href="SecureCompilation.Coherence.html#10050" class="Bound">ss</a>
        <a id="10341" href="SecureCompilation.Coherence.html#10341" class="Bound">Œì‚ÇÅ</a>  <a id="10345" class="Symbol">=</a> <a id="10347" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="10350" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10354" class="Symbol">(</a><a id="10355" href="Prelude.Nary.html#671" class="Function">uncurry‚ÇÉ</a> <a id="10364" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">‚ü®_has_‚ü©at_</a><a id="10374" class="Symbol">)</a> <a id="10376" href="SecureCompilation.Coherence.html#10009" class="Bound">ds</a>
        <a id="10387" href="SecureCompilation.Coherence.html#10387" class="Bound">Œî</a>   <a id="10391" class="Symbol">=</a> <a id="10393" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="10396" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10400" class="Symbol">(</a><a id="10401" href="Prelude.Nary.html#671" class="Function">uncurry‚ÇÉ</a> <a id="10410" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">_‚à∂_‚ôØ_</a><a id="10415" class="Symbol">)</a> <a id="10417" href="SecureCompilation.Coherence.html#10050" class="Bound">ss</a>
        <a id="10428" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a>  <a id="10432" class="Symbol">=</a> <a id="10434" href="SecureCompilation.Coherence.html#10387" class="Bound">Œî</a> <a id="10436" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="10438" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Œì‚ÇÄ</a>
        <a id="10449" href="SecureCompilation.Coherence.html#10449" class="Bound">Œì‚ÇÅ‚ÇÇ</a> <a id="10453" class="Symbol">=</a> <a id="10455" href="SecureCompilation.Coherence.html#10341" class="Bound">Œì‚ÇÅ</a> <a id="10458" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="10460" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a>
        <a id="10471" href="SecureCompilation.Coherence.html#10471" class="Bound">Œì</a>   <a id="10475" class="Symbol">=</a> <a id="10477" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü®</a> <a id="10479" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="10481" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="10483" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="10485" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü©at</a> <a id="10489" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="10491" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="10493" class="Symbol">(</a><a id="10494" href="SecureCompilation.Coherence.html#10341" class="Bound">Œì‚ÇÅ</a> <a id="10497" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="10499" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a><a id="10501" class="Symbol">)</a>
        <a id="10511" href="SecureCompilation.Coherence.html#10511" class="Bound">Œì‚Çú</a>  <a id="10515" class="Symbol">=</a> <a id="10517" href="SecureCompilation.Coherence.html#10471" class="Bound">Œì</a> <a id="10519" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="10522" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
      <a id="10530" class="Keyword">in</a>
      <a id="10539" class="Comment">-- ii) in RÀ¢, Œ± consumes ‚ü®D+C,v‚ü©y and the deposits ‚ü®A·µ¢,v·µ¢‚ü©‚Çì·µ¢ to produce ‚ü®C‚Ä≤,v‚Ä≤‚ü©y‚Ä≤</a>
      <a id="10627" class="Comment">--     where D = ‚ãØ : put‚ãØreveal‚ãØ.C‚Ä≤</a>
      <a id="10669" class="Comment">--     let t be the maximum deadline in an `after` in front of D</a>
      <a id="10740" class="Comment">--     T0D0: what should t‚Ä≤ be in case there are no `after` decorations? (currently any value)</a>
      <a id="10841" class="Symbol">(</a><a id="10842" href="SecureCompilation.Coherence.html#10842" class="Bound">t‚â°</a> <a id="10845" class="Symbol">:</a> <a id="10847" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="10849" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="10851" href="Prelude.Ord.html#840" class="Function">maximum</a> <a id="10859" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="10861" href="SecureCompilation.Coherence.html#10143" class="Bound">ts</a><a id="10863" class="Symbol">)</a>
      <a id="10871" class="Symbol">(</a><a id="10872" href="SecureCompilation.Coherence.html#10872" class="Bound">d‚â°</a> <a id="10875" class="Symbol">:</a> <a id="10877" href="BitML.Contracts.Helpers.html#1506" class="Function">d</a> <a id="10879" href="BitML.Contracts.Helpers.html#14976" class="Function Operator">‚â°‚ãØ‚à∂</a> <a id="10883" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">put</a> <a id="10887" href="SecureCompilation.Coherence.html#10283" class="Bound">xs</a> <a id="10890" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">&amp;reveal</a> <a id="10898" href="SecureCompilation.Coherence.html#10312" class="Bound">as</a> <a id="10901" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">if</a> <a id="10904" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="10906" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">‚áí</a> <a id="10908" href="BitML.Contracts.Types.html#1353" class="Generalizable">c‚Ä≤</a><a id="10910" class="Symbol">)</a>
      <a id="10918" class="Symbol">(</a><a id="10919" href="SecureCompilation.Coherence.html#10919" class="Bound">R‚âà</a> <a id="10922" class="Symbol">:</a> <a id="10924" href="SecureCompilation.Coherence.html#9950" class="Bound">RÀ¢</a> <a id="10927" href="SymbolicModel.Run.Base.html#2053" class="Function Operator">‚âà‚ãØ</a> <a id="10930" href="SecureCompilation.Coherence.html#10511" class="Bound">Œì‚Çú</a><a id="10932" class="Symbol">)</a>
    <a id="10938" class="Symbol">‚Üí</a> <a id="10940" class="Keyword">let</a>
        <a id="10952" href="SecureCompilation.Coherence.html#10952" class="Bound">Œ±</a>   <a id="10956" class="Symbol">=</a> <a id="10958" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">put‚¶Ö</a> <a id="10963" href="SecureCompilation.Coherence.html#10283" class="Bound">xs</a> <a id="10966" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">,</a> <a id="10968" href="SecureCompilation.Coherence.html#10312" class="Bound">as</a> <a id="10971" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">,</a> <a id="10973" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="10975" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">‚¶Ü</a>
        <a id="10985" href="SecureCompilation.Coherence.html#10985" class="Bound">Œì‚Ä≤</a>  <a id="10989" class="Symbol">=</a> <a id="10991" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü®</a> <a id="10993" href="BitML.Contracts.Types.html#1353" class="Generalizable">c‚Ä≤</a> <a id="10996" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="10998" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="11000" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="11002" href="Data.List.Base.html#4784" class="Function">sum</a> <a id="11006" href="SecureCompilation.Coherence.html#10278" class="Bound">vs</a> <a id="11009" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü©at</a> <a id="11013" href="BitML.BasicTypes.html#505" class="Generalizable">y‚Ä≤</a> <a id="11016" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="11018" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a>
        <a id="11029" href="SecureCompilation.Coherence.html#11029" class="Bound">t‚Ä≤</a>  <a id="11033" class="Symbol">=</a> <a id="11035" href="BitML.BasicTypes.html#547" class="Generalizable">t</a>
        <a id="11045" href="SecureCompilation.Coherence.html#11045" class="Bound">Œì‚Çú‚Ä≤</a> <a id="11049" class="Symbol">=</a> <a id="11051" href="SecureCompilation.Coherence.html#10985" class="Bound">Œì‚Ä≤</a> <a id="11054" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="11057" href="SecureCompilation.Coherence.html#11029" class="Bound">t‚Ä≤</a>
      <a id="11066" class="Keyword">in</a>
      <a id="11075" class="Symbol">(</a><a id="11076" href="SecureCompilation.Coherence.html#11076" class="Bound">‚àÉŒì‚âà</a> <a id="11080" class="Symbol">:</a> <a id="11082" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="11084" class="Symbol">(</a><a id="11085" href="SymbolicModel.Helpers.html#1359" class="Function Operator">_‚âà·∂ú</a> <a id="11089" href="SecureCompilation.Coherence.html#10985" class="Bound">Œì‚Ä≤</a><a id="11091" class="Symbol">))</a> <a id="11094" class="Symbol">‚Üí</a> <a id="11096" class="Keyword">let</a> <a id="11100" href="SecureCompilation.Coherence.html#11100" class="Bound">Œì‚Çú‚Ä≥</a> <a id="11104" class="Symbol">=</a> <a id="11106" href="SecureCompilation.Coherence.html#11076" class="Bound">‚àÉŒì‚âà</a> <a id="11110" class="Symbol">.</a><a id="11111" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="11117" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="11120" href="SecureCompilation.Coherence.html#11029" class="Bound">t‚Ä≤</a> <a id="11123" class="Keyword">in</a>
      <a id="11132" class="Comment">-- Hypotheses from [C-PutRev]</a>
      <a id="11168" class="Symbol">(</a><a id="11169" href="SecureCompilation.Coherence.html#11169" class="Bound">fresh-y‚Ä≤</a> <a id="11178" class="Symbol">:</a> <a id="11180" href="BitML.BasicTypes.html#505" class="Generalizable">y‚Ä≤</a> <a id="11183" href="Data.List.Membership.Setoid.html#936" class="Function Operator">‚àâ</a> <a id="11185" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="11187" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">L.‚à∑</a> <a id="11191" href="BitML.Contracts.Helpers.html#5113" class="Function">ids</a> <a id="11195" href="SecureCompilation.Coherence.html#10449" class="Bound">Œì‚ÇÅ‚ÇÇ</a><a id="11198" class="Symbol">)</a>
      <a id="11206" class="Symbol">(</a><a id="11207" href="SecureCompilation.Coherence.html#11207" class="Bound">p‚ü¶Œî‚üß‚â°</a> <a id="11213" class="Symbol">:</a> <a id="11215" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">S.‚ü¶</a> <a id="11219" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="11221" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">‚üß</a> <a id="11223" href="SecureCompilation.Coherence.html#10387" class="Bound">Œî</a> <a id="11225" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="11227" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="11232" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="11236" class="Symbol">)</a>
      <a id="11244" class="Comment">-- Hypotheses from [Timeout]</a>
      <a id="11279" class="Symbol">(</a><a id="11280" href="SecureCompilation.Coherence.html#11280" class="Bound">As‚â°‚àÖ</a> <a id="11285" class="Symbol">:</a> <a id="11287" href="Prelude.Lists.Empty.html#274" class="Function">Null</a> <a id="11292" href="SecureCompilation.Coherence.html#10138" class="Bound">As</a><a id="11294" class="Symbol">)</a>
    <a id="11300" class="Symbol">‚Üí</a> <a id="11302" class="Keyword">let</a>
        <a id="11314" href="SecureCompilation.Coherence.html#11314" class="Bound">‚àÄ‚â§t</a> <a id="11318" class="Symbol">:</a> <a id="11320" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="11324" class="Symbol">(</a><a id="11325" href="Prelude.Ord.html#214" class="Field Operator">_‚â§</a> <a id="11328" href="SecureCompilation.Coherence.html#11029" class="Bound">t‚Ä≤</a><a id="11330" class="Symbol">)</a> <a id="11332" href="SecureCompilation.Coherence.html#10143" class="Bound">ts</a>
        <a id="11343" href="SecureCompilation.Coherence.html#11314" class="Bound">‚àÄ‚â§t</a> <a id="11347" class="Symbol">=</a> <a id="11349" href="Prelude.SubstDSL.html#448" class="Function">‚ü™</a> <a id="11351" class="Symbol">(Œª</a> <a id="11354" href="SecureCompilation.Coherence.html#11354" class="Bound">‚óÜ</a> <a id="11356" class="Symbol">‚Üí</a> <a id="11358" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="11362" class="Symbol">(</a><a id="11363" href="Prelude.Ord.html#214" class="Field Operator">_‚â§</a> <a id="11366" href="SecureCompilation.Coherence.html#11354" class="Bound">‚óÜ</a><a id="11367" class="Symbol">)</a> <a id="11369" href="SecureCompilation.Coherence.html#10143" class="Bound">ts</a><a id="11371" class="Symbol">)</a> <a id="11373" href="Prelude.SubstDSL.html#448" class="Function">‚ü´</a> <a id="11375" href="SecureCompilation.Coherence.html#10842" class="Bound">t‚â°</a> <a id="11378" href="Prelude.SubstDSL.html#448" class="Function">~:</a> <a id="11381" href="Prelude.Ord.html#4762" class="Postulate">‚àÄ‚â§max</a> <a id="11387" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="11389" href="SecureCompilation.Coherence.html#10143" class="Bound">ts</a>

        <a id="11401" href="SecureCompilation.Coherence.html#11401" class="Bound">put‚Üí</a> <a id="11406" class="Symbol">:</a> <a id="11408" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü®</a> <a id="11410" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="11412" href="BitML.Contracts.Helpers.html#1519" class="Function">d‚àó</a> <a id="11415" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="11417" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="11419" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="11421" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü©at</a> <a id="11425" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="11427" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="11429" href="SecureCompilation.Coherence.html#10449" class="Bound">Œì‚ÇÅ‚ÇÇ</a> <a id="11433" href="BitML.Semantics.InferenceRules.html#1230" class="Datatype Operator">‚Äî[</a> <a id="11436" href="SecureCompilation.Coherence.html#10952" class="Bound">Œ±</a> <a id="11438" href="BitML.Semantics.InferenceRules.html#1230" class="Datatype Operator">]‚Üí</a> <a id="11441" href="SecureCompilation.Coherence.html#10985" class="Bound">Œì‚Ä≤</a>
        <a id="11452" href="SecureCompilation.Coherence.html#11401" class="Bound">put‚Üí</a> <a id="11457" class="Symbol">=</a> <a id="11459" href="Prelude.SubstDSL.html#448" class="Function">‚ü™</a> <a id="11461" class="Symbol">(Œª</a> <a id="11464" href="SecureCompilation.Coherence.html#11464" class="Bound">‚óÜ</a> <a id="11466" class="Symbol">‚Üí</a> <a id="11468" class="Symbol">(</a><a id="11469" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü®</a> <a id="11471" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="11473" href="SecureCompilation.Coherence.html#11464" class="Bound">‚óÜ</a> <a id="11475" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="11477" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="11479" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="11481" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">‚ü©at</a> <a id="11485" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="11487" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="11489" class="Symbol">(</a><a id="11490" href="SecureCompilation.Coherence.html#10341" class="Bound">Œì‚ÇÅ</a> <a id="11493" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">‚à£</a> <a id="11495" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a><a id="11497" class="Symbol">)</a> <a id="11499" href="BitML.Semantics.InferenceRules.html#1230" class="Datatype Operator">‚Äî[</a> <a id="11502" href="SecureCompilation.Coherence.html#10952" class="Bound">Œ±</a> <a id="11504" href="BitML.Semantics.InferenceRules.html#1230" class="Datatype Operator">]‚Üí</a> <a id="11507" href="SecureCompilation.Coherence.html#10985" class="Bound">Œì‚Ä≤</a><a id="11509" class="Symbol">))</a> <a id="11512" href="Prelude.SubstDSL.html#448" class="Function">‚ü´</a> <a id="11514" href="SecureCompilation.Coherence.html#10872" class="Bound">d‚â°</a> <a id="11517" href="Prelude.SubstDSL.html#448" class="Function">~:</a> <a id="11520" href="BitML.Semantics.InferenceRules.html#6437" class="InductiveConstructor">[C-PutRev]</a> <a id="11531" class="Symbol">{</a><a id="11532" class="Argument">ds</a> <a id="11535" class="Symbol">=</a> <a id="11537" href="SecureCompilation.Coherence.html#10009" class="Bound">ds</a><a id="11539" class="Symbol">}</a> <a id="11541" class="Symbol">{</a><a id="11542" class="Argument">ss</a> <a id="11545" class="Symbol">=</a> <a id="11547" href="SecureCompilation.Coherence.html#10050" class="Bound">ss</a><a id="11549" class="Symbol">}</a> <a id="11551" href="SecureCompilation.Coherence.html#11169" class="Bound">fresh-y‚Ä≤</a> <a id="11560" href="SecureCompilation.Coherence.html#11207" class="Bound">p‚ü¶Œî‚üß‚â°</a>

        <a id="11575" href="SecureCompilation.Coherence.html#11575" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="11580" class="Symbol">:</a> <a id="11582" href="SecureCompilation.Coherence.html#10511" class="Bound">Œì‚Çú</a> <a id="11585" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">‚Äî[</a> <a id="11588" href="SecureCompilation.Coherence.html#10952" class="Bound">Œ±</a> <a id="11590" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">]‚Üí‚Çú</a> <a id="11594" href="SecureCompilation.Coherence.html#11045" class="Bound">Œì‚Çú‚Ä≤</a>
        <a id="11606" href="SecureCompilation.Coherence.html#11575" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="11611" class="Symbol">=</a> <a id="11613" href="BitML.Semantics.InferenceRules.html#9436" class="InductiveConstructor">[Timeout]</a> <a id="11623" href="SecureCompilation.Coherence.html#11280" class="Bound">As‚â°‚àÖ</a> <a id="11628" href="SecureCompilation.Coherence.html#11314" class="Bound">‚àÄ‚â§t</a> <a id="11632" href="SecureCompilation.Coherence.html#11401" class="Bound">put‚Üí</a> <a id="11637" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="11651" class="Keyword">open</a> <a id="11656" href="SymbolicModel.Helpers.html#21874" class="Module">H‚ÇÜ</a> <a id="11659" class="Symbol">{</a><a id="11660" href="SecureCompilation.Coherence.html#9950" class="Bound">RÀ¢</a><a id="11662" class="Symbol">}</a> <a id="11664" href="SecureCompilation.Coherence.html#9973" class="Bound">ùï£</a> <a id="11666" href="BitML.BasicTypes.html#547" class="Generalizable">t</a> <a id="11668" href="SecureCompilation.Coherence.html#10952" class="Bound">Œ±</a> <a id="11670" href="SecureCompilation.Coherence.html#11029" class="Bound">t‚Ä≤</a> <a id="11673" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="11675" href="SecureCompilation.Coherence.html#10176" class="Bound">v</a> <a id="11677" href="SecureCompilation.Coherence.html#10178" class="Bound">y</a> <a id="11679" href="SecureCompilation.Coherence.html#10009" class="Bound">ds</a> <a id="11682" href="SecureCompilation.Coherence.html#10428" class="Bound">Œì‚ÇÇ</a> <a id="11685" href="BitML.Contracts.Types.html#1353" class="Generalizable">c‚Ä≤</a> <a id="11688" href="BitML.BasicTypes.html#505" class="Generalizable">y‚Ä≤</a> <a id="11691" href="SecureCompilation.Coherence.html#10919" class="Bound">R‚âà</a> <a id="11694" href="SecureCompilation.Coherence.html#11575" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="11699" href="SecureCompilation.Coherence.html#11076" class="Bound">‚àÉŒì‚âà</a> <a id="11703" class="Keyword">using</a> <a id="11709" class="Symbol">(</a><a id="11710" class="Keyword">module</a> <a id="11717" href="SymbolicModel.Helpers.html#22067" class="Module">H‚ÇÜ‚Ä≤</a><a id="11720" class="Symbol">;</a> <a id="11722" href="SymbolicModel.Helpers.html#21977" class="Function">Lift·∂ú</a><a id="11727" class="Symbol">)</a>

        <a id="11738" class="Comment">-- (iii) {G}C‚Ä≥ is the ancestor of ‚ü®D+C, v‚ü©y in RÀ¢</a>
        <a id="11796" href="SecureCompilation.Coherence.html#11796" class="Bound">‚ü®G‚ü©C‚Ä≥</a> <a id="11802" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11804" class="Symbol">_</a> <a id="11806" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11808" class="Symbol">_</a> <a id="11810" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11812" href="SecureCompilation.Coherence.html#11812" class="Bound">c‚äÜ</a> <a id="11815" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11817" href="SecureCompilation.Coherence.html#11817" class="Bound">anc</a> <a id="11821" class="Symbol">=</a> <a id="11823" href="SymbolicModel.Helpers.html#3193" class="Function">ANCESTOR</a> <a id="11832" class="Symbol">{</a><a id="11833" class="Argument">R</a> <a id="11835" class="Symbol">=</a> <a id="11837" href="SecureCompilation.Coherence.html#9950" class="Bound">RÀ¢</a><a id="11839" class="Symbol">}</a> <a id="11841" class="Symbol">{</a><a id="11842" class="Argument">Œì</a> <a id="11844" class="Symbol">=</a> <a id="11846" href="SecureCompilation.Coherence.html#10471" class="Bound">Œì</a><a id="11847" class="Symbol">}</a> <a id="11849" href="SecureCompilation.Coherence.html#10919" class="Bound">R‚âà</a> <a id="11852" class="Symbol">(</a><a id="11853" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="11858" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="11862" class="Symbol">)</a>
        <a id="11872" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü®</a> <a id="11874" href="SecureCompilation.Coherence.html#11874" class="Bound">G</a> <a id="11876" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">‚ü©</a> <a id="11878" href="SecureCompilation.Coherence.html#11878" class="Bound">C‚Ä≥</a> <a id="11881" class="Symbol">=</a> <a id="11883" href="SecureCompilation.Coherence.html#11796" class="Bound">‚ü®G‚ü©C‚Ä≥</a>

        <a id="11898" href="SecureCompilation.Coherence.html#11898" class="Bound">d‚àà</a> <a id="11901" class="Symbol">:</a> <a id="11903" href="BitML.Contracts.Helpers.html#1506" class="Function">d</a> <a id="11905" href="Data.List.Membership.Setoid.html#887" class="Function Operator">‚àà</a> <a id="11907" href="BitML.Contracts.Helpers.html#17424" class="Function">subterms·µÉ‚Ä≤</a> <a id="11918" href="SecureCompilation.Coherence.html#11796" class="Bound">‚ü®G‚ü©C‚Ä≥</a>
        <a id="11932" href="SecureCompilation.Coherence.html#11898" class="Bound">d‚àà</a> <a id="11935" class="Symbol">=</a> <a id="11937" href="SecureCompilation.Coherence.html#11812" class="Bound">c‚äÜ</a> <a id="11940" class="Symbol">(</a><a id="11941" href="Data.List.Membership.Propositional.Properties.html#11093" class="Function">L.Mem.‚àà-lookup</a> <a id="11956" href="SecureCompilation.Coherence.html#10101" class="Bound">i</a><a id="11957" class="Symbol">)</a>

        <a id="11968" class="Comment">-- (iv) submit transaction T</a>
        <a id="12005" class="Comment">--      where ‚àô (T‚Ä≤,o) = txout‚Ä≤(y)</a>
        <a id="12048" class="Comment">--            ‚àô T is the first transaction in Bc(c‚Ä≤,d,T‚Ä≤,o,v‚Ä≤,x‚Éó,partG,t)</a>
        <a id="12130" class="Comment">--      i.e. the one corresponding to subterm `d‚àó = put xs &amp;reveal as if p ‚Üí c‚Ä≤`</a>
        <a id="12219" href="SecureCompilation.Coherence.html#12219" class="Bound">T</a> <a id="12221" class="Symbol">:</a> <a id="12223" href="Bitcoin.Tx.Base.html#1255" class="Function">‚àÉTx</a>
        <a id="12235" href="SecureCompilation.Coherence.html#12219" class="Bound">T</a> <a id="12237" class="Symbol">=</a> <a id="12239" class="Keyword">let</a> <a id="12243" class="Symbol">_</a> <a id="12245" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12247" href="SecureCompilation.Coherence.html#12247" class="Bound">‚àÄd‚àó</a> <a id="12251" class="Symbol">=</a> <a id="12253" href="SecureCompilation.Coherence.html#1607" class="Function">COMPILE</a> <a id="12261" class="Symbol">(</a><a id="12262" href="SymbolicModel.Helpers.html#21977" class="Function">Lift·∂ú</a> <a id="12268" href="SecureCompilation.Coherence.html#11817" class="Bound">anc</a><a id="12271" class="Symbol">)</a>
                <a id="12289" class="Symbol">_</a> <a id="12291" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12293" href="SecureCompilation.Coherence.html#12293" class="Bound">T·µà</a> <a id="12296" class="Symbol">=</a> <a id="12298" href="SecureCompilation.Coherence.html#12247" class="Bound">‚àÄd‚àó</a> <a id="12302" href="SecureCompilation.Coherence.html#11898" class="Bound">d‚àà</a> <a id="12305" href="Prelude.SubstDSL.html#124" class="Function">:~</a> <a id="12308" href="SecureCompilation.Coherence.html#10872" class="Bound">d‚â°</a> <a id="12311" href="Prelude.SubstDSL.html#124" class="Function">‚ü™</a> <a id="12313" href="SecureCompilation.Compiler.html#2044" class="Function">‚àÉTx·∂ú</a> <a id="12318" href="Prelude.SubstDSL.html#124" class="Function">‚ü´</a>
            <a id="12332" class="Keyword">in</a> <a id="12335" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="12338" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="12341" href="SecureCompilation.Coherence.html#12293" class="Bound">T·µà</a>

        <a id="12353" href="SecureCompilation.Coherence.html#12353" class="Bound">Œª·∂ú</a> <a id="12356" class="Symbol">=</a> <a id="12358" href="ComputationalModel.Strategy.html#947" class="InductiveConstructor">submit</a> <a id="12365" href="SecureCompilation.Coherence.html#12219" class="Bound">T</a>

        <a id="12376" class="Comment">-- (v) extend txout‚Ä≤ with {y‚Ä≤‚Ü¶(T,0)}, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤</a>
        <a id="12449" class="Keyword">open</a> <a id="12454" href="SymbolicModel.Helpers.html#22067" class="Module">H‚ÇÜ‚Ä≤</a> <a id="12458" class="Symbol">(</a><a id="12459" href="SecureCompilation.Coherence.html#12219" class="Bound">T</a> <a id="12461" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="12464" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="12466" class="Symbol">)</a> <a id="12468" class="Keyword">using</a> <a id="12474" class="Symbol">(</a><a id="12475" href="SymbolicModel.Helpers.html#24322" class="Function">ŒªÀ¢</a><a id="12477" class="Symbol">)</a>
      <a id="12485" class="Keyword">in</a>
      <a id="12494" class="Comment">--‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî</a>
      <a id="12573" class="Symbol">(</a><a id="12574" href="SecureCompilation.Coherence.html#11100" class="Bound">Œì‚Çú‚Ä≥</a> <a id="12578" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="12580" href="SecureCompilation.Coherence.html#9955" class="Bound">ùï£‚àó</a> <a id="12583" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="12585" href="SymbolicModel.Helpers.html#24322" class="Function">ŒªÀ¢</a> <a id="12588" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="12589" class="Symbol">)</a> <a id="12591" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">~‚ÇÅ‚ÇÅ</a> <a id="12595" class="Symbol">(</a><a id="12596" href="SecureCompilation.Coherence.html#12353" class="Bound">Œª·∂ú</a> <a id="12599" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="12601" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="12603" class="Symbol">)</a>
<a id="12605" class="Comment">{-
  -- ** Contract actions: authorize reveal
  [7] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
        ‚àÄ {a} ‚Üí -- [T0D0] fixed in Agda-HEAD, see issue #5683
        let Œì = ‚ü® A ‚à∂ a ‚ôØ just n ‚ü© ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in
        ‚àÄ {Œî√óhÃÖ : List (Secret √ó Maybe ‚Ñï √ó ‚Ñ§)} {k‚Éó : ùïÇ¬≤‚Ä≤ ‚ü®G‚ü©C} ‚Üí let ‚ü® G ‚ü© C = ‚ü®G‚ü©C in

      ‚à£ m ‚à£·µê ‚â§ Œ∑
    ‚Üí (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)

    ‚Üí let
        Œ±   = auth-rev‚¶Ö A , a ‚¶Ü
        Œì‚Ä≤  = A ‚à∂ a ‚ôØ n ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] [C-AuthRev] refl

        C : Message
        C = encode {RÀ¢ = RÀ¢} txout‚Ä≤ ‚ü®G‚ü©C

        Œî : List (Secret √ó Maybe ‚Ñï)
        Œî = map (Œª{ (s , mn , _) ‚Üí s , mn }) Œî√óhÃÖ

        hÃÖ : Message
        hÃÖ = map (proj‚ÇÇ ‚àò proj‚ÇÇ) Œî√óhÃÖ

        kÃÖ : Message
        kÃÖ = concatMap (map pub ‚àò codom) (codom k‚Éó)

        a‚àà : a ‚àà namesÀ° RÀ¢
        a‚àà = namesÀ°‚¶Öend‚¶Ü‚äÜ RÀ¢
            $ ‚àànamesÀ°-resp-‚âà a {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà) (here refl)

        -- T0D0: should we search for a signature of this message instead?
        C,hÃÖ,kÃÖ : Message
        C,hÃÖ,kÃÖ = C ‚óá hÃÖ ‚óá kÃÖ

        -- (i) some participant B broadcasts message m
        Œª·∂ú = B ‚Üí‚àó‚à∂ m

        -- (iii) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚Çá ùï£ t Œ± t‚Ä≤ A a n Œì‚ÇÄ R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      -- (ii) in R·∂ú we find ‚ãØ (B ‚Üí O ‚à∂ m) (O ‚Üí B : sechash‚Ä≤(a)) for some B ‚ãØ
      (‚àÉ Œª B ‚Üí (B , m , [ sechash‚Ä≤ {a} a‚àà ]) ‚àà oracleInteractions R·∂ú)

      -- (iv) in RÀ¢, we find an A:{G}C,‚àÜ action, with a in G
    ‚Üí (‚àÉŒ± : auth-commit‚¶Ö A , ‚ü®G‚ü©C , Œî ‚¶Ü ‚àà labels RÀ¢)
    ‚Üí a ‚àà namesÀ° G

      -- ... with a corresponding broadcast of m‚Ä≤=(C,hÃÖ,kÃÖ) in R·∂ú
    ‚Üí (‚àÉŒª : Any (Œª l ‚Üí ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ C,hÃÖ,kÃÖ) R·∂ú)

      -- (v) Œª·∂ú is the first broadcast of m after the first broadcast of m‚Ä≤
    ‚Üí All (Œª l ‚Üí ‚àÄ X ‚Üí l ‚â¢ X ‚Üí‚àó‚à∂ m) (Any-tail ‚àÉŒª)
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Contract actions: split
  [8] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
        ‚àÄ {i : Index c} ‚Üí let open ‚à£SELECT c i; As , ts = decorations d in
        ‚àÄ {vcis : List (S.Value √ó Contracts √ó Id)} ‚Üí let vs , cs , xs = unzip‚ÇÉ vcis; v = sum vs in
        ‚àÄ {y Œì‚ÇÄ} ‚Üí -- [T0D0] fixed in Agda-HEAD, see issue #5683
        let Œì = ‚ü® c , v ‚ü©at y ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      -- (i) in RÀ¢, Œ± consumes ‚ü®D+C,v‚ü©y to obtain ‚ü®C‚ÇÄ,v‚ÇÄ‚ü©‚Çì‚ÇÄ | ‚ãØ | ‚ü®C‚Çñ,v‚Çñ‚ü©‚Çì‚Çñ
      --     where D = ‚ãØ : split vs ‚Üí cs
      --     let t be the maximum deadline in an `after` in front of D
      --     T0D0: what should t‚Ä≤ be in case there are not after decorations? (currently any value)
      (t‚â° : t ‚â° maximum t ts)
      (d‚â° : d ‚â°‚ãØ‚à∂ split (zip vs cs))
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
      -- Hypotheses from [C-Split]
      (fresh-xs : All (_‚àâ y L.‚à∑ ids Œì‚ÇÄ) xs)
      -- Hypotheses from [Timeout]
      (As‚â°‚àÖ : Null As)
    ‚Üí let
        Œ±   = split‚¶Ö y ‚¶Ü
        Œì‚Ä≤  = || map (uncurry‚ÇÉ $ flip ‚ü®_,_‚ü©at_) vcis ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        ‚àÄ‚â§t : All (_‚â§ t‚Ä≤) ts
        ‚àÄ‚â§t = ‚ü™ (Œª ‚óÜ ‚Üí All (_‚â§ ‚óÜ) ts) ‚ü´ t‚â° ~: ‚àÄ‚â§max t ts

        split‚Üí : ‚ü® [ d‚àó ] , v ‚ü©at y ‚à£ Œì‚ÇÄ ‚Äî[ Œ± ]‚Üí Œì‚Ä≤
        split‚Üí = ‚ü™ (Œª ‚óÜ ‚Üí ‚ü® [ ‚óÜ ] , v ‚ü©at y ‚à£ Œì‚ÇÄ ‚Äî[ Œ± ]‚Üí Œì‚Ä≤) ‚ü´ d‚â°
              ~: [C-Split] {vcis = vcis} fresh-xs

        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Timeout] As‚â°‚àÖ ‚àÄ‚â§t split‚Üí refl

        open H‚Çà {RÀ¢} ùï£ t Œ± t‚Ä≤ c v y Œì‚ÇÄ vcis R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (module H‚Çà‚Ä≤; Lift·∂ú)

        -- (iii) {G}C‚Ä≤ is the ancestor of ‚ü®D+C,v‚ü©y in RÀ¢
        ‚ü®G‚ü©C‚Ä≤ , _ , _ , c‚äÜ , anc = ANCESTOR {R = RÀ¢} {Œì = Œì} R‚âà (here refl)
        ‚ü® G ‚ü© C‚Ä≤ = ‚ü®G‚ü©C‚Ä≤

        d‚àà : d ‚àà subterms·µÉ‚Ä≤ ‚ü®G‚ü©C‚Ä≤
        d‚àà = c‚äÜ (L.Mem.‚àà-lookup i)

        -- (iii) submit transaction T
        --       where ‚àô (T‚Ä≤,o) = txout‚Ä≤(y)
        --             ‚àô T is the first transaction in Bpar(cs,d,T‚Ä≤,o,partG,t)
        --       i.e. the one corresponding to subterm `d‚àó = split (zip vs cs)`
        T =
          let
            _ , ‚àÄd‚àó = COMPILE (Lift·∂ú anc)
            i , T·µà = ‚àÄd‚àó d‚àà :~ d‚â° ‚ü™ ‚àÉTx·∂ú ‚ü´

            open ‚â°-Reasoning renaming (_‚àé to _‚àé‚àé)
            vs‚â° , cs‚â° , xs‚â° = length-unzip‚ÇÉ vcis

            l‚â° : length xs ‚â° length (zip vs cs)
            l‚â° = sym
               $ begin length (zip vs cs)    ‚â°‚ü® L.length-zipWith _,_ vs cs ‚ü©
                       length vs ‚äì length cs ‚â°‚ü® Nat.m‚â•n‚áím‚äìn‚â°n $ Nat.‚â§-reflexive $ trans cs‚â° (sym vs‚â°) ‚ü©
                       length cs             ‚â°‚ü® cs‚â° ‚ü©
                       length vcis           ‚â°‚ü® sym xs‚â° ‚ü©
                       length xs             ‚àé‚àé

            T·µà‚Ä≤ : Tx i (length xs)
            T·µà‚Ä≤ = ‚ü™ Tx i ‚ü´ l‚â° ~: T·µà
          in -, -, T·µà‚Ä≤

        Œª·∂ú = submit T

        -- (iv) extend txout‚Ä≤ with {x·µ¢ ‚Ü¶ (T,i)}, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        txout‚Å∫ : xs ‚Ü¶ TxInput‚Ä≤
        txout‚Å∫ x‚àà = T at (L.Any.index x‚àà)

        open H‚Çà‚Ä≤ txout‚Å∫ using (ŒªÀ¢)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Contract actions: withdraw
  [9] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
        ‚àÄ {i : Index c} ‚Üí let open ‚à£SELECT c i; As , ts = decorations d in
        let Œì = ‚ü® c , v ‚ü©at y ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      -- (i) in RÀ¢, Œ± consumes ‚ü®D+C,v‚ü©y to obtain ‚ü®A,v‚ü©‚Çì (where D = ‚ãØ : withdraw A)
      (d‚â° : d ‚â°‚ãØ‚à∂ withdraw A)
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = withdraw‚¶Ö A , v , y ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has v ‚ü©at x ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [C-Withdraw]
      (fresh-x : x ‚àâ y L.‚à∑ ids Œì‚ÇÄ)
      -- Hypotheses from [Timeout]
      (As‚â°‚àÖ : Null As)
      (‚àÄ‚â§t : All (_‚â§ t) ts)
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Timeout] As‚â°‚àÖ ‚àÄ‚â§t (‚ü™ (Œª ‚óÜ ‚Üí ‚ü® [ ‚óÜ ] , v ‚ü©at y ‚à£ Œì‚ÇÄ ‚Äî[ Œ± ]‚Üí Œì‚Ä≤) ‚ü´ d‚â° ~: [C-Withdraw] fresh-x) refl

        open H‚Çâ {RÀ¢} ùï£ t Œ± t‚Ä≤ c v y Œì‚ÇÄ A x R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (module H‚Çâ‚Ä≤; Lift·∂ú)

        -- (ii) {G}C‚Ä≤ is the ancestor of ‚ü®D+C,v‚ü©y in RÀ¢
        ‚ü®G‚ü©C‚Ä≤ , _ , _ , c‚äÜ , anc = ANCESTOR {R = RÀ¢} {Œì = Œì} R‚âà (here refl)
        ‚ü® G ‚ü© C‚Ä≤ = ‚ü®G‚ü©C‚Ä≤

        d‚àà : d ‚àà subterms·µÉ‚Ä≤ ‚ü®G‚ü©C‚Ä≤
        d‚àà = c‚äÜ (L.Mem.‚àà-lookup i)

        --   ‚àô T‚Ä≤ at o = txout‚Ä≤(x)
        --   ‚àô T is the first transaction of Bd(d,d,T‚Ä≤,o,v,partG,0)
        -- i.e.
        -- (iii) submit transaction T
        --       where ‚àô (T‚Ä≤,o) = txout‚Ä≤(y)
        --             ‚àô T is the first transaction in Bd(d,d,T‚Ä≤,o,v,partG,0)
        --       i.e. the one corresponding to subterm `d‚àó = withdraw A`
        T = let _ , ‚àÄd‚àó = COMPILE (Lift·∂ú anc)
                _ , T·µà = ‚àÄd‚àó d‚àà :~ d‚â° ‚ü™ ‚àÉTx·∂ú ‚ü´
            in -, -, T·µà

        Œª·∂ú = submit T

        -- (iv) extend txout‚Ä≤ with {x ‚Ü¶ (T,0)}, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚Çâ‚Ä≤ (T at 0F) using (ŒªÀ¢)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: authorize join
  [10] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has v ‚ü©at x ‚à£ ‚ü® A has v‚Ä≤ ‚ü©at x‚Ä≤ ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-join‚¶Ö A , x ‚Üî x‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has v ‚ü©at x ‚à£ ‚ü® A has v‚Ä≤ ‚ü©at x‚Ä≤ ‚à£ A auth[ x ‚Üî x‚Ä≤ ‚ñ∑‚ü® A , v + v‚Ä≤ ‚ü© ] ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] [DEP-AuthJoin] refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)
        x‚àà‚Ä≤ = n‚äÜ (there $‚Ä≤ here refl)
      in
      (‚àÉŒª : Any (Œª l ‚Üí ‚àÉ Œª B ‚Üí ‚àÉ Œª T
                ‚Üí (l ‚â° B ‚Üí‚àó‚à∂ [ T ‚ôØ ])
                √ó (inputs  T ‚â° hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ‚à∑ hashTx‚Å± (txout‚Ä≤ {x‚Ä≤} x‚àà‚Ä≤) ‚à∑ [])
                √ó (outputs T ‚â° V.[ Ctx 1 , record {value = v + v‚Ä≤; validator = ∆õ (versig [ KÃÇ A ] [ # 0 ])} ])
                ) R·∂ú)
    ‚Üí let
        T : ‚àÉTx
        T = 2 , 1 , (L.Any.satisfied ‚àÉŒª .proj‚ÇÇ .proj‚ÇÇ .proj‚ÇÅ)

        -- (iii) broadcast transaction T, signed by A
        m‚Ä≤ = [ SIG (KÃÇ A) T ]
        Œª·∂ú = B ‚Üí‚àó‚à∂ m‚Ä≤

        -- (v) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÄ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v x v‚Ä≤ x‚Ä≤ Œì‚ÇÄ R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      -- (iv) Œª·∂ú is the first broadcast of m‚Ä≤ in R·∂ú after the first broadcast of T
      All (Œª l ‚Üí ¬¨ ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ m‚Ä≤) (Any-tail ‚àÉŒª)
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: join
  [11] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has v ‚ü©at x ‚à£ ‚ü® A has v‚Ä≤ ‚ü©at x‚Ä≤ ‚à£ A auth[ x ‚Üî x‚Ä≤ ‚ñ∑‚ü® A , v + v‚Ä≤ ‚ü© ] ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = join‚¶Ö x ‚Üî x‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has (v + v‚Ä≤) ‚ü©at y ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [DEP-Join]
      (fresh-y : y ‚àâ x L.‚à∑ x‚Ä≤ ‚à∑ ids Œì‚ÇÄ)
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([DEP-Join] fresh-y) refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)
        x‚àà‚Ä≤ = n‚äÜ (there $‚Ä≤ here refl)

        -- (ii) submit transaction T
        T : ‚àÉTx
        T  = 2 , 1 , sig‚ãÜ (V.replicate [ KÃÇ A ]) record
          { inputs  = hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ‚à∑ hashTx‚Å± (txout‚Ä≤ {x‚Ä≤} x‚àà‚Ä≤) ‚à∑ []
          ; wit     = wit‚ä•
          ; relLock = V.replicate 0
          ; outputs = V.[ (v + v‚Ä≤) -redeemableWith- KÃÇ A ]
          ; absLock = 0 }
        Œª·∂ú = submit T

        -- (iii) extend txout‚Ä≤ with y‚Ü¶T‚ÇÄ (removing {x‚Ü¶_;x‚Ä≤‚Ü¶_}), sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÅ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v x v‚Ä≤ x‚Ä≤ y Œì‚ÇÄ R‚âà (T at 0F) Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: authorize divide (similar to [10])
  [12] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has (v + v‚Ä≤) ‚ü©at x ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-divide‚¶Ö A , x ‚ñ∑ v , v‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has (v + v‚Ä≤) ‚ü©at x ‚à£ A auth[ x ‚ñ∑‚ü® A , v , v‚Ä≤ ‚ü© ] ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] [DEP-AuthDivide] refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)
      in
      (‚àÉŒª : Any (Œª l ‚Üí ‚àÉ Œª B ‚Üí ‚àÉ Œª T
                ‚Üí (l ‚â° B ‚Üí‚àó‚à∂ [ T ‚ôØ ])
                √ó (inputs  T ‚â° V.[ hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ])
                √ó (outputs T ‚â° (v -redeemableWith- KÃÇ A) ‚à∑ (v‚Ä≤ -redeemableWith- KÃÇ A) ‚à∑ [])
                ) R·∂ú)
    ‚Üí let
        T : ‚àÉTx
        T = 1 , 2 , (proj‚ÇÅ $ proj‚ÇÇ $ proj‚ÇÇ $ L.Any.satisfied ‚àÉŒª)

        -- (iii) broadcast transaction T, signed by A
        m‚Ä≤ = [ SIG (KÃÇ A) T ]
        Œª·∂ú = B ‚Üí‚àó‚à∂ m‚Ä≤

        -- (v) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÇ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v v‚Ä≤ x Œì‚ÇÄ R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      -- (iv) Œª·∂ú is the first broadcast of m‚Ä≤ in R·∂ú after the first broadcast of T
      All (Œª l ‚Üí ¬¨ ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ m‚Ä≤) (Any-tail ‚àÉŒª)
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: divide (dimilar to [11])
  [13] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has (v + v‚Ä≤) ‚ü©at x ‚à£ A auth[ x ‚ñ∑‚ü® A , v , v‚Ä≤ ‚ü© ] ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = divide‚¶Ö x ‚ñ∑ v , v‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has v ‚ü©at y ‚à£ ‚ü® A has v‚Ä≤ ‚ü©at y‚Ä≤ ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [DEP-Divide]
      (fresh-ys : All (_‚àâ x L.‚à∑ ids Œì‚ÇÄ ) (y ‚à∑ y‚Ä≤ ‚à∑ []))
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([DEP-Divide] fresh-ys) refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)

        -- (iii) submit transaction T
        T  = 1 , 2 , sig‚ãÜ (V.replicate [ KÃÇ A ]) record
          { inputs  = V.[ hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ]
          ; wit     = wit‚ä•
          ; relLock = V.replicate 0
          ; outputs = (v -redeemableWith- KÃÇ A) ‚à∑ (v‚Ä≤ -redeemableWith- KÃÇ A) ‚à∑ []
          ; absLock = 0 }
        Œª·∂ú = submit T

        -- (v) extend txout‚Ä≤ with {y‚Ü¶T‚ÇÄ, y‚Ä≤‚Ü¶T‚ÇÅ} (removing x‚Ü¶T‚ÇÄ), sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÉ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v v‚Ä≤ x Œì‚ÇÄ y y‚Ä≤ R‚âà (T at 0F) (T at 1F) Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: authorize donate (similar to [10])
  [14] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has v ‚ü©at x ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-donate‚¶Ö A , x ‚ñ∑·µà B‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® A has v ‚ü©at x ‚à£ A auth[ x ‚ñ∑·µà B‚Ä≤ ] ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] [DEP-AuthDonate] refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)
      in
      (‚àÉŒª : Any (Œª l ‚Üí ‚àÉ Œª B ‚Üí ‚àÉ Œª T
                ‚Üí (l ‚â° B ‚Üí‚àó‚à∂ [ T ‚ôØ ])
                √ó (inputs  T ‚â° V.[ hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ])
                √ó (outputs T ‚â° V.[ v -redeemableWith- KÃÇ B‚Ä≤ ])
                ) R·∂ú)
    ‚Üí let
        T : ‚àÉTx
        T = 1 , 1 , (proj‚ÇÅ $ proj‚ÇÇ $ proj‚ÇÇ $ L.Any.satisfied ‚àÉŒª)

        -- (iii) broadcast transaction T, signed by A
        m‚Ä≤ = [ SIG (KÃÇ A) T ]
        Œª·∂ú = B ‚Üí‚àó‚à∂ m‚Ä≤

        -- (v) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÑ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v x Œì‚ÇÄ B‚Ä≤ R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      -- (iv) Œª·∂ú is the first broadcast of m‚Ä≤ in R·∂ú after the first broadcast of T
      All (Œª l ‚Üí ¬¨ ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ m‚Ä≤) (Any-tail ‚àÉŒª)
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: donate (similar to [11])
  [15] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         let Œì = ‚ü® A has v ‚ü©at x ‚à£ A auth[ x ‚ñ∑·µà B‚Ä≤ ] ‚à£ Œì‚ÇÄ; Œì‚Çú = Œì at t in

      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = donate‚¶Ö x ‚ñ∑·µà B‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = ‚ü® B‚Ä≤ has v ‚ü©at y ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [DEP-Donate]
      (fresh-y : y ‚àâ x L.‚à∑ ids Œì‚ÇÄ)
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([DEP-Donate] fresh-y) refl

        n‚äÜ : Œì ‚äÜ‚¶Ö names ≥ ‚¶Ü RÀ¢
        n‚äÜ  = names ≥‚¶Öend‚¶Ü‚äÜ RÀ¢ ‚àò ‚àànames ≥-resp-‚âà _ {Œì}{cfg (RÀ¢ .end)} (‚Ü≠-sym $ proj‚ÇÇ R‚âà)
        x‚àà  = n‚äÜ (here refl)

        -- (iii) submit transaction T
        T  = 1 , 1 , sig‚ãÜ (V.replicate [ KÃÇ A ]) record
          { inputs  = V.[ hashTx‚Å± (txout‚Ä≤ {x} x‚àà) ]
          ; wit     = wit‚ä•
          ; relLock = V.replicate 0
          ; outputs = V.[ v -redeemableWith- KÃÇ B‚Ä≤ ]
          ; absLock = 0 }
        Œª·∂ú = submit T

        -- (v) extend txout‚Ä≤ with y‚Ü¶T‚ÇÄ (removing x‚Ü¶T‚ÇÄ), sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÖ {RÀ¢} ùï£ t Œ± t‚Ä≤ A v x B‚Ä≤ Œì‚ÇÄ y R‚âà (T at 0F) Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢)
      in
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
      (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú)
-}</a>
  <a id="28244" class="Comment">-- ** After</a>
  <a id="_~‚ÇÅ‚ÇÅ_.[18]"></a><a id="28258" href="SecureCompilation.Coherence.html#28258" class="InductiveConstructor">[18]</a> <a id="28263" class="Symbol">:</a> <a id="28265" class="Symbol">‚àÄ</a> <a id="28267" class="Symbol">{</a><a id="28268" href="SecureCompilation.Coherence.html#28268" class="Bound">RÀ¢</a><a id="28270" class="Symbol">}</a> <a id="28272" class="Symbol">{</a><a id="28273" href="SecureCompilation.Coherence.html#28273" class="Bound">ùï£‚àó</a> <a id="28276" class="Symbol">:</a> <a id="28278" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="28281" href="SecureCompilation.Coherence.html#28268" class="Bound">RÀ¢</a><a id="28283" class="Symbol">}</a> <a id="28285" class="Symbol">‚Üí</a> <a id="28287" class="Keyword">let</a> <a id="28291" href="SecureCompilation.Coherence.html#28291" class="Bound">ùï£</a> <a id="28293" class="Symbol">=</a> <a id="28295" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="28300" href="SecureCompilation.Coherence.html#28273" class="Bound">ùï£‚àó</a><a id="28302" class="Symbol">;</a> <a id="28304" class="Keyword">open</a> <a id="28309" href="SymbolicModel.Mappings.Base.html#1169" class="Module">‚Ñù</a> <a id="28311" href="SecureCompilation.Coherence.html#28291" class="Bound">ùï£</a> <a id="28313" class="Keyword">in</a>

      <a id="28323" class="Symbol">(</a><a id="28324" href="SecureCompilation.Coherence.html#28324" class="Bound">Œ¥&gt;0</a> <a id="28328" class="Symbol">:</a> <a id="28330" href="BitML.BasicTypes.html#549" class="Generalizable">Œ¥</a> <a id="28332" href="Prelude.Ord.html#286" class="Function Operator">&gt;</a> <a id="28334" class="Number">0</a><a id="28335" class="Symbol">)</a>
    <a id="28341" class="Symbol">‚Üí</a> <a id="28343" class="Keyword">let</a>
        <a id="28355" href="SecureCompilation.Coherence.html#28355" class="Bound">Œì‚Çú</a><a id="28357" class="Symbol">@(</a><a id="28359" href="SecureCompilation.Coherence.html#28359" class="Bound">Œì</a> <a id="28361" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="28364" href="SecureCompilation.Coherence.html#28364" class="Bound">t</a><a id="28365" class="Symbol">)</a> <a id="28367" class="Symbol">=</a> <a id="28369" href="SecureCompilation.Coherence.html#28268" class="Bound">RÀ¢</a> <a id="28372" class="Symbol">.</a><a id="28373" href="Prelude.Traces.html#527" class="Field">end</a>
        <a id="28385" href="SecureCompilation.Coherence.html#28385" class="Bound">Œ±</a>   <a id="28389" class="Symbol">=</a> <a id="28391" href="BitML.Semantics.Label.html#1632" class="InductiveConstructor Operator">delay‚¶Ö</a> <a id="28398" href="BitML.BasicTypes.html#549" class="Generalizable">Œ¥</a> <a id="28400" href="BitML.Semantics.Label.html#1632" class="InductiveConstructor Operator">‚¶Ü</a>
        <a id="28410" href="SecureCompilation.Coherence.html#28410" class="Bound">t‚Ä≤</a>  <a id="28414" class="Symbol">=</a> <a id="28416" href="SecureCompilation.Coherence.html#28364" class="Bound">t</a> <a id="28418" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="28420" href="BitML.BasicTypes.html#549" class="Generalizable">Œ¥</a>
        <a id="28430" href="SecureCompilation.Coherence.html#28430" class="Bound">Œì‚Çú‚Ä≤</a> <a id="28434" class="Symbol">=</a> <a id="28436" href="SecureCompilation.Coherence.html#28359" class="Bound">Œì</a> <a id="28438" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="28441" href="SecureCompilation.Coherence.html#28410" class="Bound">t‚Ä≤</a>
        <a id="28452" href="SecureCompilation.Coherence.html#28452" class="Bound">Œª·∂ú</a>  <a id="28456" class="Symbol">=</a> <a id="28458" href="ComputationalModel.Strategy.html#992" class="InductiveConstructor">delay</a> <a id="28464" href="BitML.BasicTypes.html#549" class="Generalizable">Œ¥</a>
      <a id="28472" class="Keyword">in</a>
      <a id="28481" class="Symbol">(</a><a id="28482" href="SecureCompilation.Coherence.html#28482" class="Bound">‚àÉŒì‚âà</a> <a id="28486" class="Symbol">:</a> <a id="28488" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="28490" class="Symbol">(</a><a id="28491" href="SymbolicModel.Helpers.html#1359" class="Function Operator">_‚âà·∂ú</a> <a id="28495" href="SecureCompilation.Coherence.html#28359" class="Bound">Œì</a><a id="28496" class="Symbol">))</a> <a id="28499" class="Symbol">‚Üí</a> <a id="28501" class="Keyword">let</a> <a id="28505" href="SecureCompilation.Coherence.html#28505" class="Bound">Œì‚Çú‚Ä≥</a> <a id="28509" class="Symbol">=</a> <a id="28511" href="SecureCompilation.Coherence.html#28482" class="Bound">‚àÉŒì‚âà</a> <a id="28515" class="Symbol">.</a><a id="28516" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="28522" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="28525" href="SecureCompilation.Coherence.html#28410" class="Bound">t‚Ä≤</a> <a id="28528" class="Keyword">in</a>
      <a id="28537" class="Keyword">let</a>
        <a id="28549" href="SecureCompilation.Coherence.html#28549" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="28554" class="Symbol">:</a> <a id="28556" href="SecureCompilation.Coherence.html#28355" class="Bound">Œì‚Çú</a> <a id="28559" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">‚Äî[</a> <a id="28562" href="SecureCompilation.Coherence.html#28385" class="Bound">Œ±</a> <a id="28564" href="BitML.Semantics.InferenceRules.html#9014" class="Datatype Operator">]‚Üí‚Çú</a> <a id="28568" href="SecureCompilation.Coherence.html#28430" class="Bound">Œì‚Çú‚Ä≤</a>
        <a id="28580" href="SecureCompilation.Coherence.html#28549" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="28585" class="Symbol">=</a> <a id="28587" href="BitML.Semantics.InferenceRules.html#9286" class="InductiveConstructor">[Delay]</a> <a id="28595" href="SecureCompilation.Coherence.html#28324" class="Bound">Œ¥&gt;0</a>

        <a id="28608" class="Keyword">open</a> <a id="28613" href="SymbolicModel.Helpers.html#37569" class="Module">H‚ÇÅ‚Çà</a> <a id="28617" class="Symbol">{</a><a id="28618" href="SecureCompilation.Coherence.html#28268" class="Bound">RÀ¢</a><a id="28620" class="Symbol">}</a> <a id="28622" href="SecureCompilation.Coherence.html#28291" class="Bound">ùï£</a> <a id="28624" href="SecureCompilation.Coherence.html#28364" class="Bound">t</a> <a id="28626" href="SecureCompilation.Coherence.html#28385" class="Bound">Œ±</a> <a id="28628" href="SecureCompilation.Coherence.html#28410" class="Bound">t‚Ä≤</a> <a id="28631" href="SecureCompilation.Coherence.html#28359" class="Bound">Œì</a> <a id="28633" class="Symbol">(</a><a id="28634" href="BitML.Semantics.Configurations.Helpers.html#2232" class="Function">‚âà·µó-refl</a> <a id="28642" class="Symbol">{</a><a id="28643" href="SecureCompilation.Coherence.html#28355" class="Bound">Œì‚Çú</a><a id="28645" class="Symbol">})</a> <a id="28648" href="SecureCompilation.Coherence.html#28549" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="28653" href="SecureCompilation.Coherence.html#28482" class="Bound">‚àÉŒì‚âà</a> <a id="28657" class="Keyword">using</a> <a id="28663" class="Symbol">(</a><a id="28664" href="SymbolicModel.Helpers.html#38025" class="Function">ŒªÀ¢</a><a id="28666" class="Symbol">)</a>
      <a id="28674" class="Keyword">in</a>
      <a id="28683" class="Comment">--‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî</a>
      <a id="28762" class="Symbol">(</a><a id="28763" href="SecureCompilation.Coherence.html#28505" class="Bound">Œì‚Çú‚Ä≥</a> <a id="28767" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="28769" href="SecureCompilation.Coherence.html#28273" class="Bound">ùï£‚àó</a> <a id="28772" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="28774" href="SymbolicModel.Helpers.html#38025" class="Function">ŒªÀ¢</a> <a id="28777" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="28778" class="Symbol">)</a> <a id="28780" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">~‚ÇÅ‚ÇÅ</a> <a id="28784" class="Symbol">(</a><a id="28785" href="SecureCompilation.Coherence.html#28452" class="Bound">Œª·∂ú</a> <a id="28788" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="28790" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="28792" class="Symbol">)</a>

<a id="_‚âÅ‚ÇÅ‚ÇÅ_"></a><a id="28795" href="SecureCompilation.Coherence.html#28795" class="Function Operator">_‚âÅ‚ÇÅ‚ÇÅ_</a> <a id="28801" class="Symbol">:</a> <a id="28803" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="28806" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="28809" class="Symbol">‚Üí</a> <a id="28811" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="28817" class="Symbol">‚Üí</a> <a id="28819" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="28823" href="SecureCompilation.Coherence.html#28795" class="Function Operator">_‚âÅ‚ÇÅ‚ÇÅ_</a> <a id="28829" class="Symbol">=</a> <a id="28831" href="Relation.Nullary.html#656" class="Function Operator">¬¨_</a> <a id="28834" href="Function.Base.html#1219" class="Function Operator">‚àò‚ÇÇ</a> <a id="28837" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">_~‚ÇÅ‚ÇÅ_</a>

<a id="28844" class="Keyword">data</a> <a id="_~‚ÇÅ‚ÇÇ_"></a><a id="28849" href="SecureCompilation.Coherence.html#28849" class="Datatype Operator">_~‚ÇÅ‚ÇÇ_</a> <a id="28855" class="Symbol">:</a> <a id="28857" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="28860" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="28863" class="Symbol">‚Üí</a> <a id="28865" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="28871" class="Symbol">‚Üí</a> <a id="28873" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="28877" class="Keyword">where</a>
<a id="28883" class="Comment">{-
  -- ** Deposits: authorize destroy
  [16] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         ‚àÄ {ds : List (Participant √ó S.Value √ó Id)} {j : Index ds}

    ‚Üí let
        k  = length ds
        xs = map (proj‚ÇÇ ‚àò proj‚ÇÇ) ds
        A  = proj‚ÇÅ (ds ‚Äº j)
        j‚Ä≤ = ‚Äº-map {xs = ds} j
        Œî  = || map (Œª{ (B·µ¢ , v·µ¢ , x·µ¢) ‚Üí ‚ü® B·µ¢ has v·µ¢ ‚ü©at x·µ¢ }) ds
        Œì  = Œî ‚à£ Œì‚ÇÄ
        Œì‚Çú = Œì at t
      in
      -- (ii) in RÀ¢ we find ‚ü®B·µ¢,v·µ¢‚ü©y·µ¢ for i ‚àà 1..k
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = auth-destroy‚¶Ö A , xs , j‚Ä≤ ‚¶Ü
        Œì‚Ä≤  = Œî ‚à£ A auth[ xs , j‚Ä≤ ‚ñ∑·µàÀ¢ y ] ‚à£ Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      -- Hypotheses from [DEP-AuthDestroy]
      (fresh-y : y ‚àâ ids Œì‚ÇÄ)
    ‚Üí let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] ([DEP-AuthDestroy] fresh-y) refl

        -- (vii) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        open H‚ÇÅ‚ÇÜ {RÀ¢} ùï£ t Œ± t‚Ä≤ ds Œì‚ÇÄ  j A y R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢; xs‚Ü¶)
      in
      -- (iii) in R·∂ú we find B ‚Üí ‚àó ‚à∂ T, for some T having txout‚Ä≤(y·µ¢) as inputs (+ possibly others)
      (T : Tx i 0)
    ‚Üí (hashTx‚Å± &lt;$&gt; codom xs‚Ü¶) ‚äÜ V.toList (inputs T)
    ‚Üí (T‚àà : Any (Œª l ‚Üí ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ [ T ‚ôØ ]) R·∂ú)

    ‚Üí let
        -- (iv) broadcast transaction T, signed by A
        m = [ SIG (KÃÇ A) T ]
        Œª·∂ú = B ‚Üí‚àó‚à∂ m
      in
      -- (v) Œª·∂ú is the first broadcast of m in R·∂ú after the first broadcast of T
      All (Œª l ‚Üí ¬¨ ‚àÉ Œª B ‚Üí l ‚â° B ‚Üí‚àó‚à∂ m) (Any-tail T‚àà)

      -- (vi) Œª·∂ú does not correspond to any *other* symbolic move
    ‚Üí (‚àÄ Œì‚Çú‚Ä≤ (ŒªÀ¢‚Ä≤ : ùïÉ RÀ¢ Œì‚Çú‚Ä≤)
        ‚Üí ŒªÀ¢‚Ä≤ .proj‚ÇÅ .proj‚ÇÅ ‚â¢ ŒªÀ¢ .proj‚ÇÅ .proj‚ÇÅ
        ‚Üí (Œì‚Çú‚Ä≤ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢‚Ä≤ ‚úì) ‚âÅ‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú))
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÇ (Œª·∂ú ‚à∑ R·∂ú)

  -- ** Deposits: destroy
  [17] : ‚àÄ {RÀ¢} {ùï£‚àó : ‚Ñù‚àó RÀ¢} ‚Üí let ùï£ = ‚Ñù‚àó‚áí‚Ñù ùï£‚àó; open ‚Ñù ùï£ in
         ‚àÄ {ds : List (Participant √ó S.Value √ó Id)} {j : Index ds}

    ‚Üí let
        xs = map (proj‚ÇÇ ‚àò proj‚ÇÇ) ds
        Œî  = || map (Œª{ (i , A·µ¢ , v·µ¢ , x·µ¢) ‚Üí ‚ü® A·µ¢ has v·µ¢ ‚ü©at x·µ¢ ‚à£ A·µ¢ auth[ xs , ‚Äº-map {xs = ds} i ‚ñ∑·µàÀ¢ y ] })
                    (enumerate ds)
        Œì  = Œî ‚à£ Œì‚ÇÄ
        Œì‚Çú = Œì at t
      in
      -- (ii) in RÀ¢, Œ± assumes ‚ü®A·µ¢,v·µ¢‚ü©x·µ¢ to obtain 0
      (R‚âà : RÀ¢ ‚âà‚ãØ Œì‚Çú)
    ‚Üí let
        Œ±   = destroy‚¶Ö xs ‚¶Ü
        Œì‚Ä≤  = Œì‚ÇÄ
        t‚Ä≤  = t
        Œì‚Çú‚Ä≤ = Œì‚Ä≤ at t‚Ä≤
      in
      (‚àÉŒì‚âà : ‚àÉ (_‚âà·∂ú Œì‚Ä≤)) ‚Üí let Œì‚Çú‚Ä≥ = ‚àÉŒì‚âà .proj‚ÇÅ at t‚Ä≤ in
      let
        Œì‚ÜíŒì‚Ä≤ : Œì‚Çú ‚Äî[ Œ± ]‚Üí‚Çú Œì‚Çú‚Ä≤
        Œì‚ÜíŒì‚Ä≤ = [Action] [DEP-Destroy] refl

        -- (v) txout = txout‚Ä≤, sechash = sechash‚Ä≤, Œ∫ = Œ∫‚Ä≤
        -- remove {‚ãØ x·µ¢ ‚Ü¶ (T·µ¢,j) ‚ãØ} from txout‚Ä≤
        open H‚ÇÅ‚Çá {RÀ¢} ùï£ t Œ± t‚Ä≤ ds Œì‚ÇÄ y R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (ŒªÀ¢; xs‚Ü¶)
      in
      (T : Tx i 0)
    ‚Üí (hashTx‚Å± &lt;$&gt; codom xs‚Ü¶) ‚äÜ V.toList (inputs T)

    ‚Üí let
        -- (iii) submit transaction T
        Œª·∂ú = submit (_ , _ , T)
      in

      -- (iv) Œª·∂ú does not correspond to any *other* symbolic move
      (‚àÄ Œì‚Çú‚Ä≤ (ŒªÀ¢‚Ä≤ : ùïÉ RÀ¢ Œì‚Çú‚Ä≤)
        ‚Üí ŒªÀ¢‚Ä≤ .proj‚ÇÅ .proj‚ÇÅ ‚â¢ ŒªÀ¢ .proj‚ÇÅ .proj‚ÇÅ
        ‚Üí (Œì‚Çú‚Ä≤ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢‚Ä≤ ‚úì) ‚âÅ‚ÇÅ‚ÇÅ (Œª·∂ú ‚à∑ R·∂ú))
      --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
    ‚Üí (Œì‚Çú‚Ä≥ ‚à∑ ùï£‚àó ‚ä£ ŒªÀ¢ ‚úì) ~‚ÇÅ‚ÇÇ (Œª·∂ú ‚à∑ R·∂ú)
-}</a>
<a id="_‚âÅ‚ÇÅ‚ÇÇ_"></a><a id="32034" href="SecureCompilation.Coherence.html#32034" class="Function Operator">_‚âÅ‚ÇÅ‚ÇÇ_</a> <a id="32040" class="Symbol">:</a> <a id="32042" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32045" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="32048" class="Symbol">‚Üí</a> <a id="32050" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="32056" class="Symbol">‚Üí</a> <a id="32058" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="32062" href="SecureCompilation.Coherence.html#32034" class="Function Operator">_‚âÅ‚ÇÅ‚ÇÇ_</a> <a id="32068" class="Symbol">=</a> <a id="32070" href="Relation.Nullary.html#656" class="Function Operator">¬¨_</a> <a id="32073" href="Function.Base.html#1219" class="Function Operator">‚àò‚ÇÇ</a> <a id="32076" href="SecureCompilation.Coherence.html#28849" class="Datatype Operator">_~‚ÇÅ‚ÇÇ_</a>

<a id="32083" class="Keyword">data</a> <a id="_~‚ÇÅ_"></a><a id="32088" href="SecureCompilation.Coherence.html#32088" class="Datatype Operator">_~‚ÇÅ_</a> <a id="32093" class="Symbol">:</a> <a id="32095" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32098" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="32101" class="Symbol">‚Üí</a> <a id="32103" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="32109" class="Symbol">‚Üí</a> <a id="32111" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="32115" class="Keyword">where</a>

  <a id="_~‚ÇÅ_.[L]_"></a><a id="32124" href="SecureCompilation.Coherence.html#32124" class="InductiveConstructor Operator">[L]_</a> <a id="32129" class="Symbol">:</a> <a id="32131" class="Symbol">‚àÄ</a> <a id="32133" class="Symbol">{</a><a id="32134" href="SecureCompilation.Coherence.html#32134" class="Bound">RÀ¢</a><a id="32136" class="Symbol">}</a> <a id="32138" class="Symbol">{</a><a id="32139" href="SecureCompilation.Coherence.html#32139" class="Bound">ùï£‚àó</a> <a id="32142" class="Symbol">:</a> <a id="32144" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32147" href="SecureCompilation.Coherence.html#32134" class="Bound">RÀ¢</a><a id="32149" class="Symbol">}</a> <a id="32151" class="Symbol">{</a><a id="32152" href="SecureCompilation.Coherence.html#32152" class="Bound">ŒªÀ¢</a> <a id="32155" class="Symbol">:</a> <a id="32157" href="SymbolicModel.Mappings.Properties.html#3542" class="Function">ùïÉ</a> <a id="32159" href="SecureCompilation.Coherence.html#32134" class="Bound">RÀ¢</a> <a id="32162" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a><a id="32164" class="Symbol">}</a> <a id="32166" class="Symbol">‚Üí</a>
    <a id="32172" class="Symbol">(</a><a id="32173" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="32176" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="32178" href="SecureCompilation.Coherence.html#32139" class="Bound">ùï£‚àó</a> <a id="32181" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="32183" href="SecureCompilation.Coherence.html#32152" class="Bound">ŒªÀ¢</a> <a id="32186" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="32187" class="Symbol">)</a> <a id="32189" href="SecureCompilation.Coherence.html#1904" class="Datatype Operator">~‚ÇÅ‚ÇÅ</a> <a id="32193" class="Symbol">(</a><a id="32194" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32197" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="32199" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="32201" class="Symbol">)</a>
    <a id="32207" href="Prelude.InferenceRules.html#13794" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="32242" class="Symbol">(</a><a id="32243" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="32246" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="32248" href="SecureCompilation.Coherence.html#32139" class="Bound">ùï£‚àó</a> <a id="32251" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="32253" href="SecureCompilation.Coherence.html#32152" class="Bound">ŒªÀ¢</a> <a id="32256" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="32257" class="Symbol">)</a> <a id="32259" href="SecureCompilation.Coherence.html#32088" class="Datatype Operator">~‚ÇÅ</a>  <a id="32263" class="Symbol">(</a><a id="32264" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32267" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="32269" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="32271" class="Symbol">)</a>

  <a id="_~‚ÇÅ_.[R]_"></a><a id="32276" href="SecureCompilation.Coherence.html#32276" class="InductiveConstructor Operator">[R]_</a> <a id="32281" class="Symbol">:</a> <a id="32283" class="Symbol">‚àÄ</a> <a id="32285" class="Symbol">{</a><a id="32286" href="SecureCompilation.Coherence.html#32286" class="Bound">RÀ¢</a><a id="32288" class="Symbol">}</a> <a id="32290" class="Symbol">{</a><a id="32291" href="SecureCompilation.Coherence.html#32291" class="Bound">ùï£‚àó</a> <a id="32294" class="Symbol">:</a> <a id="32296" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32299" href="SecureCompilation.Coherence.html#32286" class="Bound">RÀ¢</a><a id="32301" class="Symbol">}</a> <a id="32303" class="Symbol">{</a><a id="32304" href="SecureCompilation.Coherence.html#32304" class="Bound">ŒªÀ¢</a> <a id="32307" class="Symbol">:</a> <a id="32309" href="SymbolicModel.Mappings.Properties.html#3542" class="Function">ùïÉ</a> <a id="32311" href="SecureCompilation.Coherence.html#32286" class="Bound">RÀ¢</a> <a id="32314" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a><a id="32316" class="Symbol">}</a> <a id="32318" class="Symbol">‚Üí</a>
    <a id="32324" class="Symbol">(</a><a id="32325" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="32328" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="32330" href="SecureCompilation.Coherence.html#32291" class="Bound">ùï£‚àó</a> <a id="32333" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="32335" href="SecureCompilation.Coherence.html#32304" class="Bound">ŒªÀ¢</a> <a id="32338" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="32339" class="Symbol">)</a> <a id="32341" href="SecureCompilation.Coherence.html#28849" class="Datatype Operator">~‚ÇÅ‚ÇÇ</a> <a id="32345" class="Symbol">(</a><a id="32346" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32349" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="32351" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="32353" class="Symbol">)</a>
    <a id="32359" href="Prelude.InferenceRules.html#13794" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="32394" class="Symbol">(</a><a id="32395" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="32398" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="32400" href="SecureCompilation.Coherence.html#32291" class="Bound">ùï£‚àó</a> <a id="32403" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="32405" href="SecureCompilation.Coherence.html#32304" class="Bound">ŒªÀ¢</a> <a id="32408" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="32409" class="Symbol">)</a> <a id="32411" href="SecureCompilation.Coherence.html#32088" class="Datatype Operator">~‚ÇÅ</a>  <a id="32415" class="Symbol">(</a><a id="32416" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32419" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="32421" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="32423" class="Symbol">)</a>

<a id="_‚âÅ‚ÇÅ_"></a><a id="32426" href="SecureCompilation.Coherence.html#32426" class="Function Operator">_‚âÅ‚ÇÅ_</a> <a id="32431" class="Symbol">:</a> <a id="32433" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32436" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="32439" class="Symbol">‚Üí</a> <a id="32441" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="32447" class="Symbol">‚Üí</a> <a id="32449" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="32453" href="SecureCompilation.Coherence.html#32426" class="Function Operator">_‚âÅ‚ÇÅ_</a> <a id="32458" class="Symbol">=</a> <a id="32460" href="Relation.Nullary.html#656" class="Function Operator">¬¨_</a> <a id="32463" href="Function.Base.html#1219" class="Function Operator">‚àò‚ÇÇ</a> <a id="32466" href="SecureCompilation.Coherence.html#32088" class="Datatype Operator">_~‚ÇÅ_</a>

<a id="32472" class="Comment">-- * Inductive case 2</a>
<a id="32494" class="Keyword">data</a> <a id="_~‚ÇÇ_"></a><a id="32499" href="SecureCompilation.Coherence.html#32499" class="Datatype Operator">_~‚ÇÇ_</a> <a id="32504" class="Symbol">(</a><a id="32505" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a> <a id="32508" class="Symbol">:</a> <a id="32510" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="32513" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a><a id="32515" class="Symbol">)</a> <a id="32517" class="Symbol">:</a> <a id="32519" href="ComputationalModel.Strategy.html#835" class="Datatype">C.Label</a> <a id="32527" class="Symbol">‚Üí</a> <a id="32529" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="32533" class="Keyword">where</a>
  <a id="_~‚ÇÇ_.[1]"></a><a id="32541" href="SecureCompilation.Coherence.html#32541" class="InductiveConstructor">[1]</a> <a id="32545" class="Symbol">:</a>
    <a id="32551" class="Keyword">let</a> <a id="32555" href="SecureCompilation.Coherence.html#32555" class="Bound">ùï£</a> <a id="32557" class="Symbol">=</a> <a id="32559" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="32564" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a><a id="32566" class="Symbol">;</a> <a id="32568" class="Keyword">open</a> <a id="32573" href="SymbolicModel.Mappings.Base.html#1169" class="Module">‚Ñù</a> <a id="32575" href="SecureCompilation.Coherence.html#32555" class="Bound">ùï£</a> <a id="32577" class="Keyword">in</a>
    <a id="32584" href="SecureCompilation.Coherence.html#1091" class="Generalizable">T</a> <a id="32586" class="Symbol">.</a><a id="32587" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a> <a id="32593" class="Symbol">.</a><a id="32594" href="Agda.Builtin.Sigma.html#264" class="Field">proj‚ÇÇ</a> <a id="32600" class="Symbol">.</a><a id="32601" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a> <a id="32608" href="Prelude.Apartness.html#237" class="Field Operator">‚ôØ</a> <a id="32610" class="Symbol">(</a><a id="32611" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTx‚Å±</a> <a id="32619" href="Prelude.Functor.html#301" class="Field Operator">&lt;$&gt;</a> <a id="32623" href="Prelude.Lists.Mappings.html#824" class="Function">codom</a> <a id="32629" href="SymbolicModel.Mappings.Base.html#1224" class="Function">txout‚Ä≤</a><a id="32635" class="Symbol">)</a>
    <a id="32641" href="Prelude.InferenceRules.html#12771" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="32698" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a> <a id="32701" href="SecureCompilation.Coherence.html#32499" class="Datatype Operator">~‚ÇÇ</a> <a id="32704" href="ComputationalModel.Strategy.html#947" class="InductiveConstructor">submit</a> <a id="32711" href="SecureCompilation.Coherence.html#1091" class="Generalizable">T</a>

  <a id="_~‚ÇÇ_.[2]"></a><a id="32716" href="SecureCompilation.Coherence.html#32716" class="InductiveConstructor">[2]</a> <a id="32720" class="Symbol">:</a>
    <a id="32726" class="Symbol">(</a><a id="32727" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32730" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="32732" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32734" href="ComputationalModel.Strategy.html#1049" class="InductiveConstructor Operator">‚ÜíO‚à∂</a> <a id="32738" href="ComputationalModel.Strategy.html#1212" class="Generalizable">m</a><a id="32739" class="Symbol">)</a> <a id="32741" href="Data.Sum.Base.html#734" class="Datatype Operator">‚äé</a> <a id="32743" class="Symbol">(</a><a id="32744" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="32747" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="32749" href="ComputationalModel.Strategy.html#1121" class="InductiveConstructor Operator">O‚Üí</a> <a id="32752" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32754" href="ComputationalModel.Strategy.html#1121" class="InductiveConstructor Operator">‚à∂</a> <a id="32756" href="ComputationalModel.Strategy.html#1212" class="Generalizable">m</a><a id="32757" class="Symbol">)</a>
    <a id="32763" href="Prelude.InferenceRules.html#13721" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="32800" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a> <a id="32803" href="SecureCompilation.Coherence.html#32499" class="Datatype Operator">~‚ÇÇ</a> <a id="32806" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a>

  <a id="_~‚ÇÇ_.[3]"></a><a id="32812" href="SecureCompilation.Coherence.html#32812" class="InductiveConstructor">[3]</a> <a id="32816" class="Symbol">:</a>
    <a id="32822" class="Keyword">let</a> <a id="32826" href="SecureCompilation.Coherence.html#32826" class="Bound">Œª·∂ú</a> <a id="32829" class="Symbol">=</a> <a id="32831" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32833" href="ComputationalModel.Strategy.html#878" class="InductiveConstructor Operator">‚Üí‚àó‚à∂</a> <a id="32837" href="ComputationalModel.Strategy.html#1212" class="Generalizable">m</a> <a id="32839" class="Keyword">in</a>
    <a id="32846" class="Comment">-- Œª·∂ú does not correspond to any symbolic move</a>
    <a id="32897" class="Symbol">(‚àÄ</a> <a id="32900" class="Symbol">{</a><a id="32901" href="SecureCompilation.Coherence.html#32901" class="Bound">Œì‚Çú</a> <a id="32904" href="SecureCompilation.Coherence.html#32904" class="Bound">R·∂ú</a><a id="32906" class="Symbol">}</a> <a id="32908" class="Symbol">(</a><a id="32909" href="SecureCompilation.Coherence.html#32909" class="Bound">ŒªÀ¢</a> <a id="32912" class="Symbol">:</a> <a id="32914" href="SymbolicModel.Mappings.Properties.html#3542" class="Function">ùïÉ</a> <a id="32916" href="SecureCompilation.Coherence.html#32513" class="Bound">RÀ¢</a> <a id="32919" href="SecureCompilation.Coherence.html#32901" class="Bound">Œì‚Çú</a><a id="32921" class="Symbol">)</a> <a id="32923" class="Symbol">‚Üí</a> <a id="32925" class="Symbol">(</a><a id="32926" href="SecureCompilation.Coherence.html#32901" class="Bound">Œì‚Çú</a> <a id="32929" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="32931" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a> <a id="32934" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="32936" href="SecureCompilation.Coherence.html#32909" class="Bound">ŒªÀ¢</a> <a id="32939" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="32940" class="Symbol">)</a> <a id="32942" href="SecureCompilation.Coherence.html#32426" class="Function Operator">‚âÅ‚ÇÅ</a> <a id="32945" class="Symbol">(</a><a id="32946" href="SecureCompilation.Coherence.html#32826" class="Bound">Œª·∂ú</a> <a id="32949" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="32951" href="SecureCompilation.Coherence.html#32904" class="Bound">R·∂ú</a><a id="32953" class="Symbol">))</a>
    <a id="32960" href="Prelude.InferenceRules.html#12408" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="33023" href="SecureCompilation.Coherence.html#32505" class="Bound">ùï£‚àó</a> <a id="33026" href="SecureCompilation.Coherence.html#32499" class="Datatype Operator">~‚ÇÇ</a> <a id="33029" href="SecureCompilation.Coherence.html#32826" class="Bound">Œª·∂ú</a>

<a id="33033" class="Keyword">data</a> <a id="_~‚Ä≤_"></a><a id="33038" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">_~‚Ä≤_</a> <a id="33043" class="Symbol">:</a> <a id="33045" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="33048" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="33051" class="Symbol">‚Üí</a> <a id="33053" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="33059" class="Symbol">‚Üí</a> <a id="33061" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="33065" class="Keyword">where</a>

  <a id="33074" class="Comment">-- * Base case</a>
  <a id="_~‚Ä≤_.base"></a><a id="33091" href="SecureCompilation.Coherence.html#33091" class="InductiveConstructor">base</a> <a id="33096" class="Symbol">:</a> <a id="33098" class="Symbol">‚àÄ</a> <a id="33100" class="Symbol">{</a><a id="33101" href="SecureCompilation.Coherence.html#33101" class="Bound">‚ÑΩ</a> <a id="33103" class="Symbol">:</a> <a id="33105" href="SymbolicModel.Mappings.Base.html#1335" class="Function">‚Ñæ·µó</a> <a id="33108" href="BitML.Semantics.Configurations.Types.html#1930" class="Generalizable">Œì‚Çú‚ÇÄ</a><a id="33111" class="Symbol">}</a> <a id="33113" class="Symbol">‚Üí</a> <a id="33115" class="Keyword">let</a> <a id="33119" class="Keyword">open</a> <a id="33124" href="SymbolicModel.Mappings.Base.html#1362" class="Module">‚Ñæ·µó</a> <a id="33127" href="SecureCompilation.Coherence.html#33101" class="Bound">‚ÑΩ</a><a id="33128" class="Symbol">;</a> <a id="33130" href="SecureCompilation.Coherence.html#33130" class="Bound">Œì‚ÇÄ</a> <a id="33133" class="Symbol">=</a> <a id="33135" href="BitML.Semantics.Configurations.Types.html#1930" class="Generalizable">Œì‚Çú‚ÇÄ</a> <a id="33139" class="Symbol">.</a><a id="33140" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="33144" class="Keyword">in</a>

      <a id="33154" class="Comment">-- (i) RÀ¢ = Œì‚ÇÄ ‚à£ 0, with Œì‚ÇÄ initial</a>
    <a id="33194" class="Symbol">‚àÄ</a> <a id="33196" class="Symbol">(</a><a id="33197" href="SecureCompilation.Coherence.html#33197" class="Bound">init</a> <a id="33202" class="Symbol">:</a> <a id="33204" href="Prelude.Traces.html#283" class="Field">Initial</a> <a id="33212" href="BitML.Semantics.Configurations.Types.html#1930" class="Generalizable">Œì‚Çú‚ÇÄ</a><a id="33215" class="Symbol">)</a> <a id="33217" class="Symbol">‚Üí</a>
      <a id="33225" class="Comment">-- (ii) R·∂ú = T‚ÇÄ ‚ãØ initial</a>
    <a id="33255" class="Symbol">‚àÄ</a> <a id="33257" class="Symbol">(</a><a id="33258" href="SecureCompilation.Coherence.html#33258" class="Bound">cinit</a> <a id="33264" class="Symbol">:</a> <a id="33266" href="ComputationalModel.Strategy.html#2346" class="Function">C.Initial</a> <a id="33276" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="33278" class="Symbol">)</a> <a id="33280" class="Symbol">‚Üí</a>
      <a id="33288" class="Comment">-- (iii) generation of public keys, we do not consider that here</a>
      <a id="33359" class="Comment">-- (iv) ‚ü®A,v‚ü©‚Çì ‚àà Œì‚ÇÄ ‚áí txout{ x ‚Ü¶ (v$ spendable with KÃÇ(A)(r‚Çê)) ‚àà T‚ÇÄ }</a>
    <a id="33433" href="Prelude.InferenceRules.html#56094" class="Function Operator">‚àô</a> <a id="33435" class="Symbol">(‚àÄ</a> <a id="33438" class="Symbol">{</a><a id="33439" href="SecureCompilation.Coherence.html#33439" class="Bound">A</a> <a id="33441" href="SecureCompilation.Coherence.html#33441" class="Bound">v</a> <a id="33443" href="SecureCompilation.Coherence.html#33443" class="Bound">x</a><a id="33444" class="Symbol">}</a> <a id="33446" class="Symbol">(</a><a id="33447" href="SecureCompilation.Coherence.html#33447" class="Bound">d‚àà</a> <a id="33450" class="Symbol">:</a> <a id="33452" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">‚ü®</a> <a id="33454" href="SecureCompilation.Coherence.html#33439" class="Bound">A</a> <a id="33456" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="33460" href="SecureCompilation.Coherence.html#33441" class="Bound">v</a> <a id="33462" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">‚ü©at</a> <a id="33466" href="SecureCompilation.Coherence.html#33443" class="Bound">x</a> <a id="33468" href="BitML.Semantics.Configurations.Helpers.html#4008" class="Function Operator">‚àà·∂ú</a> <a id="33471" href="SecureCompilation.Coherence.html#33130" class="Bound">Œì‚ÇÄ</a><a id="33473" class="Symbol">)</a> <a id="33475" class="Symbol">‚Üí</a>
        <a id="33485" class="Keyword">let</a> <a id="33489" href="SecureCompilation.Coherence.html#33489" class="Bound">‚àÉT‚ÇÄ</a> <a id="33493" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="33495" class="Symbol">_</a> <a id="33497" class="Symbol">=</a> <a id="33499" href="SecureCompilation.Coherence.html#33258" class="Bound">cinit</a><a id="33504" class="Symbol">;</a> <a id="33506" class="Symbol">_</a> <a id="33508" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="33510" href="SecureCompilation.Coherence.html#33510" class="Bound">o</a> <a id="33512" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="33514" href="SecureCompilation.Coherence.html#33514" class="Bound">T‚ÇÄ</a> <a id="33517" class="Symbol">=</a> <a id="33519" href="SecureCompilation.Coherence.html#33489" class="Bound">‚àÉT‚ÇÄ</a> <a id="33523" class="Keyword">in</a>
        <a id="33534" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="33536" class="Symbol">Œª</a> <a id="33538" href="SecureCompilation.Coherence.html#33538" class="Bound">o·µ¢</a> <a id="33541" class="Symbol">‚Üí</a> <a id="33543" class="Symbol">(</a><a id="33544" href="SymbolicModel.Mappings.Base.html#1420" class="Field">txoutŒì</a> <a id="33551" class="Symbol">(</a><a id="33552" href="BitML.Semantics.Configurations.Helpers.html#15353" class="Function">deposit‚ààŒì‚áínames ≥</a> <a id="33569" class="Symbol">{</a><a id="33570" class="Argument">Œì</a> <a id="33572" class="Symbol">=</a> <a id="33574" href="SecureCompilation.Coherence.html#33130" class="Bound">Œì‚ÇÄ</a><a id="33576" class="Symbol">}</a> <a id="33578" href="SecureCompilation.Coherence.html#33447" class="Bound">d‚àà</a><a id="33580" class="Symbol">)</a> <a id="33582" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="33584" href="SecureCompilation.Coherence.html#33489" class="Bound">‚àÉT‚ÇÄ</a> <a id="33588" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="33591" href="SecureCompilation.Coherence.html#33538" class="Bound">o·µ¢</a><a id="33593" class="Symbol">)</a>
               <a id="33610" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="33612" class="Symbol">(</a><a id="33613" href="SecureCompilation.Coherence.html#33514" class="Bound">T‚ÇÄ</a> <a id="33616" href="Bitcoin.Tx.Base.html#2139" class="Function Operator">‚Äº·µí</a> <a id="33619" href="SecureCompilation.Coherence.html#33538" class="Bound">o·µ¢</a> <a id="33622" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">‚â°</a> <a id="33624" href="SecureCompilation.Coherence.html#33441" class="Bound">v</a> <a id="33626" href="SecureCompilation.Coherence.html#1322" class="Function Operator">-redeemableWith-</a> <a id="33643" href="ComputationalModel.KeyPairs.html#297" class="Function">KÃÇ</a> <a id="33646" href="SecureCompilation.Coherence.html#33439" class="Bound">A</a><a id="33647" class="Symbol">))</a>
      <a id="33656" class="Comment">-- (v)  dom sechash = ‚àÖ</a>
      <a id="33686" class="Comment">-- (vi) dom Œ∫       = ‚àÖ</a>
      <a id="33716" class="Comment">-- by definition of Initial/‚Ñù</a>
      <a id="33752" href="Prelude.InferenceRules.html#11574" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
      <a id="33829" class="Symbol">(</a><a id="33830" href="SecureCompilation.Coherence.html#33101" class="Bound">‚ÑΩ</a> <a id="33832" href="SymbolicModel.Helpers.html#1470" class="InductiveConstructor Operator">‚àé‚ä£</a> <a id="33835" href="SecureCompilation.Coherence.html#33197" class="Bound">init</a> <a id="33840" href="SymbolicModel.Helpers.html#1470" class="InductiveConstructor Operator">‚úì</a><a id="33841" class="Symbol">)</a> <a id="33843" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="33846" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a>

  <a id="33852" class="Comment">-- * Inductive case 1</a>
  <a id="_~‚Ä≤_.step‚ÇÅ"></a><a id="33876" href="SecureCompilation.Coherence.html#33876" class="InductiveConstructor">step‚ÇÅ</a> <a id="33882" class="Symbol">:</a> <a id="33884" class="Symbol">‚àÄ</a> <a id="33886" class="Symbol">{</a><a id="33887" href="SecureCompilation.Coherence.html#33887" class="Bound">RÀ¢</a><a id="33889" class="Symbol">}</a> <a id="33891" class="Symbol">{</a><a id="33892" href="SecureCompilation.Coherence.html#33892" class="Bound">ùï£‚àó</a> <a id="33895" class="Symbol">:</a> <a id="33897" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="33900" href="SecureCompilation.Coherence.html#33887" class="Bound">RÀ¢</a><a id="33902" class="Symbol">}</a> <a id="33904" class="Symbol">{</a><a id="33905" href="SecureCompilation.Coherence.html#33905" class="Bound">ŒªÀ¢</a> <a id="33908" class="Symbol">:</a> <a id="33910" href="SymbolicModel.Mappings.Properties.html#3542" class="Function">ùïÉ</a> <a id="33912" href="SecureCompilation.Coherence.html#33887" class="Bound">RÀ¢</a> <a id="33915" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a><a id="33917" class="Symbol">}</a> <a id="33919" class="Symbol">‚Üí</a>
    <a id="33925" href="Prelude.InferenceRules.html#56094" class="Function Operator">‚àô</a> <a id="33927" href="SecureCompilation.Coherence.html#33892" class="Bound">ùï£‚àó</a> <a id="33930" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="33933" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a>
    <a id="33940" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="33942" class="Symbol">(</a><a id="33943" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="33946" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="33948" href="SecureCompilation.Coherence.html#33892" class="Bound">ùï£‚àó</a> <a id="33951" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="33953" href="SecureCompilation.Coherence.html#33905" class="Bound">ŒªÀ¢</a> <a id="33956" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="33957" class="Symbol">)</a> <a id="33959" href="SecureCompilation.Coherence.html#32088" class="Datatype Operator">~‚ÇÅ</a> <a id="33962" class="Symbol">(</a><a id="33963" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="33966" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="33968" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="33970" class="Symbol">)</a>
      <a id="33978" href="Prelude.InferenceRules.html#13829" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
      <a id="34014" class="Symbol">(</a><a id="34015" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a> <a id="34018" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚à∑</a> <a id="34020" href="SecureCompilation.Coherence.html#33892" class="Bound">ùï£‚àó</a> <a id="34023" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚ä£</a> <a id="34025" href="SecureCompilation.Coherence.html#33905" class="Bound">ŒªÀ¢</a> <a id="34028" href="SymbolicModel.Helpers.html#1579" class="InductiveConstructor Operator">‚úì</a><a id="34029" class="Symbol">)</a> <a id="34031" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="34034" class="Symbol">(</a><a id="34035" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="34038" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="34040" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="34042" class="Symbol">)</a>

  <a id="34047" class="Comment">-- * Inductive case 2</a>
  <a id="_~‚Ä≤_.step‚ÇÇ"></a><a id="34071" href="SecureCompilation.Coherence.html#34071" class="InductiveConstructor">step‚ÇÇ</a> <a id="34077" class="Symbol">:</a> <a id="34079" class="Symbol">‚àÄ</a> <a id="34081" class="Symbol">{</a><a id="34082" href="SecureCompilation.Coherence.html#34082" class="Bound">RÀ¢</a><a id="34084" class="Symbol">}</a> <a id="34086" class="Symbol">{</a><a id="34087" href="SecureCompilation.Coherence.html#34087" class="Bound">ùï£‚àó</a> <a id="34090" class="Symbol">:</a> <a id="34092" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="34095" href="SecureCompilation.Coherence.html#34082" class="Bound">RÀ¢</a><a id="34097" class="Symbol">}</a> <a id="34099" class="Symbol">‚Üí</a>
    <a id="34105" href="Prelude.InferenceRules.html#56094" class="Function Operator">‚àô</a> <a id="34107" href="SecureCompilation.Coherence.html#34087" class="Bound">ùï£‚àó</a> <a id="34110" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="34113" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a>
    <a id="34120" href="Prelude.InferenceRules.html#56028" class="Function Operator">‚àô</a> <a id="34122" href="SecureCompilation.Coherence.html#34087" class="Bound">ùï£‚àó</a> <a id="34125" href="SecureCompilation.Coherence.html#32499" class="Datatype Operator">~‚ÇÇ</a> <a id="34128" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a>
      <a id="34137" href="Prelude.InferenceRules.html#14214" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
      <a id="34159" href="SecureCompilation.Coherence.html#34087" class="Bound">ùï£‚àó</a> <a id="34162" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="34165" class="Symbol">(</a><a id="34166" href="ComputationalModel.Strategy.html#1248" class="Generalizable">Œª·∂ú</a> <a id="34169" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">‚à∑</a> <a id="34171" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a><a id="34173" class="Symbol">)</a>

<a id="_~_"></a><a id="34176" href="SecureCompilation.Coherence.html#34176" class="Function Operator">_~_</a> <a id="_‚âÅ_"></a><a id="34180" href="SecureCompilation.Coherence.html#34180" class="Function Operator">_‚âÅ_</a> <a id="34184" class="Symbol">:</a> <a id="34186" href="SymbolicModel.Run.Base.html#408" class="Function">S.Run</a> <a id="34192" class="Symbol">‚Üí</a> <a id="34194" href="ComputationalModel.Strategy.html#1160" class="Function">C.Run</a> <a id="34200" class="Symbol">‚Üí</a> <a id="34202" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="34206" href="SecureCompilation.Coherence.html#34206" class="Bound">RÀ¢</a> <a id="34209" href="SecureCompilation.Coherence.html#34176" class="Function Operator">~</a> <a id="34211" href="SecureCompilation.Coherence.html#34211" class="Bound">R·∂ú</a> <a id="34214" class="Symbol">=</a> <a id="34216" href="Data.Product.html#1369" class="Function">‚àÉ</a> <a id="34218" class="Symbol">Œª</a> <a id="34220" class="Symbol">(</a><a id="34221" href="SecureCompilation.Coherence.html#34221" class="Bound">ùï£‚àó</a> <a id="34224" class="Symbol">:</a> <a id="34226" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="34229" href="SecureCompilation.Coherence.html#34206" class="Bound">RÀ¢</a><a id="34231" class="Symbol">)</a> <a id="34233" class="Symbol">‚Üí</a> <a id="34235" href="SecureCompilation.Coherence.html#34221" class="Bound">ùï£‚àó</a> <a id="34238" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="34241" href="SecureCompilation.Coherence.html#34211" class="Bound">R·∂ú</a>
<a id="34244" href="SecureCompilation.Coherence.html#34180" class="Function Operator">_‚âÅ_</a> <a id="34248" class="Symbol">=</a> <a id="34250" href="Relation.Nullary.html#656" class="Function Operator">¬¨_</a> <a id="34253" href="Function.Base.html#1219" class="Function Operator">‚àò‚ÇÇ</a> <a id="34256" href="SecureCompilation.Coherence.html#34176" class="Function Operator">_~_</a>

<a id="34261" class="Keyword">private</a>
  <a id="testPatternMatch-~"></a><a id="34271" href="SecureCompilation.Coherence.html#34271" class="Function">testPatternMatch-~</a> <a id="34290" class="Symbol">:</a> <a id="34292" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a> <a id="34295" href="SecureCompilation.Coherence.html#34176" class="Function Operator">~</a> <a id="34297" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a> <a id="34300" class="Symbol">‚Üí</a> <a id="34302" href="Agda.Builtin.Unit.html#164" class="Record">‚ä§</a>
  <a id="34306" href="SecureCompilation.Coherence.html#34271" class="Function">testPatternMatch-~</a> <a id="34325" class="Symbol">(</a><a id="34326" href="SecureCompilation.Coherence.html#34326" class="Bound">ùï£‚àó</a> <a id="34329" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="34331" href="SecureCompilation.Coherence.html#34331" class="Bound">coh</a><a id="34334" class="Symbol">)</a> <a id="34336" class="Keyword">with</a> <a id="34341" href="SecureCompilation.Coherence.html#34331" class="Bound">coh</a>
  <a id="34347" class="Symbol">...</a> <a id="34351" class="Symbol">|</a> <a id="34353" href="SecureCompilation.Coherence.html#33091" class="InductiveConstructor">base</a> <a id="34358" href="SecureCompilation.Coherence.html#34358" class="Bound">init</a> <a id="34363" href="SecureCompilation.Coherence.html#34363" class="Bound">cinit</a> <a id="34369" href="SecureCompilation.Coherence.html#34369" class="Bound">txout‚âà</a> <a id="34376" class="Symbol">=</a> <a id="34378" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="34383" class="Symbol">...</a> <a id="34387" class="Symbol">|</a> <a id="34389" href="SecureCompilation.Coherence.html#34071" class="InductiveConstructor">step‚ÇÇ</a> <a id="34395" class="Symbol">_</a> <a id="34397" class="Symbol">(</a><a id="34398" href="SecureCompilation.Coherence.html#32541" class="InductiveConstructor">[1]</a> <a id="34402" href="SecureCompilation.Coherence.html#34402" class="Bound">ins‚ôØ</a><a id="34406" class="Symbol">)</a> <a id="34408" class="Symbol">=</a> <a id="34410" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="34415" class="Symbol">...</a> <a id="34419" class="Symbol">|</a> <a id="34421" href="SecureCompilation.Coherence.html#34071" class="InductiveConstructor">step‚ÇÇ</a> <a id="34427" class="Symbol">_</a> <a id="34429" class="Symbol">(</a><a id="34430" href="SecureCompilation.Coherence.html#32716" class="InductiveConstructor">[2]</a> <a id="34434" href="SecureCompilation.Coherence.html#34434" class="Bound">Œª·∂ú‚â°</a><a id="34437" class="Symbol">)</a> <a id="34439" class="Symbol">=</a> <a id="34441" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="34446" class="Symbol">...</a> <a id="34450" class="Symbol">|</a> <a id="34452" href="SecureCompilation.Coherence.html#34071" class="InductiveConstructor">step‚ÇÇ</a> <a id="34458" class="Symbol">_</a> <a id="34460" class="Symbol">(</a><a id="34461" href="SecureCompilation.Coherence.html#32812" class="InductiveConstructor">[3]</a> <a id="34465" href="SecureCompilation.Coherence.html#34465" class="Bound">¬¨p</a><a id="34467" class="Symbol">)</a> <a id="34469" class="Symbol">=</a> <a id="34471" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="34476" class="Symbol">...</a> <a id="34480" class="Symbol">|</a> <a id="34482" href="SecureCompilation.Coherence.html#33876" class="InductiveConstructor">step‚ÇÅ</a> <a id="34488" class="Symbol">_</a> <a id="34490" href="SecureCompilation.Coherence.html#34490" class="Bound">p</a> <a id="34492" class="Keyword">with</a> <a id="34497" href="SecureCompilation.Coherence.html#34490" class="Bound">p</a>
  <a id="34501" class="Symbol">...</a> <a id="34505" class="Symbol">|</a> <a id="34507" href="SecureCompilation.Coherence.html#32124" class="InductiveConstructor Operator">[L]</a> <a id="34511" href="SecureCompilation.Coherence.html#1986" class="InductiveConstructor">[1]</a>  <a id="34516" href="SecureCompilation.Coherence.html#34516" class="Bound">R‚âà</a> <a id="34519" href="SecureCompilation.Coherence.html#34519" class="Bound">‚àÉŒì‚âà</a> <a id="34523" href="SecureCompilation.Coherence.html#34523" class="Bound">vad</a> <a id="34527" href="SecureCompilation.Coherence.html#34527" class="Bound">hon</a> <a id="34531" href="SecureCompilation.Coherence.html#34531" class="Bound">d‚äÜ</a> <a id="34534" class="Symbol">=</a> <a id="34536" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
  <a id="34541" class="Symbol">...</a> <a id="34545" class="Symbol">|</a> <a id="34547" href="SecureCompilation.Coherence.html#32124" class="InductiveConstructor Operator">[L]</a> <a id="34551" href="SecureCompilation.Coherence.html#2875" class="InductiveConstructor">[2]</a>  <a id="34556" href="SecureCompilation.Coherence.html#34556" class="Bound">R‚âà</a> <a id="34559" href="SecureCompilation.Coherence.html#34559" class="Bound">‚àÉŒì‚âà</a> <a id="34563" href="SecureCompilation.Coherence.html#34563" class="Bound">as‚â°</a> <a id="34567" href="SecureCompilation.Coherence.html#34567" class="Bound">All‚àâ</a> <a id="34572" href="SecureCompilation.Coherence.html#34572" class="Bound">Hon‚áí</a> <a id="34577" href="SecureCompilation.Coherence.html#34577" class="Bound">‚àÉB</a> <a id="34580" href="SecureCompilation.Coherence.html#34580" class="Bound">h‚â°</a> <a id="34583" href="SecureCompilation.Coherence.html#34583" class="Bound">h‚ààO</a> <a id="34587" href="SecureCompilation.Coherence.html#34587" class="Bound">unique-h</a> <a id="34596" href="SecureCompilation.Coherence.html#34596" class="Bound">h‚ôØsechash</a> <a id="34606" class="Symbol">=</a> <a id="34608" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="34611" class="Comment">{-
  ... | [L] [3]  R‚âà ‚àÉŒì‚âà committedA A‚ààper ‚àÉB = tt
  ... | [L] [4]  R‚âà ‚àÉŒì‚âà fresh-z = tt
  ... | [L] [5]  d‚â° R‚âà ‚àÉŒì‚âà = tt
-}</a>
  <a id="34737" class="Symbol">...</a> <a id="34741" class="Symbol">|</a> <a id="34743" href="SecureCompilation.Coherence.html#32124" class="InductiveConstructor Operator">[L]</a> <a id="34747" href="SecureCompilation.Coherence.html#9941" class="InductiveConstructor">[6]</a>  <a id="34752" href="SecureCompilation.Coherence.html#34752" class="Bound">t‚â°</a> <a id="34755" href="SecureCompilation.Coherence.html#34755" class="Bound">d‚â°</a> <a id="34758" href="SecureCompilation.Coherence.html#34758" class="Bound">R‚âà</a> <a id="34761" href="SecureCompilation.Coherence.html#34761" class="Bound">‚àÉŒì‚âà</a> <a id="34765" href="SecureCompilation.Coherence.html#34765" class="Bound">fresh-y‚Ä≤</a> <a id="34774" href="SecureCompilation.Coherence.html#34774" class="Bound">p‚ü¶Œî‚üß‚â°</a> <a id="34780" href="SecureCompilation.Coherence.html#34780" class="Bound">As‚â°‚àÖ</a> <a id="34785" class="Symbol">=</a> <a id="34787" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="34790" class="Comment">{-
  ... | [L] [7]  R‚âà ‚àÉŒì‚âà fresh-ys ‚àÉB ‚àÉŒ± a‚àà ‚àÉŒª first-Œª·∂ú = tt
  ... | [L] [8]  t‚â° d‚â° R‚âà fresh-xs As‚â°‚àÖ ‚àÉŒì‚âà = tt
  ... | [L] [9]  d‚â° R‚âà ‚àÉŒì‚âà frsg-x As‚â°‚àÖ ‚àÄ‚â§t = tt
  ... | [L] [10] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = tt
  ... | [L] [11] R‚âà ‚àÉŒì‚âà fresh-y = tt
  ... | [L] [12] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = tt
  ... | [L] [13] R‚âà ‚àÉŒì‚âà fresh-ys = tt
  ... | [L] [14] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = tt
  ... | [L] [15] R‚âà ‚àÉŒì‚âà fresh-y = tt
  ... | [R] [16] R‚âà ‚àÉŒì‚âà fresh-y T ‚äÜins T‚àà first-Œª·∂ú ¬¨coh = tt
  ... | [R] [17] R‚âà ‚àÉŒì‚âà T ‚äÜins ¬¨coh = tt
-}</a>
  <a id="35291" class="Symbol">...</a> <a id="35295" class="Symbol">|</a> <a id="35297" href="SecureCompilation.Coherence.html#32124" class="InductiveConstructor Operator">[L]</a> <a id="35301" href="SecureCompilation.Coherence.html#28258" class="InductiveConstructor">[18]</a> <a id="35306" href="SecureCompilation.Coherence.html#35306" class="Bound">Œ¥&gt;0</a> <a id="35310" href="SecureCompilation.Coherence.html#35310" class="Bound">‚àÉŒì‚âà</a> <a id="35314" class="Symbol">=</a> <a id="35316" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
</pre></body></html>