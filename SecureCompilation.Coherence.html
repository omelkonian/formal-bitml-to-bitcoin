<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Coherence</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- {-# OPTIONS -v eta:100 #-}</a>
<a id="31" class="Symbol">{-#</a> <a id="35" class="Keyword">OPTIONS</a> <a id="43" class="Pragma">--auto-inline</a> <a id="57" class="Symbol">#-}</a>
<a id="61" class="Keyword">open</a> <a id="66" class="Keyword">import</a> <a id="73" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="86" class="Keyword">hiding</a> <a id="93" class="Symbol">(</a><a id="94" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="95" class="Symbol">)</a>
<a id="97" class="Keyword">open</a> <a id="102" href="Prelude.Init.html#5562" class="Module">L.Mem</a>
<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="191" class="Keyword">open</a> <a id="196" class="Keyword">import</a> <a id="203" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="382" class="Keyword">open</a> <a id="387" class="Keyword">import</a> <a id="394" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>
<a id="438" class="Keyword">open</a> <a id="443" class="Keyword">import</a> <a id="450" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>

<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="493" class="Keyword">using</a> <a id="499" class="Symbol">(</a><a id="500" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a><a id="507" class="Symbol">)</a>

<a id="510" class="Keyword">module</a> <a id="517" href="SecureCompilation.Coherence.html" class="Module">SecureCompilation.Coherence</a>
  <a id="547" class="Symbol">(</a><a id="548" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a> <a id="560" class="Symbol">:</a> <a id="562" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="565" class="Symbol">)</a>
  <a id="569" class="Symbol">â¦ƒ</a> <a id="571" href="SecureCompilation.Coherence.html#571" class="Bound">_</a> <a id="573" class="Symbol">:</a> <a id="575" href="Prelude.DecEq.Core.html#103" class="Record">DecEq</a> <a id="581" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a> <a id="593" class="Symbol">â¦„</a>
  <a id="597" class="Symbol">(</a><a id="598" href="SecureCompilation.Coherence.html#598" class="Bound">Honest</a> <a id="605" class="Symbol">:</a> <a id="607" href="Data.List.NonEmpty.Base.html#1079" class="Record">Listâº</a> <a id="613" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a><a id="624" class="Symbol">)</a>

  <a id="629" class="Symbol">(</a><a id="630" href="SecureCompilation.Coherence.html#630" class="Bound">finPart</a> <a id="638" class="Symbol">:</a> <a id="640" href="Prelude.Lists.html#26908" class="Function">Finite</a> <a id="647" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a><a id="658" class="Symbol">)</a>
  <a id="662" class="Symbol">(</a><a id="663" href="SecureCompilation.Coherence.html#663" class="Bound">keypairs</a> <a id="672" class="Symbol">:</a> <a id="674" class="Symbol">âˆ€</a> <a id="676" class="Symbol">(</a><a id="677" href="SecureCompilation.Coherence.html#677" class="Bound">A</a> <a id="679" class="Symbol">:</a> <a id="681" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a><a id="692" class="Symbol">)</a> <a id="694" class="Symbol">â†’</a> <a id="696" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="704" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="706" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a><a id="713" class="Symbol">)</a>

  <a id="718" class="Symbol">(</a><a id="719" href="SecureCompilation.Coherence.html#719" class="Bound">Î·</a> <a id="721" class="Symbol">:</a> <a id="723" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a><a id="724" class="Symbol">)</a> <a id="726" class="Comment">-- security parameter</a>
  <a id="750" class="Keyword">where</a>

<a id="757" class="Keyword">open</a> <a id="762" class="Keyword">import</a> <a id="769" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="783" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a> <a id="795" href="SecureCompilation.Coherence.html#598" class="Bound">Honest</a> as <a id="S"></a><a id="805" href="SecureCompilation.Coherence.html#805" class="Module">S</a>
  <a id="809" class="Keyword">hiding</a> <a id="816" class="Symbol">(</a><a id="817" href="Prelude.Closures.html#3164" class="InductiveConstructor Operator">_âˆ</a><a id="819" class="Symbol">;</a> <a id="821" href="Prelude.Closures.html#3065" class="InductiveConstructor Operator">begin_</a><a id="827" class="Symbol">)</a>

<a id="830" class="Keyword">open</a> <a id="835" class="Keyword">import</a> <a id="842" href="ComputationalModel.Strategy.html" class="Module">ComputationalModel.Strategy</a> <a id="870" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a> <a id="882" href="SecureCompilation.Coherence.html#598" class="Bound">Honest</a> <a id="889" href="SecureCompilation.Coherence.html#630" class="Bound">finPart</a> <a id="897" href="SecureCompilation.Coherence.html#663" class="Bound">keypairs</a> as <a id="C"></a><a id="909" href="SecureCompilation.Coherence.html#909" class="Module">C</a>
  <a id="913" class="Keyword">hiding</a> <a id="920" class="Symbol">(</a><a id="921" href="ComputationalModel.Strategy.html#578" class="Function">Hon</a><a id="924" class="Symbol">;</a> <a id="926" href="ComputationalModel.Strategy.html#2324" class="Function">Initial</a><a id="933" class="Symbol">;</a> <a id="935" href="ComputationalModel.Strategy.html#2478" class="Function">Valid</a><a id="940" class="Symbol">;</a> <a id="942" href="ComputationalModel.Strategy.html#4128" class="Field">Î£</a><a id="943" class="Symbol">)</a>
<a id="945" class="Keyword">open</a> <a id="950" class="Keyword">import</a> <a id="957" href="Bitcoin.html" class="Module">Bitcoin</a> <a id="965" class="Symbol">as</a> <a id="968" class="Module">C</a>
  <a id="972" class="Keyword">hiding</a> <a id="979" class="Symbol">(</a><a id="980" href="Bitcoin.BasicTypes.html#313" class="Generalizable">t</a><a id="981" class="Symbol">;</a> <a id="983" href="Bitcoin.BasicTypes.html#315" class="Generalizable">tâ€²</a><a id="985" class="Symbol">;</a> <a id="987" href="Bitcoin.Script.Base.html#917" class="InductiveConstructor">`</a><a id="988" class="Symbol">;</a> <a id="990" href="Bitcoin.Script.Base.html#1293" class="InductiveConstructor Operator">âˆ£_âˆ£</a><a id="993" class="Symbol">;</a> <a id="995" href="Bitcoin.Consistency.html#3116" class="InductiveConstructor">âˆ™</a><a id="996" class="Symbol">)</a>

<a id="999" class="Keyword">open</a> <a id="1004" class="Keyword">import</a> <a id="1011" href="SecureCompilation.Compiler.html" class="Module">SecureCompilation.Compiler</a> <a id="1038" href="SecureCompilation.Coherence.html#548" class="Bound">Participant</a> <a id="1050" href="SecureCompilation.Coherence.html#598" class="Bound">Honest</a> <a id="1057" href="SecureCompilation.Coherence.html#719" class="Bound">Î·</a>


<a id="1061" class="Keyword">private</a>
  <a id="1071" class="Keyword">variable</a>
    <a id="1084" href="SecureCompilation.Coherence.html#1084" class="Generalizable">âŸ¨GâŸ©C</a> <a id="1089" href="SecureCompilation.Coherence.html#1089" class="Generalizable">âŸ¨GâŸ©Câ€²</a> <a id="1095" href="SecureCompilation.Coherence.html#1095" class="Generalizable">âŸ¨GâŸ©Câ€³</a> <a id="1101" class="Symbol">:</a> <a id="1103" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a>
    <a id="1110" href="SecureCompilation.Coherence.html#1110" class="Generalizable">T</a> <a id="1112" href="SecureCompilation.Coherence.html#1112" class="Generalizable">Tâ€²</a> <a id="1115" class="Symbol">:</a> <a id="1117" href="Bitcoin.Tx.Base.html#1255" class="Function">âˆƒTx</a>

    <a id="1126" href="SecureCompilation.Coherence.html#1126" class="Generalizable">ğ•£</a>  <a id="1129" class="Symbol">:</a> <a id="1131" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="1133" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a>
    <a id="1140" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a> <a id="1143" href="SecureCompilation.Coherence.html#1143" class="Generalizable">âˆƒğ•£â€²</a> <a id="1147" class="Symbol">:</a> <a id="1149" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="1151" href="SymbolicModel.Collections.html#5953" class="Record">â„</a>

<a id="1154" class="Keyword">postulate</a>
  <a id="encode"></a><a id="1166" href="SecureCompilation.Coherence.html#1166" class="Postulate">encode</a> <a id="1173" class="Symbol">:</a> <a id="1175" href="SymbolicModel.Collections.html#5421" class="Function">Txout</a> <a id="1181" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="1184" class="Symbol">â†’</a> <a id="1186" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a> <a id="1189" class="Symbol">â†’</a> <a id="1191" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
  <a id="1201" class="Comment">-- ^ encode {G}C as a bitstring, representing each x in it as txout(x)</a>

  <a id="SIGáµ–"></a><a id="1275" href="SecureCompilation.Coherence.html#1275" class="Postulate">SIGáµ–</a> <a id="1280" class="Symbol">:</a> <a id="1282" class="Symbol">âˆ€</a> <a id="1284" class="Symbol">{</a><a id="1285" href="SecureCompilation.Coherence.html#1285" class="Bound">A</a> <a id="1287" class="Symbol">:</a> <a id="1289" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="1292" class="Symbol">}</a> <a id="1294" class="Symbol">â†’</a> <a id="1296" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a> <a id="1298" class="Comment">{- public key -}</a> <a id="1315" class="Symbol">â†’</a> <a id="1317" href="SecureCompilation.Coherence.html#1285" class="Bound">A</a> <a id="1319" class="Symbol">â†’</a> <a id="1321" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a>

  <a id="âˆ£_âˆ£á¶»"></a><a id="1326" href="SecureCompilation.Coherence.html#1326" class="Postulate Operator">âˆ£_âˆ£á¶»</a> <a id="1331" class="Symbol">:</a> <a id="1333" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a> <a id="1335" class="Symbol">â†’</a> <a id="1337" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a>
  <a id="âˆ£_âˆ£áµ"></a><a id="1341" href="SecureCompilation.Coherence.html#1341" class="Postulate Operator">âˆ£_âˆ£áµ</a> <a id="1346" class="Symbol">:</a> <a id="1348" href="ComputationalModel.Strategy.html#790" class="Function">Message</a> <a id="1356" class="Symbol">â†’</a> <a id="1358" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a>

<a id="_-redeemableWith-_"></a><a id="1361" href="SecureCompilation.Coherence.html#1361" class="Function Operator">_-redeemableWith-_</a> <a id="1380" class="Symbol">:</a> <a id="1382" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="1390" class="Symbol">â†’</a> <a id="1392" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1400" class="Symbol">â†’</a> <a id="1402" href="Bitcoin.Tx.Base.html#793" class="Function">âˆƒTxOutput</a>
<a id="1412" href="SecureCompilation.Coherence.html#1412" class="Bound">v</a> <a id="1414" href="SecureCompilation.Coherence.html#1361" class="Function Operator">-redeemableWith-</a> <a id="1431" href="SecureCompilation.Coherence.html#1431" class="Bound">k</a> <a id="1433" class="Symbol">=</a> <a id="1435" href="Bitcoin.Script.Base.html#375" class="InductiveConstructor">Ctx</a> <a id="1439" class="Number">1</a> <a id="1441" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1443" class="Keyword">record</a> <a id="1450" class="Symbol">{</a><a id="1451" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="1457" class="Symbol">=</a> <a id="1459" href="SecureCompilation.Coherence.html#1412" class="Bound">v</a><a id="1460" class="Symbol">;</a>  <a id="1463" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Bitcoin.Script.Base.html#2174" class="InductiveConstructor Operator">Æ›</a> <a id="1477" class="Symbol">(</a><a id="1478" href="Bitcoin.Script.Base.html#1413" class="InductiveConstructor">versig</a> <a id="1485" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1487" href="SecureCompilation.Coherence.html#1431" class="Bound">k</a> <a id="1489" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1491" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1493" href="Data.Fin.html#730" class="Function Operator">#</a> <a id="1495" class="Number">0</a> <a id="1497" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="1498" class="Symbol">)}</a>

<a id="1502" class="Comment">-- T0D0: redefine Message â‰ˆ â„¤ ??</a>
<a id="SIGáµ"></a><a id="1535" href="SecureCompilation.Coherence.html#1535" class="Function">SIGáµ</a> <a id="1540" class="Symbol">:</a> <a id="1542" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1550" class="Symbol">â†’</a> <a id="1552" href="ComputationalModel.Strategy.html#790" class="Function">Message</a> <a id="1560" class="Symbol">â†’</a> <a id="1562" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
<a id="1570" href="SecureCompilation.Coherence.html#1535" class="Function">SIGáµ</a> <a id="1575" href="SecureCompilation.Coherence.html#1575" class="Bound">k</a> <a id="1577" class="Symbol">=</a> <a id="1579" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="1588" href="SecureCompilation.Coherence.html#1575" class="Bound">k</a><a id="1589" class="Symbol">)</a>

<a id="1592" class="Comment">-- [BUG] cannot use `? âŠ†â¦… names â¦† ?` as a coherence hypothesis, need to partially apply the module and apply namesâŠ† everytime :(</a>
<a id="1721" class="Comment">-- [WORKAROUND] Expose instantiated operator to help Agda&#39;s inference</a>
<a id="_âŠ†â¦…áµ–namesá¶œâ¦†_"></a><a id="1791" href="SecureCompilation.Coherence.html#1791" class="Function Operator">_âŠ†â¦…áµ–namesá¶œâ¦†_</a> <a id="1804" class="Symbol">:</a> <a id="1806" href="BitML.Contracts.Types.html#1823" class="Datatype">Precondition</a> <a id="1819" class="Symbol">â†’</a> <a id="1821" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a> <a id="1825" class="Symbol">â†’</a> <a id="1827" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1831" href="SecureCompilation.Coherence.html#1791" class="Function Operator">_âŠ†â¦…áµ–namesá¶œâ¦†_</a> <a id="1844" class="Symbol">=</a> <a id="1846" href="Prelude.Collections.html#1041" class="Function Operator">_âŠ†â¦…</a> <a id="1850" href="BitML.Contracts.Helpers.html#3710" class="Function">names</a> <a id="1856" href="Prelude.Collections.html#1041" class="Function Operator">â¦†_</a>

<a id="1860" class="Comment">-- [Bug]</a>
<a id="_âˆˆâ¦…adsâ¦†_"></a><a id="1869" href="SecureCompilation.Coherence.html#1869" class="Function Operator">_âˆˆâ¦…adsâ¦†_</a> <a id="1878" class="Symbol">:</a> <a id="1880" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a> <a id="1883" class="Symbol">â†’</a> <a id="1885" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a> <a id="1889" class="Symbol">â†’</a> <a id="1891" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1895" href="SecureCompilation.Coherence.html#1895" class="Bound">ad</a> <a id="1898" href="SecureCompilation.Coherence.html#1869" class="Function Operator">âˆˆâ¦…adsâ¦†</a> <a id="1905" href="SecureCompilation.Coherence.html#1905" class="Bound">Î“</a> <a id="1907" class="Symbol">=</a> <a id="1909" href="SecureCompilation.Coherence.html#1895" class="Bound">ad</a> <a id="1912" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="1914" href="BitML.Semantics.Configurations.Helpers.html#5996" class="Function">authorizedHonAds</a> <a id="1931" href="SecureCompilation.Coherence.html#1905" class="Bound">Î“</a>

<a id="1934" class="Comment">-- [BUG] See issue #5464</a>
<a id="_â‰ˆá¶œ_"></a><a id="1959" href="SecureCompilation.Coherence.html#1959" class="Function Operator">_â‰ˆá¶œ_</a> <a id="1964" class="Symbol">=</a> <a id="1966" href="Prelude.Setoid.html#160" class="Field Operator">_â‰ˆ_</a> <a id="1970" class="Symbol">â¦ƒ</a> <a id="1972" href="BitML.Semantics.Configurations.Helpers.html#1085" class="Function">IS-Cfg</a> <a id="1979" class="Symbol">â¦„</a>

<a id="1982" class="Comment">-- ** Types and notation.</a>

<a id="2009" class="Keyword">data</a> <a id="coher"></a><a id="2014" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="2020" class="Symbol">:</a> <a id="2022" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="2024" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="2026" class="Symbol">â†’</a> <a id="2028" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a> <a id="2034" class="Symbol">â†’</a> <a id="2036" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="2041" class="Keyword">data</a> <a id="coherâ‚"></a><a id="2046" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a> <a id="2053" class="Symbol">:</a>
  <a id="2057" class="Symbol">(</a><a id="2058" href="SecureCompilation.Coherence.html#2058" class="Bound">RË¢</a> <a id="2061" class="Symbol">:</a> <a id="2063" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2068" class="Symbol">)</a> <a id="2070" class="Symbol">(</a><a id="2071" href="SecureCompilation.Coherence.html#2071" class="Bound">ğ•’</a> <a id="2073" class="Symbol">:</a> <a id="2075" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="2077" href="SecureCompilation.Coherence.html#2058" class="Bound">RË¢</a> <a id="2080" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="2082" class="Symbol">)</a>
  <a id="2086" class="Symbol">(</a><a id="2087" href="SecureCompilation.Coherence.html#2087" class="Bound">Rá¶œ</a> <a id="2090" class="Symbol">:</a> <a id="2092" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2097" class="Symbol">)</a> <a id="2099" class="Symbol">(</a><a id="2100" href="SecureCompilation.Coherence.html#2100" class="Bound">Î»á¶œ</a> <a id="2103" class="Symbol">:</a> <a id="2105" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2112" class="Symbol">)</a>
  <a id="2116" class="Symbol">â†’</a> <a id="2118" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="2120" class="Symbol">(</a><a id="2121" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="2124" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="2126" href="SecureCompilation.Coherence.html#2058" class="Bound">RË¢</a> <a id="2129" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="2131" href="SecureCompilation.Coherence.html#2071" class="Bound">ğ•’</a><a id="2132" class="Symbol">)</a>
  <a id="2136" class="Symbol">â†’</a> <a id="2138" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="2143" class="Keyword">data</a> <a id="coherâ‚â‚"></a><a id="2148" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="2156" class="Symbol">:</a>
  <a id="2160" class="Symbol">(</a><a id="2161" href="SecureCompilation.Coherence.html#2161" class="Bound">RË¢</a> <a id="2164" class="Symbol">:</a> <a id="2166" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2171" class="Symbol">)</a> <a id="2173" class="Symbol">(</a><a id="2174" href="SecureCompilation.Coherence.html#2174" class="Bound">ğ•’</a> <a id="2176" class="Symbol">:</a> <a id="2178" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="2180" href="SecureCompilation.Coherence.html#2161" class="Bound">RË¢</a> <a id="2183" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="2185" class="Symbol">)</a>
  <a id="2189" class="Symbol">(</a><a id="2190" href="SecureCompilation.Coherence.html#2190" class="Bound">Rá¶œ</a> <a id="2193" class="Symbol">:</a> <a id="2195" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2200" class="Symbol">)</a> <a id="2202" class="Symbol">(</a><a id="2203" href="SecureCompilation.Coherence.html#2203" class="Bound">Î»á¶œ</a> <a id="2206" class="Symbol">:</a> <a id="2208" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2215" class="Symbol">)</a>
  <a id="2219" class="Symbol">â†’</a> <a id="2221" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="2223" class="Symbol">(</a><a id="2224" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="2227" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="2229" href="SecureCompilation.Coherence.html#2161" class="Bound">RË¢</a> <a id="2232" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="2234" href="SecureCompilation.Coherence.html#2174" class="Bound">ğ•’</a><a id="2235" class="Symbol">)</a>
  <a id="2239" class="Symbol">â†’</a> <a id="2241" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="2246" class="Keyword">data</a> <a id="coherâ‚â‚‚"></a><a id="2251" href="SecureCompilation.Coherence.html#2251" class="Datatype">coherâ‚â‚‚</a> <a id="2259" class="Symbol">:</a>
  <a id="2263" class="Symbol">(</a><a id="2264" href="SecureCompilation.Coherence.html#2264" class="Bound">RË¢</a> <a id="2267" class="Symbol">:</a> <a id="2269" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2274" class="Symbol">)</a> <a id="2276" class="Symbol">(</a><a id="2277" href="SecureCompilation.Coherence.html#2277" class="Bound">ğ•’</a> <a id="2279" class="Symbol">:</a> <a id="2281" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="2283" href="SecureCompilation.Coherence.html#2264" class="Bound">RË¢</a> <a id="2286" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="2288" class="Symbol">)</a>
  <a id="2292" class="Symbol">(</a><a id="2293" href="SecureCompilation.Coherence.html#2293" class="Bound">Rá¶œ</a> <a id="2296" class="Symbol">:</a> <a id="2298" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2303" class="Symbol">)</a> <a id="2305" class="Symbol">(</a><a id="2306" href="SecureCompilation.Coherence.html#2306" class="Bound">Î»á¶œ</a> <a id="2309" class="Symbol">:</a> <a id="2311" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2318" class="Symbol">)</a>
  <a id="2322" class="Symbol">â†’</a> <a id="2324" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="2326" class="Symbol">(</a><a id="2327" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="2330" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="2332" href="SecureCompilation.Coherence.html#2264" class="Bound">RË¢</a> <a id="2335" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="2337" href="SecureCompilation.Coherence.html#2277" class="Bound">ğ•’</a><a id="2338" class="Symbol">)</a>
  <a id="2342" class="Symbol">â†’</a> <a id="2344" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="2349" class="Keyword">data</a> <a id="coherâ‚‚"></a><a id="2354" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="2361" class="Symbol">(</a><a id="2362" href="SecureCompilation.Coherence.html#2362" class="Bound">RË¢</a> <a id="2365" class="Symbol">:</a> <a id="2367" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2372" class="Symbol">)</a> <a id="2374" class="Symbol">(</a><a id="2375" href="SecureCompilation.Coherence.html#2375" class="Bound">txout</a> <a id="2381" class="Symbol">:</a> <a id="2383" href="SymbolicModel.Collections.html#5421" class="Function">Txout</a> <a id="2389" href="SecureCompilation.Coherence.html#2362" class="Bound">RË¢</a><a id="2391" class="Symbol">)</a> <a id="2393" class="Symbol">:</a> <a id="2395" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a> <a id="2403" class="Symbol">â†’</a> <a id="2405" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="2410" class="Keyword">data</a> <a id="2415" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="2421" class="Keyword">where</a>

  <a id="coher.base"></a><a id="2430" href="SecureCompilation.Coherence.html#2430" class="InductiveConstructor">base</a> <a id="2435" class="Symbol">:</a> <a id="2437" class="Keyword">let</a> <a id="2441" href="SecureCompilation.Coherence.html#2441" class="Bound">RË¢</a> <a id="2444" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2446" href="SecureCompilation.Coherence.html#2446" class="Bound">ğ•£</a> <a id="2448" class="Symbol">=</a> <a id="2450" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a><a id="2452" class="Symbol">;</a> <a id="2454" class="Keyword">open</a> <a id="2459" href="SymbolicModel.Collections.html#5953" class="Module">â„</a> <a id="2461" href="SecureCompilation.Coherence.html#2446" class="Bound">ğ•£</a> <a id="2463" class="Keyword">in</a>

      <a id="2473" class="Comment">-- (i) RË¢ = Î“â‚€ âˆ£ 0, with Î“â‚€ initial</a>
      <a id="2515" class="Symbol">(</a><a id="2516" href="SecureCompilation.Coherence.html#2516" class="Bound">init</a> <a id="2521" class="Symbol">:</a> <a id="2523" href="Prelude.Traces.html#283" class="Field">Initial</a> <a id="2531" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Î“â‚€</a><a id="2533" class="Symbol">)</a>
    <a id="2539" class="Symbol">â†’</a> <a id="2541" class="Symbol">(</a><a id="2542" href="SecureCompilation.Coherence.html#2542" class="Bound">Râ‰ˆ</a> <a id="2545" class="Symbol">:</a> <a id="2547" href="SecureCompilation.Coherence.html#2441" class="Bound">RË¢</a> <a id="2550" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="2552" class="Symbol">((</a><a id="2554" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Î“â‚€</a> <a id="2557" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="2560" class="Number">0</a><a id="2561" class="Symbol">)</a> <a id="2563" href="SymbolicModel.Run.html#865" class="Function Operator">âˆâŠ£</a> <a id="2566" class="Symbol">(</a><a id="2567" href="SecureCompilation.Coherence.html#2516" class="Bound">init</a> <a id="2572" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2574" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2578" class="Symbol">)))</a>
      <a id="2588" class="Comment">-- (ii) Rá¶œ = Tâ‚€ â‹¯ initial</a>
    <a id="2618" class="Symbol">â†’</a> <a id="2620" class="Symbol">(</a><a id="2621" href="SecureCompilation.Coherence.html#2621" class="Bound">cinit</a> <a id="2627" class="Symbol">:</a> <a id="2629" href="ComputationalModel.Strategy.html#2324" class="Function">C.Initial</a> <a id="2639" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="2641" class="Symbol">)</a>
    <a id="2647" class="Symbol">â†’</a> <a id="2649" class="Keyword">let</a> <a id="2653" href="SecureCompilation.Coherence.html#2653" class="Bound">âˆƒTâ‚€</a> <a id="2657" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2659" class="Symbol">_</a> <a id="2661" class="Symbol">=</a> <a id="2663" href="SecureCompilation.Coherence.html#2621" class="Bound">cinit</a><a id="2668" class="Symbol">;</a> <a id="2670" class="Symbol">_</a> <a id="2672" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2674" href="SecureCompilation.Coherence.html#2674" class="Bound">o</a> <a id="2676" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2678" href="SecureCompilation.Coherence.html#2678" class="Bound">Tâ‚€</a> <a id="2681" class="Symbol">=</a> <a id="2683" href="SecureCompilation.Coherence.html#2653" class="Bound">âˆƒTâ‚€</a> <a id="2687" class="Keyword">in</a>

      <a id="2697" class="Comment">-- (iii) generation of public keys, we do not consider that here</a>
      <a id="2768" class="Comment">-- [T0D0] is our idealistic assumption reasonable?? -- ask BitML authors</a>

      <a id="2848" class="Comment">-- (iv) txout { âŸ¨ A , v âŸ©â‚“ âˆˆ Î“â‚€ â†¦ Tâ‚€{value = $ v, spendable with KÌ‚(A)(râ‚)} âˆˆ Tâ‚€ }</a>
      <a id="2937" class="Symbol">(âˆ€</a> <a id="2940" class="Symbol">{</a><a id="2941" href="SecureCompilation.Coherence.html#2941" class="Bound">A</a> <a id="2943" href="SecureCompilation.Coherence.html#2943" class="Bound">v</a> <a id="2945" href="SecureCompilation.Coherence.html#2945" class="Bound">x</a><a id="2946" class="Symbol">}</a> <a id="2948" class="Symbol">(</a><a id="2949" href="SecureCompilation.Coherence.html#2949" class="Bound">dâˆˆ</a> <a id="2952" class="Symbol">:</a> <a id="2954" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">âŸ¨</a> <a id="2956" href="SecureCompilation.Coherence.html#2941" class="Bound">A</a> <a id="2958" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="2962" href="SecureCompilation.Coherence.html#2943" class="Bound">v</a> <a id="2964" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">âŸ©at</a> <a id="2968" href="SecureCompilation.Coherence.html#2945" class="Bound">x</a> <a id="2970" href="BitML.Semantics.Configurations.Helpers.html#2116" class="Function Operator">âˆˆá¶œ</a> <a id="2973" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Î“â‚€</a><a id="2975" class="Symbol">)</a>
         <a id="2986" class="Symbol">â†’</a> <a id="2988" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="2990" class="Symbol">Î»</a> <a id="2992" href="SecureCompilation.Coherence.html#2992" class="Bound">oáµ¢</a>
         <a id="3004" class="Symbol">â†’</a> <a id="3006" class="Keyword">let</a>
             <a id="3023" href="SecureCompilation.Coherence.html#3023" class="Bound">xâˆˆ</a> <a id="3026" class="Symbol">:</a> <a id="3028" href="SecureCompilation.Coherence.html#2945" class="Bound">x</a> <a id="3030" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="3032" href="BitML.Contracts.Helpers.html#3836" class="Function">namesÊ³</a> <a id="3039" href="SecureCompilation.Coherence.html#2441" class="Bound">RË¢</a>
             <a id="3055" href="SecureCompilation.Coherence.html#3023" class="Bound">xâˆˆ</a> <a id="3058" class="Symbol">=</a> <a id="3060" href="Prelude.General.html#1253" class="Function">âŸª</a> <a id="3062" class="Symbol">(Î»</a> <a id="3065" href="SecureCompilation.Coherence.html#3065" class="Bound">â—†</a> <a id="3067" class="Symbol">â†’</a> <a id="3069" href="SecureCompilation.Coherence.html#2945" class="Bound">x</a> <a id="3071" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="3073" href="BitML.Contracts.Helpers.html#3836" class="Function">namesÊ³</a> <a id="3080" href="SecureCompilation.Coherence.html#3065" class="Bound">â—†</a><a id="3081" class="Symbol">)</a> <a id="3083" href="Prelude.General.html#1253" class="Function">âŸ«</a> <a id="3085" href="SecureCompilation.Coherence.html#2542" class="Bound">Râ‰ˆ</a>
               <a id="3103" href="Prelude.General.html#1253" class="Function">~:</a> <a id="3106" href="Prelude.General.html#1253" class="Function">âŸª</a> <a id="3108" class="Symbol">(Î»</a> <a id="3111" href="SecureCompilation.Coherence.html#3111" class="Bound">â—†</a> <a id="3113" class="Symbol">â†’</a> <a id="3115" href="SecureCompilation.Coherence.html#2945" class="Bound">x</a> <a id="3117" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="3119" href="SecureCompilation.Coherence.html#3111" class="Bound">â—†</a><a id="3120" class="Symbol">)</a> <a id="3122" href="Prelude.General.html#1253" class="Function">âŸ«</a> <a id="3124" class="Symbol">(</a><a id="3125" href="SymbolicModel.Collections.html#4847" class="Function">namesÊ³-âˆ</a> <a id="3134" class="Symbol">{</a><a id="3135" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Î“â‚€</a><a id="3137" class="Symbol">}{</a><a id="3139" href="SecureCompilation.Coherence.html#2516" class="Bound">init</a><a id="3143" class="Symbol">})</a>
               <a id="3161" href="Prelude.General.html#1253" class="Function">~:</a> <a id="3164" href="BitML.Semantics.Configurations.Helpers.html#9713" class="Function">depositâˆˆÎ“â‡’namesÊ³</a> <a id="3181" class="Symbol">{</a><a id="3182" class="Argument">Î“</a> <a id="3184" class="Symbol">=</a> <a id="3186" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Î“â‚€</a><a id="3188" class="Symbol">}</a> <a id="3190" href="SecureCompilation.Coherence.html#2949" class="Bound">dâˆˆ</a>
           <a id="3204" class="Keyword">in</a>
             <a id="3220" class="Symbol">(</a><a id="3221" href="SymbolicModel.Collections.html#6027" class="Function">txoutâ€²</a> <a id="3228" href="SecureCompilation.Coherence.html#3023" class="Bound">xâˆˆ</a> <a id="3231" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="3233" href="SecureCompilation.Coherence.html#2653" class="Bound">âˆƒTâ‚€</a> <a id="3237" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="3240" href="SecureCompilation.Coherence.html#2992" class="Bound">oáµ¢</a><a id="3242" class="Symbol">)</a> <a id="3244" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="3246" class="Symbol">(</a><a id="3247" href="SecureCompilation.Coherence.html#2678" class="Bound">Tâ‚€</a> <a id="3250" href="Bitcoin.Tx.Base.html#2139" class="Function Operator">â€¼áµ’</a> <a id="3253" href="SecureCompilation.Coherence.html#2992" class="Bound">oáµ¢</a> <a id="3256" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="3258" href="SecureCompilation.Coherence.html#2943" class="Bound">v</a> <a id="3260" href="SecureCompilation.Coherence.html#1361" class="Function Operator">-redeemableWith-</a> <a id="3277" href="ComputationalModel.KeyPairs.html#297" class="Function">KÌ‚</a> <a id="3280" href="SecureCompilation.Coherence.html#2941" class="Bound">A</a><a id="3281" class="Symbol">)</a>
      <a id="3289" class="Symbol">)</a>
      <a id="3297" class="Comment">-- (v) dom sechash = âˆ…</a>
    <a id="3324" class="Symbol">â†’</a> <a id="3326" href="Prelude.Lists.html#13215" class="Function">dom</a> <a id="3330" href="SymbolicModel.Collections.html#6050" class="Function">sechashâ€²</a> <a id="3339" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="3341" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
      <a id="3350" class="Comment">-- (vi) dom Îº = âˆ…</a>
    <a id="3372" class="Symbol">â†’</a> <a id="3374" href="Prelude.Lists.html#13215" class="Function">dom</a> <a id="3378" href="SymbolicModel.Collections.html#6075" class="Function">Îºâ€²</a> <a id="3381" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="3383" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
      <a id="3392" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="3469" class="Symbol">â†’</a> <a id="3471" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3477" class="Symbol">(</a><a id="3478" href="SecureCompilation.Coherence.html#2441" class="Bound">RË¢</a> <a id="3481" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3483" href="SecureCompilation.Coherence.html#2446" class="Bound">ğ•£</a><a id="3484" class="Symbol">)</a> <a id="3486" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a>

  <a id="coher.stepâ‚"></a><a id="3492" href="SecureCompilation.Coherence.html#3492" class="InductiveConstructor">stepâ‚</a> <a id="3498" class="Symbol">:</a> <a id="3500" class="Keyword">let</a> <a id="3504" href="SecureCompilation.Coherence.html#3504" class="Bound">RË¢</a> <a id="3507" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3509" href="SecureCompilation.Coherence.html#3509" class="Bound">ğ•£</a> <a id="3511" class="Symbol">=</a> <a id="3513" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a> <a id="3516" class="Keyword">in</a>
        <a id="3527" class="Symbol">âˆ€</a> <a id="3529" class="Symbol">{</a><a id="3530" href="SecureCompilation.Coherence.html#3530" class="Bound">ğ•’</a> <a id="3532" class="Symbol">:</a> <a id="3534" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="3536" href="SecureCompilation.Coherence.html#3504" class="Bound">RË¢</a> <a id="3539" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="3541" class="Symbol">}</a> <a id="3543" class="Symbol">â†’</a>
          <a id="3555" class="Keyword">let</a> <a id="3559" href="SecureCompilation.Coherence.html#3559" class="Bound">RË¢â€²</a> <a id="3563" class="Symbol">=</a> <a id="3565" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="3568" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="3570" href="SecureCompilation.Coherence.html#3504" class="Bound">RË¢</a> <a id="3573" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="3575" href="SecureCompilation.Coherence.html#3530" class="Bound">ğ•’</a> <a id="3577" class="Keyword">in</a>
        <a id="3588" class="Symbol">âˆ€</a> <a id="3590" class="Symbol">{</a><a id="3591" href="SecureCompilation.Coherence.html#3591" class="Bound">ğ•£â€²</a> <a id="3594" class="Symbol">:</a> <a id="3596" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="3598" href="SecureCompilation.Coherence.html#3559" class="Bound">RË¢â€²</a><a id="3601" class="Symbol">}</a> <a id="3603" class="Symbol">â†’</a>

      <a id="3612" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3618" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a> <a id="3621" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a>
    <a id="3628" class="Symbol">â†’</a> <a id="3630" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a> <a id="3637" href="SecureCompilation.Coherence.html#3504" class="Bound">RË¢</a> <a id="3640" href="SecureCompilation.Coherence.html#3530" class="Bound">ğ•’</a> <a id="3642" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="3645" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="3648" href="SecureCompilation.Coherence.html#3591" class="Bound">ğ•£â€²</a>
      <a id="3657" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="3734" class="Symbol">â†’</a> <a id="3736" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3742" href="SecureCompilation.Coherence.html#1143" class="Generalizable">âˆƒğ•£â€²</a> <a id="3746" class="Symbol">(</a><a id="3747" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="3750" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">âˆ·</a> <a id="3752" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="3754" class="Symbol">)</a>

  <a id="coher.stepâ‚‚"></a><a id="3759" href="SecureCompilation.Coherence.html#3759" class="InductiveConstructor">stepâ‚‚</a> <a id="3765" class="Symbol">:</a> <a id="3767" class="Keyword">let</a> <a id="3771" href="SecureCompilation.Coherence.html#3771" class="Bound">RË¢</a> <a id="3774" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3776" href="SecureCompilation.Coherence.html#3776" class="Bound">ğ•£</a> <a id="3778" class="Symbol">=</a> <a id="3780" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a><a id="3782" class="Symbol">;</a> <a id="3784" class="Keyword">open</a> <a id="3789" href="SymbolicModel.Collections.html#5953" class="Module">â„</a> <a id="3791" href="SecureCompilation.Coherence.html#3776" class="Bound">ğ•£</a> <a id="3793" class="Keyword">in</a>

      <a id="3803" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3809" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a> <a id="3812" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a>
    <a id="3819" class="Symbol">â†’</a> <a id="3821" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="3828" href="SecureCompilation.Coherence.html#3771" class="Bound">RË¢</a> <a id="3831" href="SymbolicModel.Collections.html#6027" class="Function">txoutâ€²</a> <a id="3838" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a>
      <a id="3847" class="Comment">----------------------------------------</a>
    <a id="3892" class="Symbol">â†’</a> <a id="3894" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3900" href="SecureCompilation.Coherence.html#1140" class="Generalizable">âˆƒğ•£</a> <a id="3903" class="Symbol">(</a><a id="3904" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="3907" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">âˆ·</a> <a id="3909" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="3911" class="Symbol">)</a>

<a id="_~_"></a><a id="3914" href="SecureCompilation.Coherence.html#3914" class="Function Operator">_~_</a> <a id="_â‰_"></a><a id="3918" href="SecureCompilation.Coherence.html#3918" class="Function Operator">_â‰_</a> <a id="3922" class="Symbol">:</a> <a id="3924" href="SymbolicModel.Run.html#706" class="Function">S.Run</a> <a id="3930" class="Symbol">â†’</a> <a id="3932" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a> <a id="3938" class="Symbol">â†’</a> <a id="3940" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3944" href="SecureCompilation.Coherence.html#3944" class="Bound">RË¢</a> <a id="3947" href="SecureCompilation.Coherence.html#3914" class="Function Operator">~</a> <a id="3949" href="SecureCompilation.Coherence.html#3949" class="Bound">Rá¶œ</a> <a id="3952" class="Symbol">=</a> <a id="3954" href="Data.Product.html#1806" class="Function">âˆƒ[</a> <a id="3957" href="SecureCompilation.Coherence.html#3957" class="Bound">ğ•£</a> <a id="3959" href="Data.Product.html#1806" class="Function">]</a> <a id="3961" href="SecureCompilation.Coherence.html#2014" class="Datatype">coher</a> <a id="3967" class="Symbol">(</a><a id="3968" href="SecureCompilation.Coherence.html#3944" class="Bound">RË¢</a> <a id="3971" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3973" href="SecureCompilation.Coherence.html#3957" class="Bound">ğ•£</a><a id="3974" class="Symbol">)</a> <a id="3976" href="SecureCompilation.Coherence.html#3949" class="Bound">Rá¶œ</a>
<a id="3979" href="SecureCompilation.Coherence.html#3979" class="Bound">RË¢</a> <a id="3982" href="SecureCompilation.Coherence.html#3918" class="Function Operator">â‰</a> <a id="3984" href="SecureCompilation.Coherence.html#3984" class="Bound">Rá¶œ</a> <a id="3987" class="Symbol">=</a> <a id="3989" href="Relation.Nullary.html#656" class="Function Operator">Â¬</a> <a id="3991" href="SecureCompilation.Coherence.html#3979" class="Bound">RË¢</a> <a id="3994" href="SecureCompilation.Coherence.html#3914" class="Function Operator">~</a> <a id="3996" href="SecureCompilation.Coherence.html#3984" class="Bound">Rá¶œ</a>

<a id="4000" class="Comment">-- ** Definitions.</a>
<a id="4019" class="Keyword">data</a> <a id="4024" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a> <a id="4031" class="Keyword">where</a>
  <a id="coherâ‚.[L]"></a><a id="4039" href="SecureCompilation.Coherence.html#4039" class="InductiveConstructor">[L]</a> <a id="4043" class="Symbol">:</a> <a id="4045" class="Symbol">âˆ€</a> <a id="4047" class="Symbol">{</a><a id="4048" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a><a id="4050" class="Symbol">}</a> <a id="4052" class="Symbol">{</a><a id="4053" href="SecureCompilation.Coherence.html#4053" class="Bound">ğ•£</a> <a id="4055" class="Symbol">:</a> <a id="4057" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="4059" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a><a id="4061" class="Symbol">}</a> <a id="4063" class="Symbol">{</a><a id="4064" href="SecureCompilation.Coherence.html#4064" class="Bound">ğ•’</a> <a id="4066" class="Symbol">:</a> <a id="4068" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="4070" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a> <a id="4073" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="4075" class="Symbol">}</a> <a id="4077" class="Symbol">â†’</a> <a id="4079" class="Keyword">let</a> <a id="4083" href="SecureCompilation.Coherence.html#4083" class="Bound">RË¢â€²</a> <a id="4087" class="Symbol">=</a> <a id="4089" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="4092" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="4094" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a> <a id="4097" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="4099" href="SecureCompilation.Coherence.html#4064" class="Bound">ğ•’</a> <a id="4101" class="Keyword">in</a>
        <a id="4112" class="Symbol">âˆ€</a> <a id="4114" class="Symbol">{</a><a id="4115" href="SecureCompilation.Coherence.html#4115" class="Bound">ğ•£â€²</a> <a id="4118" class="Symbol">:</a> <a id="4120" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="4122" href="SecureCompilation.Coherence.html#4083" class="Bound">RË¢â€²</a><a id="4125" class="Symbol">}</a>
    <a id="4131" class="Symbol">â†’</a> <a id="4133" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="4141" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a> <a id="4144" href="SecureCompilation.Coherence.html#4064" class="Bound">ğ•’</a> <a id="4146" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="4149" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="4152" href="SecureCompilation.Coherence.html#4115" class="Bound">ğ•£â€²</a>
    <a id="4159" class="Symbol">â†’</a> <a id="4161" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a>  <a id="4169" href="SecureCompilation.Coherence.html#4048" class="Bound">RË¢</a> <a id="4172" href="SecureCompilation.Coherence.html#4064" class="Bound">ğ•’</a> <a id="4174" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="4177" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="4180" href="SecureCompilation.Coherence.html#4115" class="Bound">ğ•£â€²</a>

  <a id="coherâ‚.[R]"></a><a id="4186" href="SecureCompilation.Coherence.html#4186" class="InductiveConstructor">[R]</a> <a id="4190" class="Symbol">:</a> <a id="4192" class="Symbol">âˆ€</a> <a id="4194" class="Symbol">{</a><a id="4195" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a><a id="4197" class="Symbol">}</a> <a id="4199" class="Symbol">{</a><a id="4200" href="SecureCompilation.Coherence.html#4200" class="Bound">ğ•£</a> <a id="4202" class="Symbol">:</a> <a id="4204" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="4206" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a><a id="4208" class="Symbol">}</a> <a id="4210" class="Symbol">{</a><a id="4211" href="SecureCompilation.Coherence.html#4211" class="Bound">ğ•’</a> <a id="4213" class="Symbol">:</a> <a id="4215" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="4217" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a> <a id="4220" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a><a id="4222" class="Symbol">}</a> <a id="4224" class="Symbol">â†’</a> <a id="4226" class="Keyword">let</a> <a id="4230" href="SecureCompilation.Coherence.html#4230" class="Bound">RË¢â€²</a> <a id="4234" class="Symbol">=</a> <a id="4236" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Î“â‚œ</a> <a id="4239" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="4241" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a> <a id="4244" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="4246" href="SecureCompilation.Coherence.html#4211" class="Bound">ğ•’</a> <a id="4248" class="Keyword">in</a>
        <a id="4259" class="Symbol">âˆ€</a> <a id="4261" class="Symbol">{</a><a id="4262" href="SecureCompilation.Coherence.html#4262" class="Bound">ğ•£â€²</a> <a id="4265" class="Symbol">:</a> <a id="4267" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="4269" href="SecureCompilation.Coherence.html#4230" class="Bound">RË¢â€²</a><a id="4272" class="Symbol">}</a>
    <a id="4278" class="Symbol">â†’</a> <a id="4280" href="SecureCompilation.Coherence.html#2251" class="Datatype">coherâ‚â‚‚</a> <a id="4288" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a> <a id="4291" href="SecureCompilation.Coherence.html#4211" class="Bound">ğ•’</a> <a id="4293" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="4296" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="4299" href="SecureCompilation.Coherence.html#4262" class="Bound">ğ•£â€²</a>
    <a id="4306" class="Symbol">â†’</a> <a id="4308" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a>  <a id="4316" href="SecureCompilation.Coherence.html#4195" class="Bound">RË¢</a> <a id="4319" href="SecureCompilation.Coherence.html#4211" class="Bound">ğ•’</a> <a id="4321" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="4324" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="4327" href="SecureCompilation.Coherence.html#4262" class="Bound">ğ•£â€²</a>


<a id="4332" class="Keyword">data</a> <a id="4337" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="4345" class="Keyword">where</a>
  <a id="4353" class="Comment">-- ** Advertising a contract</a>
  <a id="coherâ‚â‚.[1]"></a><a id="4384" href="SecureCompilation.Coherence.html#4384" class="InductiveConstructor">[1]</a> <a id="4388" class="Symbol">:</a> <a id="4390" class="Symbol">âˆ€</a> <a id="4392" class="Symbol">{</a><a id="4393" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="4398" class="Symbol">:</a> <a id="4400" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a><a id="4402" class="Symbol">}</a> <a id="4404" class="Symbol">{</a><a id="4405" href="SecureCompilation.Coherence.html#4405" class="Bound">ğ•£</a> <a id="4407" class="Symbol">:</a> <a id="4409" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="4411" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a><a id="4413" class="Symbol">}</a> <a id="4415" class="Symbol">â†’</a> <a id="4417" class="Comment">-- [BUG] cannot use generalised variable âŸ¨GâŸ©C</a>
      <a id="4469" class="Keyword">let</a>
        <a id="4481" class="Keyword">open</a> <a id="4486" href="SymbolicModel.Collections.html#5953" class="Module">â„</a> <a id="4488" href="SecureCompilation.Coherence.html#4405" class="Bound">ğ•£</a>
        <a id="4498" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ¨</a> <a id="4500" href="SecureCompilation.Coherence.html#4500" class="Bound">G</a> <a id="4502" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ©</a> <a id="4504" href="SecureCompilation.Coherence.html#4504" class="Bound">C</a> <a id="4506" class="Symbol">=</a> <a id="4508" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="4513" class="Symbol">;</a> <a id="4515" href="SecureCompilation.Coherence.html#4515" class="Bound">partG</a> <a id="4521" class="Symbol">=</a> <a id="4523" href="BitML.Contracts.Helpers.html#2611" class="Function">nub-participants</a> <a id="4540" href="SecureCompilation.Coherence.html#4500" class="Bound">G</a>
        <a id="4550" href="SecureCompilation.Coherence.html#4550" class="Bound">Î“â‚œ</a> <a id="4553" class="Symbol">=</a> <a id="4555" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Î“</a> <a id="4557" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="4560" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
      <a id="4568" class="Keyword">in</a>
      <a id="4577" class="Symbol">(</a><a id="4578" href="SecureCompilation.Coherence.html#4578" class="Bound">Râ‰ˆ</a> <a id="4581" class="Symbol">:</a> <a id="4583" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="4586" href="SymbolicModel.Run.html#1482" class="Function Operator">â‰ˆâ‹¯</a> <a id="4589" href="SecureCompilation.Coherence.html#4550" class="Bound">Î“â‚œ</a><a id="4591" class="Symbol">)</a> <a id="4593" class="Symbol">â†’</a>
      <a id="4601" class="Keyword">let</a>
        <a id="4613" href="SecureCompilation.Coherence.html#4613" class="Bound">Î±</a>   <a id="4617" class="Symbol">=</a> <a id="4619" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">advertiseâ¦…</a> <a id="4630" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="4635" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">â¦†</a>
        <a id="4645" href="SecureCompilation.Coherence.html#4645" class="Bound">Î“â€²</a>  <a id="4649" class="Symbol">=</a> <a id="4651" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="4653" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="4658" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="4660" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Î“</a>
        <a id="4670" href="SecureCompilation.Coherence.html#4670" class="Bound">tâ€²</a>  <a id="4674" class="Symbol">=</a> <a id="4676" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="4686" href="SecureCompilation.Coherence.html#4686" class="Bound">Î“â‚œâ€²</a> <a id="4690" class="Symbol">=</a> <a id="4692" href="SecureCompilation.Coherence.html#4645" class="Bound">Î“â€²</a> <a id="4695" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="4698" href="SecureCompilation.Coherence.html#4670" class="Bound">tâ€²</a>

        <a id="4710" href="SecureCompilation.Coherence.html#4710" class="Bound">C</a>  <a id="4713" class="Symbol">=</a> <a id="4715" href="SecureCompilation.Coherence.html#1166" class="Postulate">encode</a> <a id="4722" class="Symbol">{</a><a id="4723" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a><a id="4725" class="Symbol">}</a> <a id="4727" href="SymbolicModel.Collections.html#6027" class="Field">txoutâ€²</a> <a id="4734" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a>
        <a id="4747" href="SecureCompilation.Coherence.html#4747" class="Bound">Î»á¶œ</a> <a id="4750" class="Symbol">=</a> <a id="4752" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="4754" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="4758" href="SecureCompilation.Coherence.html#4710" class="Bound">C</a>
      <a id="4766" class="Keyword">in</a>
      <a id="4775" class="Symbol">(</a><a id="4776" href="SecureCompilation.Coherence.html#4776" class="Bound">âˆƒÎ“â‰ˆ</a> <a id="4780" class="Symbol">:</a> <a id="4782" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="4784" class="Symbol">(</a><a id="4785" href="SecureCompilation.Coherence.html#1959" class="Function Operator">_â‰ˆá¶œ</a> <a id="4789" href="SecureCompilation.Coherence.html#4645" class="Bound">Î“â€²</a><a id="4791" class="Symbol">))</a>
      <a id="4800" class="Comment">-- Hypotheses from [C-Advertise]</a>
      <a id="4839" class="Symbol">(</a><a id="4840" href="SecureCompilation.Coherence.html#4840" class="Bound">vad</a> <a id="4844" class="Symbol">:</a> <a id="4846" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="4852" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a><a id="4856" class="Symbol">)</a>
      <a id="4864" class="Symbol">(</a><a id="4865" href="SecureCompilation.Coherence.html#4865" class="Bound">hon</a> <a id="4869" class="Symbol">:</a> <a id="4871" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="4875" class="Symbol">(</a><a id="4876" href="Data.List.Membership.Setoid.html#887" class="Function Operator">_âˆˆ</a> <a id="4879" href="BitML.Contracts.Types.html#482" class="Function">Hon</a><a id="4882" class="Symbol">)</a> <a id="4884" href="SecureCompilation.Coherence.html#4515" class="Bound">partG</a><a id="4889" class="Symbol">)</a>
      <a id="4897" class="Symbol">(</a><a id="4898" href="SecureCompilation.Coherence.html#4898" class="Bound">dâŠ†</a>  <a id="4902" class="Symbol">:</a> <a id="4904" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="4909" href="Prelude.Collections.html#1041" class="Function Operator">âŠ†â¦…</a> <a id="4912" href="BitML.Contracts.Helpers.html#6482" class="Function">deposits</a> <a id="4921" href="Prelude.Collections.html#1041" class="Function Operator">â¦†</a> <a id="4923" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Î“</a><a id="4924" class="Symbol">)</a> <a id="4926" class="Symbol">â†’</a>
      <a id="4934" class="Keyword">let</a>
        <a id="4946" href="SecureCompilation.Coherence.html#4946" class="Bound">Î“â†’Î“â€²</a> <a id="4951" class="Symbol">:</a> <a id="4953" href="SecureCompilation.Coherence.html#4550" class="Bound">Î“â‚œ</a> <a id="4956" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">â€”[</a> <a id="4959" href="SecureCompilation.Coherence.html#4613" class="Bound">Î±</a> <a id="4961" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">]â†’â‚œ</a> <a id="4965" href="SecureCompilation.Coherence.html#4686" class="Bound">Î“â‚œâ€²</a>
        <a id="4977" href="SecureCompilation.Coherence.html#4946" class="Bound">Î“â†’Î“â€²</a> <a id="4982" class="Symbol">=</a> <a id="4984" href="BitML.Semantics.InferenceRules.html#8583" class="InductiveConstructor">[Action]</a> <a id="4993" class="Symbol">(</a><a id="4994" href="BitML.Semantics.InferenceRules.html#3751" class="InductiveConstructor">[C-Advertise]</a> <a id="5008" href="SecureCompilation.Coherence.html#4840" class="Bound">vad</a> <a id="5012" href="SecureCompilation.Coherence.html#4865" class="Bound">hon</a> <a id="5016" href="SecureCompilation.Coherence.html#4898" class="Bound">dâŠ†</a><a id="5018" class="Symbol">)</a> <a id="5020" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="5034" class="Comment">-- txoutâ€² = txout, sechashâ€² = sechash, Îºâ€² = Îº</a>
        <a id="5088" class="Keyword">open</a> <a id="5093" href="SymbolicModel.Helpers.html#4371" class="Module">Hâ‚</a> <a id="5096" class="Symbol">{</a><a id="5097" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a><a id="5099" class="Symbol">}</a> <a id="5101" href="SecureCompilation.Coherence.html#4405" class="Bound">ğ•£</a> <a id="5103" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="5105" href="SecureCompilation.Coherence.html#4613" class="Bound">Î±</a> <a id="5107" href="SecureCompilation.Coherence.html#4670" class="Bound">tâ€²</a> <a id="5110" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Î“</a> <a id="5112" href="SecureCompilation.Coherence.html#4578" class="Bound">Râ‰ˆ</a> <a id="5115" href="SecureCompilation.Coherence.html#4393" class="Bound">âŸ¨GâŸ©C</a> <a id="5120" href="SecureCompilation.Coherence.html#4946" class="Bound">Î“â†’Î“â€²</a> <a id="5125" href="SecureCompilation.Coherence.html#4776" class="Bound">âˆƒÎ“â‰ˆ</a>
      <a id="5135" class="Keyword">in</a>
      <a id="5144" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
      <a id="5223" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="5231" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="5234" href="SymbolicModel.Helpers.html#1546" class="Function">ğ•’</a> <a id="5236" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="5239" href="SecureCompilation.Coherence.html#4747" class="Bound">Î»á¶œ</a> <a id="5242" href="SymbolicModel.Helpers.html#2255" class="Function">ğ•£â€²</a>
      <a id="5251" class="Comment">-- coherâ‚â‚â¦… RË¢ â€”[ ğ•’ ]â†’ ğ•£â€² âˆ£ Rá¶œ âˆ·Ê³ Î»á¶œ â¦†</a>
      <a id="5296" class="Comment">-- pattern coherâ‚â‚â¦…_â€”[_]â†’_âˆ£_âˆ·âŸ©_â¦† RË¢ ğ•’ ğ•£ Rá¶œ Î»á¶œ = coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£</a>

  <a id="5368" class="Comment">-- ** Stipulation: committing secrets</a>
  <a id="coherâ‚â‚.[2]"></a><a id="5408" href="SecureCompilation.Coherence.html#5408" class="InductiveConstructor">[2]</a> <a id="5412" class="Symbol">:</a> <a id="5414" class="Symbol">âˆ€</a> <a id="5416" class="Symbol">{</a><a id="5417" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a> <a id="5420" class="Symbol">:</a> <a id="5422" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="5427" class="Symbol">}</a> <a id="5429" class="Symbol">{</a><a id="5430" href="SecureCompilation.Coherence.html#5430" class="Bound">ğ•£</a> <a id="5432" class="Symbol">:</a> <a id="5434" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="5436" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a><a id="5438" class="Symbol">}</a> <a id="5440" class="Symbol">{</a><a id="5441" href="SecureCompilation.Coherence.html#5441" class="Bound">Î”Ã—hÌ…</a> <a id="5446" class="Symbol">:</a> <a id="5448" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5453" class="Symbol">(</a><a id="5454" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="5461" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="5463" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5469" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a> <a id="5471" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="5473" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a><a id="5474" class="Symbol">)}</a>
        <a id="5485" class="Comment">-- [BUG] doesnt work with t/Î“â‚€/âŸ¨GâŸ©C as generalized variables</a>
        <a id="5554" class="Symbol">{</a><a id="5555" href="SecureCompilation.Coherence.html#5555" class="Bound">t</a> <a id="5557" href="SecureCompilation.Coherence.html#5557" class="Bound">Î“â‚€</a><a id="5559" class="Symbol">}</a> <a id="5561" class="Symbol">{</a><a id="5562" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a> <a id="5567" class="Symbol">:</a> <a id="5569" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a><a id="5571" class="Symbol">}</a> <a id="5573" class="Symbol">{</a><a id="5574" href="SecureCompilation.Coherence.html#5574" class="Bound">kâƒ—</a> <a id="5577" class="Symbol">:</a> <a id="5579" href="SymbolicModel.Collections.html#5605" class="Function">ğ•‚Â²â€²</a> <a id="5583" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a><a id="5587" class="Symbol">}</a> <a id="5589" class="Symbol">â†’</a>
      <a id="5597" class="Keyword">let</a>
        <a id="5609" class="Keyword">open</a> <a id="5614" href="SymbolicModel.Collections.html#5953" class="Module">â„</a> <a id="5616" href="SecureCompilation.Coherence.html#5430" class="Bound">ğ•£</a>
        <a id="5626" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ¨</a> <a id="5628" href="SecureCompilation.Coherence.html#5628" class="Bound">G</a> <a id="5630" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ©</a> <a id="5632" href="SecureCompilation.Coherence.html#5632" class="Bound">C</a> <a id="5634" class="Symbol">=</a> <a id="5636" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a>
        <a id="5649" href="SecureCompilation.Coherence.html#5649" class="Bound">Î“</a> <a id="5651" class="Symbol">=</a> <a id="5653" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="5655" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a> <a id="5660" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="5662" href="SecureCompilation.Coherence.html#5557" class="Bound">Î“â‚€</a>
        <a id="5673" href="SecureCompilation.Coherence.html#5673" class="Bound">Î“â‚œ</a> <a id="5676" class="Symbol">=</a> <a id="5678" href="SecureCompilation.Coherence.html#5649" class="Bound">Î“</a> <a id="5680" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="5683" href="SecureCompilation.Coherence.html#5555" class="Bound">t</a>
      <a id="5691" class="Keyword">in</a>
      <a id="5700" class="Symbol">(</a><a id="5701" href="SecureCompilation.Coherence.html#5701" class="Bound">Râ‰ˆ</a> <a id="5704" class="Symbol">:</a> <a id="5706" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a> <a id="5709" href="SymbolicModel.Run.html#1482" class="Function Operator">â‰ˆâ‹¯</a> <a id="5712" href="SecureCompilation.Coherence.html#5673" class="Bound">Î“â‚œ</a><a id="5714" class="Symbol">)</a> <a id="5716" class="Symbol">â†’</a>
      <a id="5724" class="Keyword">let</a>
        <a id="5736" href="SecureCompilation.Coherence.html#5736" class="Bound">C</a> <a id="5738" class="Symbol">:</a> <a id="5740" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="5756" href="SecureCompilation.Coherence.html#5736" class="Bound">C</a> <a id="5758" class="Symbol">=</a> <a id="5760" href="SecureCompilation.Coherence.html#1166" class="Postulate">encode</a> <a id="5767" class="Symbol">{</a><a id="5768" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a><a id="5770" class="Symbol">}</a> <a id="5772" href="SymbolicModel.Collections.html#6027" class="Function">txoutâ€²</a> <a id="5779" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a>

        <a id="5793" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a> <a id="5795" class="Symbol">:</a> <a id="5797" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5802" class="Symbol">(</a><a id="5803" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="5810" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="5812" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="5818" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a><a id="5819" class="Symbol">)</a>
        <a id="5829" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a> <a id="5831" class="Symbol">=</a> <a id="5833" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5837" class="Symbol">(Î»{</a> <a id="5841" class="Symbol">(</a><a id="5842" href="SecureCompilation.Coherence.html#5842" class="Bound">s</a> <a id="5844" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5846" href="SecureCompilation.Coherence.html#5846" class="Bound">mn</a> <a id="5849" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5851" class="Symbol">_)</a> <a id="5854" class="Symbol">â†’</a> <a id="5856" href="SecureCompilation.Coherence.html#5842" class="Bound">s</a> <a id="5858" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5860" href="SecureCompilation.Coherence.html#5846" class="Bound">mn</a> <a id="5863" class="Symbol">})</a> <a id="5866" href="SecureCompilation.Coherence.html#5441" class="Bound">Î”Ã—hÌ…</a>

        <a id="5880" class="Comment">-- [BUG] leads to internal error</a>
        <a id="5921" class="Comment">-- (unsolved meta after serialization, c.f. issue #5584)</a>
        <a id="5986" class="Comment">-- (as , ms) = unzip Î”</a>
        <a id="6017" href="SecureCompilation.Coherence.html#6017" class="Bound">as</a> <a id="6020" class="Symbol">=</a> <a id="6022" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a> <a id="6028" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6030" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="6036" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a>
        <a id="6046" href="SecureCompilation.Coherence.html#6046" class="Bound">ms</a> <a id="6049" class="Symbol">=</a> <a id="6051" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="6057" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6059" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="6065" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a>

        <a id="6076" href="SecureCompilation.Coherence.html#6076" class="Bound">Î”á¶œ</a> <a id="6079" class="Symbol">:</a> <a id="6081" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a>
        <a id="6093" href="SecureCompilation.Coherence.html#6076" class="Bound">Î”á¶œ</a> <a id="6096" class="Symbol">=</a> <a id="6098" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="6101" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6105" class="Symbol">(</a><a id="6106" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="6114" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">âŸ¨</a> <a id="6116" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6118" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">âˆ¶_â™¯_âŸ©</a><a id="6123" class="Symbol">)</a> <a id="6125" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a>

        <a id="6136" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a> <a id="6139" class="Symbol">:</a> <a id="6141" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6146" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a> <a id="6148" class="Comment">-- â‰ˆ Message</a>
        <a id="6169" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a> <a id="6172" class="Symbol">=</a> <a id="6174" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6178" class="Symbol">(</a><a id="6179" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="6185" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="6187" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a><a id="6192" class="Symbol">)</a> <a id="6194" href="SecureCompilation.Coherence.html#5441" class="Bound">Î”Ã—hÌ…</a>

        <a id="6208" href="SecureCompilation.Coherence.html#6208" class="Bound">kÌ…</a> <a id="6211" class="Symbol">:</a> <a id="6213" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6218" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a> <a id="6220" class="Comment">-- â‰ˆ Message</a>
        <a id="6241" href="SecureCompilation.Coherence.html#6208" class="Bound">kÌ…</a> <a id="6244" class="Symbol">=</a> <a id="6246" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="6256" class="Symbol">(</a><a id="6257" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6261" href="Bitcoin.Crypto.html#377" class="Field">pub</a> <a id="6265" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="6267" href="Prelude.Lists.html#13278" class="Function">codom</a><a id="6272" class="Symbol">)</a> <a id="6274" class="Symbol">(</a><a id="6275" href="Prelude.Lists.html#13278" class="Function">codom</a> <a id="6281" href="SecureCompilation.Coherence.html#5574" class="Bound">kâƒ—</a><a id="6283" class="Symbol">)</a>

        <a id="6294" href="SecureCompilation.Coherence.html#6294" class="Bound">C,hÌ…,kÌ…</a> <a id="6302" class="Symbol">:</a> <a id="6304" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="6320" href="SecureCompilation.Coherence.html#6294" class="Bound">C,hÌ…,kÌ…</a> <a id="6328" class="Symbol">=</a> <a id="6330" href="SecureCompilation.Coherence.html#5736" class="Bound">C</a> <a id="6332" href="Prelude.Semigroup.html#134" class="Field Operator">â—‡</a> <a id="6334" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a> <a id="6337" href="Prelude.Semigroup.html#134" class="Field Operator">â—‡</a> <a id="6339" href="SecureCompilation.Coherence.html#6208" class="Bound">kÌ…</a>

        <a id="6351" href="SecureCompilation.Coherence.html#6351" class="Bound">C,hÌ…,kÌ…â‚</a> <a id="6360" class="Symbol">:</a> <a id="6362" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="6378" href="SecureCompilation.Coherence.html#6351" class="Bound">C,hÌ…,kÌ…â‚</a> <a id="6387" class="Symbol">=</a> <a id="6389" href="SecureCompilation.Coherence.html#1535" class="Function">SIGáµ</a> <a id="6394" class="Symbol">(</a><a id="6395" href="ComputationalModel.KeyPairs.html#249" class="Function">K</a> <a id="6397" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="6398" class="Symbol">)</a> <a id="6400" href="SecureCompilation.Coherence.html#6294" class="Bound">C,hÌ…,kÌ…</a>

        <a id="6417" href="SecureCompilation.Coherence.html#6417" class="Bound">Î±</a>   <a id="6421" class="Symbol">=</a> <a id="6423" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commitâ¦…</a> <a id="6436" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6438" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="6440" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a> <a id="6445" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="6447" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a> <a id="6449" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">â¦†</a>
        <a id="6459" href="SecureCompilation.Coherence.html#6459" class="Bound">Î“â€²</a>  <a id="6463" class="Symbol">=</a> <a id="6465" href="SecureCompilation.Coherence.html#5649" class="Bound">Î“</a> <a id="6467" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="6469" href="SecureCompilation.Coherence.html#6076" class="Bound">Î”á¶œ</a> <a id="6472" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="6474" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6476" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="6482" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">â™¯â–·</a> <a id="6485" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a> <a id="6490" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a>
        <a id="6500" href="SecureCompilation.Coherence.html#6500" class="Bound">tâ€²</a>  <a id="6504" class="Symbol">=</a> <a id="6506" href="SecureCompilation.Coherence.html#5555" class="Bound">t</a>
        <a id="6516" href="SecureCompilation.Coherence.html#6516" class="Bound">Î“â‚œâ€²</a> <a id="6520" class="Symbol">=</a> <a id="6522" href="SecureCompilation.Coherence.html#6459" class="Bound">Î“â€²</a> <a id="6525" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="6528" href="SecureCompilation.Coherence.html#6500" class="Bound">tâ€²</a>
        <a id="6539" href="SecureCompilation.Coherence.html#6539" class="Bound">Î»á¶œ</a>  <a id="6543" class="Symbol">=</a> <a id="6545" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="6547" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="6551" href="SecureCompilation.Coherence.html#6351" class="Bound">C,hÌ…,kÌ…â‚</a>
      <a id="6566" class="Keyword">in</a>
      <a id="6575" class="Symbol">(</a><a id="6576" href="SecureCompilation.Coherence.html#6576" class="Bound">âˆƒÎ“â‰ˆ</a> <a id="6580" class="Symbol">:</a> <a id="6582" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="6584" class="Symbol">(</a><a id="6585" href="SecureCompilation.Coherence.html#1959" class="Function Operator">_â‰ˆá¶œ</a> <a id="6589" href="SecureCompilation.Coherence.html#6459" class="Bound">Î“â€²</a><a id="6591" class="Symbol">))</a>
      <a id="6600" class="Comment">-- Hypotheses from [C-AuthCommit]</a>
      <a id="6640" class="Symbol">(</a><a id="6641" href="SecureCompilation.Coherence.html#6641" class="Bound">asâ‰¡</a> <a id="6645" class="Symbol">:</a> <a id="6647" href="SecureCompilation.Coherence.html#6017" class="Bound">as</a> <a id="6650" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="6652" href="BitML.Contracts.Helpers.html#7257" class="Function">secretsOfáµ–</a> <a id="6663" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6665" href="SecureCompilation.Coherence.html#5628" class="Bound">G</a><a id="6666" class="Symbol">)</a>
      <a id="6674" class="Symbol">(</a><a id="6675" href="SecureCompilation.Coherence.html#6675" class="Bound">Allâˆ‰</a> <a id="6680" class="Symbol">:</a> <a id="6682" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="6686" class="Symbol">(</a><a id="6687" href="Data.List.Membership.Setoid.html#936" class="Function Operator">_âˆ‰</a> <a id="6690" href="BitML.Semantics.Configurations.Helpers.html#6204" class="Function">secretsOfá¶œá¶ </a> <a id="6702" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6704" href="SecureCompilation.Coherence.html#5557" class="Bound">Î“â‚€</a><a id="6706" class="Symbol">)</a> <a id="6708" href="SecureCompilation.Coherence.html#6017" class="Bound">as</a><a id="6710" class="Symbol">)</a>
      <a id="6718" class="Symbol">(</a><a id="6719" href="SecureCompilation.Coherence.html#6719" class="Bound">Honâ‡’</a> <a id="6724" class="Symbol">:</a> <a id="6726" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6728" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="6730" href="BitML.Contracts.Types.html#482" class="Function">Hon</a> <a id="6734" class="Symbol">â†’</a> <a id="6736" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="6740" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="6748" href="SecureCompilation.Coherence.html#6046" class="Bound">ms</a><a id="6750" class="Symbol">)</a> <a id="6752" class="Symbol">â†’</a>
      <a id="6760" class="Keyword">let</a>
        <a id="6772" href="SecureCompilation.Coherence.html#6772" class="Bound">Î“â†’Î“â€²</a> <a id="6777" class="Symbol">:</a> <a id="6779" href="SecureCompilation.Coherence.html#5673" class="Bound">Î“â‚œ</a> <a id="6782" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">â€”[</a> <a id="6785" href="SecureCompilation.Coherence.html#6417" class="Bound">Î±</a> <a id="6787" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">]â†’â‚œ</a> <a id="6791" href="SecureCompilation.Coherence.html#6516" class="Bound">Î“â‚œâ€²</a>
        <a id="6803" href="SecureCompilation.Coherence.html#6772" class="Bound">Î“â†’Î“â€²</a> <a id="6808" class="Symbol">=</a> <a id="6810" href="BitML.Semantics.InferenceRules.html#8583" class="InductiveConstructor">[Action]</a> <a id="6819" class="Symbol">(</a><a id="6820" href="BitML.Semantics.InferenceRules.html#4132" class="InductiveConstructor">[C-AuthCommit]</a> <a id="6835" href="SecureCompilation.Coherence.html#6641" class="Bound">asâ‰¡</a> <a id="6839" href="SecureCompilation.Coherence.html#6675" class="Bound">Allâˆ‰</a> <a id="6844" href="SecureCompilation.Coherence.html#6719" class="Bound">Honâ‡’</a><a id="6848" class="Symbol">)</a> <a id="6850" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="6864" class="Comment">-- (v) txout = txoutâ€² (vi) extend sechashâ€² (vii) extend Îºâ€²</a>
        <a id="6931" href="SecureCompilation.Coherence.html#6931" class="Bound">sechashâº</a> <a id="6940" class="Symbol">:</a> <a id="6942" href="SecureCompilation.Coherence.html#6017" class="Bound">as</a> <a id="6945" href="Prelude.Lists.html#13162" class="Function Operator">â†¦</a> <a id="6947" href="Agda.Builtin.Int.html#246" class="Datatype">â„¤</a>
        <a id="6957" href="SecureCompilation.Coherence.html#6931" class="Bound">sechashâº</a> <a id="6966" href="SecureCompilation.Coherence.html#6966" class="Bound">aâˆˆ</a> <a id="6969" class="Symbol">=</a>
          <a id="6981" class="Keyword">let</a> <a id="6985" class="Symbol">_</a> <a id="6987" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6989" href="SecureCompilation.Coherence.html#6989" class="Bound">aÃ—mâˆˆ</a> <a id="6994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6996" class="Symbol">_</a>    <a id="7001" class="Symbol">=</a> <a id="7003" href="Prelude.Lists.html#8818" class="Function">âˆˆ-unzipâ»Ë¡</a> <a id="7013" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a> <a id="7015" href="SecureCompilation.Coherence.html#6966" class="Bound">aâˆˆ</a>
              <a id="7032" class="Symbol">(_</a> <a id="7035" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7037" class="Symbol">_</a> <a id="7039" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7041" href="SecureCompilation.Coherence.html#7041" class="Bound">z</a><a id="7042" class="Symbol">)</a> <a id="7044" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7046" class="Symbol">_</a> <a id="7048" class="Symbol">=</a> <a id="7050" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">âˆˆ-mapâ»</a> <a id="7057" class="Symbol">(Î»{</a> <a id="7061" class="Symbol">(</a><a id="7062" href="SecureCompilation.Coherence.html#7062" class="Bound">s</a> <a id="7064" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7066" href="SecureCompilation.Coherence.html#7066" class="Bound">mn</a> <a id="7069" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7071" class="Symbol">_)</a> <a id="7074" class="Symbol">â†’</a> <a id="7076" href="SecureCompilation.Coherence.html#7062" class="Bound">s</a> <a id="7078" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7080" href="SecureCompilation.Coherence.html#7066" class="Bound">mn</a> <a id="7083" class="Symbol">})</a> <a id="7086" href="SecureCompilation.Coherence.html#6989" class="Bound">aÃ—mâˆˆ</a>
          <a id="7101" class="Keyword">in</a> <a id="7104" href="SecureCompilation.Coherence.html#7041" class="Bound">z</a>

        <a id="7115" class="Keyword">open</a> <a id="7120" href="SymbolicModel.Helpers.html#4678" class="Module">Hâ‚‚</a> <a id="7123" class="Symbol">{</a><a id="7124" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a><a id="7126" class="Symbol">}</a> <a id="7128" href="SecureCompilation.Coherence.html#5430" class="Bound">ğ•£</a> <a id="7130" href="SecureCompilation.Coherence.html#5555" class="Bound">t</a> <a id="7132" href="SecureCompilation.Coherence.html#6417" class="Bound">Î±</a> <a id="7134" href="SecureCompilation.Coherence.html#6500" class="Bound">tâ€²</a> <a id="7137" href="SecureCompilation.Coherence.html#5649" class="Bound">Î“</a> <a id="7139" href="SecureCompilation.Coherence.html#5701" class="Bound">Râ‰ˆ</a> <a id="7142" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="7144" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="7146" href="SecureCompilation.Coherence.html#5562" class="Bound">âŸ¨GâŸ©C</a> <a id="7151" href="SecureCompilation.Coherence.html#5793" class="Bound">Î”</a> <a id="7153" href="SecureCompilation.Coherence.html#6931" class="Bound">sechashâº</a> <a id="7162" href="SecureCompilation.Coherence.html#5574" class="Bound">kâƒ—</a> <a id="7165" href="SecureCompilation.Coherence.html#6772" class="Bound">Î“â†’Î“â€²</a> <a id="7170" href="SecureCompilation.Coherence.html#6576" class="Bound">âˆƒÎ“â‰ˆ</a>
      <a id="7180" class="Keyword">in</a>
      <a id="7189" class="Comment">-- (i) âŸ¨GâŸ©C has been previously advertised in Rá¶œ</a>
      <a id="7244" class="Comment">-- T0D0: make sure it is the first occurrence of such a broadcast in Rá¶œ</a>
      <a id="7322" class="Symbol">(</a><a id="7323" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="7325" class="Symbol">Î»</a> <a id="7327" href="SecureCompilation.Coherence.html#7327" class="Bound">B</a> <a id="7329" class="Symbol">â†’</a> <a id="7331" class="Symbol">(</a><a id="7332" href="SecureCompilation.Coherence.html#7327" class="Bound">B</a> <a id="7334" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="7338" href="SecureCompilation.Coherence.html#5736" class="Bound">C</a><a id="7339" class="Symbol">)</a> <a id="7341" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="7343" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="7345" class="Symbol">)</a>

      <a id="7354" class="Comment">-- (ii) broadcast message in Rá¶œ</a>
      <a id="7392" class="Comment">-- T0D0: make sure that Î»á¶œ is the first occurrence of such a message after C in Rá¶œ</a>
    <a id="7479" class="Comment">-- â†’ âˆƒ Î» B â†’ Î»á¶œ â‰¡ B â†’âˆ—âˆ¶ C,hÌ…,kÌ…â‚</a>
    <a id="7516" class="Symbol">â†’</a> <a id="7518" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="7522" class="Symbol">(Î»</a> <a id="7525" href="SecureCompilation.Coherence.html#7525" class="Bound">háµ¢</a> <a id="7528" class="Symbol">â†’</a> <a id="7530" href="SecureCompilation.Coherence.html#1326" class="Postulate Operator">âˆ£</a> <a id="7532" href="SecureCompilation.Coherence.html#7525" class="Bound">háµ¢</a> <a id="7535" href="SecureCompilation.Coherence.html#1326" class="Postulate Operator">âˆ£á¶»</a> <a id="7538" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="7540" href="SecureCompilation.Coherence.html#719" class="Bound">Î·</a><a id="7541" class="Symbol">)</a> <a id="7543" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a>

      <a id="7553" class="Comment">-- (iii) each háµ¢ is obtained by querying the oracle, otherwise we have a dishonestly chosen secret</a>
    <a id="7656" class="Symbol">â†’</a> <a id="7658" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="7662" class="Symbol">(Î»{</a> <a id="7666" class="Symbol">(_</a> <a id="7669" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7671" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="7676" href="SecureCompilation.Coherence.html#7676" class="Bound">Náµ¢</a> <a id="7679" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7681" href="SecureCompilation.Coherence.html#7681" class="Bound">háµ¢</a><a id="7683" class="Symbol">)</a>
            <a id="7697" class="Symbol">â†’</a> <a id="7699" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="7701" class="Symbol">Î»</a> <a id="7703" href="SecureCompilation.Coherence.html#7703" class="Bound">B</a> <a id="7705" class="Symbol">â†’</a> <a id="7707" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="7709" class="Symbol">Î»</a> <a id="7711" href="SecureCompilation.Coherence.html#7711" class="Bound">máµ¢</a> <a id="7714" class="Symbol">â†’</a> <a id="7716" class="Symbol">((</a><a id="7718" href="SecureCompilation.Coherence.html#7703" class="Bound">B</a> <a id="7720" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7722" href="SecureCompilation.Coherence.html#7711" class="Bound">máµ¢</a> <a id="7725" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7727" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="7729" href="SecureCompilation.Coherence.html#7681" class="Bound">háµ¢</a> <a id="7732" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="7733" class="Symbol">)</a> <a id="7735" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="7737" href="ComputationalModel.Strategy.html#3170" class="Function">oracleInteractions</a> <a id="7756" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="7758" class="Symbol">)</a> <a id="7760" href="Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="7762" class="Symbol">(</a><a id="7763" href="SecureCompilation.Coherence.html#1341" class="Postulate Operator">âˆ£</a> <a id="7765" href="SecureCompilation.Coherence.html#7711" class="Bound">máµ¢</a> <a id="7768" href="SecureCompilation.Coherence.html#1341" class="Postulate Operator">âˆ£áµ</a> <a id="7771" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="7773" href="SecureCompilation.Coherence.html#719" class="Bound">Î·</a> <a id="7775" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7777" href="SecureCompilation.Coherence.html#7676" class="Bound">Náµ¢</a><a id="7779" class="Symbol">)</a>
            <a id="7793" class="Symbol">;</a> <a id="7795" class="Symbol">(_</a> <a id="7798" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7800" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="7808" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7810" href="SecureCompilation.Coherence.html#7810" class="Bound">háµ¢</a><a id="7812" class="Symbol">)</a>
            <a id="7826" class="Symbol">â†’</a> <a id="7828" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="7830" href="SecureCompilation.Coherence.html#7810" class="Bound">háµ¢</a> <a id="7833" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="7835" href="Data.List.Membership.Setoid.html#936" class="Function Operator">âˆ‰</a> <a id="7837" href="Data.List.Base.html#1544" class="Function">map</a> <a id="7841" class="Symbol">(</a><a id="7842" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="7848" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="7850" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a><a id="7855" class="Symbol">)</a> <a id="7857" class="Symbol">(</a><a id="7858" href="Data.List.Base.html#8092" class="Function">filter</a> <a id="7865" class="Symbol">((</a><a id="7867" href="SecureCompilation.Coherence.html#719" class="Bound">Î·</a> <a id="7869" href="Prelude.Ord.html#487" class="Function Operator">â‰¤?_</a><a id="7872" class="Symbol">)</a> <a id="7874" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="7876" href="SecureCompilation.Coherence.html#1341" class="Postulate Operator">âˆ£_âˆ£áµ</a> <a id="7881" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="7883" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a> <a id="7889" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="7891" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a><a id="7896" class="Symbol">)</a> <a id="7898" class="Symbol">(</a><a id="7899" href="ComputationalModel.Strategy.html#3170" class="Function">oracleInteractions</a> <a id="7918" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="7920" class="Symbol">))</a>
            <a id="7935" class="Symbol">})</a> <a id="7938" href="SecureCompilation.Coherence.html#5441" class="Bound">Î”Ã—hÌ…</a>

      <a id="7950" class="Comment">-- (iv) no hash is reused</a>
    <a id="7980" class="Symbol">â†’</a> <a id="7982" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="7989" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a>
    <a id="7996" class="Symbol">â†’</a> <a id="7998" href="Data.List.Relation.Binary.Disjoint.Setoid.html#842" class="Function">Disjoint</a> <a id="8007" href="SecureCompilation.Coherence.html#6136" class="Bound">hÌ…</a> <a id="8010" class="Symbol">(</a><a id="8011" href="Prelude.Lists.html#13278" class="Function">codom</a> <a id="8017" href="SymbolicModel.Helpers.html#1928" class="Function">sechash</a><a id="8024" class="Symbol">)</a>
      <a id="8032" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="8109" class="Symbol">â†’</a> <a id="8111" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="8119" href="SecureCompilation.Coherence.html#5417" class="Bound">RË¢</a> <a id="8122" href="SymbolicModel.Helpers.html#1546" class="Function">ğ•’</a> <a id="8124" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="8127" href="SecureCompilation.Coherence.html#6539" class="Bound">Î»á¶œ</a> <a id="8130" href="SymbolicModel.Helpers.html#2255" class="Function">ğ•£â€²</a>

  <a id="8136" class="Comment">-- ** Stipulation: authorizing deposits</a>
  <a id="coherâ‚â‚.[3]"></a><a id="8178" href="SecureCompilation.Coherence.html#8178" class="InductiveConstructor">[3]</a> <a id="8182" class="Symbol">:</a> <a id="8184" class="Symbol">âˆ€</a> <a id="8186" class="Symbol">{</a><a id="8187" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8192" class="Symbol">:</a> <a id="8194" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a><a id="8196" class="Symbol">}</a> <a id="8198" class="Symbol">â†’</a> <a id="8200" class="Keyword">let</a> <a id="8204" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ¨</a> <a id="8206" href="SecureCompilation.Coherence.html#8206" class="Bound">G</a> <a id="8208" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ©</a> <a id="8210" href="SecureCompilation.Coherence.html#8210" class="Bound">C</a> <a id="8212" class="Symbol">=</a> <a id="8214" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8219" class="Symbol">;</a> <a id="8221" href="SecureCompilation.Coherence.html#8221" class="Bound">partG</a> <a id="8227" class="Symbol">=</a> <a id="8229" href="SecureCompilation.Coherence.html#8206" class="Bound">G</a> <a id="8231" href="SymbolicModel.Helpers.html#930" class="Function Operator">âˆ™partG</a> <a id="8238" class="Keyword">in</a>
        <a id="8249" class="Symbol">âˆ€</a> <a id="8251" class="Symbol">{</a><a id="8252" href="SecureCompilation.Coherence.html#8252" class="Bound">t</a> <a id="8254" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a> <a id="8256" href="SecureCompilation.Coherence.html#8256" class="Bound">Î“â‚€</a><a id="8258" class="Symbol">}</a> <a id="8260" class="Symbol">â†’</a> <a id="8262" class="Keyword">let</a> <a id="8266" href="SecureCompilation.Coherence.html#8266" class="Bound">Î“</a> <a id="8268" class="Symbol">=</a> <a id="8270" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="8272" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8277" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="8279" href="SecureCompilation.Coherence.html#8256" class="Bound">Î“â‚€</a><a id="8281" class="Symbol">;</a> <a id="8283" href="SecureCompilation.Coherence.html#8283" class="Bound">Î“â‚œ</a> <a id="8286" class="Symbol">=</a> <a id="8288" href="SecureCompilation.Coherence.html#8266" class="Bound">Î“</a> <a id="8290" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="8293" href="SecureCompilation.Coherence.html#8252" class="Bound">t</a> <a id="8295" class="Keyword">in</a>
        <a id="8306" class="Symbol">(</a><a id="8307" href="SecureCompilation.Coherence.html#8307" class="Bound">Râ‰ˆ</a> <a id="8310" class="Symbol">:</a> <a id="8312" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="8315" href="SymbolicModel.Run.html#1482" class="Function Operator">â‰ˆâ‹¯</a> <a id="8318" href="SecureCompilation.Coherence.html#8283" class="Bound">Î“â‚œ</a><a id="8320" class="Symbol">)</a>

    <a id="8327" class="Symbol">â†’</a> <a id="8329" class="Keyword">let</a>
        <a id="8341" href="SecureCompilation.Coherence.html#8341" class="Bound">Î±</a>   <a id="8345" class="Symbol">=</a> <a id="8347" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">auth-initâ¦…</a> <a id="8358" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a> <a id="8360" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">,</a> <a id="8362" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8367" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">,</a> <a id="8369" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="8371" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">â¦†</a>
        <a id="8381" href="SecureCompilation.Coherence.html#8381" class="Bound">Î“â€²</a>  <a id="8385" class="Symbol">=</a> <a id="8387" href="SecureCompilation.Coherence.html#8266" class="Bound">Î“</a> <a id="8389" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="8391" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a> <a id="8393" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="8399" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="8401" href="BitML.Semantics.Action.html#729" class="InductiveConstructor Operator">â–·Ë¢</a> <a id="8404" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8409" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a>
        <a id="8419" href="SecureCompilation.Coherence.html#8419" class="Bound">tâ€²</a>  <a id="8423" class="Symbol">=</a> <a id="8425" href="SecureCompilation.Coherence.html#8252" class="Bound">t</a>
        <a id="8435" href="SecureCompilation.Coherence.html#8435" class="Bound">Î“â‚œâ€²</a> <a id="8439" class="Symbol">=</a> <a id="8441" href="SecureCompilation.Coherence.html#8381" class="Bound">Î“â€²</a> <a id="8444" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="8447" href="SecureCompilation.Coherence.html#8419" class="Bound">tâ€²</a>
      <a id="8456" class="Keyword">in</a>
      <a id="8465" class="Symbol">(</a><a id="8466" href="SecureCompilation.Coherence.html#8466" class="Bound">âˆƒÎ“â‰ˆ</a> <a id="8470" class="Symbol">:</a> <a id="8472" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="8474" class="Symbol">(</a><a id="8475" href="SecureCompilation.Coherence.html#1959" class="Function Operator">_â‰ˆá¶œ</a> <a id="8479" href="SecureCompilation.Coherence.html#8381" class="Bound">Î“â€²</a><a id="8481" class="Symbol">))</a>
      <a id="8490" class="Comment">-- Hypotheses from [C-AuthInit]</a>
      <a id="8528" class="Symbol">(</a><a id="8529" href="SecureCompilation.Coherence.html#8529" class="Bound">committedA</a> <a id="8540" class="Symbol">:</a> <a id="8542" href="SecureCompilation.Coherence.html#8221" class="Bound">partG</a> <a id="8548" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">âŠ†</a> <a id="8550" href="BitML.Semantics.Configurations.Helpers.html#6433" class="Function">committedParticipants</a> <a id="8572" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8577" href="SecureCompilation.Coherence.html#8256" class="Bound">Î“â‚€</a><a id="8579" class="Symbol">)</a>
      <a id="8587" class="Symbol">(</a><a id="8588" href="SecureCompilation.Coherence.html#8588" class="Bound">Aâˆˆper</a> <a id="8594" class="Symbol">:</a> <a id="8596" class="Symbol">(</a><a id="8597" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a> <a id="8599" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8601" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="8603" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8605" href="BitML.BasicTypes.html#482" class="Generalizable">x</a><a id="8606" class="Symbol">)</a> <a id="8608" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="8610" href="BitML.Contracts.Helpers.html#8617" class="Function">persistentDeposits</a> <a id="8629" href="SecureCompilation.Coherence.html#8206" class="Bound">G</a><a id="8630" class="Symbol">)</a> <a id="8632" class="Symbol">â†’</a>
      <a id="8640" class="Keyword">let</a>
        <a id="8652" class="Comment">-- Aâˆˆâ€² : A âˆˆ committedParticipants âŸ¨GâŸ©C Î“â‚€</a>
        <a id="8703" class="Comment">-- Aâˆˆâ€² = committedA $ âˆˆ-nubâº (persistentParticipantsâŠ† {g = G} $ âˆˆ-mapâº projâ‚ Aâˆˆper)</a>

        <a id="8796" href="SecureCompilation.Coherence.html#8796" class="Bound">Î“â†’Î“â€²</a> <a id="8801" class="Symbol">:</a> <a id="8803" href="SecureCompilation.Coherence.html#8283" class="Bound">Î“â‚œ</a> <a id="8806" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">â€”[</a> <a id="8809" href="SecureCompilation.Coherence.html#8341" class="Bound">Î±</a> <a id="8811" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">]â†’â‚œ</a> <a id="8815" href="SecureCompilation.Coherence.html#8435" class="Bound">Î“â‚œâ€²</a>
        <a id="8827" href="SecureCompilation.Coherence.html#8796" class="Bound">Î“â†’Î“â€²</a> <a id="8832" class="Symbol">=</a> <a id="8834" href="BitML.Semantics.InferenceRules.html#8583" class="InductiveConstructor">[Action]</a> <a id="8843" class="Symbol">(</a><a id="8844" href="BitML.Semantics.InferenceRules.html#4710" class="InductiveConstructor">[C-AuthInit]</a> <a id="8857" href="SecureCompilation.Coherence.html#8529" class="Bound">committedA</a> <a id="8868" href="SecureCompilation.Coherence.html#8588" class="Bound">Aâˆˆper</a><a id="8873" class="Symbol">)</a> <a id="8875" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="8889" class="Comment">-- (iv) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²</a>
        <a id="8948" class="Keyword">open</a> <a id="8953" href="SymbolicModel.Helpers.html#8164" class="Module">Hâ‚ƒ</a> <a id="8956" class="Symbol">{</a><a id="8957" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a><a id="8959" class="Symbol">}</a> <a id="8961" href="SecureCompilation.Coherence.html#1126" class="Generalizable">ğ•£</a> <a id="8963" href="SecureCompilation.Coherence.html#8252" class="Bound">t</a> <a id="8965" href="SecureCompilation.Coherence.html#8341" class="Bound">Î±</a> <a id="8967" href="SecureCompilation.Coherence.html#8419" class="Bound">tâ€²</a> <a id="8970" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a> <a id="8975" href="SecureCompilation.Coherence.html#8256" class="Bound">Î“â‚€</a> <a id="8978" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a> <a id="8980" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="8982" href="SecureCompilation.Coherence.html#8307" class="Bound">Râ‰ˆ</a> <a id="8985" href="SecureCompilation.Coherence.html#8796" class="Bound">Î“â†’Î“â€²</a> <a id="8990" href="SecureCompilation.Coherence.html#8466" class="Bound">âˆƒÎ“â‰ˆ</a>

        <a id="9003" href="SecureCompilation.Coherence.html#9003" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="9009" class="Symbol">:</a> <a id="9011" href="Bitcoin.Tx.Base.html#1255" class="Function">âˆƒTx</a>
        <a id="9023" href="SecureCompilation.Coherence.html#9003" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="9029" class="Symbol">=</a>
          <a id="9041" class="Keyword">let</a> <a id="9045" class="Comment">-- invoke compiler</a>
            <a id="9076" href="SecureCompilation.Coherence.html#9076" class="Bound">K</a> <a id="9078" class="Symbol">:</a> <a id="9080" href="SymbolicModel.Collections.html#5546" class="Function">ğ•‚</a> <a id="9082" href="SecureCompilation.Coherence.html#8206" class="Bound">G</a>
            <a id="9096" href="SecureCompilation.Coherence.html#9076" class="Bound">K</a> <a id="9098" class="Symbol">{</a><a id="9099" href="SecureCompilation.Coherence.html#9099" class="Bound">p</a><a id="9100" class="Symbol">}</a> <a id="9102" class="Symbol">_</a> <a id="9104" class="Symbol">=</a> <a id="9106" href="ComputationalModel.KeyPairs.html#297" class="Function">KÌ‚</a> <a id="9109" href="SecureCompilation.Coherence.html#9099" class="Bound">p</a>

            <a id="9124" class="Keyword">open</a> <a id="9129" href="SymbolicModel.Helpers.html#9114" class="Module">Hâ‚ƒâ€²</a> <a id="9133" href="SecureCompilation.Coherence.html#8529" class="Bound">committedA</a>

            <a id="9157" href="SecureCompilation.Coherence.html#9157" class="Bound">âˆƒtxÂ¹</a> <a id="9162" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9164" class="Symbol">_</a> <a id="9166" class="Symbol">=</a> <a id="9168" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="9183" class="Symbol">{</a><a id="9184" class="Argument">ad</a> <a id="9187" class="Symbol">=</a> <a id="9189" href="SecureCompilation.Coherence.html#8187" class="Bound">âŸ¨GâŸ©C</a><a id="9193" class="Symbol">}</a> <a id="9195" href="SymbolicModel.Helpers.html#3154" class="Function">vad</a> <a id="9199" href="SymbolicModel.Helpers.html#3523" class="Function">sechashâ‚€</a> <a id="9208" href="SymbolicModel.Helpers.html#3250" class="Function">txoutâ‚€</a> <a id="9215" href="SecureCompilation.Coherence.html#9076" class="Bound">K</a> <a id="9217" href="SymbolicModel.Helpers.html#3680" class="Function">Îºâ‚€</a>
          <a id="9230" class="Keyword">in</a>
            <a id="9245" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="9248" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="9251" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="9257" href="SecureCompilation.Coherence.html#9157" class="Bound">âˆƒtxÂ¹</a>

        <a id="9271" class="Comment">-- (i) broadcast Táµ¢â‚™áµ¢â‚œ , signed with A&#39;s private key</a>
        <a id="9332" href="SecureCompilation.Coherence.html#9332" class="Bound">m</a> <a id="9334" class="Symbol">=</a> <a id="9336" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="9338" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="9342" class="Symbol">(</a><a id="9343" href="ComputationalModel.KeyPairs.html#297" class="Function">KÌ‚</a> <a id="9346" href="SecureCompilation.Coherence.html#8254" class="Bound">A</a><a id="9347" class="Symbol">)</a> <a id="9349" href="SecureCompilation.Coherence.html#9003" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="9355" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="9365" href="SecureCompilation.Coherence.html#9365" class="Bound">Î»á¶œ</a> <a id="9368" class="Symbol">=</a> <a id="9370" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="9372" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="9376" href="SecureCompilation.Coherence.html#9332" class="Bound">m</a>
      <a id="9384" class="Keyword">in</a>
      <a id="9393" class="Comment">-- (ii) Táµ¢â‚™áµ¢â‚œ occurs as a message in Rá¶œ</a>
      <a id="9439" class="Symbol">(</a><a id="9440" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="9442" class="Symbol">Î»</a> <a id="9444" href="SecureCompilation.Coherence.html#9444" class="Bound">B</a> <a id="9446" class="Symbol">â†’</a> <a id="9448" class="Symbol">(</a><a id="9449" href="SecureCompilation.Coherence.html#9444" class="Bound">B</a> <a id="9451" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="9455" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="9457" href="Bitcoin.Crypto.html#606" class="Postulate">HASH</a> <a id="9462" href="SecureCompilation.Coherence.html#9003" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="9468" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="9469" class="Symbol">)</a> <a id="9471" href="Data.List.Membership.Setoid.html#887" class="Function Operator">âˆˆ</a> <a id="9473" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a><a id="9475" class="Symbol">)</a>

      <a id="9484" class="Comment">-- (iii) broadcast message in Rá¶œ</a>
      <a id="9523" class="Comment">-- T0D0: make sure that Î»á¶œ is the first occurrence of such a message after Tinit in Rá¶œ</a>
      <a id="9616" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="9693" class="Symbol">â†’</a> <a id="9695" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="9703" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="9706" href="SymbolicModel.Helpers.html#1546" class="Function">ğ•’</a> <a id="9708" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="9711" href="SecureCompilation.Coherence.html#9365" class="Bound">Î»á¶œ</a> <a id="9714" href="SymbolicModel.Helpers.html#2255" class="Function">ğ•£â€²</a>

  <a id="9720" class="Comment">-- ** Stipulation: activating the contract</a>
  <a id="coherâ‚â‚.[4]"></a><a id="9765" href="SecureCompilation.Coherence.html#9765" class="InductiveConstructor">[4]</a> <a id="9769" class="Symbol">:</a> <a id="9771" class="Symbol">âˆ€</a> <a id="9773" class="Symbol">{</a><a id="9774" href="SecureCompilation.Coherence.html#9774" class="Bound">t</a> <a id="9776" href="SecureCompilation.Coherence.html#9776" class="Bound">Î“â‚€</a><a id="9778" class="Symbol">}</a> <a id="9780" class="Symbol">{</a><a id="9781" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a> <a id="9784" class="Symbol">:</a> <a id="9786" href="BitML.Contracts.Types.html#2612" class="Function">Ad</a><a id="9788" class="Symbol">}</a>
    <a id="9794" class="Symbol">â†’</a> <a id="9796" class="Keyword">let</a>
        <a id="9808" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ¨</a> <a id="9810" href="SecureCompilation.Coherence.html#9810" class="Bound">G</a> <a id="9812" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">âŸ©</a> <a id="9814" href="SecureCompilation.Coherence.html#9814" class="Bound">C</a> <a id="9816" class="Symbol">=</a> <a id="9818" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a>
        <a id="9829" href="SecureCompilation.Coherence.html#9829" class="Bound">toSpend</a> <a id="9837" class="Symbol">=</a> <a id="9839" href="BitML.Contracts.Helpers.html#8617" class="Function">persistentDeposits</a> <a id="9858" href="SecureCompilation.Coherence.html#9810" class="Bound">G</a>
        <a id="9868" href="SecureCompilation.Coherence.html#9868" class="Bound">partG</a>   <a id="9876" class="Symbol">=</a> <a id="9878" href="SecureCompilation.Coherence.html#9810" class="Bound">G</a> <a id="9880" href="SymbolicModel.Helpers.html#930" class="Function Operator">âˆ™partG</a>
        <a id="9895" href="SecureCompilation.Coherence.html#9895" class="Bound">v</a>       <a id="9903" class="Symbol">=</a> <a id="9905" href="Data.List.Base.html#4784" class="Function">sum</a> <a id="9909" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9911" href="Data.List.Base.html#1544" class="Function">map</a> <a id="9915" class="Symbol">(</a><a id="9916" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a> <a id="9922" href="Function.Base.html#1031" class="Function Operator">âˆ˜</a> <a id="9924" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a><a id="9929" class="Symbol">)</a> <a id="9931" href="SecureCompilation.Coherence.html#9829" class="Bound">toSpend</a>

        <a id="9948" href="SecureCompilation.Coherence.html#9948" class="Bound">Î“</a> <a id="9950" class="Symbol">=</a> <a id="9952" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="9954" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a> <a id="9957" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="9959" href="SecureCompilation.Coherence.html#9776" class="Bound">Î“â‚€</a>
          <a id="9972" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="9974" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="9977" href="Data.List.Base.html#1544" class="Function">map</a> <a id="9981" class="Symbol">(Î»{</a> <a id="9985" class="Symbol">(</a><a id="9986" href="SecureCompilation.Coherence.html#9986" class="Bound">Aáµ¢</a> <a id="9989" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9991" href="SecureCompilation.Coherence.html#9991" class="Bound">váµ¢</a> <a id="9994" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9996" href="SecureCompilation.Coherence.html#9996" class="Bound">xáµ¢</a><a id="9998" class="Symbol">)</a> <a id="10000" class="Symbol">â†’</a> <a id="10002" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">âŸ¨</a> <a id="10004" href="SecureCompilation.Coherence.html#9986" class="Bound">Aáµ¢</a> <a id="10007" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="10011" href="SecureCompilation.Coherence.html#9991" class="Bound">váµ¢</a> <a id="10014" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">âŸ©at</a> <a id="10018" href="SecureCompilation.Coherence.html#9996" class="Bound">xáµ¢</a> <a id="10021" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="10023" href="SecureCompilation.Coherence.html#9986" class="Bound">Aáµ¢</a> <a id="10026" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="10032" href="SecureCompilation.Coherence.html#9996" class="Bound">xáµ¢</a> <a id="10035" href="BitML.Semantics.Action.html#729" class="InductiveConstructor Operator">â–·Ë¢</a> <a id="10038" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a> <a id="10041" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="10043" class="Symbol">})</a> <a id="10046" href="SecureCompilation.Coherence.html#9829" class="Bound">toSpend</a>
          <a id="10064" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="10066" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="10069" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10073" class="Symbol">(</a><a id="10074" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">_auth[</a> <a id="10081" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">â™¯â–·</a> <a id="10084" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a> <a id="10087" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a><a id="10088" class="Symbol">)</a> <a id="10090" href="SecureCompilation.Coherence.html#9868" class="Bound">partG</a>
        <a id="10104" href="SecureCompilation.Coherence.html#10104" class="Bound">Î“â‚œ</a> <a id="10107" class="Symbol">=</a> <a id="10109" href="SecureCompilation.Coherence.html#9948" class="Bound">Î“</a> <a id="10111" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="10114" href="SecureCompilation.Coherence.html#9774" class="Bound">t</a>
      <a id="10122" class="Keyword">in</a>
      <a id="10131" class="Comment">-- (i) consume {G}C and its persistent deposits from RË¢</a>
      <a id="10193" class="Symbol">(</a><a id="10194" href="SecureCompilation.Coherence.html#10194" class="Bound">Râ‰ˆ</a> <a id="10197" class="Symbol">:</a> <a id="10199" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="10202" href="SymbolicModel.Run.html#1482" class="Function Operator">â‰ˆâ‹¯</a> <a id="10205" href="SecureCompilation.Coherence.html#10104" class="Bound">Î“â‚œ</a><a id="10207" class="Symbol">)</a>

    <a id="10214" class="Symbol">â†’</a> <a id="10216" class="Keyword">let</a>
        <a id="10228" href="SecureCompilation.Coherence.html#10228" class="Bound">Î±</a>   <a id="10232" class="Symbol">=</a> <a id="10234" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">initâ¦…</a> <a id="10240" href="SecureCompilation.Coherence.html#9810" class="Bound">G</a> <a id="10242" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">,</a> <a id="10244" href="SecureCompilation.Coherence.html#9814" class="Bound">C</a> <a id="10246" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">â¦†</a>
        <a id="10256" href="SecureCompilation.Coherence.html#10256" class="Bound">Î“â€²</a>  <a id="10260" class="Symbol">=</a> <a id="10262" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">âŸ¨</a> <a id="10264" href="SecureCompilation.Coherence.html#9814" class="Bound">C</a> <a id="10266" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="10268" href="SecureCompilation.Coherence.html#9895" class="Bound">v</a> <a id="10270" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">âŸ©at</a> <a id="10274" href="BitML.BasicTypes.html#486" class="Generalizable">z</a> <a id="10276" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">âˆ£</a> <a id="10278" href="SecureCompilation.Coherence.html#9776" class="Bound">Î“â‚€</a>
        <a id="10289" href="SecureCompilation.Coherence.html#10289" class="Bound">tâ€²</a>  <a id="10293" class="Symbol">=</a> <a id="10295" href="SecureCompilation.Coherence.html#9774" class="Bound">t</a>
        <a id="10305" href="SecureCompilation.Coherence.html#10305" class="Bound">Î“â‚œâ€²</a> <a id="10309" class="Symbol">=</a> <a id="10311" href="SecureCompilation.Coherence.html#10256" class="Bound">Î“â€²</a> <a id="10314" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="10317" href="SecureCompilation.Coherence.html#10289" class="Bound">tâ€²</a>
      <a id="10326" class="Keyword">in</a>
      <a id="10335" class="Symbol">(</a><a id="10336" href="SecureCompilation.Coherence.html#10336" class="Bound">âˆƒÎ“â‰ˆ</a> <a id="10340" class="Symbol">:</a> <a id="10342" href="Data.Product.html#1369" class="Function">âˆƒ</a> <a id="10344" class="Symbol">(</a><a id="10345" href="SecureCompilation.Coherence.html#1959" class="Function Operator">_â‰ˆá¶œ</a> <a id="10349" href="SecureCompilation.Coherence.html#10256" class="Bound">Î“â€²</a><a id="10351" class="Symbol">))</a> <a id="10354" class="Symbol">â†’</a>
      <a id="10362" class="Keyword">let</a>
        <a id="10374" href="SecureCompilation.Coherence.html#10374" class="Bound">Î“â†’Î“â€²</a> <a id="10379" class="Symbol">:</a> <a id="10381" href="SecureCompilation.Coherence.html#10104" class="Bound">Î“â‚œ</a> <a id="10384" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">â€”[</a> <a id="10387" href="SecureCompilation.Coherence.html#10228" class="Bound">Î±</a> <a id="10389" href="BitML.Semantics.InferenceRules.html#8476" class="Datatype Operator">]â†’â‚œ</a> <a id="10393" href="SecureCompilation.Coherence.html#10305" class="Bound">Î“â‚œâ€²</a>
        <a id="10405" href="SecureCompilation.Coherence.html#10374" class="Bound">Î“â†’Î“â€²</a> <a id="10410" class="Symbol">=</a> <a id="10412" href="BitML.Semantics.InferenceRules.html#8583" class="InductiveConstructor">[Action]</a> <a id="10421" href="BitML.Semantics.InferenceRules.html#5119" class="InductiveConstructor">[C-Init]</a> <a id="10430" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="10444" class="Keyword">open</a> <a id="10449" href="SymbolicModel.Helpers.html#9833" class="Module">Hâ‚„</a> <a id="10452" class="Symbol">{</a><a id="10453" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a><a id="10455" class="Symbol">}</a> <a id="10457" href="SecureCompilation.Coherence.html#1126" class="Generalizable">ğ•£</a> <a id="10459" href="SecureCompilation.Coherence.html#9774" class="Bound">t</a> <a id="10461" href="SecureCompilation.Coherence.html#10228" class="Bound">Î±</a> <a id="10463" href="SecureCompilation.Coherence.html#10289" class="Bound">tâ€²</a> <a id="10466" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a> <a id="10469" href="SecureCompilation.Coherence.html#9776" class="Bound">Î“â‚€</a> <a id="10472" href="SecureCompilation.Coherence.html#9829" class="Bound">toSpend</a> <a id="10480" href="SecureCompilation.Coherence.html#9895" class="Bound">v</a> <a id="10482" href="BitML.BasicTypes.html#486" class="Generalizable">z</a> <a id="10484" href="SecureCompilation.Coherence.html#10194" class="Bound">Râ‰ˆ</a> <a id="10487" href="SecureCompilation.Coherence.html#10374" class="Bound">Î“â†’Î“â€²</a> <a id="10492" href="SecureCompilation.Coherence.html#10336" class="Bound">âˆƒÎ“â‰ˆ</a>

        <a id="10505" href="SecureCompilation.Coherence.html#10505" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="10511" class="Symbol">:</a> <a id="10513" href="Bitcoin.Tx.Base.html#1255" class="Function">âˆƒTx</a>
        <a id="10525" href="SecureCompilation.Coherence.html#10505" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="10531" class="Symbol">=</a>
          <a id="10543" class="Keyword">let</a> <a id="10547" class="Comment">-- invoke compiler</a>
            <a id="10578" href="SecureCompilation.Coherence.html#10578" class="Bound">KÌ‚</a> <a id="10581" class="Symbol">:</a> <a id="10583" href="SymbolicModel.Collections.html#5546" class="Function">ğ•‚</a> <a id="10585" href="SecureCompilation.Coherence.html#9810" class="Bound">G</a>
            <a id="10599" href="SecureCompilation.Coherence.html#10578" class="Bound">KÌ‚</a> <a id="10602" class="Symbol">{</a><a id="10603" href="SecureCompilation.Coherence.html#10603" class="Bound">p</a><a id="10604" class="Symbol">}</a> <a id="10606" class="Symbol">_</a> <a id="10608" class="Symbol">=</a> <a id="10610" href="ComputationalModel.KeyPairs.html#297" class="Function">KÌ‚</a> <a id="10613" href="SecureCompilation.Coherence.html#10603" class="Bound">p</a>

            <a id="10628" class="Keyword">open</a> <a id="10633" href="SymbolicModel.Helpers.html#13491" class="Module">Hâ‚„â€²</a>

            <a id="10650" href="SecureCompilation.Coherence.html#10650" class="Bound">âˆƒtxÂ¹</a> <a id="10655" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10657" class="Symbol">_</a> <a id="10659" class="Symbol">=</a> <a id="10661" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="10676" class="Symbol">{</a><a id="10677" class="Argument">ad</a> <a id="10680" class="Symbol">=</a> <a id="10682" href="SecureCompilation.Coherence.html#9781" class="Bound">ad</a><a id="10684" class="Symbol">}</a> <a id="10686" href="SymbolicModel.Helpers.html#3154" class="Function">vad</a> <a id="10690" href="SymbolicModel.Helpers.html#3523" class="Function">sechashâ‚€</a> <a id="10699" href="SymbolicModel.Helpers.html#3250" class="Function">txoutâ‚€</a> <a id="10706" href="SecureCompilation.Coherence.html#10578" class="Bound">KÌ‚</a> <a id="10709" href="SymbolicModel.Helpers.html#3680" class="Function">Îºâ‚€</a>
          <a id="10722" class="Keyword">in</a>
            <a id="10737" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="10740" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="10743" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="10749" href="SecureCompilation.Coherence.html#10650" class="Bound">âˆƒtxÂ¹</a>

        <a id="10763" class="Comment">-- (ii) append Táµ¢â‚™áµ¢â‚œ to the blockchain</a>
        <a id="10810" href="SecureCompilation.Coherence.html#10810" class="Bound">Î»á¶œ</a> <a id="10813" class="Symbol">=</a> <a id="10815" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="10822" href="SecureCompilation.Coherence.html#10505" class="Bound">Táµ¢â‚™áµ¢â‚œ</a>

        <a id="10837" class="Comment">-- (iii) sechash = sechashâ€², Îº = Îºâ€², txout extends txoutâ€² with (z â†¦ Táµ¢â‚™áµ¢â‚œ)</a>
        <a id="10920" class="Keyword">open</a> <a id="10925" href="SymbolicModel.Helpers.html#13842" class="Module">Hâ‚„â€³</a> <a id="10929" class="Symbol">(</a><a id="10930" href="SecureCompilation.Coherence.html#10505" class="Bound">Táµ¢â‚™áµ¢â‚œ</a> <a id="10936" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="10939" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="10941" class="Symbol">)</a>
      <a id="10949" class="Keyword">in</a>
      <a id="10958" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
      <a id="11037" href="SecureCompilation.Coherence.html#2148" class="Datatype">coherâ‚â‚</a> <a id="11045" href="SymbolicModel.Run.html#742" class="Generalizable">RË¢</a> <a id="11048" href="SymbolicModel.Helpers.html#1546" class="Function">ğ•’</a> <a id="11050" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rá¶œ</a> <a id="11053" href="SecureCompilation.Coherence.html#10810" class="Bound">Î»á¶œ</a> <a id="11056" href="SymbolicModel.Helpers.html#2255" class="Function">ğ•£â€²</a>

<a id="11060" class="Comment">{-
  -- ** Contract actions: authorize control
  [5] : let open â„ ğ•£ in
      âˆ€ {âŸ¨GâŸ©C : Ad} â†’ let âŸ¨ G âŸ© C = âŸ¨GâŸ©C; partG = G âˆ™partG in
      âˆ€ {v x Î“â‚€ t câ€²} {i : Index câ€²} â†’ let d = câ€² â€¼ i; dâˆ— = removeTopDecorations d in
      let Î“ = âŸ¨ câ€² , v âŸ©at x âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      -- D â‰¡ A âˆ¶ Dâ€²
      (Dâ‰¡A:Dâ€² : A âˆˆ authDecorations d)

      -- (i) RË¢ contains âŸ¨Câ€² , vâŸ©â‚“ with Câ€² = D + âˆ‘áµ¢ Dáµ¢
    â†’ (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

      -- (ii) {G}C is the ancestor of âŸ¨Câ€², vâŸ©â‚“ in RË¢
    â†’ (anc : Ancestor RË¢ (câ€² , v , x) âŸ¨GâŸ©C)
    â†’ let dâŠ† , adâˆˆ , _ = anc

          dâˆˆ : d âˆˆ subtermsá¶œâ€² C
          dâˆˆ = dâŠ† (âˆˆ-lookup i)
      in

      -- [T0D0] additional hypotheses, should hold since we know the following:
      --   âˆ™  ...
      (namesâŠ† : G âŠ†â¦…áµ–namesá¶œâ¦† Î“â‚€)

      -- [T0D0] additional hypotheses, should hold since we know the following:
      --   âˆ™  ...
    â†’ (Aâˆˆ : A âˆˆ partG)

    â†’ let
        Î±   = auth-controlâ¦… A , x â–· d â¦†
        Î“â€²  = âŸ¨ câ€² , v âŸ©at x âˆ£ A auth[ x â–· d ] âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      -- Hypotheses from [C-AuthControl], already in hypothesis `Dâ‰¡A:Dâ€²`
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] ([C-AuthControl] Dâ‰¡A:Dâ€²) refl

        -- (iv) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚… {RË¢} ğ•£ t Î± tâ€² câ€² v x Î“â‚€ A i Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ

        vad : Valid âŸ¨GâŸ©C
        vad =
          let _ , Râ€² , adâˆˆRâ€² = âŸ¨c,vâŸ©âˆˆâ‰ˆâ‡’adâˆˆ {RË¢} Râ‰ˆ (here refl)
          in adâˆˆâ‡’valid {R = Râ€²} adâˆˆRâ€²

        -- (iii) broadcast transaction T, as obtained from the compiler, signed by A
        --       where âˆ™ (Tâ€²,o) = txoutâ€²(x)
        --             âˆ™ T is the first transaction in Bd(d,d,Tâ€²,o,v,partG,0)
        --       i.e. the one corresponding to subterm `dâˆ— = removeTopDecorations d`
        T : âˆƒTx
        T =
          let -- invoke compiler
            KÌ‚ : ğ•‚ G
            KÌ‚ {p} _ = KÌ‚ p

            open Hâ‚…â€² âŸ¨GâŸ©C adâˆˆ namesâŠ†

            -- retrieve transaction for specific subterm
            dâˆ—âˆˆ : dâˆ— âˆˆ subtermsáµƒâº âŸ¨GâŸ©C
            dâˆ—âˆˆ = h-subá¶œ {ds = C} dâˆˆ

            âˆƒtxÂ¹ = projâ‚‚ (bitml-compiler {ad = âŸ¨GâŸ©C} vad sechashâ‚€ txoutâ‚€ KÌ‚ Îºâ‚€) dâˆ—âˆˆ
          in
            -, -, projâ‚‚ âˆƒtxÂ¹

        Î»á¶œ = B â†’âˆ—âˆ¶ [ SIGáµ– (pub $ Îºâ€² adâˆˆ dâˆˆ {A} Aâˆˆ) T ]
      in
      -- (v) transaction T has been previously broadcasted in Rá¶œ, and Î»á¶œ is the first signature on T after that
      (âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ]) Rá¶œ)
    â†’ All (Î» l â†’ Â¬ âˆƒ Î» B â†’ Â¬ âˆƒ Î» k â†’ l â‰¡ B â†’âˆ—âˆ¶ [ SIGáµ– k T ]) (Any-tail âˆƒÎ»)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Contract actions: put
  [6] : âˆ€ {âŸ¨GâŸ©Câ€³ : Ad} {vad : Valid âŸ¨GâŸ©Câ€³} â†’ let âŸ¨ G âŸ© Câ€³ = âŸ¨GâŸ©Câ€³; partG = G âˆ™partG in
        -- [T0D0] should we *derive* that âŸ¨GâŸ©C is valid??
        âˆ€ {ds : List (Participant Ã— S.Value Ã— Id)} {ss : List (Participant Ã— Secret Ã— â„•)}
          {i : Index c} â†’ let d = c â€¼ i; dâˆ— = removeTopDecorations d; As , ts = decorations d in

      let
        -- (i) xs = xâ‚â‹¯xâ‚–
        (_ , vs , xs) = unzipâ‚ƒ ds
        (_ , as , _)  = unzipâ‚ƒ ss
        Î“â‚ = || map (Î»{ (Aáµ¢ , váµ¢ , xáµ¢) â†’ âŸ¨ Aáµ¢ has váµ¢ âŸ©at xáµ¢ }) ds
        Î”  = || map (Î»{ (Bi , ai , Ni) â†’ Bi âˆ¶ ai â™¯ Ni       }) ss
        Î“â‚‚ = Î” âˆ£ Î“â‚€
        Î“  = âŸ¨ c , v âŸ©at y âˆ£ (Î“â‚ âˆ£ Î“â‚‚)
        Î“â‚œ = Î“ at t
      in
      -- ii) in RË¢, Î± consumes âŸ¨D+C,vâŸ©y and the deposits âŸ¨Aáµ¢,váµ¢âŸ©â‚“áµ¢ to produce âŸ¨Câ€²,vâ€²âŸ©yâ€²
      --     where D = â‹¯ : putâ‹¯revealâ‹¯.Câ€²
      --     let t be the maximum deadline in an after in front of D
      --     T0D0: what should tâ€² be in case there are not after decorations?
      (dâ‰¡ : d â‰¡â‹¯âˆ¶ put xs &amp;reveal as if p â‡’ câ€²)
    â†’ (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

      -- (iii) {G}Câ€³ is the ancestor of âŸ¨D+C,vâŸ©y in RË¢
    â†’ (anc : Ancestor RË¢ (c , v , y) âŸ¨GâŸ©Câ€³)
    â†’ let
        dâŠ† , adâˆˆ , _ = anc

        dâˆˆ : d âˆˆ subtermsá¶œâ€² Câ€³
        dâˆˆ = dâŠ† (âˆˆ-lookup i)
      in
      -- hypotheses from [C-PutRev]
      (pâŸ¦Î”âŸ§â‰¡ : S.âŸ¦ p âŸ§ Î” â‰¡ just true)
      -- hypotheses from [Timeout]
      (Asâ‰¡âˆ… : As â‰¡ [])
      -- (âˆ€â‰¤t : All (_â‰¤ t) ts)
      (tâ‰¡ : t â‰¡ maximum t ts)
      -- [T0D0] additional hypotheses, should hold since we know the following:
      --   âˆ™  ...
      (namesâŠ† : G âŠ†â¦…áµ–namesá¶œâ¦† Î“â‚‚) â†’
      let
        Î±   = putâ¦… xs , as , y â¦†
        Î“â€²  = âŸ¨ câ€² , v + sum vs âŸ©at yâ€² âˆ£ Î“â‚‚
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        âˆ€â‰¤t : All (_â‰¤ tâ€²) ts
        âˆ€â‰¤t = âŸª (Î» â—† â†’ All (_â‰¤ â—†) ts) âŸ« tâ‰¡ ~: âˆ€â‰¤max t ts

        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Timeout] Asâ‰¡âˆ… âˆ€â‰¤t
                 (âŸª (Î» â—† â†’ (âŸ¨ [ â—† ] , v âŸ©at y âˆ£ (Î“â‚ âˆ£ Î“â‚‚) â€”[ Î± ]â†’ Î“â€²)) âŸ« dâ‰¡ ~: [C-PutRev] {ds = ds} {ss = ss} pâŸ¦Î”âŸ§â‰¡) refl

        open Hâ‚† {RË¢} ğ•£ t Î± tâ€² c v y ds Î“â‚‚ câ€² yâ€² Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ

        -- (iv) submit transaction T
        --      where âˆ™ (Tâ€²,o) = txoutâ€²(y)
        --            âˆ™ T is the first transaction in Bc(câ€²,d,Tâ€²,o,vâ€²,xâƒ—,partG,t)
        --      i.e. the one corresponding to subterm `dâˆ— = put xs &amp;reveal as if p â†’ câ€²`
        T : âˆƒTx
        T =
          let -- invoke compiler
            K : ğ•‚ G
            K {p} _ = KÌ‚ p

            open Hâ‚†â€³ âŸ¨GâŸ©Câ€³ adâˆˆ namesâŠ†

            -- retrieve transaction for specific subterm
            dâˆ—âˆˆ : dâˆ— âˆˆ subtermsá¶œâº Câ€³
            dâˆ—âˆˆ = h-subá¶œ {ds = Câ€³} dâˆˆ

            âˆƒtx : âˆƒTxá¶œ dâˆ—
            âˆƒtx = projâ‚‚ (bitml-compiler {ad = âŸ¨GâŸ©Câ€³} vad sechashâ‚€ txoutâ‚€ K Îºâ‚€) dâˆ—âˆˆ

            âˆƒtxÂ¹ : âˆƒTxÂ¹
            âˆƒtxÂ¹ = âˆƒtx :~ dâ‰¡ âŸª âˆƒTxá¶œ âŸ«
          in
            -, -, projâ‚‚ âˆƒtxÂ¹

        Î»á¶œ = submit T

        -- (v) extend txoutâ€² with {yâ€²â†¦(T,0)}, sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚†â€² (T at 0F)
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Contract actions: authorize reveal
  [7] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
      âˆ€ {a n} â†’ let Î“ = âŸ¨ A âˆ¶ a â™¯ just n âŸ© âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in
      âˆ€ {Î”Ã—hÌ… : List (Secret Ã— Maybe â„• Ã— â„¤)} {kâƒ— : ğ•‚Â²â€² âŸ¨GâŸ©C} â†’ let âŸ¨ G âŸ© C = âŸ¨GâŸ©C in

      âˆ£ m âˆ£áµ â‰¤ Î·
    â†’ (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = auth-revâ¦… A , a â¦†
        Î“â€²  = A âˆ¶ a â™¯ n âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [C-AuthRev] refl

        C : Message
        C = encode {RË¢ = RË¢} txoutâ€² âŸ¨GâŸ©C

        Î” : List (Secret Ã— Maybe â„•)
        Î” = map (Î»{ (s , mn , _) â†’ s , mn }) Î”Ã—hÌ…

        hÌ… : Message
        hÌ… = map (projâ‚‚ âˆ˜ projâ‚‚) Î”Ã—hÌ…

        kÌ… : Message
        kÌ… = concatMap (map pub âˆ˜ codom) (codom kâƒ—)

        aâˆˆ : a âˆˆ namesË¡ RË¢
        aâˆˆ = âˆˆnamesË¡-resp-â‰ˆ a {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

        -- T0D0: should we search for a signature of this message instead?
        C,hÌ…,kÌ… : Message
        C,hÌ…,kÌ… = C â—‡ hÌ… â—‡ kÌ…

        -- (i) some participant B broadcasts message m
        Î»á¶œ = B â†’âˆ—âˆ¶ m

        -- (iii) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚‡ {RË¢} ğ•£ t Î± tâ€² A a n Î“â‚€ Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      -- (ii) in Rá¶œ we find â‹¯ (B â†’ O âˆ¶ m) (O â†’ B : sechashâ€²(a)) for some B â‹¯
      (âˆƒ Î» B â†’ (B , m , [ sechashâ€² {a} aâˆˆ ]) âˆˆ oracleInteractions Rá¶œ)

      -- (iv) in RË¢, we find an A:{G}C,âˆ† action, with a in G
    â†’ (âˆƒÎ± : auth-commitâ¦… A , âŸ¨GâŸ©C , Î” â¦† âˆˆ labels RË¢)
    â†’ a âˆˆ namesË¡ G

      -- ... with a corresponding broadcast of mâ€²=(C,hÌ…,kÌ…) in Rá¶œ
    â†’ (âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ C,hÌ…,kÌ…) Rá¶œ)

      -- (v) Î»á¶œ is the first broadcast of m after the first broadcast of mâ€²
    â†’ All (Î» l â†’ âˆ€ X â†’ l â‰¢ X â†’âˆ—âˆ¶ m) (Any-tail âˆƒÎ»)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Contract actions: split
  [8] : âˆ€ {âŸ¨GâŸ©Câ€² : Ad} {vad : Valid âŸ¨GâŸ©Câ€²} â†’ let âŸ¨ G âŸ© Câ€² = âŸ¨GâŸ©Câ€²; partG = G âˆ™partG in
        âˆ€ {i : Index c} â†’ let d = c â€¼ i; dâˆ— = removeTopDecorations d; As , ts = decorations d in
        âˆ€ {vcis : List (S.Value Ã— Contracts Ã— Id)} â†’ let vs , cs , xs = unzipâ‚ƒ vcis; v = sum vs in
        âˆ€ {t} â†’ let Î“ = âŸ¨ c , v âŸ©at y âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      -- (i) in RË¢, Î± consumes âŸ¨D+C,vâŸ©y to obtain âŸ¨Câ‚€,vâ‚€âŸ©â‚“â‚€ | â‹¯ | âŸ¨Câ‚–,vâ‚–âŸ©â‚“â‚–
      --     where D = â‹¯ : split vs â†’ cs
      --     let t be the maximum deadline in an after in front of D
      --     T0D0: what should tâ€² be in case there are not after decorations?
      (dâ‰¡ : d â‰¡â‹¯âˆ¶ split (zip vs cs))
    â†’ (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

      -- (iii) {G}Câ€² is the ancestor of âŸ¨D+C,vâŸ©y in RË¢
    â†’ (anc : Ancestor RË¢ (c , v , y) âŸ¨GâŸ©Câ€²)
    â†’ let dâŠ† , adâˆˆ , _ = anc

          dâˆˆ : d âˆˆ subtermsá¶œâ€² Câ€²
          dâˆˆ = dâŠ† (âˆˆ-lookup i)
      in
      -- hypotheses from [Timeout]
      (Asâ‰¡âˆ… : As â‰¡ [])
      -- (âˆ€â‰¤t : All (_â‰¤ t) ts)
      (tâ‰¡ : t â‰¡ maximum t ts)
      -- [T0D0] additional hypotheses, should hold since we know the following:
      --   âˆ™  ...
      (namesâŠ† : G âŠ†â¦…áµ–namesá¶œâ¦† Î“â‚€)

    â†’ let
        Î±   = splitâ¦… y â¦†
        Î“â€²  = || map (Î»{ (váµ¢ , cáµ¢ , xáµ¢) â†’ âŸ¨ cáµ¢ , váµ¢ âŸ©at xáµ¢ }) vcis âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        âˆ€â‰¤t : All (_â‰¤ tâ€²) ts
        âˆ€â‰¤t = âŸª (Î» â—† â†’ All (_â‰¤ â—†) ts) âŸ« tâ‰¡ ~: âˆ€â‰¤max t ts

        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Timeout] Asâ‰¡âˆ… âˆ€â‰¤t (âŸª (Î» â—† â†’ âŸ¨ [ â—† ] , v âŸ©at y âˆ£ Î“â‚€ â€”[ Î± ]â†’ Î“â€²) âŸ« dâ‰¡ ~: [C-Split] {vcis = vcis}) refl

        open Hâ‚ˆ {RË¢} ğ•£ t Î± tâ€² c v y Î“â‚€ vcis Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ

        -- (iii) submit transaction T
        --       where âˆ™ (Tâ€²,o) = txoutâ€²(y)
        --             âˆ™ T is the first transaction in Bpar(cs,d,Tâ€²,o,partG,t)
        --       i.e. the one corresponding to subterm `dâˆ— = split (zip vs cs)`
        T : âˆƒ Î» i â†’ Tx i (length xs)
        T =
          let -- invoke compiler
            K : ğ•‚ G
            K {p} _ = KÌ‚ p

            open Hâ‚ˆâ€³ âŸ¨GâŸ©Câ€² adâˆˆ namesâŠ†

            -- retrieve transaction for specific subterm
            dâˆ—âˆˆ : dâˆ— âˆˆ subtermsá¶œâº Câ€²
            dâˆ—âˆˆ = h-subá¶œ {ds = Câ€²} dâˆˆ

            âˆƒtx : âˆƒTxá¶œ dâˆ—
            âˆƒtx = projâ‚‚ (bitml-compiler {ad = âŸ¨GâŸ©Câ€²} vad sechashâ‚€ txoutâ‚€ K Îºâ‚€) dâˆ—âˆˆ

            âˆƒtxâ€² : âˆƒ[ i ] Tx i (length $ zip vs cs)
            âˆƒtxâ€² = âˆƒtx :~ dâ‰¡ âŸª âˆƒTxá¶œ âŸ«

            open â‰¡-Reasoning
            vsâ‰¡ , csâ‰¡ , xsâ‰¡ = length-unzipâ‚ƒ vcis

            lâ‰¡ : length xs â‰¡ length (zip vs cs)
            lâ‰¡ = sym
               $ begin length (zip vs cs)    â‰¡âŸ¨ L.length-zipWith _,_ vs cs âŸ©
                       length vs âŠ“ length cs â‰¡âŸ¨ Nat.mâ‰¥nâ‡’mâŠ“nâ‰¡n $ Nat.â‰¤-reflexive $ trans csâ‰¡ (sym vsâ‰¡) âŸ©
                       length cs             â‰¡âŸ¨ csâ‰¡ âŸ©
                       length vcis           â‰¡âŸ¨ sym xsâ‰¡ âŸ©
                       length xs             âˆ

            âˆƒtxâ€³ : âˆƒ[ i ] Tx i (length xs)
            âˆƒtxâ€³ = âŸª (Î» â—† â†’ âˆƒ[ i ] Tx i â—†) âŸ« lâ‰¡ ~: âˆƒtxâ€²
          in
            âˆƒtxâ€³

        âˆƒT = -, -, projâ‚‚ T

        Î»á¶œ = submit âˆƒT

        -- (iv) extend txoutâ€² with {xáµ¢ â†¦ (T,i)}, sechash = sechashâ€², Îº = Îºâ€²
        txoutâº : xs â†¦ TxInputâ€²
        txoutâº xâˆˆ = âˆƒT at (L.Any.index xâˆˆ)

        open Hâ‚ˆâ€² txoutâº
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Contract actions: withdraw
  [9] : âˆ€ {âŸ¨GâŸ©Câ€² : Ad} {vad : Valid âŸ¨GâŸ©Câ€²} â†’ let âŸ¨ G âŸ© Câ€² = âŸ¨GâŸ©Câ€²; partG = G âˆ™partG in
        âˆ€ {i : Index c} â†’ let d = c â€¼ i; dâˆ— = removeTopDecorations d; As , ts = decorations d in
        let Î“ = âŸ¨ c , v âŸ©at y âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      -- (i) in RË¢, Î± consumes âŸ¨D+C,vâŸ©y to obtain âŸ¨A,vâŸ©â‚“ (where D = â‹¯ : withdraw A)
      (dâ‰¡ : d â‰¡â‹¯âˆ¶ withdraw A)
    â†’ (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

      -- (ii) {G}Câ€² is the ancestor of âŸ¨D+C,vâŸ©y in RË¢
    â†’ (anc : Ancestor RË¢ (c , v , y) âŸ¨GâŸ©Câ€²)
    â†’ let dâŠ† , adâˆˆ , _ = anc

          dâˆˆ : d âˆˆ subtermsá¶œâ€² Câ€²
          dâˆˆ = dâŠ† (âˆˆ-lookup i)
      in
      -- hypotheses from [Timeout]
      (Asâ‰¡âˆ… : As â‰¡ [])
      (âˆ€â‰¤t : All (_â‰¤ t) ts)
      -- [T0D0] additional hypotheses, should hold since we know the following:
      --   âˆ™  ...
      (namesâŠ† : G âŠ†â¦…áµ–namesá¶œâ¦† Î“â‚€)

    â†’ let
        Î±   = withdrawâ¦… A , v , y â¦†
        Î“â€²  = âŸ¨ A has v âŸ©at x âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let

        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Timeout] Asâ‰¡âˆ… âˆ€â‰¤t (âŸª (Î» â—† â†’ âŸ¨ [ â—† ] , v âŸ©at y âˆ£ Î“â‚€ â€”[ Î± ]â†’ Î“â€²) âŸ« dâ‰¡ ~: [C-Withdraw]) refl

        open Hâ‚‰ {RË¢} ğ•£ t Î± tâ€² c v y Î“â‚€ A x Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ

        --   âˆ™ Tâ€² at o = txoutâ€²(x)
        --   âˆ™ T is the first transaction of Bd(d,d,Tâ€²,o,v,partG,0)
        -- i.e.
        -- (iii) submit transaction T
        --       where âˆ™ (Tâ€²,o) = txoutâ€²(y)
        --             âˆ™ T is the first transaction in Bd(d,d,Tâ€²,o,v,partG,0)
        --       i.e. the one corresponding to subterm `dâˆ— = withdraw A`
        T : âˆƒTx
        T =
          let -- invoke compiler
            K : ğ•‚ G
            K {p} _ = KÌ‚ p

            open Hâ‚‰â€³ âŸ¨GâŸ©Câ€² adâˆˆ namesâŠ†

            -- retrieve transaction for specific subterm
            dâˆ—âˆˆ : dâˆ— âˆˆ subtermsá¶œâº Câ€²
            dâˆ—âˆˆ = h-subá¶œ {ds = Câ€²} dâˆˆ

            âˆƒtx : âˆƒTxá¶œ dâˆ—
            âˆƒtx = projâ‚‚ (bitml-compiler {ad = âŸ¨GâŸ©Câ€²} vad sechashâ‚€ txoutâ‚€ K Îºâ‚€) dâˆ—âˆˆ

            âˆƒtxÂ¹ : âˆƒTxÂ¹
            âˆƒtxÂ¹ = âˆƒtx :~ dâ‰¡ âŸª âˆƒTxá¶œ âŸ«
          in
            -, -, projâ‚‚ âˆƒtxÂ¹

        Î»á¶œ = submit T

        -- (iv) extend txoutâ€² with {x â†¦ (T,0)}, sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚‰â€² (T at 0F)
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: authorize join
  [10] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x xâ€² : Id} â†’ let Î“ = âŸ¨ A has v âŸ©at x âˆ£ âŸ¨ A has vâ€² âŸ©at xâ€² âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = auth-joinâ¦… A , x â†” xâ€² â¦†
        Î“â€²  = âŸ¨ A has v âŸ©at x âˆ£ âŸ¨ A has vâ€² âŸ©at xâ€² âˆ£ A auth[ x â†” xâ€² â–·âŸ¨ A , v + vâ€² âŸ© ] âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-AuthJoin] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

        xâ€²âˆˆ : xâ€² âˆˆ namesÊ³ RË¢
        xâ€²âˆˆ = âˆˆnamesÊ³-resp-â‰ˆ xâ€² {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (there (here refl))
      in
      (âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
                â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
                Ã— (inputs  T â‰¡ hashTxâ± (txoutâ€² {x} xâˆˆ) âˆ· hashTxâ± (txoutâ€² {xâ€²} xâ€²âˆˆ) âˆ· [])
                Ã— (outputs T â‰¡ V.[ Ctx 1 , record {value = v + vâ€²; validator = Æ› (versig [ KÌ‚ A ] [ # 0 ])} ])
                ) Rá¶œ)
    â†’ let
        T : âˆƒTx
        T = 2 , 1 , (projâ‚ $ projâ‚‚ $ projâ‚‚ $ L.Any.satisfied âˆƒÎ»)

        -- (iii) broadcast transaction T, signed by A
        mâ€² = [ SIG (KÌ‚ A) T ]
        Î»á¶œ = B â†’âˆ—âˆ¶ mâ€²

        -- (v) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚€ {RË¢} ğ•£ t Î± tâ€² A v x vâ€² xâ€² Î“â‚€ Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      -- (iv) Î»á¶œ is the first broadcast of mâ€² in Rá¶œ after the first broadcast of T
      All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: join
  [11] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x xâ€² : Id} â†’ let Î“ = âŸ¨ A has v âŸ©at x âˆ£ âŸ¨ A has vâ€² âŸ©at xâ€² âˆ£ A auth[ x â†” xâ€² â–·âŸ¨ A , v + vâ€² âŸ© ] âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = joinâ¦… x â†” xâ€² â¦†
        Î“â€²  = âŸ¨ A has (v + vâ€²) âŸ©at y âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-Join] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

        xâ€²âˆˆ : xâ€² âˆˆ namesÊ³ RË¢
        xâ€²âˆˆ = âˆˆnamesÊ³-resp-â‰ˆ xâ€² {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (there (here refl))

        -- (ii) submit transaction T
        T : âˆƒTx
        T  = 2 , 1 , sigâ‹† (V.replicate [ KÌ‚ A ]) record
           { inputs  = hashTxâ± (txoutâ€² {x} xâˆˆ) âˆ· hashTxâ± (txoutâ€² {xâ€²} xâ€²âˆˆ) âˆ· []
           ; wit     = witâŠ¥
           ; relLock = V.replicate 0
           ; outputs = V.[ (v + vâ€²) -redeemableWith- KÌ‚ A ]
           ; absLock = 0 }
        Î»á¶œ = submit T

        -- (iii) extend txoutâ€² with yâ†¦Tâ‚€ (removing {xâ†¦_;xâ€²â†¦_}), sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚ {RË¢} ğ•£ t Î± tâ€² A v x vâ€² xâ€² y Î“â‚€ Râ‰ˆ (T at 0F) Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: authorize divide (similar to [10])
  [12] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x : Id} â†’ let Î“ = âŸ¨ A has (v + vâ€²) âŸ©at x âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = auth-divideâ¦… A , x â–· v , vâ€² â¦†
        Î“â€²  = âŸ¨ A has (v + vâ€²) âŸ©at x âˆ£ A auth[ x â–·âŸ¨ A , v , vâ€² âŸ© ] âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-AuthDivide] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)
      in
      (âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
                â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
                Ã— (inputs  T â‰¡ V.[ hashTxâ± (txoutâ€² {x} xâˆˆ) ])
                Ã— (outputs T â‰¡ (v -redeemableWith- KÌ‚ A) âˆ· (vâ€² -redeemableWith- KÌ‚ A) âˆ· [])
                ) Rá¶œ)
    â†’ let
        T : âˆƒTx
        T = 1 , 2 , (projâ‚ $ projâ‚‚ $ projâ‚‚ $ L.Any.satisfied âˆƒÎ»)

        -- (iii) broadcast transaction T, signed by A
        mâ€² = [ SIG (KÌ‚ A) T ]
        Î»á¶œ = B â†’âˆ—âˆ¶ mâ€²

        -- (v) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚‚ {RË¢} ğ•£ t Î± tâ€² A v vâ€² x Î“â‚€ Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      -- (iv) Î»á¶œ is the first broadcast of mâ€² in Rá¶œ after the first broadcast of T
      All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: divide (dimilar to [11])
  [13] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x : Id} â†’ let Î“ = âŸ¨ A has (v + vâ€²) âŸ©at x âˆ£ A auth[ x â–·âŸ¨ A , v , vâ€² âŸ© ] âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = divideâ¦… x â–· v , vâ€² â¦†
        Î“â€²  = âŸ¨ A has v âŸ©at y âˆ£ âŸ¨ A has vâ€² âŸ©at yâ€² âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-Divide] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

        -- (iii) submit transaction T
        T  = 1 , 2 , sigâ‹† (V.replicate [ KÌ‚ A ]) record
           { inputs  = V.[ hashTxâ± (txoutâ€² {x} xâˆˆ) ]
           ; wit     = witâŠ¥
           ; relLock = V.replicate 0
           ; outputs = (v -redeemableWith- KÌ‚ A) âˆ· (vâ€² -redeemableWith- KÌ‚ A) âˆ· []
           ; absLock = 0 }
        Î»á¶œ = submit T

        -- (v) extend txoutâ€² with {yâ†¦Tâ‚€, yâ€²â†¦Tâ‚} (removing xâ†¦Tâ‚€), sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚ƒ {RË¢} ğ•£ t Î± tâ€² A v vâ€² x Î“â‚€ y yâ€² Râ‰ˆ (T at 0F) (T at 1F) Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: authorize donate (similar to [10])
  [14] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x : Id} â†’ let Î“ = âŸ¨ A has v âŸ©at x âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = auth-donateâ¦… A , x â–·áµˆ Bâ€² â¦†
        Î“â€²  = âŸ¨ A has v âŸ©at x âˆ£ A auth[ x â–·áµˆ Bâ€² ] âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-AuthDonate] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)
      in
      (âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
                â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
                Ã— (inputs  T â‰¡ V.[ hashTxâ± (txoutâ€² {x} xâˆˆ) ])
                Ã— (outputs T â‰¡ V.[ v -redeemableWith- KÌ‚ Bâ€² ])
                ) Rá¶œ)
    â†’ let
        T : âˆƒTx
        T = 1 , 1 , (projâ‚ $ projâ‚‚ $ projâ‚‚ $ L.Any.satisfied âˆƒÎ»)

        -- (iii) broadcast transaction T, signed by A
        mâ€² = [ SIG (KÌ‚ A) T ]
        Î»á¶œ = B â†’âˆ—âˆ¶ mâ€²

        -- (v) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚„ {RË¢} ğ•£ t Î± tâ€² A v x Î“â‚€ Bâ€² Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      -- (iv) Î»á¶œ is the first broadcast of mâ€² in Rá¶œ after the first broadcast of T
      All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: donate (similar to [11])
  [15] : âˆ€ {RË¢} {ğ•£ : â„ RË¢} â†’ let open â„ ğ•£ in
       âˆ€ {x : Id} â†’ let Î“ = âŸ¨ A has v âŸ©at x âˆ£ A auth[ x â–·áµˆ Bâ€² ] âˆ£ Î“â‚€; Î“â‚œ = Î“ at t in

      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = donateâ¦… x â–·áµˆ Bâ€² â¦†
        Î“â€²  = âŸ¨ Bâ€² has v âŸ©at y âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-Donate] refl

        xâˆˆ : x âˆˆ namesÊ³ RË¢
        xâˆˆ = âˆˆnamesÊ³-resp-â‰ˆ x {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

        -- (iii) submit transaction T
        T  = 1 , 1 , sigâ‹† (V.replicate [ KÌ‚ A ]) record
           { inputs  = V.[ hashTxâ± (txoutâ€² {x} xâˆˆ) ]
           ; wit     = witâŠ¥
           ; relLock = V.replicate 0
           ; outputs = V.[ v -redeemableWith- KÌ‚ Bâ€² ]
           ; absLock = 0 }
        Î»á¶œ = submit T

        -- (v) extend txoutâ€² with yâ†¦Tâ‚€ (removing xâ†¦Tâ‚€), sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚… {RË¢} ğ•£ t Î± tâ€² A v x Bâ€² Î“â‚€ y Râ‰ˆ (T at 0F) Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
      coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** After
  [18] :
    (Î´&gt;0 : Î´ &gt; 0) â†’
    let
      Î“â‚œ@(Î“ at t) = RË¢ .end
      Î±   = delayâ¦… Î´ â¦†
      tâ€²  = (t + Î´)
      Î“â‚œâ€² = Î“ at tâ€²
      Î»á¶œ  = delay Î´
    in
    (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“)) â†’
    let
      Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
      Î“â†’Î“â€² = [Delay] Î´&gt;0

      open Hâ‚â‚ˆ {RË¢} ğ•£ t Î± tâ€² Î“ (â‰ˆáµ—-refl {Î“â‚œ}) Î“â†’Î“â€² âˆƒÎ“â‰ˆ
    in
    --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    coherâ‚â‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²
-}</a>

<a id="32644" class="Keyword">data</a> <a id="32649" href="SecureCompilation.Coherence.html#2251" class="Datatype">coherâ‚â‚‚</a> <a id="32657" class="Keyword">where</a>
<a id="32663" class="Comment">{-
  -- ** Deposits: authorize destroy
  [16] : âˆ€ {ds : List (Participant Ã— S.Value Ã— Id)} {j : Index ds} {xs : Ids}

    â†’ let
        k  = length ds
        xs = map (projâ‚‚ âˆ˜ projâ‚‚) ds
        A  = projâ‚ (ds â€¼ j)
        jâ€² = â€¼-map {xs = ds} j
        Î”  = || map (Î»{ (Báµ¢ , váµ¢ , xáµ¢) â†’ âŸ¨ Báµ¢ has váµ¢ âŸ©at xáµ¢ }) ds
        Î“  = Î” âˆ£ Î“â‚€
        Î“â‚œ = Î“ at t
      in
      -- (ii) in RË¢ we find âŸ¨Báµ¢,váµ¢âŸ©yáµ¢ for i âˆˆ 1..k
      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = auth-destroyâ¦… A , xs , jâ€² â¦†
        Î“â€²  = Î” âˆ£ A auth[ xs , jâ€² â–·áµˆË¢ y ] âˆ£ Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-AuthDestroy] refl

        -- (vii) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        open Hâ‚â‚† {RË¢} ğ•£ t Î± tâ€² ds Î“â‚€  j A y Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      -- (iii) in Rá¶œ we find B â†’ âˆ— âˆ¶ T, for some T having txoutâ€²(yáµ¢) as inputs (+ possibly others)
      (T : Tx i 0)
    â†’ (hashTxâ± &lt;$&gt; codom xsâ†¦) âŠ† V.toList (inputs T)
    â†’ (Tâˆˆ : Any (Î» l â†’ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ]) Rá¶œ)

    â†’ let
        -- (iv) broadcast transaction T, signed by A
        m = [ SIG (KÌ‚ A) T ]
        Î»á¶œ = B â†’âˆ—âˆ¶ m
      in
      -- (v) Î»á¶œ is the first broadcast of m in Rá¶œ after the first broadcast of T
      All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ m) (Any-tail Tâˆˆ)

      -- (vi) Î»á¶œ does not correspond to any *other* symbolic move
    â†’ (âˆ€ Î“â‚œâ€² (ğ•’â€² : ğ”¸ RË¢ Î“â‚œâ€²) (ğ•£ : â„ RË¢) (ğ•£â€² : â„ $ Î“â‚œâ€² âˆ· RË¢ âŠ£ ğ•’â€²)
         â†’ projâ‚ ğ•’â€² â‰¢ projâ‚ ğ•’
         â†’ Â¬ coherâ‚â‚ RË¢ ğ•’â€² Rá¶œ Î»á¶œ ğ•£â€²)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²

  -- ** Deposits: destroy
  [17] : âˆ€ {ds : List (Participant Ã— S.Value Ã— Id)} {j : Index ds} {xs : Ids}

    â†’ let
        xs = map (projâ‚‚ âˆ˜ projâ‚‚) ds
        Î”  = || map (Î»{ (i , Aáµ¢ , váµ¢ , xáµ¢) â†’ âŸ¨ Aáµ¢ has váµ¢ âŸ©at xáµ¢ âˆ£ Aáµ¢ auth[ xs , â€¼-map {xs = ds} i â–·áµˆË¢ y ] }) (enumerate ds)
        Î“  = Î” âˆ£ Î“â‚€
        Î“â‚œ = Î“ at t
      in
      -- (ii) in RË¢, Î± assumes âŸ¨Aáµ¢,váµ¢âŸ©xáµ¢ to obtain 0
      (Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ)

    â†’ let
        Î±   = destroyâ¦… xs â¦†
        Î“â€²  = Î“â‚€
        tâ€²  = t
        Î“â‚œâ€² = Î“â€² at tâ€²
      in
      (âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆá¶œ Î“â€²)) â†’
      let
        Î“â†’Î“â€² : Î“â‚œ â€”[ Î± ]â†’â‚œ Î“â‚œâ€²
        Î“â†’Î“â€² = [Action] [DEP-Destroy] refl

        -- (v) txout = txoutâ€², sechash = sechashâ€², Îº = Îºâ€²
        -- remove {â‹¯ xáµ¢ â†¦ (Táµ¢,j) â‹¯} from txoutâ€²
        open Hâ‚â‚‡ {RË¢} ğ•£ t Î± tâ€² ds Î“â‚€ y Râ‰ˆ Î“â†’Î“â€² âˆƒÎ“â‰ˆ
      in
      (T : Tx i 0)
    â†’ (hashTxâ± &lt;$&gt; codom xsâ†¦) âŠ† V.toList (inputs T)

    â†’ let
        -- (iii) submit transaction T
        Î»á¶œ = submit (_ , _ , T)
      in

      -- (iv) Î»á¶œ does not correspond to any *other* symbolic move
      (âˆ€ Î“â‚œâ€² (ğ•’â€² : ğ”¸ RË¢ Î“â‚œâ€²) (ğ•£â€² : â„ $ Î“â‚œâ€² âˆ· RË¢ âŠ£ ğ•’â€²)
         â†’ projâ‚ ğ•’â€² â‰¢ projâ‚ ğ•’
         â†’ Â¬ coherâ‚â‚ RË¢ ğ•’â€² Rá¶œ Î»á¶œ ğ•£â€²)
      --â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    â†’ coherâ‚â‚‚ RË¢ ğ•’ Rá¶œ Î»á¶œ ğ•£â€²
-}</a>

<a id="35516" class="Keyword">data</a> <a id="35521" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="35528" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="35531" href="SecureCompilation.Coherence.html#35531" class="Bound">txout</a> <a id="35537" class="Keyword">where</a>

  <a id="coherâ‚‚.[1]"></a><a id="35546" href="SecureCompilation.Coherence.html#35546" class="InductiveConstructor">[1]</a> <a id="35550" class="Symbol">:</a>

      <a id="35559" href="Data.List.Relation.Binary.Disjoint.Setoid.html#842" class="Function">Disjoint</a> <a id="35568" class="Symbol">(</a><a id="35569" href="Data.Vec.Base.html#7438" class="Function">V.toList</a> <a id="35578" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="35580" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a> <a id="35587" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="35589" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="35595" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="35597" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a> <a id="35603" href="SecureCompilation.Coherence.html#1110" class="Generalizable">T</a><a id="35604" class="Symbol">)</a> <a id="35606" class="Symbol">(</a><a id="35607" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxâ±</a> <a id="35615" href="Prelude.Functor.html#299" class="Field Operator">&lt;$&gt;</a> <a id="35619" href="Prelude.Lists.html#13278" class="Function">codom</a> <a id="35625" href="SecureCompilation.Coherence.html#35531" class="Bound">txout</a><a id="35630" class="Symbol">)</a>
      <a id="35638" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="35715" class="Symbol">â†’</a> <a id="35717" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="35724" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="35727" href="SecureCompilation.Coherence.html#35531" class="Bound">txout</a> <a id="35733" class="Symbol">(</a><a id="35734" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="35741" href="SecureCompilation.Coherence.html#1110" class="Generalizable">T</a><a id="35742" class="Symbol">)</a>

  <a id="coherâ‚‚.[2]"></a><a id="35747" href="SecureCompilation.Coherence.html#35747" class="InductiveConstructor">[2]</a> <a id="35751" class="Symbol">:</a>

      <a id="35760" class="Symbol">(</a><a id="35761" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="35764" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="35766" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="35768" href="ComputationalModel.Strategy.html#1027" class="InductiveConstructor Operator">â†’Oâˆ¶</a> <a id="35772" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a><a id="35773" class="Symbol">)</a>
    <a id="35779" href="Data.Sum.Base.html#734" class="Datatype Operator">âŠ</a> <a id="35781" class="Symbol">(</a><a id="35782" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a> <a id="35785" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="35787" href="ComputationalModel.Strategy.html#1099" class="InductiveConstructor Operator">Oâ†’</a> <a id="35790" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="35792" href="ComputationalModel.Strategy.html#1099" class="InductiveConstructor Operator">âˆ¶</a> <a id="35794" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a><a id="35795" class="Symbol">)</a>
      <a id="35803" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="35880" class="Symbol">â†’</a> <a id="35882" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="35889" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="35892" href="SecureCompilation.Coherence.html#35531" class="Bound">txout</a> <a id="35898" href="ComputationalModel.Strategy.html#1226" class="Generalizable">Î»á¶œ</a>

  <a id="coherâ‚‚.[3]"></a><a id="35904" href="SecureCompilation.Coherence.html#35904" class="InductiveConstructor">[3]</a> <a id="35908" class="Symbol">:</a> <a id="35910" class="Keyword">let</a> <a id="35914" href="SecureCompilation.Coherence.html#35914" class="Bound">Î»á¶œ</a> <a id="35917" class="Symbol">=</a> <a id="35919" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="35921" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">â†’âˆ—âˆ¶</a> <a id="35925" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a> <a id="35927" class="Keyword">in</a>

      <a id="35937" class="Comment">-- Î»á¶œ does not correspond to any symbolic move</a>
      <a id="35990" class="Symbol">(âˆ€</a> <a id="35993" href="SecureCompilation.Coherence.html#35993" class="Bound">Î“â‚œ</a> <a id="35996" href="SecureCompilation.Coherence.html#35996" class="Bound">Rá¶œ</a> <a id="35999" class="Symbol">(</a><a id="36000" href="SecureCompilation.Coherence.html#36000" class="Bound">ğ•’</a> <a id="36002" class="Symbol">:</a> <a id="36004" href="SymbolicModel.Run.html#1713" class="Function">ğ”¸</a> <a id="36006" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="36009" href="SecureCompilation.Coherence.html#35993" class="Bound">Î“â‚œ</a><a id="36011" class="Symbol">)</a> <a id="36013" class="Symbol">(</a><a id="36014" href="SecureCompilation.Coherence.html#36014" class="Bound">ğ•£â€²</a> <a id="36017" class="Symbol">:</a> <a id="36019" href="SymbolicModel.Collections.html#5953" class="Record">â„</a> <a id="36021" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="36023" href="SecureCompilation.Coherence.html#35993" class="Bound">Î“â‚œ</a> <a id="36026" href="SymbolicModel.Run.html#1839" class="Function Operator">âˆ·</a> <a id="36028" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="36031" href="SymbolicModel.Run.html#1839" class="Function Operator">âŠ£</a> <a id="36033" href="SecureCompilation.Coherence.html#36000" class="Bound">ğ•’</a><a id="36034" class="Symbol">)</a>
         <a id="36045" class="Symbol">â†’</a> <a id="36047" href="Relation.Nullary.html#656" class="Function Operator">Â¬</a> <a id="36049" href="SecureCompilation.Coherence.html#2046" class="Datatype">coherâ‚</a> <a id="36056" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="36059" href="SecureCompilation.Coherence.html#36000" class="Bound">ğ•’</a> <a id="36061" href="SecureCompilation.Coherence.html#35996" class="Bound">Rá¶œ</a> <a id="36064" href="SecureCompilation.Coherence.html#35914" class="Bound">Î»á¶œ</a> <a id="36067" href="SecureCompilation.Coherence.html#36014" class="Bound">ğ•£â€²</a><a id="36069" class="Symbol">)</a>
      <a id="36077" class="Comment">--â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</a>
    <a id="36154" class="Symbol">â†’</a> <a id="36156" href="SecureCompilation.Coherence.html#2354" class="Datatype">coherâ‚‚</a> <a id="36163" href="SecureCompilation.Coherence.html#35528" class="Bound">RË¢</a> <a id="36166" href="SecureCompilation.Coherence.html#35531" class="Bound">txout</a> <a id="36172" href="SecureCompilation.Coherence.html#35914" class="Bound">Î»á¶œ</a>

<a id="36176" class="Comment">{- T0D0: enforce common naming scheme via a module that re-exports names in a systematic way

  e.g. [1]: open â€”â†’âŸ¨ (advertise[ âŸ¨GâŸ©C ]) â‰ˆ (A â†’âˆ—âˆ¶ C) âŸ© (` âŸ¨GâŸ©C âˆ£ Î“) AT t

  module â€”â†’âŸ¨_â‰ˆ_âŸ©_AT_
    (`Î± : S.Label) (`Î»á¶œ : C.Label)
    (`Î“â€² : Cfg) (`tâ€² : S.Time)
    where
      private
        Î±   = `Î±
        Î“â€²  = `Î“â€²
        tâ€²  = `tâ€²
        Î“â‚œâ€² = `Î“â€² at `tâ€²
        Î»á¶œ  = `Î»á¶œ
-}</a>
</pre></body></html>