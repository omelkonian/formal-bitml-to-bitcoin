<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Coherence</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="26" class="Keyword">hiding</a> <a id="33" class="Symbol">(</a><a id="34" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="35" class="Symbol">)</a>
<a id="37" class="Keyword">open</a> <a id="42" href="Prelude.Init.html#5120" class="Module">L.Mem</a>
<a id="48" class="Keyword">open</a> <a id="53" class="Keyword">import</a> <a id="60" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Prelude.DecLists.html" class="Module">Prelude.DecLists</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Prelude.Monoid.html" class="Module">Prelude.Monoid</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="274" class="Keyword">open</a> <a id="279" class="Keyword">import</a> <a id="286" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="351" class="Keyword">open</a> <a id="356" class="Keyword">import</a> <a id="363" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>

<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="433" class="Keyword">using</a> <a id="439" class="Symbol">(</a><a id="440" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a><a id="447" class="Symbol">)</a>

<a id="450" class="Keyword">module</a> <a id="457" href="SecureCompilation.Coherence.html" class="Module">SecureCompilation.Coherence</a>
  <a id="487" class="Symbol">(</a><a id="488" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="500" class="Symbol">:</a> <a id="502" class="PrimitiveType">Set</a><a id="505" class="Symbol">)</a>
  <a id="509" class="Symbol">⦃</a> <a id="511" href="SecureCompilation.Coherence.html#511" class="Bound">_</a> <a id="513" class="Symbol">:</a> <a id="515" href="Prelude.DecEq.Core.html#103" class="Record">DecEq</a> <a id="521" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="533" class="Symbol">⦄</a>
  <a id="537" class="Symbol">(</a><a id="538" href="SecureCompilation.Coherence.html#538" class="Bound">Honest</a> <a id="545" class="Symbol">:</a> <a id="547" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="553" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a><a id="564" class="Symbol">)</a>

  <a id="569" class="Symbol">(</a><a id="570" href="SecureCompilation.Coherence.html#570" class="Bound">finPart</a> <a id="578" class="Symbol">:</a> <a id="580" href="Prelude.Lists.html#26216" class="Function">Finite</a> <a id="587" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a><a id="598" class="Symbol">)</a>
  <a id="602" class="Symbol">(</a><a id="603" href="SecureCompilation.Coherence.html#603" class="Bound">keypairs</a> <a id="612" class="Symbol">:</a> <a id="614" class="Symbol">∀</a> <a id="616" class="Symbol">(</a><a id="617" href="SecureCompilation.Coherence.html#617" class="Bound">A</a> <a id="619" class="Symbol">:</a> <a id="621" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a><a id="632" class="Symbol">)</a> <a id="634" class="Symbol">→</a> <a id="636" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="644" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="646" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a><a id="653" class="Symbol">)</a>

  <a id="658" class="Symbol">(</a><a id="659" href="SecureCompilation.Coherence.html#659" class="Bound">η</a> <a id="661" class="Symbol">:</a> <a id="663" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="664" class="Symbol">)</a> <a id="666" class="Comment">-- security parameter</a>
  <a id="690" class="Keyword">where</a>

<a id="697" class="Keyword">open</a> <a id="702" class="Keyword">import</a> <a id="709" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="723" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="735" href="SecureCompilation.Coherence.html#538" class="Bound">Honest</a> <a id="742" class="Symbol">as</a> <a id="S"></a><a id="745" href="SecureCompilation.Coherence.html#745" class="Module">S</a>
  <a id="749" class="Keyword">hiding</a> <a id="756" class="Symbol">(</a><a id="757" href="Prelude.Closures.html#3164" class="InductiveConstructor Operator">_∎</a><a id="759" class="Symbol">;</a> <a id="761" href="Prelude.Closures.html#3065" class="InductiveConstructor Operator">begin_</a><a id="767" class="Symbol">)</a>

<a id="770" class="Keyword">open</a> <a id="775" class="Keyword">import</a> <a id="782" href="ComputationalModel.Strategy.html" class="Module">ComputationalModel.Strategy</a> <a id="810" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="822" href="SecureCompilation.Coherence.html#538" class="Bound">Honest</a> <a id="829" href="SecureCompilation.Coherence.html#570" class="Bound">finPart</a> <a id="837" href="SecureCompilation.Coherence.html#603" class="Bound">keypairs</a> <a id="846" class="Symbol">as</a> <a id="C"></a><a id="849" href="SecureCompilation.Coherence.html#849" class="Module">C</a>
  <a id="853" class="Keyword">hiding</a> <a id="860" class="Symbol">(</a><a id="861" href="ComputationalModel.Strategy.html#578" class="Function">Hon</a><a id="864" class="Symbol">;</a> <a id="866" href="ComputationalModel.Strategy.html#2324" class="Function">Initial</a><a id="873" class="Symbol">;</a> <a id="875" href="ComputationalModel.Strategy.html#2478" class="Function">Valid</a><a id="880" class="Symbol">;</a> <a id="882" href="ComputationalModel.Strategy.html#4128" class="Field">Σ</a><a id="883" class="Symbol">)</a>
<a id="885" class="Keyword">open</a> <a id="890" class="Keyword">import</a> <a id="897" href="Bitcoin.html" class="Module">Bitcoin</a> <a id="905" class="Symbol">as</a> <a id="908" class="Module">C</a>
  <a id="912" class="Keyword">hiding</a> <a id="919" class="Symbol">(</a><a id="920" href="Bitcoin.BasicTypes.html#313" class="Generalizable">t</a><a id="921" class="Symbol">;</a> <a id="923" href="Bitcoin.BasicTypes.html#315" class="Generalizable">t′</a><a id="925" class="Symbol">;</a> <a id="927" href="Bitcoin.Script.Base.html#917" class="InductiveConstructor">`</a><a id="928" class="Symbol">;</a> <a id="930" href="Bitcoin.Script.Base.html#1293" class="InductiveConstructor Operator">∣_∣</a><a id="933" class="Symbol">;</a> <a id="935" href="Bitcoin.Consistency.html#3116" class="InductiveConstructor">∙</a><a id="936" class="Symbol">)</a>

<a id="939" class="Keyword">open</a> <a id="944" class="Keyword">import</a> <a id="951" href="SecureCompilation.Compiler.html" class="Module">SecureCompilation.Compiler</a> <a id="978" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="990" href="SecureCompilation.Coherence.html#538" class="Bound">Honest</a> <a id="997" href="SecureCompilation.Coherence.html#659" class="Bound">η</a>

<a id="authorizedHonAdsᶜ"></a><a id="1000" href="SecureCompilation.Coherence.html#1000" class="Function">authorizedHonAdsᶜ</a> <a id="1018" class="Symbol">=</a> <a id="1020" href="BitML.Semantics.Configurations.Helpers.html#5795" class="Function">authorizedHonAds</a> <a id="1037" class="Symbol">{</a><a id="1038" class="Argument">X</a> <a id="1040" class="Symbol">=</a> <a id="1042" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a><a id="1045" class="Symbol">}</a>
<a id="1047" class="Comment">-- authorizedHonAdsʳ = authorizedHonAds {X = Run}</a>

<a id="1098" class="Keyword">private</a>
  <a id="1108" class="Keyword">variable</a>
    <a id="1121" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="1126" href="SecureCompilation.Coherence.html#1126" class="Generalizable">⟨G⟩C′</a> <a id="1132" href="SecureCompilation.Coherence.html#1132" class="Generalizable">⟨G⟩C″</a> <a id="1138" class="Symbol">:</a> <a id="1140" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a>
    <a id="1158" href="SecureCompilation.Coherence.html#1158" class="Generalizable">T</a> <a id="1160" href="SecureCompilation.Coherence.html#1160" class="Generalizable">T′</a> <a id="1163" class="Symbol">:</a> <a id="1165" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>

    <a id="1174" class="Comment">-- Rˢ : S.Run</a>
    <a id="1192" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a>  <a id="1195" class="Symbol">:</a> <a id="1197" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="1199" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a>

    <a id="1207" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a> <a id="1210" href="SecureCompilation.Coherence.html#1210" class="Generalizable">∃𝕣′</a> <a id="1214" class="Symbol">:</a> <a id="1216" href="Data.Product.html#1369" class="Function">∃</a> <a id="1218" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a>

<a id="1221" class="Keyword">postulate</a>
  <a id="encode"></a><a id="1233" href="SecureCompilation.Coherence.html#1233" class="Postulate">encode</a> <a id="1240" class="Symbol">:</a> <a id="1242" href="SymbolicModel.Collections.html#3418" class="Function">Txout</a> <a id="1248" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="1251" class="Symbol">→</a> <a id="1253" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a> <a id="1267" class="Symbol">→</a> <a id="1269" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
  <a id="1279" class="Comment">-- ^ encode {G}C as a bitstring, representing each x in it as txout(x)</a>

  <a id="SIGᵖ"></a><a id="1353" href="SecureCompilation.Coherence.html#1353" class="Postulate">SIGᵖ</a> <a id="1358" class="Symbol">:</a> <a id="1360" class="Symbol">∀</a> <a id="1362" class="Symbol">{</a><a id="1363" href="SecureCompilation.Coherence.html#1363" class="Bound">A</a> <a id="1365" class="Symbol">:</a> <a id="1367" class="PrimitiveType">Set</a><a id="1370" class="Symbol">}</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1376" class="Comment">{- public key -}</a> <a id="1393" class="Symbol">→</a> <a id="1395" href="SecureCompilation.Coherence.html#1363" class="Bound">A</a> <a id="1397" class="Symbol">→</a> <a id="1399" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>

  <a id="∣_∣ᶻ"></a><a id="1404" href="SecureCompilation.Coherence.html#1404" class="Postulate Operator">∣_∣ᶻ</a> <a id="1409" class="Symbol">:</a> <a id="1411" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="∣_∣ᵐ"></a><a id="1419" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣_∣ᵐ</a> <a id="1424" class="Symbol">:</a> <a id="1426" href="ComputationalModel.Strategy.html#790" class="Function">Message</a> <a id="1434" class="Symbol">→</a> <a id="1436" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="_-redeemableWith-_"></a><a id="1439" href="SecureCompilation.Coherence.html#1439" class="Function Operator">_-redeemableWith-_</a> <a id="1458" class="Symbol">:</a> <a id="1460" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="1468" class="Symbol">→</a> <a id="1470" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1478" class="Symbol">→</a> <a id="1480" href="Bitcoin.Tx.Base.html#793" class="Function">∃TxOutput</a>
<a id="1490" href="SecureCompilation.Coherence.html#1490" class="Bound">v</a> <a id="1492" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="1509" href="SecureCompilation.Coherence.html#1509" class="Bound">k</a> <a id="1511" class="Symbol">=</a> <a id="1513" href="Bitcoin.Script.Base.html#375" class="InductiveConstructor">Ctx</a> <a id="1517" class="Number">1</a> <a id="1519" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1521" class="Keyword">record</a> <a id="1528" class="Symbol">{</a><a id="1529" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="1535" class="Symbol">=</a> <a id="1537" href="SecureCompilation.Coherence.html#1490" class="Bound">v</a><a id="1538" class="Symbol">;</a>  <a id="1541" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Bitcoin.Script.Base.html#2174" class="InductiveConstructor Operator">ƛ</a> <a id="1555" class="Symbol">(</a><a id="1556" href="Bitcoin.Script.Base.html#1413" class="InductiveConstructor">versig</a> <a id="1563" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1565" href="SecureCompilation.Coherence.html#1509" class="Bound">k</a> <a id="1567" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1569" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1571" href="Data.Fin.html#730" class="Function Operator">#</a> <a id="1573" class="Number">0</a> <a id="1575" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="1576" class="Symbol">)}</a>

<a id="1580" class="Comment">-- T0D0: redefine Message ≈ ℤ ??</a>
<a id="SIGᵐ"></a><a id="1613" href="SecureCompilation.Coherence.html#1613" class="Function">SIGᵐ</a> <a id="1618" class="Symbol">:</a> <a id="1620" href="Bitcoin.Crypto.html#345" class="Record">KeyPair</a> <a id="1628" class="Symbol">→</a> <a id="1630" href="ComputationalModel.Strategy.html#790" class="Function">Message</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
<a id="1648" href="SecureCompilation.Coherence.html#1613" class="Function">SIGᵐ</a> <a id="1653" href="SecureCompilation.Coherence.html#1653" class="Bound">k</a> <a id="1655" class="Symbol">=</a> <a id="1657" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1661" class="Symbol">(</a><a id="1662" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="1666" href="SecureCompilation.Coherence.html#1653" class="Bound">k</a><a id="1667" class="Symbol">)</a>

<a id="1670" class="Comment">-- [BUG] cannot use `? ⊆⦅ names ⦆ ?` as a coherence hypothesis, need to partially apply the module and apply names⊆ everytime :(</a>
<a id="1799" class="Comment">-- [WORKAROUND] Expose instantiated operator to help Agda&#39;s inference</a>
<a id="_⊆⦅ᵖnamesᶜ⦆_"></a><a id="1869" href="SecureCompilation.Coherence.html#1869" class="Function Operator">_⊆⦅ᵖnamesᶜ⦆_</a> <a id="1882" class="Symbol">:</a> <a id="1884" href="BitML.Contracts.Types.html#1823" class="Datatype">Precondition</a> <a id="1897" class="Symbol">→</a> <a id="1899" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a> <a id="1903" class="Symbol">→</a> <a id="1905" class="PrimitiveType">Set</a>
<a id="1909" href="SecureCompilation.Coherence.html#1869" class="Function Operator">_⊆⦅ᵖnamesᶜ⦆_</a> <a id="1922" class="Symbol">=</a> <a id="1924" href="Prelude.Collections.html#1041" class="Function Operator">_⊆⦅</a> <a id="1928" href="BitML.Contracts.Helpers.html#3536" class="Function">names</a> <a id="1934" href="Prelude.Collections.html#1041" class="Function Operator">⦆_</a>

<a id="1938" class="Comment">-- [Bug]</a>
<a id="_∈⦅ads⦆_"></a><a id="1947" href="SecureCompilation.Coherence.html#1947" class="Function Operator">_∈⦅ads⦆_</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a> <a id="1972" class="Symbol">→</a> <a id="1974" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a> <a id="1978" class="Symbol">→</a> <a id="1980" class="PrimitiveType">Set</a>
<a id="1984" href="SecureCompilation.Coherence.html#1984" class="Bound">ad</a> <a id="1987" href="SecureCompilation.Coherence.html#1947" class="Function Operator">∈⦅ads⦆</a> <a id="1994" href="SecureCompilation.Coherence.html#1994" class="Bound">Γ</a> <a id="1996" class="Symbol">=</a> <a id="1998" href="SecureCompilation.Coherence.html#1984" class="Bound">ad</a> <a id="2001" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="2003" href="BitML.Semantics.Configurations.Helpers.html#5795" class="Function">authorizedHonAds</a> <a id="2020" href="SecureCompilation.Coherence.html#1994" class="Bound">Γ</a>

<a id="2023" class="Comment">-- ** Types and notation.</a>
<a id="2049" class="Keyword">data</a> <a id="coher"></a><a id="2054" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="2060" class="Symbol">:</a> <a id="2062" href="Data.Product.html#1369" class="Function">∃</a> <a id="2064" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="2066" class="Symbol">→</a> <a id="2068" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a> <a id="2074" class="Symbol">→</a> <a id="2076" class="PrimitiveType">Set</a>

<a id="2081" class="Keyword">data</a> <a id="coher₁"></a><a id="2086" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a> <a id="2093" class="Symbol">:</a>
  <a id="2097" class="Symbol">(</a><a id="2098" href="SecureCompilation.Coherence.html#2098" class="Bound">Rˢ</a> <a id="2101" class="Symbol">:</a> <a id="2103" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2108" class="Symbol">)</a> <a id="2110" class="Symbol">(</a><a id="2111" href="SecureCompilation.Coherence.html#2111" class="Bound">𝕒</a> <a id="2113" class="Symbol">:</a> <a id="2115" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="2117" href="SecureCompilation.Coherence.html#2098" class="Bound">Rˢ</a> <a id="2120" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="2122" class="Symbol">)</a>
  <a id="2126" class="Symbol">(</a><a id="2127" href="SecureCompilation.Coherence.html#2127" class="Bound">Rᶜ</a> <a id="2130" class="Symbol">:</a> <a id="2132" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2137" class="Symbol">)</a> <a id="2139" class="Symbol">(</a><a id="2140" href="SecureCompilation.Coherence.html#2140" class="Bound">λᶜ</a> <a id="2143" class="Symbol">:</a> <a id="2145" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2152" class="Symbol">)</a>
  <a id="2156" class="Symbol">→</a> <a id="2158" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="2160" class="Symbol">(</a><a id="2161" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="2164" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="2166" href="SecureCompilation.Coherence.html#2098" class="Bound">Rˢ</a> <a id="2169" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="2171" href="SecureCompilation.Coherence.html#2111" class="Bound">𝕒</a><a id="2172" class="Symbol">)</a>
  <a id="2176" class="Symbol">→</a> <a id="2178" class="PrimitiveType">Set</a>

<a id="2183" class="Keyword">data</a> <a id="coher₁₁"></a><a id="2188" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="2196" class="Symbol">:</a>
  <a id="2200" class="Symbol">(</a><a id="2201" href="SecureCompilation.Coherence.html#2201" class="Bound">Rˢ</a> <a id="2204" class="Symbol">:</a> <a id="2206" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2211" class="Symbol">)</a> <a id="2213" class="Symbol">(</a><a id="2214" href="SecureCompilation.Coherence.html#2214" class="Bound">𝕒</a> <a id="2216" class="Symbol">:</a> <a id="2218" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="2220" href="SecureCompilation.Coherence.html#2201" class="Bound">Rˢ</a> <a id="2223" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="2225" class="Symbol">)</a>
  <a id="2229" class="Symbol">(</a><a id="2230" href="SecureCompilation.Coherence.html#2230" class="Bound">Rᶜ</a> <a id="2233" class="Symbol">:</a> <a id="2235" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2240" class="Symbol">)</a> <a id="2242" class="Symbol">(</a><a id="2243" href="SecureCompilation.Coherence.html#2243" class="Bound">λᶜ</a> <a id="2246" class="Symbol">:</a> <a id="2248" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2255" class="Symbol">)</a>
  <a id="2259" class="Symbol">→</a> <a id="2261" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="2263" class="Symbol">(</a><a id="2264" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="2267" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="2269" href="SecureCompilation.Coherence.html#2201" class="Bound">Rˢ</a> <a id="2272" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="2274" href="SecureCompilation.Coherence.html#2214" class="Bound">𝕒</a><a id="2275" class="Symbol">)</a>
  <a id="2279" class="Symbol">→</a> <a id="2281" class="PrimitiveType">Set</a>

<a id="2286" class="Keyword">data</a> <a id="coher₁₂"></a><a id="2291" href="SecureCompilation.Coherence.html#2291" class="Datatype">coher₁₂</a> <a id="2299" class="Symbol">:</a>
  <a id="2303" class="Symbol">(</a><a id="2304" href="SecureCompilation.Coherence.html#2304" class="Bound">Rˢ</a> <a id="2307" class="Symbol">:</a> <a id="2309" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2314" class="Symbol">)</a> <a id="2316" class="Symbol">(</a><a id="2317" href="SecureCompilation.Coherence.html#2317" class="Bound">𝕒</a> <a id="2319" class="Symbol">:</a> <a id="2321" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="2323" href="SecureCompilation.Coherence.html#2304" class="Bound">Rˢ</a> <a id="2326" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="2328" class="Symbol">)</a>
  <a id="2332" class="Symbol">(</a><a id="2333" href="SecureCompilation.Coherence.html#2333" class="Bound">Rᶜ</a> <a id="2336" class="Symbol">:</a> <a id="2338" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a><a id="2343" class="Symbol">)</a> <a id="2345" class="Symbol">(</a><a id="2346" href="SecureCompilation.Coherence.html#2346" class="Bound">λᶜ</a> <a id="2349" class="Symbol">:</a> <a id="2351" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a><a id="2358" class="Symbol">)</a>
  <a id="2362" class="Symbol">→</a> <a id="2364" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="2366" class="Symbol">(</a><a id="2367" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="2370" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="2372" href="SecureCompilation.Coherence.html#2304" class="Bound">Rˢ</a> <a id="2375" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="2377" href="SecureCompilation.Coherence.html#2317" class="Bound">𝕒</a><a id="2378" class="Symbol">)</a>
  <a id="2382" class="Symbol">→</a> <a id="2384" class="PrimitiveType">Set</a>

<a id="2389" class="Keyword">data</a> <a id="coher₂"></a><a id="2394" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="2401" class="Symbol">(</a><a id="2402" href="SecureCompilation.Coherence.html#2402" class="Bound">Rˢ</a> <a id="2405" class="Symbol">:</a> <a id="2407" href="SymbolicModel.Run.html#706" class="Function">S.Run</a><a id="2412" class="Symbol">)</a> <a id="2414" class="Symbol">(</a><a id="2415" href="SecureCompilation.Coherence.html#2415" class="Bound">txout</a> <a id="2421" class="Symbol">:</a> <a id="2423" href="SymbolicModel.Collections.html#3418" class="Function">Txout</a> <a id="2429" href="SecureCompilation.Coherence.html#2402" class="Bound">Rˢ</a><a id="2431" class="Symbol">)</a> <a id="2433" class="Symbol">:</a> <a id="2435" href="ComputationalModel.Strategy.html#813" class="Datatype">C.Label</a> <a id="2443" class="Symbol">→</a> <a id="2445" class="PrimitiveType">Set</a>


<a id="2451" class="Keyword">data</a> <a id="2456" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="2462" class="Keyword">where</a>

  <a id="coher.base"></a><a id="2471" href="SecureCompilation.Coherence.html#2471" class="InductiveConstructor">base</a> <a id="2476" class="Symbol">:</a> <a id="2478" class="Keyword">let</a> <a id="2482" href="SecureCompilation.Coherence.html#2482" class="Bound">Rˢ</a> <a id="2485" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2487" href="SecureCompilation.Coherence.html#2487" class="Bound">𝕣</a> <a id="2489" class="Symbol">=</a> <a id="2491" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a><a id="2493" class="Symbol">;</a> <a id="2495" class="Keyword">open</a> <a id="2500" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="2502" href="SecureCompilation.Coherence.html#2487" class="Bound">𝕣</a> <a id="2504" class="Keyword">in</a>

      <a id="2514" class="Comment">-- (i) Rˢ = Γ₀ ∣ 0, with Γ₀ initial</a>
      <a id="2556" class="Symbol">(</a><a id="2557" href="SecureCompilation.Coherence.html#2557" class="Bound">init</a> <a id="2562" class="Symbol">:</a> <a id="2564" href="Prelude.Traces.html#283" class="Field">Initial</a> <a id="2572" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="2574" class="Symbol">)</a>
    <a id="2580" class="Symbol">→</a> <a id="2582" class="Symbol">(</a><a id="2583" href="SecureCompilation.Coherence.html#2583" class="Bound">cfg≈</a> <a id="2588" class="Symbol">:</a> <a id="2590" href="SecureCompilation.Coherence.html#2482" class="Bound">Rˢ</a> <a id="2593" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2595" class="Symbol">((</a><a id="2597" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="2600" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="2603" class="Number">0</a><a id="2604" class="Symbol">)</a> <a id="2606" href="SymbolicModel.Run.html#865" class="Function Operator">∎⊣</a> <a id="2609" class="Symbol">(</a><a id="2610" href="SecureCompilation.Coherence.html#2557" class="Bound">init</a> <a id="2615" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2617" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2621" class="Symbol">)))</a>
      <a id="2631" class="Comment">-- (ii) Rᶜ = T₀ ⋯ initial</a>
    <a id="2661" class="Symbol">→</a> <a id="2663" class="Symbol">(</a><a id="2664" href="SecureCompilation.Coherence.html#2664" class="Bound">cinit</a> <a id="2670" class="Symbol">:</a> <a id="2672" href="ComputationalModel.Strategy.html#2324" class="Function">C.Initial</a> <a id="2682" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="2684" class="Symbol">)</a>
    <a id="2690" class="Symbol">→</a> <a id="2692" class="Keyword">let</a> <a id="2696" href="SecureCompilation.Coherence.html#2696" class="Bound">∃T₀</a> <a id="2700" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2702" class="Symbol">_</a> <a id="2704" class="Symbol">=</a> <a id="2706" href="SecureCompilation.Coherence.html#2664" class="Bound">cinit</a><a id="2711" class="Symbol">;</a> <a id="2713" class="Symbol">_</a> <a id="2715" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2717" href="SecureCompilation.Coherence.html#2717" class="Bound">o</a> <a id="2719" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2721" href="SecureCompilation.Coherence.html#2721" class="Bound">T₀</a> <a id="2724" class="Symbol">=</a> <a id="2726" href="SecureCompilation.Coherence.html#2696" class="Bound">∃T₀</a> <a id="2730" class="Keyword">in</a>

      <a id="2740" class="Comment">-- (iii) generation of public keys, we do not consider that here</a>
      <a id="2811" class="Comment">-- [T0D0] is our idealistic assumption reasonable?? -- ask BitML authors</a>

      <a id="2891" class="Comment">-- (iv) txout { ⟨ A , v ⟩ₓ ∈ Γ₀ ↦ T₀{value = $ v, spendable with K̂(A)(rₐ)} ∈ T₀ }</a>
      <a id="2980" class="Symbol">(∀</a> <a id="2983" class="Symbol">{</a><a id="2984" href="SecureCompilation.Coherence.html#2984" class="Bound">A</a> <a id="2986" href="SecureCompilation.Coherence.html#2986" class="Bound">v</a> <a id="2988" href="SecureCompilation.Coherence.html#2988" class="Bound">x</a><a id="2989" class="Symbol">}</a> <a id="2991" class="Symbol">(</a><a id="2992" href="SecureCompilation.Coherence.html#2992" class="Bound">d∈</a> <a id="2995" class="Symbol">:</a> <a id="2997" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="2999" href="SecureCompilation.Coherence.html#2984" class="Bound">A</a> <a id="3001" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="3005" href="SecureCompilation.Coherence.html#2986" class="Bound">v</a> <a id="3007" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="3011" href="SecureCompilation.Coherence.html#2988" class="Bound">x</a> <a id="3013" href="BitML.Semantics.Configurations.Helpers.html#2140" class="Function Operator">∈ᶜ</a> <a id="3016" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="3018" class="Symbol">)</a>
         <a id="3029" class="Symbol">→</a> <a id="3031" href="Data.Product.html#1369" class="Function">∃</a> <a id="3033" class="Symbol">λ</a> <a id="3035" href="SecureCompilation.Coherence.html#3035" class="Bound">oᵢ</a>
         <a id="3047" class="Symbol">→</a> <a id="3049" class="Keyword">let</a>
             <a id="3066" href="SecureCompilation.Coherence.html#3066" class="Bound">x∈</a> <a id="3069" class="Symbol">:</a> <a id="3071" href="SecureCompilation.Coherence.html#2988" class="Bound">x</a> <a id="3073" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3075" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="3082" href="SecureCompilation.Coherence.html#2482" class="Bound">Rˢ</a>
             <a id="3098" href="SecureCompilation.Coherence.html#3066" class="Bound">x∈</a> <a id="3101" class="Symbol">=</a> <a id="3103" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="3109" class="Symbol">(λ</a> <a id="3112" href="SecureCompilation.Coherence.html#3112" class="Bound">◆</a> <a id="3114" class="Symbol">→</a> <a id="3116" href="SecureCompilation.Coherence.html#2988" class="Bound">x</a> <a id="3118" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3120" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="3127" href="SecureCompilation.Coherence.html#3112" class="Bound">◆</a><a id="3128" class="Symbol">)</a> <a id="3130" class="Symbol">(</a><a id="3131" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="3135" href="SecureCompilation.Coherence.html#2583" class="Bound">cfg≈</a><a id="3139" class="Symbol">)</a> <a id="3141" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="3143" href="BitML.Semantics.Configurations.Helpers.html#8117" class="Function">deposit∈Γ⇒namesʳ</a> <a id="3160" class="Symbol">{</a><a id="3161" class="Argument">Γ</a> <a id="3163" class="Symbol">=</a> <a id="3165" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="3167" class="Symbol">}</a> <a id="3169" href="SecureCompilation.Coherence.html#2992" class="Bound">d∈</a>
           <a id="3183" class="Keyword">in</a>
             <a id="3199" class="Symbol">(</a><a id="3200" href="SymbolicModel.Collections.html#4024" class="Function">txout′</a> <a id="3207" href="SecureCompilation.Coherence.html#3066" class="Bound">x∈</a> <a id="3210" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3212" href="SecureCompilation.Coherence.html#2696" class="Bound">∃T₀</a> <a id="3216" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="3219" href="SecureCompilation.Coherence.html#3035" class="Bound">oᵢ</a><a id="3221" class="Symbol">)</a> <a id="3223" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3225" class="Symbol">(</a><a id="3226" href="SecureCompilation.Coherence.html#2721" class="Bound">T₀</a> <a id="3229" href="Bitcoin.Tx.Base.html#2139" class="Function Operator">‼ᵒ</a> <a id="3232" href="SecureCompilation.Coherence.html#3035" class="Bound">oᵢ</a> <a id="3235" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3237" href="SecureCompilation.Coherence.html#2986" class="Bound">v</a> <a id="3239" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="3256" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="3259" href="SecureCompilation.Coherence.html#2984" class="Bound">A</a><a id="3260" class="Symbol">)</a>
      <a id="3268" class="Symbol">)</a>
      <a id="3276" class="Comment">-- (v) dom sechash = ∅</a>
    <a id="3303" class="Symbol">→</a> <a id="3305" href="Prelude.Lists.html#13041" class="Function">dom</a> <a id="3309" href="SymbolicModel.Collections.html#4047" class="Function">sechash′</a> <a id="3318" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3320" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
      <a id="3329" class="Comment">-- (vi) dom κ = ∅</a>
    <a id="3351" class="Symbol">→</a> <a id="3353" href="Prelude.Lists.html#13041" class="Function">dom</a> <a id="3357" href="SymbolicModel.Collections.html#4072" class="Function">κ′</a> <a id="3360" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3362" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
      <a id="3371" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="3448" class="Symbol">→</a> <a id="3450" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3456" class="Symbol">(</a><a id="3457" href="SecureCompilation.Coherence.html#2482" class="Bound">Rˢ</a> <a id="3460" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3462" href="SecureCompilation.Coherence.html#2487" class="Bound">𝕣</a><a id="3463" class="Symbol">)</a> <a id="3465" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a>

  <a id="coher.step₁"></a><a id="3471" href="SecureCompilation.Coherence.html#3471" class="InductiveConstructor">step₁</a> <a id="3477" class="Symbol">:</a> <a id="3479" class="Keyword">let</a> <a id="3483" href="SecureCompilation.Coherence.html#3483" class="Bound">Rˢ</a> <a id="3486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3488" href="SecureCompilation.Coherence.html#3488" class="Bound">𝕣</a> <a id="3490" class="Symbol">=</a> <a id="3492" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a> <a id="3495" class="Keyword">in</a>
        <a id="3506" class="Symbol">∀</a> <a id="3508" class="Symbol">{</a><a id="3509" href="SecureCompilation.Coherence.html#3509" class="Bound">𝕒</a> <a id="3511" class="Symbol">:</a> <a id="3513" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="3515" href="SecureCompilation.Coherence.html#3483" class="Bound">Rˢ</a> <a id="3518" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="3520" class="Symbol">}</a> <a id="3522" class="Symbol">→</a>
          <a id="3534" class="Keyword">let</a> <a id="3538" href="SecureCompilation.Coherence.html#3538" class="Bound">Rˢ′</a> <a id="3542" class="Symbol">=</a> <a id="3544" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="3547" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="3549" href="SecureCompilation.Coherence.html#3483" class="Bound">Rˢ</a> <a id="3552" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="3554" href="SecureCompilation.Coherence.html#3509" class="Bound">𝕒</a> <a id="3556" class="Keyword">in</a>
        <a id="3567" class="Symbol">∀</a> <a id="3569" class="Symbol">{</a><a id="3570" href="SecureCompilation.Coherence.html#3570" class="Bound">𝕣′</a> <a id="3573" class="Symbol">:</a> <a id="3575" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="3577" href="SecureCompilation.Coherence.html#3538" class="Bound">Rˢ′</a><a id="3580" class="Symbol">}</a> <a id="3582" class="Symbol">→</a>

      <a id="3591" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3597" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a> <a id="3600" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a>
    <a id="3607" class="Symbol">→</a> <a id="3609" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a> <a id="3616" href="SecureCompilation.Coherence.html#3483" class="Bound">Rˢ</a> <a id="3619" href="SecureCompilation.Coherence.html#3509" class="Bound">𝕒</a> <a id="3621" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="3624" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="3627" href="SecureCompilation.Coherence.html#3570" class="Bound">𝕣′</a>
      <a id="3636" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="3713" class="Symbol">→</a> <a id="3715" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3721" href="SecureCompilation.Coherence.html#1210" class="Generalizable">∃𝕣′</a> <a id="3725" class="Symbol">(</a><a id="3726" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="3729" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3731" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="3733" class="Symbol">)</a>

  <a id="coher.step₂"></a><a id="3738" href="SecureCompilation.Coherence.html#3738" class="InductiveConstructor">step₂</a> <a id="3744" class="Symbol">:</a> <a id="3746" class="Keyword">let</a> <a id="3750" href="SecureCompilation.Coherence.html#3750" class="Bound">Rˢ</a> <a id="3753" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3755" href="SecureCompilation.Coherence.html#3755" class="Bound">𝕣</a> <a id="3757" class="Symbol">=</a> <a id="3759" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a><a id="3761" class="Symbol">;</a> <a id="3763" class="Keyword">open</a> <a id="3768" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="3770" href="SecureCompilation.Coherence.html#3755" class="Bound">𝕣</a> <a id="3772" class="Keyword">in</a>

      <a id="3782" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3788" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a> <a id="3791" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a>
    <a id="3798" class="Symbol">→</a> <a id="3800" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="3807" href="SecureCompilation.Coherence.html#3750" class="Bound">Rˢ</a> <a id="3810" href="SymbolicModel.Collections.html#4024" class="Function">txout′</a> <a id="3817" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a>
      <a id="3826" class="Comment">----------------------------------------</a>
    <a id="3871" class="Symbol">→</a> <a id="3873" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3879" href="SecureCompilation.Coherence.html#1207" class="Generalizable">∃𝕣</a> <a id="3882" class="Symbol">(</a><a id="3883" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="3886" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3888" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="3890" class="Symbol">)</a>

<a id="_~_"></a><a id="3893" href="SecureCompilation.Coherence.html#3893" class="Function Operator">_~_</a> <a id="_≁_"></a><a id="3897" href="SecureCompilation.Coherence.html#3897" class="Function Operator">_≁_</a> <a id="3901" class="Symbol">:</a> <a id="3903" href="SymbolicModel.Run.html#706" class="Function">S.Run</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="ComputationalModel.Strategy.html#1138" class="Function">C.Run</a> <a id="3917" class="Symbol">→</a> <a id="3919" class="PrimitiveType">Set</a>
<a id="3923" href="SecureCompilation.Coherence.html#3923" class="Bound">Rˢ</a> <a id="3926" href="SecureCompilation.Coherence.html#3893" class="Function Operator">~</a> <a id="3928" href="SecureCompilation.Coherence.html#3928" class="Bound">Rᶜ</a> <a id="3931" class="Symbol">=</a> <a id="3933" href="Data.Product.html#1806" class="Function">∃[</a> <a id="3936" href="SecureCompilation.Coherence.html#3936" class="Bound">𝕣</a> <a id="3938" href="Data.Product.html#1806" class="Function">]</a> <a id="3940" href="SecureCompilation.Coherence.html#2054" class="Datatype">coher</a> <a id="3946" class="Symbol">(</a><a id="3947" href="SecureCompilation.Coherence.html#3923" class="Bound">Rˢ</a> <a id="3950" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3952" href="SecureCompilation.Coherence.html#3936" class="Bound">𝕣</a><a id="3953" class="Symbol">)</a> <a id="3955" href="SecureCompilation.Coherence.html#3928" class="Bound">Rᶜ</a>
<a id="3958" href="SecureCompilation.Coherence.html#3958" class="Bound">Rˢ</a> <a id="3961" href="SecureCompilation.Coherence.html#3897" class="Function Operator">≁</a> <a id="3963" href="SecureCompilation.Coherence.html#3963" class="Bound">Rᶜ</a> <a id="3966" class="Symbol">=</a> <a id="3968" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="3970" href="SecureCompilation.Coherence.html#3958" class="Bound">Rˢ</a> <a id="3973" href="SecureCompilation.Coherence.html#3893" class="Function Operator">~</a> <a id="3975" href="SecureCompilation.Coherence.html#3963" class="Bound">Rᶜ</a>
<a id="3978" class="Comment">-- = ∃ (∃ (∃ (coher Rˢ Rᶜ)))</a>
<a id="4007" class="Comment">-- [BUG] not inferring type of existentials, although dependency is evident</a>

<a id="4084" class="Comment">-- [BUG] See issue #5464</a>
<a id="_≈ᶜ_"></a><a id="4109" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ_</a> <a id="4114" class="Symbol">=</a> <a id="4116" href="Prelude.Setoid.html#160" class="Field Operator">_≈_</a> <a id="4120" class="Symbol">⦃</a> <a id="4122" href="BitML.Semantics.Configurations.Helpers.html#1055" class="Function">IS-Cfg</a> <a id="4129" class="Symbol">⦄</a>

<a id="4132" class="Comment">-- ** Definitions.</a>
<a id="4151" class="Keyword">data</a> <a id="4156" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a> <a id="4163" class="Keyword">where</a>
  <a id="coher₁.[L]"></a><a id="4171" href="SecureCompilation.Coherence.html#4171" class="InductiveConstructor">[L]</a> <a id="4175" class="Symbol">:</a> <a id="4177" class="Symbol">∀</a> <a id="4179" class="Symbol">{</a><a id="4180" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a><a id="4182" class="Symbol">}</a> <a id="4184" class="Symbol">{</a><a id="4185" href="SecureCompilation.Coherence.html#4185" class="Bound">𝕣</a> <a id="4187" class="Symbol">:</a> <a id="4189" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="4191" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a><a id="4193" class="Symbol">}</a> <a id="4195" class="Symbol">{</a><a id="4196" href="SecureCompilation.Coherence.html#4196" class="Bound">𝕒</a> <a id="4198" class="Symbol">:</a> <a id="4200" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="4202" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a> <a id="4205" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="4207" class="Symbol">}</a> <a id="4209" class="Symbol">→</a> <a id="4211" class="Keyword">let</a> <a id="4215" href="SecureCompilation.Coherence.html#4215" class="Bound">Rˢ′</a> <a id="4219" class="Symbol">=</a> <a id="4221" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="4224" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="4226" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a> <a id="4229" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="4231" href="SecureCompilation.Coherence.html#4196" class="Bound">𝕒</a> <a id="4233" class="Keyword">in</a>
        <a id="4244" class="Symbol">∀</a> <a id="4246" class="Symbol">{</a><a id="4247" href="SecureCompilation.Coherence.html#4247" class="Bound">𝕣′</a> <a id="4250" class="Symbol">:</a> <a id="4252" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="4254" href="SecureCompilation.Coherence.html#4215" class="Bound">Rˢ′</a><a id="4257" class="Symbol">}</a>
    <a id="4263" class="Symbol">→</a> <a id="4265" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="4273" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a> <a id="4276" href="SecureCompilation.Coherence.html#4196" class="Bound">𝕒</a> <a id="4278" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="4281" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="4284" href="SecureCompilation.Coherence.html#4247" class="Bound">𝕣′</a>
    <a id="4291" class="Symbol">→</a> <a id="4293" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a>  <a id="4301" href="SecureCompilation.Coherence.html#4180" class="Bound">Rˢ</a> <a id="4304" href="SecureCompilation.Coherence.html#4196" class="Bound">𝕒</a> <a id="4306" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="4309" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="4312" href="SecureCompilation.Coherence.html#4247" class="Bound">𝕣′</a>

  <a id="coher₁.[R]"></a><a id="4318" href="SecureCompilation.Coherence.html#4318" class="InductiveConstructor">[R]</a> <a id="4322" class="Symbol">:</a> <a id="4324" class="Symbol">∀</a> <a id="4326" class="Symbol">{</a><a id="4327" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a><a id="4329" class="Symbol">}</a> <a id="4331" class="Symbol">{</a><a id="4332" href="SecureCompilation.Coherence.html#4332" class="Bound">𝕣</a> <a id="4334" class="Symbol">:</a> <a id="4336" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="4338" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a><a id="4340" class="Symbol">}</a> <a id="4342" class="Symbol">{</a><a id="4343" href="SecureCompilation.Coherence.html#4343" class="Bound">𝕒</a> <a id="4345" class="Symbol">:</a> <a id="4347" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="4349" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a> <a id="4352" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a><a id="4354" class="Symbol">}</a> <a id="4356" class="Symbol">→</a> <a id="4358" class="Keyword">let</a> <a id="4362" href="SecureCompilation.Coherence.html#4362" class="Bound">Rˢ′</a> <a id="4366" class="Symbol">=</a> <a id="4368" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Γₜ</a> <a id="4371" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="4373" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a> <a id="4376" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="4378" href="SecureCompilation.Coherence.html#4343" class="Bound">𝕒</a> <a id="4380" class="Keyword">in</a>
        <a id="4391" class="Symbol">∀</a> <a id="4393" class="Symbol">{</a><a id="4394" href="SecureCompilation.Coherence.html#4394" class="Bound">𝕣′</a> <a id="4397" class="Symbol">:</a> <a id="4399" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="4401" href="SecureCompilation.Coherence.html#4362" class="Bound">Rˢ′</a><a id="4404" class="Symbol">}</a>
    <a id="4410" class="Symbol">→</a> <a id="4412" href="SecureCompilation.Coherence.html#2291" class="Datatype">coher₁₂</a> <a id="4420" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a> <a id="4423" href="SecureCompilation.Coherence.html#4343" class="Bound">𝕒</a> <a id="4425" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="4428" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="4431" href="SecureCompilation.Coherence.html#4394" class="Bound">𝕣′</a>
    <a id="4438" class="Symbol">→</a> <a id="4440" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a>  <a id="4448" href="SecureCompilation.Coherence.html#4327" class="Bound">Rˢ</a> <a id="4451" href="SecureCompilation.Coherence.html#4343" class="Bound">𝕒</a> <a id="4453" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="4456" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="4459" href="SecureCompilation.Coherence.html#4394" class="Bound">𝕣′</a>

<a id="4463" class="Keyword">data</a> <a id="4468" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="4476" class="Keyword">where</a>

  <a id="4485" class="Comment">-- ** Advertising a contract</a>
  <a id="coher₁₁.[1]"></a><a id="4516" href="SecureCompilation.Coherence.html#4516" class="InductiveConstructor">[1]</a> <a id="4520" class="Symbol">:</a>
      <a id="4528" class="Keyword">let</a>
        <a id="4540" class="Keyword">open</a> <a id="4545" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="4547" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a>
        <a id="4557" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="4559" href="SecureCompilation.Coherence.html#4559" class="Bound">G</a> <a id="4561" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="4563" href="SecureCompilation.Coherence.html#4563" class="Bound">C</a> <a id="4565" class="Symbol">=</a> <a id="4567" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="4572" class="Symbol">;</a> <a id="4574" href="SecureCompilation.Coherence.html#4574" class="Bound">partG</a> <a id="4580" class="Symbol">=</a> <a id="4582" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="4599" href="SecureCompilation.Coherence.html#4559" class="Bound">G</a>
        <a id="4609" href="SecureCompilation.Coherence.html#4609" class="Bound">Γₜ</a> <a id="4612" class="Symbol">=</a> <a id="4614" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Γ</a> <a id="4616" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="4619" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
      <a id="4627" class="Keyword">in</a>
      <a id="4636" class="Symbol">(</a><a id="4637" href="SecureCompilation.Coherence.html#4637" class="Bound">cfg≈</a> <a id="4642" class="Symbol">:</a> <a id="4644" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="4647" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="4650" href="SecureCompilation.Coherence.html#4609" class="Bound">Γₜ</a><a id="4652" class="Symbol">)</a> <a id="4654" class="Symbol">→</a>
      <a id="4662" class="Keyword">let</a>
        <a id="4674" href="SecureCompilation.Coherence.html#4674" class="Bound">α</a>   <a id="4678" class="Symbol">=</a> <a id="4680" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">advertise⦅</a> <a id="4691" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="4696" href="BitML.Semantics.Label.html#1052" class="InductiveConstructor Operator">⦆</a>
        <a id="4706" href="SecureCompilation.Coherence.html#4706" class="Bound">Γ′</a>  <a id="4710" class="Symbol">=</a> <a id="4712" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="4714" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="4719" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="4721" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Γ</a>
        <a id="4731" href="SecureCompilation.Coherence.html#4731" class="Bound">t′</a>  <a id="4735" class="Symbol">=</a> <a id="4737" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="4747" href="SecureCompilation.Coherence.html#4747" class="Bound">Γₜ′</a> <a id="4751" class="Symbol">=</a> <a id="4753" href="SecureCompilation.Coherence.html#4706" class="Bound">Γ′</a> <a id="4756" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="4759" href="SecureCompilation.Coherence.html#4731" class="Bound">t′</a>
      <a id="4768" class="Keyword">in</a>
        <a id="4779" class="Symbol">(</a><a id="4780" href="SecureCompilation.Coherence.html#4780" class="Bound">∃Γ≈</a> <a id="4784" class="Symbol">:</a> <a id="4786" href="Data.Product.html#1369" class="Function">∃</a> <a id="4788" class="Symbol">(</a><a id="4789" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="4793" href="SecureCompilation.Coherence.html#4706" class="Bound">Γ′</a><a id="4795" class="Symbol">))</a>
      <a id="4804" class="Comment">-- Hypotheses from [C-Advertise]</a>
      <a id="4843" class="Symbol">→</a> <a id="4845" class="Symbol">(</a><a id="4846" href="SecureCompilation.Coherence.html#4846" class="Bound">vad</a> <a id="4850" class="Symbol">:</a> <a id="4852" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="4858" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a><a id="4862" class="Symbol">)</a>
      <a id="4870" class="Symbol">→</a> <a id="4872" class="Symbol">(</a><a id="4873" href="SecureCompilation.Coherence.html#4873" class="Bound">hon</a> <a id="4877" class="Symbol">:</a> <a id="4879" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="4883" class="Symbol">(</a><a id="4884" href="Data.List.Membership.Setoid.html#887" class="Function Operator">_∈</a> <a id="4887" href="BitML.Contracts.Types.html#482" class="Function">Hon</a><a id="4890" class="Symbol">)</a> <a id="4892" class="Symbol">(</a><a id="4893" href="BitML.Contracts.Helpers.html#2497" class="Function">participants</a> <a id="4906" href="SecureCompilation.Coherence.html#4559" class="Bound">G</a><a id="4907" class="Symbol">))</a>
      <a id="4916" class="Symbol">→</a> <a id="4918" class="Symbol">(</a><a id="4919" href="SecureCompilation.Coherence.html#4919" class="Bound">d⊆</a>  <a id="4923" class="Symbol">:</a> <a id="4925" href="BitML.Contracts.Helpers.html#6235" class="Function">deposits</a> <a id="4934" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="4939" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="4941" href="BitML.Contracts.Helpers.html#6235" class="Function">deposits</a> <a id="4950" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Γ</a><a id="4951" class="Symbol">)</a>
      <a id="4959" class="Symbol">→</a>
      <a id="4967" class="Keyword">let</a>
        <a id="4979" href="SecureCompilation.Coherence.html#4979" class="Bound">Γ→Γ′</a> <a id="4984" class="Symbol">:</a> <a id="4986" href="SecureCompilation.Coherence.html#4609" class="Bound">Γₜ</a> <a id="4989" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="4992" href="SecureCompilation.Coherence.html#4674" class="Bound">α</a> <a id="4994" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="4998" href="SecureCompilation.Coherence.html#4747" class="Bound">Γₜ′</a>
        <a id="5010" href="SecureCompilation.Coherence.html#4979" class="Bound">Γ→Γ′</a> <a id="5015" class="Symbol">=</a> <a id="5017" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="5026" class="Symbol">(</a><a id="5027" href="BitML.Semantics.InferenceRules.html#3638" class="InductiveConstructor">[C-Advertise]</a> <a id="5041" href="SecureCompilation.Coherence.html#4846" class="Bound">vad</a> <a id="5045" href="SecureCompilation.Coherence.html#4873" class="Bound">hon</a> <a id="5049" href="SecureCompilation.Coherence.html#4919" class="Bound">d⊆</a><a id="5051" class="Symbol">)</a> <a id="5053" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="5067" class="Comment">-- txout′ = txout, sechash′ = sechash, κ′ = κ</a>
        <a id="5121" class="Keyword">open</a> <a id="5126" href="SymbolicModel.Helpers.html#2842" class="Module">H₁</a> <a id="5129" class="Symbol">{</a><a id="5130" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="5132" class="Symbol">}</a> <a id="5134" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="5136" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="5138" href="SecureCompilation.Coherence.html#4674" class="Bound">α</a> <a id="5140" href="SecureCompilation.Coherence.html#4731" class="Bound">t′</a> <a id="5143" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Γ</a> <a id="5145" href="SecureCompilation.Coherence.html#4637" class="Bound">cfg≈</a> <a id="5150" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="5155" href="SecureCompilation.Coherence.html#4979" class="Bound">Γ→Γ′</a> <a id="5160" href="SecureCompilation.Coherence.html#4780" class="Bound">∃Γ≈</a>
      <a id="5170" class="Keyword">in</a>
      <a id="5179" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="5258" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="5266" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="5269" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="5271" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="5274" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="5277" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>
      <a id="5286" class="Comment">-- coher₁₁⦅ Rˢ —[ 𝕒 ]→ 𝕣′ , Rᶜ ∷ʳ λᶜ ⦆</a>
      <a id="5331" class="Comment">-- pattern coher₁₁⦅_—[_]→_∣_∷⟩_⦆ Rˢ 𝕒 𝕣 Rᶜ λᶜ = coher₁₁ Rˢ 𝕒 Rᶜ λᶜ 𝕣</a>

  <a id="5403" class="Comment">-- ** Stipulation: committing secrets</a>
  <a id="coher₁₁.[2]"></a><a id="5443" href="SecureCompilation.Coherence.html#5443" class="InductiveConstructor">[2]</a> <a id="5447" class="Symbol">:</a> <a id="5449" class="Symbol">∀</a> <a id="5451" class="Symbol">{</a><a id="5452" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a><a id="5454" class="Symbol">}</a> <a id="5456" class="Symbol">{</a><a id="5457" href="SecureCompilation.Coherence.html#5457" class="Bound">𝕣</a> <a id="5459" class="Symbol">:</a> <a id="5461" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="5463" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a><a id="5465" class="Symbol">}</a> <a id="5467" class="Symbol">→</a> <a id="5469" class="Keyword">let</a> <a id="5473" class="Keyword">open</a> <a id="5478" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="5480" href="SecureCompilation.Coherence.html#5457" class="Bound">𝕣</a> <a id="5482" class="Keyword">in</a>
      <a id="5491" class="Symbol">∀</a> <a id="5493" class="Symbol">{</a><a id="5494" href="SecureCompilation.Coherence.html#5494" class="Bound">Δ×h̅</a> <a id="5499" class="Symbol">:</a> <a id="5501" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5506" class="Symbol">(</a><a id="5507" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="5514" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5516" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="5522" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="5524" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5526" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="5527" class="Symbol">)}</a>
        <a id="5538" class="Comment">-- [BUG] doesnt work with t/Γ₀/⟨G⟩C as generalized variables</a>
        <a id="5607" class="Symbol">{</a><a id="5608" href="SecureCompilation.Coherence.html#5608" class="Bound">t</a> <a id="5610" href="SecureCompilation.Coherence.html#5610" class="Bound">Γ₀</a> <a id="5613" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a><a id="5617" class="Symbol">}</a> <a id="5619" class="Symbol">{</a><a id="5620" href="SecureCompilation.Coherence.html#5620" class="Bound">k⃗</a> <a id="5623" class="Symbol">:</a> <a id="5625" href="SymbolicModel.Collections.html#3602" class="Function">𝕂²′</a> <a id="5629" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a><a id="5633" class="Symbol">}</a> <a id="5635" class="Symbol">→</a> <a id="5637" class="Keyword">let</a> <a id="5641" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="5643" href="SecureCompilation.Coherence.html#5643" class="Bound">G</a> <a id="5645" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="5647" href="SecureCompilation.Coherence.html#5647" class="Bound">C</a> <a id="5649" class="Symbol">=</a> <a id="5651" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a><a id="5655" class="Symbol">;</a> <a id="5657" href="SecureCompilation.Coherence.html#5657" class="Bound">Γ</a> <a id="5659" class="Symbol">=</a> <a id="5661" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="5663" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a> <a id="5668" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="5670" href="SecureCompilation.Coherence.html#5610" class="Bound">Γ₀</a><a id="5672" class="Symbol">;</a> <a id="5674" href="SecureCompilation.Coherence.html#5674" class="Bound">Γₜ</a> <a id="5677" class="Symbol">=</a> <a id="5679" href="SecureCompilation.Coherence.html#5657" class="Bound">Γ</a> <a id="5681" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="5684" href="SecureCompilation.Coherence.html#5608" class="Bound">t</a> <a id="5686" class="Keyword">in</a>

      <a id="5696" class="Symbol">(</a><a id="5697" href="SecureCompilation.Coherence.html#5697" class="Bound">cfg≈</a> <a id="5702" class="Symbol">:</a> <a id="5704" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a> <a id="5707" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="5710" href="SecureCompilation.Coherence.html#5674" class="Bound">Γₜ</a><a id="5712" class="Symbol">)</a>
    <a id="5718" class="Symbol">→</a> <a id="5720" class="Keyword">let</a>
        <a id="5732" href="SecureCompilation.Coherence.html#5732" class="Bound">C</a> <a id="5734" class="Symbol">:</a> <a id="5736" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="5752" href="SecureCompilation.Coherence.html#5732" class="Bound">C</a> <a id="5754" class="Symbol">=</a> <a id="5756" href="SecureCompilation.Coherence.html#1233" class="Postulate">encode</a> <a id="5763" class="Symbol">{</a><a id="5764" class="Argument">Rˢ</a> <a id="5767" class="Symbol">=</a> <a id="5769" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a><a id="5771" class="Symbol">}</a> <a id="5773" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="5780" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a>

        <a id="5794" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a> <a id="5796" class="Symbol">:</a> <a id="5798" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5803" class="Symbol">(</a><a id="5804" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="5811" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="5813" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="5819" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="5820" class="Symbol">)</a>
        <a id="5830" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a> <a id="5832" class="Symbol">=</a> <a id="5834" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5838" class="Symbol">(λ{</a> <a id="5842" class="Symbol">(</a><a id="5843" href="SecureCompilation.Coherence.html#5843" class="Bound">s</a> <a id="5845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5847" href="SecureCompilation.Coherence.html#5847" class="Bound">mn</a> <a id="5850" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5852" class="Symbol">_)</a> <a id="5855" class="Symbol">→</a> <a id="5857" href="SecureCompilation.Coherence.html#5843" class="Bound">s</a> <a id="5859" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5861" href="SecureCompilation.Coherence.html#5847" class="Bound">mn</a> <a id="5864" class="Symbol">})</a> <a id="5867" href="SecureCompilation.Coherence.html#5494" class="Bound">Δ×h̅</a>

        <a id="5881" class="Symbol">(</a><a id="5882" href="SecureCompilation.Coherence.html#5882" class="Bound">as</a> <a id="5885" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5887" href="SecureCompilation.Coherence.html#5887" class="Bound">ms</a><a id="5889" class="Symbol">)</a> <a id="5891" class="Symbol">=</a> <a id="5893" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="5899" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a>

        <a id="5910" href="SecureCompilation.Coherence.html#5910" class="Bound">Δᶜ</a> <a id="5913" class="Symbol">:</a> <a id="5915" href="BitML.Semantics.Configurations.Types.html#2051" class="Function">Cfg</a>
        <a id="5927" href="SecureCompilation.Coherence.html#5910" class="Bound">Δᶜ</a> <a id="5930" class="Symbol">=</a> <a id="5932" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="5935" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5939" class="Symbol">(</a><a id="5940" href="Data.Product.html#3422" class="Function">uncurry</a> <a id="5948" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟨</a> <a id="5950" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="5952" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">∶_♯_⟩</a><a id="5957" class="Symbol">)</a> <a id="5959" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a>

        <a id="5970" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a> <a id="5973" class="Symbol">:</a> <a id="5975" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5980" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="5982" class="Comment">-- ≈ Message</a>
        <a id="6003" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a> <a id="6006" class="Symbol">=</a> <a id="6008" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6012" class="Symbol">(</a><a id="6013" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6019" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6021" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="6026" class="Symbol">)</a> <a id="6028" href="SecureCompilation.Coherence.html#5494" class="Bound">Δ×h̅</a>

        <a id="6042" href="SecureCompilation.Coherence.html#6042" class="Bound">k̅</a> <a id="6045" class="Symbol">:</a> <a id="6047" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6052" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a> <a id="6054" class="Comment">-- ≈ Message</a>
        <a id="6075" href="SecureCompilation.Coherence.html#6042" class="Bound">k̅</a> <a id="6078" class="Symbol">=</a> <a id="6080" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="6090" class="Symbol">(</a><a id="6091" href="Data.List.Base.html#1544" class="Function">map</a> <a id="6095" href="Bitcoin.Crypto.html#377" class="Field">pub</a> <a id="6099" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6101" href="Prelude.Lists.html#13104" class="Function">codom</a><a id="6106" class="Symbol">)</a> <a id="6108" class="Symbol">(</a><a id="6109" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="6115" href="SecureCompilation.Coherence.html#5620" class="Bound">k⃗</a><a id="6117" class="Symbol">)</a>

        <a id="6128" href="SecureCompilation.Coherence.html#6128" class="Bound">C,h̅,k̅</a> <a id="6136" class="Symbol">:</a> <a id="6138" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="6154" href="SecureCompilation.Coherence.html#6128" class="Bound">C,h̅,k̅</a> <a id="6162" class="Symbol">=</a> <a id="6164" href="SecureCompilation.Coherence.html#5732" class="Bound">C</a> <a id="6166" href="Prelude.Semigroup.html#134" class="Field Operator">◇</a> <a id="6168" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a> <a id="6171" href="Prelude.Semigroup.html#134" class="Field Operator">◇</a> <a id="6173" href="SecureCompilation.Coherence.html#6042" class="Bound">k̅</a>

        <a id="6185" href="SecureCompilation.Coherence.html#6185" class="Bound">C,h̅,k̅ₐ</a> <a id="6194" class="Symbol">:</a> <a id="6196" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="6212" href="SecureCompilation.Coherence.html#6185" class="Bound">C,h̅,k̅ₐ</a> <a id="6221" class="Symbol">=</a> <a id="6223" href="SecureCompilation.Coherence.html#1613" class="Function">SIGᵐ</a> <a id="6228" class="Symbol">(</a><a id="6229" href="ComputationalModel.KeyPairs.html#249" class="Function">K</a> <a id="6231" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="6232" class="Symbol">)</a> <a id="6234" href="SecureCompilation.Coherence.html#6128" class="Bound">C,h̅,k̅</a>

        <a id="6251" href="SecureCompilation.Coherence.html#6251" class="Bound">α</a>   <a id="6255" class="Symbol">=</a> <a id="6257" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="6270" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6272" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="6274" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a> <a id="6279" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="6281" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a> <a id="6283" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">⦆</a>
        <a id="6293" href="SecureCompilation.Coherence.html#6293" class="Bound">Γ′</a>  <a id="6297" class="Symbol">=</a> <a id="6299" href="SecureCompilation.Coherence.html#5657" class="Bound">Γ</a> <a id="6301" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="6303" href="SecureCompilation.Coherence.html#5910" class="Bound">Δᶜ</a> <a id="6306" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="6308" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6310" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="6316" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">♯▷</a> <a id="6319" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a> <a id="6324" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a>
        <a id="6334" href="SecureCompilation.Coherence.html#6334" class="Bound">t′</a>  <a id="6338" class="Symbol">=</a> <a id="6340" href="SecureCompilation.Coherence.html#5608" class="Bound">t</a>
        <a id="6350" href="SecureCompilation.Coherence.html#6350" class="Bound">Γₜ′</a> <a id="6354" class="Symbol">=</a> <a id="6356" href="SecureCompilation.Coherence.html#6293" class="Bound">Γ′</a> <a id="6359" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="6362" href="SecureCompilation.Coherence.html#6334" class="Bound">t′</a>
        <a id="6373" href="SecureCompilation.Coherence.html#6373" class="Bound">λᶜ</a>  <a id="6377" class="Symbol">=</a> <a id="6379" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="6381" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="6385" href="SecureCompilation.Coherence.html#6185" class="Bound">C,h̅,k̅ₐ</a>
      <a id="6400" class="Keyword">in</a>
      <a id="6409" class="Symbol">(</a><a id="6410" href="SecureCompilation.Coherence.html#6410" class="Bound">∃Γ≈</a> <a id="6414" class="Symbol">:</a> <a id="6416" href="Data.Product.html#1369" class="Function">∃</a> <a id="6418" class="Symbol">(</a><a id="6419" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="6423" href="SecureCompilation.Coherence.html#6293" class="Bound">Γ′</a><a id="6425" class="Symbol">))</a>
      <a id="6434" class="Comment">-- Hypotheses from [C-AuthCommit]</a>
      <a id="6474" class="Symbol">(</a><a id="6475" href="SecureCompilation.Coherence.html#6475" class="Bound">as≡</a> <a id="6479" class="Symbol">:</a> <a id="6481" href="SecureCompilation.Coherence.html#5882" class="Bound">as</a> <a id="6484" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="6486" href="BitML.Contracts.Helpers.html#7010" class="Function">secretsOfᵖ</a> <a id="6497" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6499" href="SecureCompilation.Coherence.html#5643" class="Bound">G</a><a id="6500" class="Symbol">)</a>
      <a id="6508" class="Symbol">(</a><a id="6509" href="SecureCompilation.Coherence.html#6509" class="Bound">All∉</a> <a id="6514" class="Symbol">:</a> <a id="6516" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="6520" class="Symbol">(</a><a id="6521" href="Data.List.Membership.Setoid.html#936" class="Function Operator">_∉</a> <a id="6524" href="BitML.Semantics.Configurations.Helpers.html#6003" class="Function">secretsOfᶜᶠ</a> <a id="6536" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6538" href="SecureCompilation.Coherence.html#5610" class="Bound">Γ₀</a><a id="6540" class="Symbol">)</a> <a id="6542" href="SecureCompilation.Coherence.html#5882" class="Bound">as</a><a id="6544" class="Symbol">)</a>
      <a id="6552" class="Symbol">(</a><a id="6553" href="SecureCompilation.Coherence.html#6553" class="Bound">Hon⇒</a> <a id="6558" class="Symbol">:</a> <a id="6560" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6562" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="6564" href="BitML.Contracts.Types.html#482" class="Function">Hon</a> <a id="6568" class="Symbol">→</a> <a id="6570" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="6574" href="Data.Maybe.html#801" class="Function">Is-just</a> <a id="6582" href="SecureCompilation.Coherence.html#5887" class="Bound">ms</a><a id="6584" class="Symbol">)</a> <a id="6586" class="Symbol">→</a>
      <a id="6594" class="Keyword">let</a>
        <a id="6606" href="SecureCompilation.Coherence.html#6606" class="Bound">Γ→Γ′</a> <a id="6611" class="Symbol">:</a> <a id="6613" href="SecureCompilation.Coherence.html#5674" class="Bound">Γₜ</a> <a id="6616" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="6619" href="SecureCompilation.Coherence.html#6251" class="Bound">α</a> <a id="6621" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="6625" href="SecureCompilation.Coherence.html#6350" class="Bound">Γₜ′</a>
        <a id="6637" href="SecureCompilation.Coherence.html#6606" class="Bound">Γ→Γ′</a> <a id="6642" class="Symbol">=</a> <a id="6644" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="6653" class="Symbol">(</a><a id="6654" href="BitML.Semantics.InferenceRules.html#4006" class="InductiveConstructor">[C-AuthCommit]</a> <a id="6669" href="SecureCompilation.Coherence.html#6475" class="Bound">as≡</a> <a id="6673" href="SecureCompilation.Coherence.html#6509" class="Bound">All∉</a> <a id="6678" href="SecureCompilation.Coherence.html#6553" class="Bound">Hon⇒</a><a id="6682" class="Symbol">)</a> <a id="6684" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="6698" class="Comment">-- (v) txout = txout′ (vi) extend sechash′ (vii) extend κ′</a>
        <a id="6765" href="SecureCompilation.Coherence.html#6765" class="Bound">sechash⁺</a> <a id="6774" class="Symbol">:</a> <a id="6776" href="SecureCompilation.Coherence.html#5882" class="Bound">as</a> <a id="6779" href="Prelude.Lists.html#12988" class="Function Operator">↦</a> <a id="6781" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a>
        <a id="6791" href="SecureCompilation.Coherence.html#6765" class="Bound">sechash⁺</a> <a id="6800" href="SecureCompilation.Coherence.html#6800" class="Bound">a∈</a> <a id="6803" class="Symbol">=</a>
          <a id="6815" class="Keyword">let</a> <a id="6819" class="Symbol">_</a> <a id="6821" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6823" href="SecureCompilation.Coherence.html#6823" class="Bound">a×m∈</a> <a id="6828" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6830" class="Symbol">_</a>    <a id="6835" class="Symbol">=</a> <a id="6837" href="Prelude.Lists.html#8818" class="Function">∈-unzip⁻ˡ</a> <a id="6847" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a> <a id="6849" href="SecureCompilation.Coherence.html#6800" class="Bound">a∈</a>
              <a id="6866" class="Symbol">(_</a> <a id="6869" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6871" class="Symbol">_</a> <a id="6873" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6875" href="SecureCompilation.Coherence.html#6875" class="Bound">z</a><a id="6876" class="Symbol">)</a> <a id="6878" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6880" class="Symbol">_</a> <a id="6882" class="Symbol">=</a> <a id="6884" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">∈-map⁻</a> <a id="6891" class="Symbol">(λ{</a> <a id="6895" class="Symbol">(</a><a id="6896" href="SecureCompilation.Coherence.html#6896" class="Bound">s</a> <a id="6898" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6900" href="SecureCompilation.Coherence.html#6900" class="Bound">mn</a> <a id="6903" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6905" class="Symbol">_)</a> <a id="6908" class="Symbol">→</a> <a id="6910" href="SecureCompilation.Coherence.html#6896" class="Bound">s</a> <a id="6912" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6914" href="SecureCompilation.Coherence.html#6900" class="Bound">mn</a> <a id="6917" class="Symbol">})</a> <a id="6920" href="SecureCompilation.Coherence.html#6823" class="Bound">a×m∈</a>
          <a id="6935" class="Keyword">in</a> <a id="6938" href="SecureCompilation.Coherence.html#6875" class="Bound">z</a>

        <a id="6949" class="Keyword">open</a> <a id="6954" href="SymbolicModel.Helpers.html#3153" class="Module">H₂</a> <a id="6957" class="Symbol">{</a><a id="6958" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a><a id="6960" class="Symbol">}</a> <a id="6962" href="SecureCompilation.Coherence.html#5457" class="Bound">𝕣</a> <a id="6964" href="SecureCompilation.Coherence.html#5608" class="Bound">t</a> <a id="6966" href="SecureCompilation.Coherence.html#6251" class="Bound">α</a> <a id="6968" href="SecureCompilation.Coherence.html#6334" class="Bound">t′</a> <a id="6971" href="SecureCompilation.Coherence.html#5657" class="Bound">Γ</a> <a id="6973" href="SecureCompilation.Coherence.html#5697" class="Bound">cfg≈</a> <a id="6978" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6980" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="6982" href="SecureCompilation.Coherence.html#5613" class="Bound">⟨G⟩C</a> <a id="6987" href="SecureCompilation.Coherence.html#5794" class="Bound">Δ</a> <a id="6989" href="SecureCompilation.Coherence.html#6765" class="Bound">sechash⁺</a> <a id="6998" href="SecureCompilation.Coherence.html#5620" class="Bound">k⃗</a> <a id="7001" href="SecureCompilation.Coherence.html#6606" class="Bound">Γ→Γ′</a> <a id="7006" href="SecureCompilation.Coherence.html#6410" class="Bound">∃Γ≈</a>
      <a id="7016" class="Keyword">in</a>
      <a id="7025" class="Comment">-- (i) ⟨G⟩C has been previously advertised in Rᶜ</a>
      <a id="7080" class="Comment">-- T0D0: make sure it is the first occurrence of such a broadcast in Rᶜ</a>
      <a id="7158" class="Symbol">(</a><a id="7159" href="Data.Product.html#1369" class="Function">∃</a> <a id="7161" class="Symbol">λ</a> <a id="7163" href="SecureCompilation.Coherence.html#7163" class="Bound">B</a> <a id="7165" class="Symbol">→</a> <a id="7167" class="Symbol">(</a><a id="7168" href="SecureCompilation.Coherence.html#7163" class="Bound">B</a> <a id="7170" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="7174" href="SecureCompilation.Coherence.html#5732" class="Bound">C</a><a id="7175" class="Symbol">)</a> <a id="7177" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="7179" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="7181" class="Symbol">)</a>

      <a id="7190" class="Comment">-- (ii) broadcast message in Rᶜ</a>
      <a id="7228" class="Comment">-- T0D0: make sure that λᶜ is the first occurrence of such a message after C in Rᶜ</a>
    <a id="7315" class="Comment">-- → ∃ λ B → λᶜ ≡ B →∗∶ C,h̅,k̅ₐ</a>
    <a id="7352" class="Symbol">→</a> <a id="7354" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="7358" class="Symbol">(λ</a> <a id="7361" href="SecureCompilation.Coherence.html#7361" class="Bound">hᵢ</a> <a id="7364" class="Symbol">→</a> <a id="7366" href="SecureCompilation.Coherence.html#1404" class="Postulate Operator">∣</a> <a id="7368" href="SecureCompilation.Coherence.html#7361" class="Bound">hᵢ</a> <a id="7371" href="SecureCompilation.Coherence.html#1404" class="Postulate Operator">∣ᶻ</a> <a id="7374" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7376" href="SecureCompilation.Coherence.html#659" class="Bound">η</a><a id="7377" class="Symbol">)</a> <a id="7379" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a>

      <a id="7389" class="Comment">-- (iii) each hᵢ is obtained by querying the oracle, otherwise we have a dishonestly chosen secret</a>
    <a id="7492" class="Symbol">→</a> <a id="7494" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="7498" class="Symbol">(λ{</a> <a id="7502" class="Symbol">(_</a> <a id="7505" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7507" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="7512" href="SecureCompilation.Coherence.html#7512" class="Bound">Nᵢ</a> <a id="7515" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7517" href="SecureCompilation.Coherence.html#7517" class="Bound">hᵢ</a><a id="7519" class="Symbol">)</a>
            <a id="7533" class="Symbol">→</a> <a id="7535" href="Data.Product.html#1369" class="Function">∃</a> <a id="7537" class="Symbol">λ</a> <a id="7539" href="SecureCompilation.Coherence.html#7539" class="Bound">B</a> <a id="7541" class="Symbol">→</a> <a id="7543" href="Data.Product.html#1369" class="Function">∃</a> <a id="7545" class="Symbol">λ</a> <a id="7547" href="SecureCompilation.Coherence.html#7547" class="Bound">mᵢ</a> <a id="7550" class="Symbol">→</a> <a id="7552" class="Symbol">((</a><a id="7554" href="SecureCompilation.Coherence.html#7539" class="Bound">B</a> <a id="7556" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7558" href="SecureCompilation.Coherence.html#7547" class="Bound">mᵢ</a> <a id="7561" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7563" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="7565" href="SecureCompilation.Coherence.html#7517" class="Bound">hᵢ</a> <a id="7568" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="7569" class="Symbol">)</a> <a id="7571" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="7573" href="ComputationalModel.Strategy.html#3170" class="Function">oracleInteractions</a> <a id="7592" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="7594" class="Symbol">)</a> <a id="7596" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="7598" class="Symbol">(</a><a id="7599" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣</a> <a id="7601" href="SecureCompilation.Coherence.html#7547" class="Bound">mᵢ</a> <a id="7604" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣ᵐ</a> <a id="7607" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7609" href="SecureCompilation.Coherence.html#659" class="Bound">η</a> <a id="7611" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7613" href="SecureCompilation.Coherence.html#7512" class="Bound">Nᵢ</a><a id="7615" class="Symbol">)</a>
            <a id="7629" class="Symbol">;</a> <a id="7631" class="Symbol">(_</a> <a id="7634" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7636" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a> <a id="7644" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7646" href="SecureCompilation.Coherence.html#7646" class="Bound">hᵢ</a><a id="7648" class="Symbol">)</a>
            <a id="7662" class="Symbol">→</a> <a id="7664" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="7666" href="SecureCompilation.Coherence.html#7646" class="Bound">hᵢ</a> <a id="7669" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="7671" href="Data.List.Membership.Setoid.html#936" class="Function Operator">∉</a> <a id="7673" href="Data.List.Base.html#1544" class="Function">map</a> <a id="7677" class="Symbol">(</a><a id="7678" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="7684" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7686" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="7691" class="Symbol">)</a> <a id="7693" class="Symbol">(</a><a id="7694" href="Data.List.Base.html#8092" class="Function">filter</a> <a id="7701" class="Symbol">((</a><a id="7703" href="SecureCompilation.Coherence.html#659" class="Bound">η</a> <a id="7705" href="Prelude.Ord.html#487" class="Function Operator">≤?_</a><a id="7708" class="Symbol">)</a> <a id="7710" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7712" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣_∣ᵐ</a> <a id="7717" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7719" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="7725" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="7727" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="7732" class="Symbol">)</a> <a id="7734" class="Symbol">(</a><a id="7735" href="ComputationalModel.Strategy.html#3170" class="Function">oracleInteractions</a> <a id="7754" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="7756" class="Symbol">))</a>
            <a id="7771" class="Symbol">})</a> <a id="7774" href="SecureCompilation.Coherence.html#5494" class="Bound">Δ×h̅</a>

      <a id="7786" class="Comment">-- (iv) no hash is reused</a>
    <a id="7816" class="Symbol">→</a> <a id="7818" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">Unique</a> <a id="7825" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a>
    <a id="7832" class="Symbol">→</a> <a id="7834" href="Data.List.Relation.Binary.Disjoint.Setoid.html#842" class="Function">Disjoint</a> <a id="7843" href="SecureCompilation.Coherence.html#5970" class="Bound">h̅</a> <a id="7846" class="Symbol">(</a><a id="7847" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="7853" href="SymbolicModel.Helpers.html#1633" class="Function">sechash</a><a id="7860" class="Symbol">)</a>
      <a id="7868" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="7945" class="Symbol">→</a> <a id="7947" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="7955" href="SecureCompilation.Coherence.html#5452" class="Bound">Rˢ</a> <a id="7958" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="7960" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="7963" href="SecureCompilation.Coherence.html#6373" class="Bound">λᶜ</a> <a id="7966" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="7972" class="Comment">-- ** Stipulation: authorizing deposits</a>
  <a id="coher₁₁.[3]"></a><a id="8014" href="SecureCompilation.Coherence.html#8014" class="InductiveConstructor">[3]</a> <a id="8018" class="Symbol">:</a> <a id="8020" class="Symbol">∀</a> <a id="8022" class="Symbol">{</a><a id="8023" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8028" class="Symbol">:</a> <a id="8030" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="8043" class="Symbol">}</a> <a id="8045" class="Symbol">{</a><a id="8046" href="SecureCompilation.Coherence.html#8046" class="Bound">vad</a> <a id="8050" class="Symbol">:</a> <a id="8052" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="8058" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a><a id="8062" class="Symbol">}</a> <a id="8064" class="Symbol">→</a> <a id="8066" class="Keyword">let</a> <a id="8070" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="8072" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a> <a id="8074" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="8076" href="SecureCompilation.Coherence.html#8076" class="Bound">C</a> <a id="8078" class="Symbol">=</a> <a id="8080" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8085" class="Symbol">;</a> <a id="8087" href="SecureCompilation.Coherence.html#8087" class="Bound">partG</a> <a id="8093" class="Symbol">=</a> <a id="8095" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="8112" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a> <a id="8114" class="Keyword">in</a>
        <a id="8125" class="Symbol">∀</a> <a id="8127" class="Symbol">{</a><a id="8128" href="SecureCompilation.Coherence.html#8128" class="Bound">t</a> <a id="8130" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="8132" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a><a id="8134" class="Symbol">}</a> <a id="8136" class="Symbol">→</a> <a id="8138" class="Keyword">let</a> <a id="8142" href="SecureCompilation.Coherence.html#8142" class="Bound">Γ</a> <a id="8144" class="Symbol">=</a> <a id="8146" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="8148" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8153" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="8155" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a><a id="8157" class="Symbol">;</a> <a id="8159" href="SecureCompilation.Coherence.html#8159" class="Bound">Γₜ</a> <a id="8162" class="Symbol">=</a> <a id="8164" href="SecureCompilation.Coherence.html#8142" class="Bound">Γ</a> <a id="8166" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="8169" href="SecureCompilation.Coherence.html#8128" class="Bound">t</a> <a id="8171" class="Keyword">in</a>

      <a id="8181" class="Symbol">(</a><a id="8182" href="SecureCompilation.Coherence.html#8182" class="Bound">cfg≈</a> <a id="8187" class="Symbol">:</a> <a id="8189" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="8192" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="8195" href="SecureCompilation.Coherence.html#8159" class="Bound">Γₜ</a><a id="8197" class="Symbol">)</a>

    <a id="8204" class="Symbol">→</a> <a id="8206" class="Keyword">let</a>
        <a id="8218" href="SecureCompilation.Coherence.html#8218" class="Bound">α</a>   <a id="8222" class="Symbol">=</a> <a id="8224" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">auth-init⦅</a> <a id="8235" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="8237" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">,</a> <a id="8239" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8244" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">,</a> <a id="8246" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="8248" href="BitML.Semantics.Label.html#1208" class="InductiveConstructor Operator">⦆</a>
        <a id="8258" href="SecureCompilation.Coherence.html#8258" class="Bound">Γ′</a>  <a id="8262" class="Symbol">=</a> <a id="8264" href="SecureCompilation.Coherence.html#8142" class="Bound">Γ</a> <a id="8266" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="8268" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="8270" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="8276" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="8278" href="BitML.Semantics.Action.html#729" class="InductiveConstructor Operator">▷ˢ</a> <a id="8281" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8286" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a>
        <a id="8296" href="SecureCompilation.Coherence.html#8296" class="Bound">t′</a>  <a id="8300" class="Symbol">=</a> <a id="8302" href="SecureCompilation.Coherence.html#8128" class="Bound">t</a>
        <a id="8312" href="SecureCompilation.Coherence.html#8312" class="Bound">Γₜ′</a> <a id="8316" class="Symbol">=</a> <a id="8318" href="SecureCompilation.Coherence.html#8258" class="Bound">Γ′</a> <a id="8321" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="8324" href="SecureCompilation.Coherence.html#8296" class="Bound">t′</a>
      <a id="8333" class="Keyword">in</a>
      <a id="8342" class="Symbol">(</a><a id="8343" href="SecureCompilation.Coherence.html#8343" class="Bound">∃Γ≈</a> <a id="8347" class="Symbol">:</a> <a id="8349" href="Data.Product.html#1369" class="Function">∃</a> <a id="8351" class="Symbol">(</a><a id="8352" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="8356" href="SecureCompilation.Coherence.html#8258" class="Bound">Γ′</a><a id="8358" class="Symbol">))</a>
      <a id="8367" class="Comment">-- Hypotheses from [C-AuthInit]</a>
      <a id="8405" class="Symbol">(</a><a id="8406" href="SecureCompilation.Coherence.html#8406" class="Bound">committedA</a> <a id="8417" class="Symbol">:</a> <a id="8419" href="SecureCompilation.Coherence.html#8087" class="Bound">partG</a> <a id="8425" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="8427" href="BitML.Semantics.Configurations.Helpers.html#6232" class="Function">committedParticipants</a> <a id="8449" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="8454" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a><a id="8456" class="Symbol">)</a>
      <a id="8464" class="Symbol">(</a><a id="8465" href="SecureCompilation.Coherence.html#8465" class="Bound">A∈per</a> <a id="8471" class="Symbol">:</a> <a id="8473" class="Symbol">(</a><a id="8474" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="8476" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8478" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="8480" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8482" href="BitML.BasicTypes.html#482" class="Generalizable">x</a><a id="8483" class="Symbol">)</a> <a id="8485" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="8487" href="BitML.Contracts.Helpers.html#7520" class="Function">persistentDeposits</a> <a id="8506" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a><a id="8507" class="Symbol">)</a>

      <a id="8516" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="8596" class="Comment">--   ∙ from the hypotheses of [C-Advertise]</a>
      <a id="8646" class="Comment">--       ∘ which introduces ` ⟨G⟩C</a>
      <a id="8687" class="Comment">--       ⇒ deposits ⟨G⟩C ⊆ deposits Γ₀</a>
      <a id="8732" class="Comment">--       ⇒ namesʳ ⟨G⟩C ⊆ namesʳ Γ₀</a>
      <a id="8773" class="Comment">--   ∙ from the hypotheses of [C-AuthCommit]</a>
      <a id="8824" class="Comment">--       ∘ which introduces ⟨ Aᵢ ∶ aᵢ ♯ Nᵢ ⟩</a>
      <a id="8875" class="Comment">--       ⇒ secrets ⟨G⟩C ⊆ secrets Γ₀</a>
      <a id="8918" class="Comment">--       ⇒ namesˡ ⟨G⟩C ⊆ namesˡ Γ₀</a>
      <a id="8959" class="Symbol">(</a><a id="8960" href="SecureCompilation.Coherence.html#8960" class="Bound">names⊆</a> <a id="8967" class="Symbol">:</a> <a id="8969" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a> <a id="8971" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="8982" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a><a id="8984" class="Symbol">)</a>
      <a id="8992" class="Comment">--   ∙ from the hypotheses of [C-Advertise]</a>
      <a id="9042" class="Comment">--       ∘ which introduces ` ⟨G⟩C</a>
      <a id="9083" class="Comment">--       ⇒ ∃(p ∈ partG). p ∈ Hon</a>
      <a id="9122" class="Comment">--   ∙ from the hypotheses of [C-AuthCommit]</a>
      <a id="9173" class="Comment">--       ∘ which introduces ⟨ Aᵢ ∶ aᵢ ♯ Nᵢ ⟩ and Aᵢ auth⦅ ♯▷ ad ⦆</a>
      <a id="9245" class="Comment">--       ⇒ we know at least one participant Aᵢ is honest</a>
      <a id="9308" class="Comment">--       → therefore, ad ∈ authorizedHonAds Γ₀</a>
      <a id="9361" class="Symbol">(</a><a id="9362" href="SecureCompilation.Coherence.html#9362" class="Bound">ad∈₀</a> <a id="9367" class="Symbol">:</a> <a id="9369" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="9374" href="SecureCompilation.Coherence.html#1947" class="Function Operator">∈⦅ads⦆</a> <a id="9381" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a><a id="9383" class="Symbol">)</a> <a id="9385" class="Symbol">→</a>

      <a id="9394" class="Keyword">let</a>
        <a id="9406" href="SecureCompilation.Coherence.html#9406" class="Bound">A∈′</a> <a id="9410" class="Symbol">:</a> <a id="9412" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="9414" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="9416" href="BitML.Semantics.Configurations.Helpers.html#6232" class="Function">committedParticipants</a> <a id="9438" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="9443" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a>
        <a id="9454" href="SecureCompilation.Coherence.html#9406" class="Bound">A∈′</a> <a id="9458" class="Symbol">=</a> <a id="9460" href="SecureCompilation.Coherence.html#8406" class="Bound">committedA</a> <a id="9471" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9473" href="Prelude.DecLists.html#2945" class="Function">∈-nub⁺</a> <a id="9480" class="Symbol">(</a><a id="9481" href="BitML.Contracts.Helpers.html#10313" class="Function">persistentParticipants⊆</a> <a id="9505" class="Symbol">{</a><a id="9506" class="Argument">g</a> <a id="9508" class="Symbol">=</a> <a id="9510" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a><a id="9511" class="Symbol">}</a> <a id="9513" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="9515" href="Data.List.Membership.Propositional.Properties.html#3368" class="Function">∈-map⁺</a> <a id="9522" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9528" href="SecureCompilation.Coherence.html#8465" class="Bound">A∈per</a><a id="9533" class="Symbol">)</a>

        <a id="9544" href="SecureCompilation.Coherence.html#9544" class="Bound">Γ→Γ′</a> <a id="9549" class="Symbol">:</a> <a id="9551" href="SecureCompilation.Coherence.html#8159" class="Bound">Γₜ</a> <a id="9554" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="9557" href="SecureCompilation.Coherence.html#8218" class="Bound">α</a> <a id="9559" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="9563" href="SecureCompilation.Coherence.html#8312" class="Bound">Γₜ′</a>
        <a id="9575" href="SecureCompilation.Coherence.html#9544" class="Bound">Γ→Γ′</a> <a id="9580" class="Symbol">=</a> <a id="9582" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="9591" class="Symbol">(</a><a id="9592" href="BitML.Semantics.InferenceRules.html#4584" class="InductiveConstructor">[C-AuthInit]</a> <a id="9605" href="SecureCompilation.Coherence.html#8406" class="Bound">committedA</a> <a id="9616" href="SecureCompilation.Coherence.html#8465" class="Bound">A∈per</a><a id="9621" class="Symbol">)</a> <a id="9623" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="9637" class="Comment">-- (iv) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="9696" class="Keyword">open</a> <a id="9701" href="SymbolicModel.Helpers.html#6589" class="Module">H₃</a> <a id="9704" class="Symbol">{</a><a id="9705" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="9707" class="Symbol">}</a> <a id="9709" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="9711" href="SecureCompilation.Coherence.html#8128" class="Bound">t</a> <a id="9713" href="SecureCompilation.Coherence.html#8218" class="Bound">α</a> <a id="9715" href="SecureCompilation.Coherence.html#8296" class="Bound">t′</a> <a id="9718" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a> <a id="9723" href="SecureCompilation.Coherence.html#8132" class="Bound">Γ₀</a> <a id="9726" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a> <a id="9728" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="9730" href="SecureCompilation.Coherence.html#8182" class="Bound">cfg≈</a> <a id="9735" href="SecureCompilation.Coherence.html#9544" class="Bound">Γ→Γ′</a> <a id="9740" href="SecureCompilation.Coherence.html#8343" class="Bound">∃Γ≈</a>

        <a id="9753" href="SecureCompilation.Coherence.html#9753" class="Bound">Tᵢₙᵢₜ</a> <a id="9759" class="Symbol">:</a> <a id="9761" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="9773" href="SecureCompilation.Coherence.html#9753" class="Bound">Tᵢₙᵢₜ</a> <a id="9779" class="Symbol">=</a>
          <a id="9791" class="Keyword">let</a> <a id="9795" class="Comment">-- invoke compiler</a>
            <a id="9826" href="SecureCompilation.Coherence.html#9826" class="Bound">K</a> <a id="9828" class="Symbol">:</a> <a id="9830" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="9832" href="SecureCompilation.Coherence.html#8072" class="Bound">G</a>
            <a id="9846" href="SecureCompilation.Coherence.html#9826" class="Bound">K</a> <a id="9848" class="Symbol">{</a><a id="9849" href="SecureCompilation.Coherence.html#9849" class="Bound">p</a><a id="9850" class="Symbol">}</a> <a id="9852" class="Symbol">_</a> <a id="9854" class="Symbol">=</a> <a id="9856" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="9859" href="SecureCompilation.Coherence.html#9849" class="Bound">p</a>

            <a id="9874" class="Keyword">open</a> <a id="9879" href="SymbolicModel.Helpers.html#7504" class="Module">H₃′</a> <a id="9883" href="SecureCompilation.Coherence.html#9362" class="Bound">ad∈₀</a> <a id="9888" href="SecureCompilation.Coherence.html#8960" class="Bound">names⊆</a>

            <a id="9908" href="SecureCompilation.Coherence.html#9908" class="Bound">∃tx¹</a> <a id="9913" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9915" class="Symbol">_</a> <a id="9917" class="Symbol">=</a> <a id="9919" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="9934" class="Symbol">{</a><a id="9935" class="Argument">ad</a> <a id="9938" class="Symbol">=</a> <a id="9940" href="SecureCompilation.Coherence.html#8023" class="Bound">⟨G⟩C</a><a id="9944" class="Symbol">}</a> <a id="9946" href="SecureCompilation.Coherence.html#8046" class="Bound">vad</a> <a id="9950" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="9959" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="9966" href="SecureCompilation.Coherence.html#9826" class="Bound">K</a> <a id="9968" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a>
          <a id="9981" class="Keyword">in</a>
            <a id="9996" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="9999" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="10002" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10008" href="SecureCompilation.Coherence.html#9908" class="Bound">∃tx¹</a>

        <a id="10022" class="Comment">-- (i) broadcast Tᵢₙᵢₜ , signed with A&#39;s private key</a>
        <a id="10083" href="SecureCompilation.Coherence.html#10083" class="Bound">m</a> <a id="10085" class="Symbol">=</a> <a id="10087" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="10089" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="10093" class="Symbol">(</a><a id="10094" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="10097" href="SecureCompilation.Coherence.html#8130" class="Bound">A</a><a id="10098" class="Symbol">)</a> <a id="10100" href="SecureCompilation.Coherence.html#9753" class="Bound">Tᵢₙᵢₜ</a> <a id="10106" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="10116" href="SecureCompilation.Coherence.html#10116" class="Bound">λᶜ</a> <a id="10119" class="Symbol">=</a> <a id="10121" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="10123" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="10127" href="SecureCompilation.Coherence.html#10083" class="Bound">m</a>
      <a id="10135" class="Keyword">in</a>
      <a id="10144" class="Comment">-- (ii) Tᵢₙᵢₜ occurs as a message in Rᶜ</a>
      <a id="10190" class="Symbol">(</a><a id="10191" href="Data.Product.html#1369" class="Function">∃</a> <a id="10193" class="Symbol">λ</a> <a id="10195" href="SecureCompilation.Coherence.html#10195" class="Bound">B</a> <a id="10197" class="Symbol">→</a> <a id="10199" class="Symbol">(</a><a id="10200" href="SecureCompilation.Coherence.html#10195" class="Bound">B</a> <a id="10202" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="10206" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="10208" href="Bitcoin.Crypto.html#606" class="Postulate">HASH</a> <a id="10213" href="SecureCompilation.Coherence.html#9753" class="Bound">Tᵢₙᵢₜ</a> <a id="10219" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="10220" class="Symbol">)</a> <a id="10222" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="10224" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="10226" class="Symbol">)</a>

      <a id="10235" class="Comment">-- (iii) broadcast message in Rᶜ</a>
      <a id="10274" class="Comment">-- T0D0: make sure that λᶜ is the first occurrence of such a message after Tinit in Rᶜ</a>
      <a id="10367" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="10444" class="Symbol">→</a> <a id="10446" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="10454" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="10457" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="10459" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="10462" href="SecureCompilation.Coherence.html#10116" class="Bound">λᶜ</a> <a id="10465" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>


  <a id="10472" class="Comment">-- ** Stipulation: activating the contract</a>
  <a id="coher₁₁.[4]"></a><a id="10517" href="SecureCompilation.Coherence.html#10517" class="InductiveConstructor">[4]</a> <a id="10521" class="Symbol">:</a> <a id="10523" class="Symbol">∀</a> <a id="10525" class="Symbol">{</a><a id="10526" href="SecureCompilation.Coherence.html#10526" class="Bound">t</a> <a id="10528" href="SecureCompilation.Coherence.html#10528" class="Bound">Γ₀</a> <a id="10531" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a> <a id="10533" href="SecureCompilation.Coherence.html#10533" class="Bound">C</a><a id="10534" class="Symbol">}</a>
    <a id="10540" class="Symbol">→</a> <a id="10542" class="Keyword">let</a>
        <a id="10554" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a>      <a id="10562" class="Symbol">=</a> <a id="10564" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="10566" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a> <a id="10568" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="10570" href="SecureCompilation.Coherence.html#10533" class="Bound">C</a>
        <a id="10580" href="SecureCompilation.Coherence.html#10580" class="Bound">toSpend</a> <a id="10588" class="Symbol">=</a> <a id="10590" href="BitML.Contracts.Helpers.html#7520" class="Function">persistentDeposits</a> <a id="10609" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a>
        <a id="10619" href="SecureCompilation.Coherence.html#10619" class="Bound">partG</a>   <a id="10627" class="Symbol">=</a> <a id="10629" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="10646" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a>
        <a id="10656" href="SecureCompilation.Coherence.html#10656" class="Bound">v</a>       <a id="10664" class="Symbol">=</a> <a id="10666" href="Data.List.Base.html#4784" class="Function">sum</a> <a id="10670" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="10672" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10676" class="Symbol">(</a><a id="10677" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10683" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="10685" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="10690" class="Symbol">)</a> <a id="10692" href="SecureCompilation.Coherence.html#10580" class="Bound">toSpend</a>

        <a id="10709" href="SecureCompilation.Coherence.html#10709" class="Bound">Γ</a> <a id="10711" class="Symbol">=</a> <a id="10713" href="BitML.Semantics.Configurations.Types.html#759" class="InductiveConstructor Operator">`</a> <a id="10715" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a> <a id="10718" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="10720" href="SecureCompilation.Coherence.html#10528" class="Bound">Γ₀</a>
          <a id="10733" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="10735" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="10738" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10742" class="Symbol">(λ{</a> <a id="10746" class="Symbol">(</a><a id="10747" href="SecureCompilation.Coherence.html#10747" class="Bound">Aᵢ</a> <a id="10750" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10752" href="SecureCompilation.Coherence.html#10752" class="Bound">vᵢ</a> <a id="10755" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10757" href="SecureCompilation.Coherence.html#10757" class="Bound">xᵢ</a><a id="10759" class="Symbol">)</a> <a id="10761" class="Symbol">→</a> <a id="10763" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="10765" href="SecureCompilation.Coherence.html#10747" class="Bound">Aᵢ</a> <a id="10768" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="10772" href="SecureCompilation.Coherence.html#10752" class="Bound">vᵢ</a> <a id="10775" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="10779" href="SecureCompilation.Coherence.html#10757" class="Bound">xᵢ</a> <a id="10782" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="10784" href="SecureCompilation.Coherence.html#10747" class="Bound">Aᵢ</a> <a id="10787" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="10793" href="SecureCompilation.Coherence.html#10757" class="Bound">xᵢ</a> <a id="10796" href="BitML.Semantics.Action.html#729" class="InductiveConstructor Operator">▷ˢ</a> <a id="10799" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a> <a id="10802" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="10804" class="Symbol">})</a> <a id="10807" href="SecureCompilation.Coherence.html#10580" class="Bound">toSpend</a>
          <a id="10825" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="10827" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="10830" href="Data.List.Base.html#1544" class="Function">map</a> <a id="10834" class="Symbol">(</a><a id="10835" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">_auth[</a> <a id="10842" href="BitML.Semantics.Action.html#666" class="InductiveConstructor Operator">♯▷</a> <a id="10845" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a> <a id="10848" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a><a id="10849" class="Symbol">)</a> <a id="10851" href="SecureCompilation.Coherence.html#10619" class="Bound">partG</a>
        <a id="10865" href="SecureCompilation.Coherence.html#10865" class="Bound">Γₜ</a> <a id="10868" class="Symbol">=</a> <a id="10870" href="SecureCompilation.Coherence.html#10709" class="Bound">Γ</a> <a id="10872" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="10875" href="SecureCompilation.Coherence.html#10526" class="Bound">t</a>
      <a id="10883" class="Keyword">in</a>
      <a id="10892" class="Symbol">{</a><a id="10893" href="SecureCompilation.Coherence.html#10893" class="Bound">vad</a> <a id="10897" class="Symbol">:</a> <a id="10899" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="10905" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a><a id="10907" class="Symbol">}</a>
      <a id="10915" class="Comment">-- (i) consume {G}C and its persistent deposits from Rˢ</a>
      <a id="10977" class="Symbol">(</a><a id="10978" href="SecureCompilation.Coherence.html#10978" class="Bound">cfg≈</a> <a id="10983" class="Symbol">:</a> <a id="10985" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="10988" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="10991" href="SecureCompilation.Coherence.html#10865" class="Bound">Γₜ</a><a id="10993" class="Symbol">)</a>

      <a id="11002" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="11082" class="Comment">--   ∙ from the hypotheses of [C-Advertise]</a>
      <a id="11132" class="Comment">--       ∘ which introduces ` ⟨G⟩C</a>
      <a id="11173" class="Comment">--       ⇒ deposits ⟨G⟩C ⊆ deposits Γ₀</a>
      <a id="11218" class="Comment">--       ⇒ namesʳ ⟨G⟩C ⊆ namesʳ Γ₀ ⊆ namesʳ (_ ∣ Γ₀ ∣ _)</a>
      <a id="11281" class="Comment">--   ∙ from the hypotheses of [C-AuthCommit]</a>
      <a id="11332" class="Comment">--       ∘ which introduces ⟨ Aᵢ ∶ aᵢ ♯ Nᵢ ⟩</a>
      <a id="11383" class="Comment">--       ⇒ secrets ⟨G⟩C ⊆ secrets Γ₀</a>
      <a id="11426" class="Comment">--       ⇒ namesˡ ⟨G⟩C ⊆ namesˡ Γ₀</a>
    <a id="11465" class="Symbol">→</a> <a id="11467" class="Symbol">(</a><a id="11468" href="SecureCompilation.Coherence.html#11468" class="Bound">names⊆</a> <a id="11475" class="Symbol">:</a> <a id="11477" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a> <a id="11479" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="11490" href="SecureCompilation.Coherence.html#10528" class="Bound">Γ₀</a><a id="11492" class="Symbol">)</a>

      <a id="11501" class="Comment">-- [T0D0] additional hypothesis, should hold from the hypotheses of [C-Advertise]</a>
    <a id="11587" class="Symbol">→</a> <a id="11589" class="Symbol">(</a><a id="11590" href="SecureCompilation.Coherence.html#11590" class="Bound">honG</a> <a id="11595" class="Symbol">:</a> <a id="11597" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="11601" class="Symbol">(</a><a id="11602" href="Data.List.Membership.Setoid.html#887" class="Function Operator">_∈</a> <a id="11605" href="BitML.Contracts.Types.html#482" class="Function">Hon</a><a id="11608" class="Symbol">)</a> <a id="11610" href="SecureCompilation.Coherence.html#10619" class="Bound">partG</a><a id="11615" class="Symbol">)</a>

    <a id="11622" class="Symbol">→</a> <a id="11624" class="Keyword">let</a>
        <a id="11636" href="SecureCompilation.Coherence.html#11636" class="Bound">α</a>   <a id="11640" class="Symbol">=</a> <a id="11642" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">init⦅</a> <a id="11648" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a> <a id="11650" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">,</a> <a id="11652" href="SecureCompilation.Coherence.html#10533" class="Bound">C</a> <a id="11654" href="BitML.Semantics.Label.html#1282" class="InductiveConstructor Operator">⦆</a>
        <a id="11664" href="SecureCompilation.Coherence.html#11664" class="Bound">Γ′</a>  <a id="11668" class="Symbol">=</a> <a id="11670" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="11672" href="SecureCompilation.Coherence.html#10533" class="Bound">C</a> <a id="11674" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="11676" href="SecureCompilation.Coherence.html#10656" class="Bound">v</a> <a id="11678" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="11682" href="BitML.BasicTypes.html#486" class="Generalizable">z</a> <a id="11684" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="11686" href="SecureCompilation.Coherence.html#10528" class="Bound">Γ₀</a>
        <a id="11697" href="SecureCompilation.Coherence.html#11697" class="Bound">t′</a>  <a id="11701" class="Symbol">=</a> <a id="11703" href="SecureCompilation.Coherence.html#10526" class="Bound">t</a>
        <a id="11713" href="SecureCompilation.Coherence.html#11713" class="Bound">Γₜ′</a> <a id="11717" class="Symbol">=</a> <a id="11719" href="SecureCompilation.Coherence.html#11664" class="Bound">Γ′</a> <a id="11722" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="11725" href="SecureCompilation.Coherence.html#11697" class="Bound">t′</a>
      <a id="11734" class="Keyword">in</a>
      <a id="11743" class="Symbol">(</a><a id="11744" href="SecureCompilation.Coherence.html#11744" class="Bound">∃Γ≈</a> <a id="11748" class="Symbol">:</a> <a id="11750" href="Data.Product.html#1369" class="Function">∃</a> <a id="11752" class="Symbol">(</a><a id="11753" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="11757" href="SecureCompilation.Coherence.html#11664" class="Bound">Γ′</a><a id="11759" class="Symbol">))</a> <a id="11762" class="Symbol">→</a>
      <a id="11770" class="Keyword">let</a>
        <a id="11782" href="SecureCompilation.Coherence.html#11782" class="Bound">Γ→Γ′</a> <a id="11787" class="Symbol">:</a> <a id="11789" href="SecureCompilation.Coherence.html#10865" class="Bound">Γₜ</a> <a id="11792" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="11795" href="SecureCompilation.Coherence.html#11636" class="Bound">α</a> <a id="11797" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="11801" href="SecureCompilation.Coherence.html#11713" class="Bound">Γₜ′</a>
        <a id="11813" href="SecureCompilation.Coherence.html#11782" class="Bound">Γ→Γ′</a> <a id="11818" class="Symbol">=</a> <a id="11820" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="11829" href="BitML.Semantics.InferenceRules.html#4974" class="InductiveConstructor">[C-Init]</a> <a id="11838" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="11852" class="Keyword">open</a> <a id="11857" href="SymbolicModel.Helpers.html#8607" class="Module">H₄</a> <a id="11860" class="Symbol">{</a><a id="11861" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="11863" class="Symbol">}</a> <a id="11865" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="11867" href="SecureCompilation.Coherence.html#10526" class="Bound">t</a> <a id="11869" href="SecureCompilation.Coherence.html#11636" class="Bound">α</a> <a id="11871" href="SecureCompilation.Coherence.html#11697" class="Bound">t′</a> <a id="11874" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a> <a id="11877" href="SecureCompilation.Coherence.html#10528" class="Bound">Γ₀</a> <a id="11880" href="SecureCompilation.Coherence.html#10580" class="Bound">toSpend</a> <a id="11888" href="SecureCompilation.Coherence.html#10619" class="Bound">partG</a> <a id="11894" href="SecureCompilation.Coherence.html#10656" class="Bound">v</a> <a id="11896" href="BitML.BasicTypes.html#486" class="Generalizable">z</a> <a id="11898" href="SecureCompilation.Coherence.html#10978" class="Bound">cfg≈</a> <a id="11903" href="SecureCompilation.Coherence.html#11782" class="Bound">Γ→Γ′</a> <a id="11908" href="SecureCompilation.Coherence.html#11744" class="Bound">∃Γ≈</a>

        <a id="11921" href="SecureCompilation.Coherence.html#11921" class="Bound">Tᵢₙᵢₜ</a> <a id="11927" class="Symbol">:</a> <a id="11929" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="11941" href="SecureCompilation.Coherence.html#11921" class="Bound">Tᵢₙᵢₜ</a> <a id="11947" class="Symbol">=</a>
          <a id="11959" class="Keyword">let</a> <a id="11963" class="Comment">-- invoke compiler</a>
            <a id="11994" href="SecureCompilation.Coherence.html#11994" class="Bound">K̂</a> <a id="11997" class="Symbol">:</a> <a id="11999" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="12001" href="SecureCompilation.Coherence.html#10531" class="Bound">G</a>
            <a id="12015" href="SecureCompilation.Coherence.html#11994" class="Bound">K̂</a> <a id="12018" class="Symbol">{</a><a id="12019" href="SecureCompilation.Coherence.html#12019" class="Bound">p</a><a id="12020" class="Symbol">}</a> <a id="12022" class="Symbol">_</a> <a id="12024" class="Symbol">=</a> <a id="12026" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="12029" href="SecureCompilation.Coherence.html#12019" class="Bound">p</a>

            <a id="12044" class="Keyword">open</a> <a id="12049" href="SymbolicModel.Helpers.html#12182" class="Module">H₄′</a> <a id="12053" href="SecureCompilation.Coherence.html#11590" class="Bound">honG</a> <a id="12058" href="SecureCompilation.Coherence.html#11468" class="Bound">names⊆</a>

            <a id="12078" href="SecureCompilation.Coherence.html#12078" class="Bound">∃tx¹</a> <a id="12083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="12085" class="Symbol">_</a> <a id="12087" class="Symbol">=</a> <a id="12089" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="12104" class="Symbol">{</a><a id="12105" class="Argument">ad</a> <a id="12108" class="Symbol">=</a> <a id="12110" href="SecureCompilation.Coherence.html#10554" class="Bound">ad</a><a id="12112" class="Symbol">}</a> <a id="12114" href="SecureCompilation.Coherence.html#10893" class="Bound">vad</a> <a id="12118" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="12127" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="12134" href="SecureCompilation.Coherence.html#11994" class="Bound">K̂</a> <a id="12137" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a>
          <a id="12150" class="Keyword">in</a>
            <a id="12165" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="12168" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="12171" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="12177" href="SecureCompilation.Coherence.html#12078" class="Bound">∃tx¹</a>

        <a id="12191" class="Comment">-- (ii) append Tᵢₙᵢₜ to the blockchain</a>
        <a id="12238" href="SecureCompilation.Coherence.html#12238" class="Bound">λᶜ</a> <a id="12241" class="Symbol">=</a> <a id="12243" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="12250" href="SecureCompilation.Coherence.html#11921" class="Bound">Tᵢₙᵢₜ</a>

        <a id="12265" class="Comment">-- (iii) sechash = sechash′, κ = κ′, txout extends txout′ with (z ↦ Tᵢₙᵢₜ)</a>
        <a id="12348" class="Keyword">open</a> <a id="12353" href="SymbolicModel.Helpers.html#13599" class="Module">H₄″</a> <a id="12357" class="Symbol">(</a><a id="12358" href="SecureCompilation.Coherence.html#11921" class="Bound">Tᵢₙᵢₜ</a> <a id="12364" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="12367" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="12369" class="Symbol">)</a>
      <a id="12377" class="Keyword">in</a>
      <a id="12386" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="12465" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="12473" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="12476" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="12478" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="12481" href="SecureCompilation.Coherence.html#12238" class="Bound">λᶜ</a> <a id="12484" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>


  <a id="12491" class="Comment">-- ** Contract actions: authorize control</a>
  <a id="coher₁₁.[5]"></a><a id="12535" href="SecureCompilation.Coherence.html#12535" class="InductiveConstructor">[5]</a> <a id="12539" class="Symbol">:</a> <a id="12541" class="Keyword">let</a> <a id="12545" class="Keyword">open</a> <a id="12550" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="12552" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="12554" class="Keyword">in</a>
      <a id="12563" class="Symbol">∀</a> <a id="12565" class="Symbol">{</a><a id="12566" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a> <a id="12571" class="Symbol">:</a> <a id="12573" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="12586" class="Symbol">}</a> <a id="12588" class="Symbol">{</a><a id="12589" href="SecureCompilation.Coherence.html#12589" class="Bound">vad</a> <a id="12593" class="Symbol">:</a> <a id="12595" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="12601" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a><a id="12605" class="Symbol">}</a> <a id="12607" class="Symbol">→</a> <a id="12609" class="Keyword">let</a> <a id="12613" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="12615" href="SecureCompilation.Coherence.html#12615" class="Bound">G</a> <a id="12617" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="12619" href="SecureCompilation.Coherence.html#12619" class="Bound">C</a> <a id="12621" class="Symbol">=</a> <a id="12623" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a><a id="12627" class="Symbol">;</a> <a id="12629" href="SecureCompilation.Coherence.html#12629" class="Bound">partG</a> <a id="12635" class="Symbol">=</a> <a id="12637" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="12654" href="SecureCompilation.Coherence.html#12615" class="Bound">G</a> <a id="12656" class="Keyword">in</a>
      <a id="12665" class="Symbol">∀</a> <a id="12667" class="Symbol">{</a><a id="12668" href="SecureCompilation.Coherence.html#12668" class="Bound">v</a> <a id="12670" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="12672" href="SecureCompilation.Coherence.html#12672" class="Bound">Γ₀</a> <a id="12675" href="SecureCompilation.Coherence.html#12675" class="Bound">t</a> <a id="12677" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a><a id="12679" class="Symbol">}</a> <a id="12681" class="Symbol">{</a><a id="12682" href="SecureCompilation.Coherence.html#12682" class="Bound">i</a> <a id="12684" class="Symbol">:</a> <a id="12686" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="12692" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a><a id="12694" class="Symbol">}</a> <a id="12696" class="Symbol">→</a> <a id="12698" class="Keyword">let</a> <a id="12702" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a> <a id="12704" class="Symbol">=</a> <a id="12706" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a> <a id="12709" href="Prelude.Lists.html#1259" class="Function Operator">‼</a> <a id="12711" href="SecureCompilation.Coherence.html#12682" class="Bound">i</a><a id="12712" class="Symbol">;</a> <a id="12714" href="SecureCompilation.Coherence.html#12714" class="Bound">d∗</a> <a id="12717" class="Symbol">=</a> <a id="12719" href="BitML.Contracts.Helpers.html#12737" class="Function">removeTopDecorations</a> <a id="12740" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a> <a id="12742" class="Keyword">in</a>
      <a id="12751" class="Keyword">let</a> <a id="12755" href="SecureCompilation.Coherence.html#12755" class="Bound">Γ</a> <a id="12757" class="Symbol">=</a> <a id="12759" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="12761" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a> <a id="12764" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="12766" href="SecureCompilation.Coherence.html#12668" class="Bound">v</a> <a id="12768" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="12772" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="12774" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="12776" href="SecureCompilation.Coherence.html#12672" class="Bound">Γ₀</a><a id="12778" class="Symbol">;</a> <a id="12780" href="SecureCompilation.Coherence.html#12780" class="Bound">Γₜ</a> <a id="12783" class="Symbol">=</a> <a id="12785" href="SecureCompilation.Coherence.html#12755" class="Bound">Γ</a> <a id="12787" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="12790" href="SecureCompilation.Coherence.html#12675" class="Bound">t</a> <a id="12792" class="Keyword">in</a>

      <a id="12802" class="Comment">-- D ≡ A ∶ D′</a>
      <a id="12822" class="Symbol">(</a><a id="12823" href="SecureCompilation.Coherence.html#12823" class="Bound">D≡A:D′</a> <a id="12830" class="Symbol">:</a> <a id="12832" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="12834" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="12836" href="BitML.Contracts.Helpers.html#12574" class="Function">authDecorations</a> <a id="12852" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a><a id="12853" class="Symbol">)</a>

      <a id="12862" class="Comment">-- (i) Rˢ contains ⟨C′ , v⟩ₓ with C′ = D + ∑ᵢ Dᵢ</a>

    <a id="12916" class="Symbol">→</a> <a id="12918" class="Symbol">(</a><a id="12919" href="SecureCompilation.Coherence.html#12919" class="Bound">cfg≈</a> <a id="12924" class="Symbol">:</a> <a id="12926" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="12929" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="12932" href="SecureCompilation.Coherence.html#12780" class="Bound">Γₜ</a><a id="12934" class="Symbol">)</a>

      <a id="12943" class="Comment">-- (ii) {G}C is the ancestor of ⟨C′, v⟩ₓ in Rˢ</a>
    <a id="12994" class="Symbol">→</a> <a id="12996" class="Symbol">(</a><a id="12997" href="SecureCompilation.Coherence.html#12997" class="Bound">anc</a> <a id="13001" class="Symbol">:</a> <a id="13003" href="SymbolicModel.Collections.html#1540" class="Function">Ancestor</a> <a id="13012" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="13015" class="Symbol">(</a><a id="13016" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a> <a id="13019" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13021" href="SecureCompilation.Coherence.html#12668" class="Bound">v</a> <a id="13023" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13025" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a><a id="13026" class="Symbol">)</a> <a id="13028" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a><a id="13032" class="Symbol">)</a>
    <a id="13038" class="Symbol">→</a> <a id="13040" class="Keyword">let</a> <a id="13044" href="SecureCompilation.Coherence.html#13044" class="Bound">d⊆</a> <a id="13047" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13049" href="SecureCompilation.Coherence.html#13049" class="Bound">ad∈</a> <a id="13053" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="13055" class="Symbol">_</a> <a id="13057" class="Symbol">=</a> <a id="13059" href="SecureCompilation.Coherence.html#12997" class="Bound">anc</a>

          <a id="13074" href="SecureCompilation.Coherence.html#13074" class="Bound">d∈</a> <a id="13077" class="Symbol">:</a> <a id="13079" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a> <a id="13081" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="13083" href="BitML.Contracts.Helpers.html#14958" class="Function">subtermsᶜ′</a> <a id="13094" href="SecureCompilation.Coherence.html#12619" class="Bound">C</a>
          <a id="13106" href="SecureCompilation.Coherence.html#13074" class="Bound">d∈</a> <a id="13109" class="Symbol">=</a> <a id="13111" href="SecureCompilation.Coherence.html#13044" class="Bound">d⊆</a> <a id="13114" class="Symbol">(</a><a id="13115" href="Data.List.Membership.Propositional.Properties.html#11093" class="Function">∈-lookup</a> <a id="13124" href="SecureCompilation.Coherence.html#12682" class="Bound">i</a><a id="13125" class="Symbol">)</a>
      <a id="13133" class="Keyword">in</a>

      <a id="13143" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="13223" class="Comment">--   ∙  ...</a>
      <a id="13241" class="Symbol">(</a><a id="13242" href="SecureCompilation.Coherence.html#13242" class="Bound">names⊆</a> <a id="13249" class="Symbol">:</a> <a id="13251" href="SecureCompilation.Coherence.html#12615" class="Bound">G</a> <a id="13253" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="13264" href="SecureCompilation.Coherence.html#12672" class="Bound">Γ₀</a><a id="13266" class="Symbol">)</a>

      <a id="13275" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="13355" class="Comment">--   ∙  ...</a>
    <a id="13371" class="Symbol">→</a> <a id="13373" class="Symbol">(</a><a id="13374" href="SecureCompilation.Coherence.html#13374" class="Bound">A∈</a> <a id="13377" class="Symbol">:</a> <a id="13379" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="13381" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="13383" href="SecureCompilation.Coherence.html#12629" class="Bound">partG</a><a id="13388" class="Symbol">)</a>

    <a id="13395" class="Symbol">→</a> <a id="13397" class="Keyword">let</a>
        <a id="13409" href="SecureCompilation.Coherence.html#13409" class="Bound">α</a>   <a id="13413" class="Symbol">=</a> <a id="13415" href="BitML.Semantics.Label.html#1562" class="InductiveConstructor Operator">auth-control⦅</a> <a id="13429" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="13431" href="BitML.Semantics.Label.html#1562" class="InductiveConstructor Operator">,</a> <a id="13433" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="13435" href="BitML.Semantics.Label.html#1562" class="InductiveConstructor Operator">▷</a> <a id="13437" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a> <a id="13439" href="BitML.Semantics.Label.html#1562" class="InductiveConstructor Operator">⦆</a>
        <a id="13449" href="SecureCompilation.Coherence.html#13449" class="Bound">Γ′</a>  <a id="13453" class="Symbol">=</a> <a id="13455" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="13457" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a> <a id="13460" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="13462" href="SecureCompilation.Coherence.html#12668" class="Bound">v</a> <a id="13464" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="13468" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="13470" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="13472" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="13474" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="13480" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="13482" href="BitML.Semantics.Action.html#784" class="InductiveConstructor Operator">▷</a> <a id="13484" href="SecureCompilation.Coherence.html#12702" class="Bound">d</a> <a id="13486" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="13488" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="13490" href="SecureCompilation.Coherence.html#12672" class="Bound">Γ₀</a>
        <a id="13501" href="SecureCompilation.Coherence.html#13501" class="Bound">t′</a>  <a id="13505" class="Symbol">=</a> <a id="13507" href="SecureCompilation.Coherence.html#12675" class="Bound">t</a>
        <a id="13517" href="SecureCompilation.Coherence.html#13517" class="Bound">Γₜ′</a> <a id="13521" class="Symbol">=</a> <a id="13523" href="SecureCompilation.Coherence.html#13449" class="Bound">Γ′</a> <a id="13526" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="13529" href="SecureCompilation.Coherence.html#13501" class="Bound">t′</a>
      <a id="13538" class="Keyword">in</a>
      <a id="13547" class="Symbol">(</a><a id="13548" href="SecureCompilation.Coherence.html#13548" class="Bound">∃Γ≈</a> <a id="13552" class="Symbol">:</a> <a id="13554" href="Data.Product.html#1369" class="Function">∃</a> <a id="13556" class="Symbol">(</a><a id="13557" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="13561" href="SecureCompilation.Coherence.html#13449" class="Bound">Γ′</a><a id="13563" class="Symbol">))</a> <a id="13566" class="Symbol">→</a>
      <a id="13574" class="Comment">-- Hypotheses from [C-AuthControl], already in hypothesis `D≡A:D′`</a>
      <a id="13647" class="Keyword">let</a>
        <a id="13659" href="SecureCompilation.Coherence.html#13659" class="Bound">Γ→Γ′</a> <a id="13664" class="Symbol">:</a> <a id="13666" href="SecureCompilation.Coherence.html#12780" class="Bound">Γₜ</a> <a id="13669" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="13672" href="SecureCompilation.Coherence.html#13409" class="Bound">α</a> <a id="13674" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="13678" href="SecureCompilation.Coherence.html#13517" class="Bound">Γₜ′</a>
        <a id="13690" href="SecureCompilation.Coherence.html#13659" class="Bound">Γ→Γ′</a> <a id="13695" class="Symbol">=</a> <a id="13697" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="13706" class="Symbol">(</a><a id="13707" href="BitML.Semantics.InferenceRules.html#6832" class="InductiveConstructor">[C-AuthControl]</a> <a id="13723" href="SecureCompilation.Coherence.html#12823" class="Bound">D≡A:D′</a><a id="13729" class="Symbol">)</a> <a id="13731" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="13745" class="Comment">-- (iv) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="13804" class="Keyword">open</a> <a id="13809" href="SymbolicModel.Helpers.html#14109" class="Module">H₅</a> <a id="13812" class="Symbol">{</a><a id="13813" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="13815" class="Symbol">}</a> <a id="13817" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="13819" href="SecureCompilation.Coherence.html#12675" class="Bound">t</a> <a id="13821" href="SecureCompilation.Coherence.html#13409" class="Bound">α</a> <a id="13823" href="SecureCompilation.Coherence.html#13501" class="Bound">t′</a> <a id="13826" href="SecureCompilation.Coherence.html#12677" class="Bound">c′</a> <a id="13829" href="SecureCompilation.Coherence.html#12668" class="Bound">v</a> <a id="13831" href="SecureCompilation.Coherence.html#12670" class="Bound">x</a> <a id="13833" href="SecureCompilation.Coherence.html#12672" class="Bound">Γ₀</a> <a id="13836" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="13838" href="SecureCompilation.Coherence.html#12682" class="Bound">i</a> <a id="13840" href="SecureCompilation.Coherence.html#12919" class="Bound">cfg≈</a> <a id="13845" href="SecureCompilation.Coherence.html#13659" class="Bound">Γ→Γ′</a> <a id="13850" href="SecureCompilation.Coherence.html#13548" class="Bound">∃Γ≈</a>

        <a id="13863" class="Comment">-- (iii) broadcast transaction T, as obtained from the compiler, signed by A</a>
        <a id="13948" class="Comment">--       where ∙ (T′,o) = txout′(x)</a>
        <a id="13992" class="Comment">--             ∙ T is the first transaction in Bd(d,d,T′,o,v,partG,0)</a>
        <a id="14070" class="Comment">--       i.e. the one corresponding to subterm `d∗ = removeTopDecorations d`</a>
        <a id="14155" href="SecureCompilation.Coherence.html#14155" class="Bound">T</a> <a id="14157" class="Symbol">:</a> <a id="14159" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="14171" href="SecureCompilation.Coherence.html#14155" class="Bound">T</a> <a id="14173" class="Symbol">=</a>
          <a id="14185" class="Keyword">let</a> <a id="14189" class="Comment">-- invoke compiler</a>
            <a id="14220" href="SecureCompilation.Coherence.html#14220" class="Bound">K̂</a> <a id="14223" class="Symbol">:</a> <a id="14225" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="14227" href="SecureCompilation.Coherence.html#12615" class="Bound">G</a>
            <a id="14241" href="SecureCompilation.Coherence.html#14220" class="Bound">K̂</a> <a id="14244" class="Symbol">{</a><a id="14245" href="SecureCompilation.Coherence.html#14245" class="Bound">p</a><a id="14246" class="Symbol">}</a> <a id="14248" class="Symbol">_</a> <a id="14250" class="Symbol">=</a> <a id="14252" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="14255" href="SecureCompilation.Coherence.html#14245" class="Bound">p</a>

            <a id="14270" class="Keyword">open</a> <a id="14275" href="SymbolicModel.Helpers.html#14266" class="Module">H₅′</a> <a id="14279" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a> <a id="14284" href="SecureCompilation.Coherence.html#13049" class="Bound">ad∈</a> <a id="14288" href="SecureCompilation.Coherence.html#13242" class="Bound">names⊆</a>

            <a id="14308" class="Comment">-- retrieve transaction for specific subterm</a>
            <a id="14365" href="SecureCompilation.Coherence.html#14365" class="Bound">d∗∈</a> <a id="14369" class="Symbol">:</a> <a id="14371" href="SecureCompilation.Coherence.html#12714" class="Bound">d∗</a> <a id="14374" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="14376" href="BitML.Contracts.Helpers.html#15371" class="Function">subtermsᵃ⁺</a> <a id="14387" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a>
            <a id="14404" href="SecureCompilation.Coherence.html#14365" class="Bound">d∗∈</a> <a id="14408" class="Symbol">=</a> <a id="14410" href="BitML.Contracts.Helpers.html#15721" class="Function">h-subᶜ</a> <a id="14417" class="Symbol">{</a><a id="14418" class="Argument">ds</a> <a id="14421" class="Symbol">=</a> <a id="14423" href="SecureCompilation.Coherence.html#12619" class="Bound">C</a><a id="14424" class="Symbol">}</a> <a id="14426" href="SecureCompilation.Coherence.html#13074" class="Bound">d∈</a>

            <a id="14442" href="SecureCompilation.Coherence.html#14442" class="Bound">∃tx¹</a> <a id="14447" class="Symbol">=</a> <a id="14449" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="14455" class="Symbol">(</a><a id="14456" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="14471" class="Symbol">{</a><a id="14472" class="Argument">ad</a> <a id="14475" class="Symbol">=</a> <a id="14477" href="SecureCompilation.Coherence.html#12566" class="Bound">⟨G⟩C</a><a id="14481" class="Symbol">}</a> <a id="14483" href="SecureCompilation.Coherence.html#12589" class="Bound">vad</a> <a id="14487" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="14496" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="14503" href="SecureCompilation.Coherence.html#14220" class="Bound">K̂</a> <a id="14506" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a><a id="14508" class="Symbol">)</a> <a id="14510" href="SecureCompilation.Coherence.html#14365" class="Bound">d∗∈</a>
          <a id="14524" class="Keyword">in</a>
            <a id="14539" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="14542" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="14545" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="14551" href="SecureCompilation.Coherence.html#14442" class="Bound">∃tx¹</a>

        <a id="14565" href="SecureCompilation.Coherence.html#14565" class="Bound">λᶜ</a> <a id="14568" class="Symbol">=</a> <a id="14570" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="14572" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="14576" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="14578" href="SecureCompilation.Coherence.html#1353" class="Postulate">SIGᵖ</a> <a id="14583" class="Symbol">(</a><a id="14584" href="Bitcoin.Crypto.html#377" class="Field">pub</a> <a id="14588" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="14590" href="SymbolicModel.Collections.html#4072" class="Function">κ′</a> <a id="14593" href="SecureCompilation.Coherence.html#13049" class="Bound">ad∈</a> <a id="14597" href="SecureCompilation.Coherence.html#13074" class="Bound">d∈</a> <a id="14600" class="Symbol">{</a><a id="14601" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="14602" class="Symbol">}</a> <a id="14604" href="SecureCompilation.Coherence.html#13374" class="Bound">A∈</a><a id="14606" class="Symbol">)</a> <a id="14608" href="SecureCompilation.Coherence.html#14155" class="Bound">T</a> <a id="14610" href="Data.List.Base.html#5025" class="Function Operator">]</a>
      <a id="14618" class="Keyword">in</a>
      <a id="14627" class="Comment">-- (v) transaction T has been previously broadcasted in Rᶜ, and λᶜ is the first signature on T after that</a>
      <a id="14739" class="Symbol">(</a><a id="14740" href="SecureCompilation.Coherence.html#14740" class="Bound">∃λ</a> <a id="14743" class="Symbol">:</a> <a id="14745" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="14749" class="Symbol">(λ</a> <a id="14752" href="SecureCompilation.Coherence.html#14752" class="Bound">l</a> <a id="14754" class="Symbol">→</a> <a id="14756" href="Data.Product.html#1369" class="Function">∃</a> <a id="14758" class="Symbol">λ</a> <a id="14760" href="SecureCompilation.Coherence.html#14760" class="Bound">B</a> <a id="14762" class="Symbol">→</a> <a id="14764" href="SecureCompilation.Coherence.html#14752" class="Bound">l</a> <a id="14766" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14768" href="SecureCompilation.Coherence.html#14760" class="Bound">B</a> <a id="14770" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="14774" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="14776" href="SecureCompilation.Coherence.html#14155" class="Bound">T</a> <a id="14778" href="Bitcoin.Crypto.html#826" class="Field Operator">♯</a> <a id="14780" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="14781" class="Symbol">)</a> <a id="14783" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="14785" class="Symbol">)</a>
    <a id="14791" class="Symbol">→</a> <a id="14793" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="14797" class="Symbol">(λ</a> <a id="14800" href="SecureCompilation.Coherence.html#14800" class="Bound">l</a> <a id="14802" class="Symbol">→</a> <a id="14804" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="14806" href="Data.Product.html#1369" class="Function">∃</a> <a id="14808" class="Symbol">λ</a> <a id="14810" href="SecureCompilation.Coherence.html#14810" class="Bound">B</a> <a id="14812" class="Symbol">→</a> <a id="14814" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="14816" href="Data.Product.html#1369" class="Function">∃</a> <a id="14818" class="Symbol">λ</a> <a id="14820" href="SecureCompilation.Coherence.html#14820" class="Bound">k</a> <a id="14822" class="Symbol">→</a> <a id="14824" href="SecureCompilation.Coherence.html#14800" class="Bound">l</a> <a id="14826" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="14828" href="SecureCompilation.Coherence.html#14810" class="Bound">B</a> <a id="14830" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="14834" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="14836" href="SecureCompilation.Coherence.html#1353" class="Postulate">SIGᵖ</a> <a id="14841" href="SecureCompilation.Coherence.html#14820" class="Bound">k</a> <a id="14843" href="SecureCompilation.Coherence.html#14155" class="Bound">T</a> <a id="14845" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="14846" class="Symbol">)</a> <a id="14848" class="Symbol">(</a><a id="14849" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="14858" href="SecureCompilation.Coherence.html#14740" class="Bound">∃λ</a><a id="14860" class="Symbol">)</a>
      <a id="14868" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="14945" class="Symbol">→</a> <a id="14947" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="14955" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="14958" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="14960" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="14963" href="SecureCompilation.Coherence.html#14565" class="Bound">λᶜ</a> <a id="14966" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="14972" class="Comment">-- ** Contract actions: put</a>
  <a id="coher₁₁.[6]"></a><a id="15002" href="SecureCompilation.Coherence.html#15002" class="InductiveConstructor">[6]</a> <a id="15006" class="Symbol">:</a> <a id="15008" class="Symbol">∀</a> <a id="15010" class="Symbol">{</a><a id="15011" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a> <a id="15017" class="Symbol">:</a> <a id="15019" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="15032" class="Symbol">}</a> <a id="15034" class="Symbol">{</a><a id="15035" href="SecureCompilation.Coherence.html#15035" class="Bound">vad</a> <a id="15039" class="Symbol">:</a> <a id="15041" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="15047" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a><a id="15052" class="Symbol">}</a> <a id="15054" class="Symbol">→</a> <a id="15056" class="Keyword">let</a> <a id="15060" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="15062" href="SecureCompilation.Coherence.html#15062" class="Bound">G</a> <a id="15064" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="15066" href="SecureCompilation.Coherence.html#15066" class="Bound">C″</a> <a id="15069" class="Symbol">=</a> <a id="15071" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a><a id="15076" class="Symbol">;</a> <a id="15078" href="SecureCompilation.Coherence.html#15078" class="Bound">partG</a> <a id="15084" class="Symbol">=</a> <a id="15086" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="15103" href="SecureCompilation.Coherence.html#15062" class="Bound">G</a> <a id="15105" class="Keyword">in</a>
        <a id="15116" class="Comment">-- [T0D0] should we *derive* that ⟨G⟩C is valid??</a>
        <a id="15174" class="Symbol">∀</a> <a id="15176" class="Symbol">{</a><a id="15177" href="SecureCompilation.Coherence.html#15177" class="Bound">ds</a> <a id="15180" class="Symbol">:</a> <a id="15182" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="15187" class="Symbol">(</a><a id="15188" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="15200" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="15202" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="15210" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="15212" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="15214" class="Symbol">)}</a> <a id="15217" class="Symbol">{</a><a id="15218" href="SecureCompilation.Coherence.html#15218" class="Bound">ss</a> <a id="15221" class="Symbol">:</a> <a id="15223" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="15228" class="Symbol">(</a><a id="15229" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="15241" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="15243" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="15250" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="15252" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="15253" class="Symbol">)}</a>
          <a id="15266" class="Symbol">{</a><a id="15267" href="SecureCompilation.Coherence.html#15267" class="Bound">i</a> <a id="15269" class="Symbol">:</a> <a id="15271" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="15277" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a><a id="15278" class="Symbol">}</a> <a id="15280" class="Symbol">→</a> <a id="15282" class="Keyword">let</a> <a id="15286" href="SecureCompilation.Coherence.html#15286" class="Bound">d</a> <a id="15288" class="Symbol">=</a> <a id="15290" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="15292" href="Prelude.Lists.html#1259" class="Function Operator">‼</a> <a id="15294" href="SecureCompilation.Coherence.html#15267" class="Bound">i</a><a id="15295" class="Symbol">;</a> <a id="15297" href="SecureCompilation.Coherence.html#15297" class="Bound">d∗</a> <a id="15300" class="Symbol">=</a> <a id="15302" href="BitML.Contracts.Helpers.html#12737" class="Function">removeTopDecorations</a> <a id="15323" href="SecureCompilation.Coherence.html#15286" class="Bound">d</a><a id="15324" class="Symbol">;</a> <a id="15326" href="SecureCompilation.Coherence.html#15326" class="Bound">As</a> <a id="15329" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15331" href="SecureCompilation.Coherence.html#15331" class="Bound">ts</a> <a id="15334" class="Symbol">=</a> <a id="15336" href="BitML.Contracts.Helpers.html#12472" class="Function">decorations</a> <a id="15348" href="SecureCompilation.Coherence.html#15286" class="Bound">d</a> <a id="15350" class="Keyword">in</a>

      <a id="15360" class="Keyword">let</a>
        <a id="15372" class="Comment">-- (i) xs = x₁⋯xₖ</a>
        <a id="15398" class="Symbol">(_</a> <a id="15401" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15403" href="SecureCompilation.Coherence.html#15403" class="Bound">vs</a> <a id="15406" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15408" href="SecureCompilation.Coherence.html#15408" class="Bound">xs</a><a id="15410" class="Symbol">)</a> <a id="15412" class="Symbol">=</a> <a id="15414" href="Prelude.Lists.html#9130" class="Function">unzip₃</a> <a id="15421" href="SecureCompilation.Coherence.html#15177" class="Bound">ds</a>
        <a id="15432" class="Symbol">(_</a> <a id="15435" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15437" href="SecureCompilation.Coherence.html#15437" class="Bound">as</a> <a id="15440" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15442" class="Symbol">_)</a>  <a id="15446" class="Symbol">=</a> <a id="15448" href="Prelude.Lists.html#9130" class="Function">unzip₃</a> <a id="15455" href="SecureCompilation.Coherence.html#15218" class="Bound">ss</a>
        <a id="15466" href="SecureCompilation.Coherence.html#15466" class="Bound">Γ₁</a> <a id="15469" class="Symbol">=</a> <a id="15471" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="15474" href="Data.List.Base.html#1544" class="Function">map</a> <a id="15478" class="Symbol">(λ{</a> <a id="15482" class="Symbol">(</a><a id="15483" href="SecureCompilation.Coherence.html#15483" class="Bound">Aᵢ</a> <a id="15486" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15488" href="SecureCompilation.Coherence.html#15488" class="Bound">vᵢ</a> <a id="15491" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15493" href="SecureCompilation.Coherence.html#15493" class="Bound">xᵢ</a><a id="15495" class="Symbol">)</a> <a id="15497" class="Symbol">→</a> <a id="15499" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="15501" href="SecureCompilation.Coherence.html#15483" class="Bound">Aᵢ</a> <a id="15504" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="15508" href="SecureCompilation.Coherence.html#15488" class="Bound">vᵢ</a> <a id="15511" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="15515" href="SecureCompilation.Coherence.html#15493" class="Bound">xᵢ</a> <a id="15518" class="Symbol">})</a> <a id="15521" href="SecureCompilation.Coherence.html#15177" class="Bound">ds</a>
        <a id="15532" href="SecureCompilation.Coherence.html#15532" class="Bound">Δ</a>  <a id="15535" class="Symbol">=</a> <a id="15537" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="15540" href="Data.List.Base.html#1544" class="Function">map</a> <a id="15544" class="Symbol">(λ{</a> <a id="15548" class="Symbol">(</a><a id="15549" href="SecureCompilation.Coherence.html#15549" class="Bound">Bi</a> <a id="15552" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15554" href="SecureCompilation.Coherence.html#15554" class="Bound">ai</a> <a id="15557" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="15559" href="SecureCompilation.Coherence.html#15559" class="Bound">Ni</a><a id="15561" class="Symbol">)</a> <a id="15563" class="Symbol">→</a> <a id="15565" href="SecureCompilation.Coherence.html#15549" class="Bound">Bi</a> <a id="15568" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">∶</a> <a id="15570" href="SecureCompilation.Coherence.html#15554" class="Bound">ai</a> <a id="15573" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">♯</a> <a id="15575" href="SecureCompilation.Coherence.html#15559" class="Bound">Ni</a>       <a id="15584" class="Symbol">})</a> <a id="15587" href="SecureCompilation.Coherence.html#15218" class="Bound">ss</a>
        <a id="15598" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a> <a id="15601" class="Symbol">=</a> <a id="15603" href="SecureCompilation.Coherence.html#15532" class="Bound">Δ</a> <a id="15605" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="15607" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="15618" href="SecureCompilation.Coherence.html#15618" class="Bound">Γ</a>  <a id="15621" class="Symbol">=</a> <a id="15623" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="15625" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="15627" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="15629" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="15631" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="15635" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="15637" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="15639" class="Symbol">(</a><a id="15640" href="SecureCompilation.Coherence.html#15466" class="Bound">Γ₁</a> <a id="15643" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="15645" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a><a id="15647" class="Symbol">)</a>
        <a id="15657" href="SecureCompilation.Coherence.html#15657" class="Bound">Γₜ</a> <a id="15660" class="Symbol">=</a> <a id="15662" href="SecureCompilation.Coherence.html#15618" class="Bound">Γ</a> <a id="15664" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="15667" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
      <a id="15675" class="Keyword">in</a>
      <a id="15684" class="Comment">-- ii) in Rˢ, α consumes ⟨D+C,v⟩y and the deposits ⟨Aᵢ,vᵢ⟩ₓᵢ to produce ⟨C′,v′⟩y′</a>
      <a id="15772" class="Comment">--     where D = ⋯ : put⋯reveal⋯.C′</a>
      <a id="15814" class="Comment">--     let t be the maximum deadline in an after in front of D</a>
      <a id="15883" class="Comment">--     T0D0: what should t′ be in case there are not after decorations?</a>
      <a id="15961" class="Symbol">(</a><a id="15962" href="SecureCompilation.Coherence.html#15962" class="Bound">d≡</a> <a id="15965" class="Symbol">:</a> <a id="15967" href="SecureCompilation.Coherence.html#15286" class="Bound">d</a> <a id="15969" href="BitML.Contracts.Helpers.html#12954" class="Function Operator">≡⋯∶</a> <a id="15973" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">put</a> <a id="15977" href="SecureCompilation.Coherence.html#15408" class="Bound">xs</a> <a id="15980" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">&amp;reveal</a> <a id="15988" href="SecureCompilation.Coherence.html#15437" class="Bound">as</a> <a id="15991" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">if</a> <a id="15994" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="15996" href="BitML.Contracts.Types.html#769" class="InductiveConstructor Operator">⇒</a> <a id="15998" href="BitML.Contracts.Types.html#1353" class="Generalizable">c′</a><a id="16000" class="Symbol">)</a>
    <a id="16006" class="Symbol">→</a> <a id="16008" class="Symbol">(</a><a id="16009" href="SecureCompilation.Coherence.html#16009" class="Bound">cfg≈</a> <a id="16014" class="Symbol">:</a> <a id="16016" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="16019" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="16022" href="SecureCompilation.Coherence.html#15657" class="Bound">Γₜ</a><a id="16024" class="Symbol">)</a>

      <a id="16033" class="Comment">-- (iii) {G}C″ is the ancestor of ⟨D+C,v⟩y in Rˢ</a>
    <a id="16086" class="Symbol">→</a> <a id="16088" class="Symbol">(</a><a id="16089" href="SecureCompilation.Coherence.html#16089" class="Bound">anc</a> <a id="16093" class="Symbol">:</a> <a id="16095" href="SymbolicModel.Collections.html#1540" class="Function">Ancestor</a> <a id="16104" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="16107" class="Symbol">(</a><a id="16108" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="16110" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16112" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="16114" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16116" href="BitML.BasicTypes.html#484" class="Generalizable">y</a><a id="16117" class="Symbol">)</a> <a id="16119" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a><a id="16124" class="Symbol">)</a>
    <a id="16130" class="Symbol">→</a> <a id="16132" class="Keyword">let</a>
        <a id="16144" href="SecureCompilation.Coherence.html#16144" class="Bound">d⊆</a> <a id="16147" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16149" href="SecureCompilation.Coherence.html#16149" class="Bound">ad∈</a> <a id="16153" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="16155" class="Symbol">_</a> <a id="16157" class="Symbol">=</a> <a id="16159" href="SecureCompilation.Coherence.html#16089" class="Bound">anc</a>

        <a id="16172" href="SecureCompilation.Coherence.html#16172" class="Bound">d∈</a> <a id="16175" class="Symbol">:</a> <a id="16177" href="SecureCompilation.Coherence.html#15286" class="Bound">d</a> <a id="16179" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="16181" href="BitML.Contracts.Helpers.html#14958" class="Function">subtermsᶜ′</a> <a id="16192" href="SecureCompilation.Coherence.html#15066" class="Bound">C″</a>
        <a id="16203" href="SecureCompilation.Coherence.html#16172" class="Bound">d∈</a> <a id="16206" class="Symbol">=</a> <a id="16208" href="SecureCompilation.Coherence.html#16144" class="Bound">d⊆</a> <a id="16211" class="Symbol">(</a><a id="16212" href="Data.List.Membership.Propositional.Properties.html#11093" class="Function">∈-lookup</a> <a id="16221" href="SecureCompilation.Coherence.html#15267" class="Bound">i</a><a id="16222" class="Symbol">)</a>
      <a id="16230" class="Keyword">in</a>
      <a id="16239" class="Comment">-- hypotheses from [C-PutRev]</a>
      <a id="16275" class="Symbol">(</a><a id="16276" href="SecureCompilation.Coherence.html#16276" class="Bound">p⟦Δ⟧≡</a> <a id="16282" class="Symbol">:</a> <a id="16284" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">S.⟦</a> <a id="16288" href="BitML.Predicate.html#949" class="Generalizable">p</a> <a id="16290" href="BitML.Semantics.Predicate.html#1129" class="Function Operator">⟧</a> <a id="16292" href="SecureCompilation.Coherence.html#15532" class="Bound">Δ</a> <a id="16294" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16296" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="16301" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="16305" class="Symbol">)</a>
      <a id="16313" class="Comment">-- hypotheses from [Timeout]</a>
      <a id="16348" class="Symbol">(</a><a id="16349" href="SecureCompilation.Coherence.html#16349" class="Bound">As≡∅</a> <a id="16354" class="Symbol">:</a> <a id="16356" href="SecureCompilation.Coherence.html#15326" class="Bound">As</a> <a id="16359" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16361" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="16363" class="Symbol">)</a>
      <a id="16371" class="Comment">-- (∀≤t : All (_≤ t) ts)</a>
      <a id="16402" class="Symbol">(</a><a id="16403" href="SecureCompilation.Coherence.html#16403" class="Bound">t≡</a> <a id="16406" class="Symbol">:</a> <a id="16408" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="16410" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="16412" href="Prelude.Ord.html#721" class="Function">maximum</a> <a id="16420" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="16422" href="SecureCompilation.Coherence.html#15331" class="Bound">ts</a><a id="16424" class="Symbol">)</a>
      <a id="16432" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="16512" class="Comment">--   ∙  ...</a>
      <a id="16530" class="Symbol">(</a><a id="16531" href="SecureCompilation.Coherence.html#16531" class="Bound">names⊆</a> <a id="16538" class="Symbol">:</a> <a id="16540" href="SecureCompilation.Coherence.html#15062" class="Bound">G</a> <a id="16542" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="16553" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a><a id="16555" class="Symbol">)</a> <a id="16557" class="Symbol">→</a>
      <a id="16565" class="Keyword">let</a>
        <a id="16577" href="SecureCompilation.Coherence.html#16577" class="Bound">α</a>   <a id="16581" class="Symbol">=</a> <a id="16583" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">put⦅</a> <a id="16588" href="SecureCompilation.Coherence.html#15408" class="Bound">xs</a> <a id="16591" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">,</a> <a id="16593" href="SecureCompilation.Coherence.html#15437" class="Bound">as</a> <a id="16596" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">,</a> <a id="16598" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="16600" href="BitML.Semantics.Label.html#1433" class="InductiveConstructor Operator">⦆</a>
        <a id="16610" href="SecureCompilation.Coherence.html#16610" class="Bound">Γ′</a>  <a id="16614" class="Symbol">=</a> <a id="16616" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="16618" href="BitML.Contracts.Types.html#1353" class="Generalizable">c′</a> <a id="16621" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="16623" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="16625" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="16627" href="Data.List.Base.html#4784" class="Function">sum</a> <a id="16631" href="SecureCompilation.Coherence.html#15403" class="Bound">vs</a> <a id="16634" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="16638" href="BitML.BasicTypes.html#491" class="Generalizable">y′</a> <a id="16641" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="16643" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a>
        <a id="16654" href="SecureCompilation.Coherence.html#16654" class="Bound">t′</a>  <a id="16658" class="Symbol">=</a> <a id="16660" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="16670" href="SecureCompilation.Coherence.html#16670" class="Bound">Γₜ′</a> <a id="16674" class="Symbol">=</a> <a id="16676" href="SecureCompilation.Coherence.html#16610" class="Bound">Γ′</a> <a id="16679" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="16682" href="SecureCompilation.Coherence.html#16654" class="Bound">t′</a>
      <a id="16691" class="Keyword">in</a>
      <a id="16700" class="Symbol">(</a><a id="16701" href="SecureCompilation.Coherence.html#16701" class="Bound">∃Γ≈</a> <a id="16705" class="Symbol">:</a> <a id="16707" href="Data.Product.html#1369" class="Function">∃</a> <a id="16709" class="Symbol">(</a><a id="16710" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="16714" href="SecureCompilation.Coherence.html#16610" class="Bound">Γ′</a><a id="16716" class="Symbol">))</a> <a id="16719" class="Symbol">→</a>
      <a id="16727" class="Keyword">let</a>
        <a id="16739" href="SecureCompilation.Coherence.html#16739" class="Bound">∀≤t</a> <a id="16743" class="Symbol">:</a> <a id="16745" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16749" class="Symbol">(</a><a id="16750" href="Prelude.Ord.html#214" class="Field Operator">_≤</a> <a id="16753" href="SecureCompilation.Coherence.html#16654" class="Bound">t′</a><a id="16755" class="Symbol">)</a> <a id="16757" href="SecureCompilation.Coherence.html#15331" class="Bound">ts</a>
        <a id="16768" href="SecureCompilation.Coherence.html#16739" class="Bound">∀≤t</a> <a id="16772" class="Symbol">=</a> <a id="16774" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="16776" class="Symbol">(λ</a> <a id="16779" href="SecureCompilation.Coherence.html#16779" class="Bound">◆</a> <a id="16781" class="Symbol">→</a> <a id="16783" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="16787" class="Symbol">(</a><a id="16788" href="Prelude.Ord.html#214" class="Field Operator">_≤</a> <a id="16791" href="SecureCompilation.Coherence.html#16779" class="Bound">◆</a><a id="16792" class="Symbol">)</a> <a id="16794" href="SecureCompilation.Coherence.html#15331" class="Bound">ts</a><a id="16796" class="Symbol">)</a> <a id="16798" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="16800" href="SecureCompilation.Coherence.html#16403" class="Bound">t≡</a> <a id="16803" href="Prelude.General.html#1195" class="Function">~:</a> <a id="16806" href="Prelude.Ord.html#3184" class="Postulate">∀≤max</a> <a id="16812" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="16814" href="SecureCompilation.Coherence.html#15331" class="Bound">ts</a>

        <a id="16826" href="SecureCompilation.Coherence.html#16826" class="Bound">Γ→Γ′</a> <a id="16831" class="Symbol">:</a> <a id="16833" href="SecureCompilation.Coherence.html#15657" class="Bound">Γₜ</a> <a id="16836" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="16839" href="SecureCompilation.Coherence.html#16577" class="Bound">α</a> <a id="16841" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="16845" href="SecureCompilation.Coherence.html#16670" class="Bound">Γₜ′</a>
        <a id="16857" href="SecureCompilation.Coherence.html#16826" class="Bound">Γ→Γ′</a> <a id="16862" class="Symbol">=</a> <a id="16864" href="BitML.Semantics.InferenceRules.html#8701" class="InductiveConstructor">[Timeout]</a> <a id="16874" href="SecureCompilation.Coherence.html#16349" class="Bound">As≡∅</a> <a id="16879" href="SecureCompilation.Coherence.html#16739" class="Bound">∀≤t</a>
                 <a id="16900" class="Symbol">(</a><a id="16901" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="16903" class="Symbol">(λ</a> <a id="16906" href="SecureCompilation.Coherence.html#16906" class="Bound">◆</a> <a id="16908" class="Symbol">→</a> <a id="16910" class="Symbol">(</a><a id="16911" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="16913" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="16915" href="SecureCompilation.Coherence.html#16906" class="Bound">◆</a> <a id="16917" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="16919" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="16921" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="16923" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="16927" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="16929" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="16931" class="Symbol">(</a><a id="16932" href="SecureCompilation.Coherence.html#15466" class="Bound">Γ₁</a> <a id="16935" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="16937" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a><a id="16939" class="Symbol">)</a> <a id="16941" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">—[</a> <a id="16944" href="SecureCompilation.Coherence.html#16577" class="Bound">α</a> <a id="16946" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">]→</a> <a id="16949" href="SecureCompilation.Coherence.html#16610" class="Bound">Γ′</a><a id="16951" class="Symbol">))</a> <a id="16954" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="16956" href="SecureCompilation.Coherence.html#15962" class="Bound">d≡</a> <a id="16959" href="Prelude.General.html#1195" class="Function">~:</a> <a id="16962" href="BitML.Semantics.InferenceRules.html#6079" class="InductiveConstructor">[C-PutRev]</a> <a id="16973" class="Symbol">{</a><a id="16974" class="Argument">ds</a> <a id="16977" class="Symbol">=</a> <a id="16979" href="SecureCompilation.Coherence.html#15177" class="Bound">ds</a><a id="16981" class="Symbol">}</a> <a id="16983" class="Symbol">{</a><a id="16984" class="Argument">ss</a> <a id="16987" class="Symbol">=</a> <a id="16989" href="SecureCompilation.Coherence.html#15218" class="Bound">ss</a><a id="16991" class="Symbol">}</a> <a id="16993" href="SecureCompilation.Coherence.html#16276" class="Bound">p⟦Δ⟧≡</a><a id="16998" class="Symbol">)</a> <a id="17000" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="17014" class="Keyword">open</a> <a id="17019" href="SymbolicModel.Helpers.html#15002" class="Module">H₆</a> <a id="17022" class="Symbol">{</a><a id="17023" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="17025" class="Symbol">}</a> <a id="17027" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="17029" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="17031" href="SecureCompilation.Coherence.html#16577" class="Bound">α</a> <a id="17033" href="SecureCompilation.Coherence.html#16654" class="Bound">t′</a> <a id="17036" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="17038" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="17040" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="17042" href="SecureCompilation.Coherence.html#15177" class="Bound">ds</a> <a id="17045" href="SecureCompilation.Coherence.html#15598" class="Bound">Γ₂</a> <a id="17048" href="BitML.Contracts.Types.html#1353" class="Generalizable">c′</a> <a id="17051" href="BitML.BasicTypes.html#491" class="Generalizable">y′</a> <a id="17054" href="SecureCompilation.Coherence.html#16009" class="Bound">cfg≈</a> <a id="17059" href="SecureCompilation.Coherence.html#16826" class="Bound">Γ→Γ′</a> <a id="17064" href="SecureCompilation.Coherence.html#16701" class="Bound">∃Γ≈</a>

        <a id="17077" class="Comment">-- (iv) submit transaction T</a>
        <a id="17114" class="Comment">--      where ∙ (T′,o) = txout′(y)</a>
        <a id="17157" class="Comment">--            ∙ T is the first transaction in Bc(c′,d,T′,o,v′,x⃗,partG,t)</a>
        <a id="17239" class="Comment">--      i.e. the one corresponding to subterm `d∗ = put xs &amp;reveal as if p → c′`</a>
        <a id="17328" href="SecureCompilation.Coherence.html#17328" class="Bound">T</a> <a id="17330" class="Symbol">:</a> <a id="17332" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="17344" href="SecureCompilation.Coherence.html#17328" class="Bound">T</a> <a id="17346" class="Symbol">=</a>
          <a id="17358" class="Keyword">let</a> <a id="17362" class="Comment">-- invoke compiler</a>
            <a id="17393" href="SecureCompilation.Coherence.html#17393" class="Bound">K</a> <a id="17395" class="Symbol">:</a> <a id="17397" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="17399" href="SecureCompilation.Coherence.html#15062" class="Bound">G</a>
            <a id="17413" href="SecureCompilation.Coherence.html#17393" class="Bound">K</a> <a id="17415" class="Symbol">{</a><a id="17416" href="SecureCompilation.Coherence.html#17416" class="Bound">p</a><a id="17417" class="Symbol">}</a> <a id="17419" class="Symbol">_</a> <a id="17421" class="Symbol">=</a> <a id="17423" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="17426" href="SecureCompilation.Coherence.html#17416" class="Bound">p</a>

            <a id="17441" class="Keyword">open</a> <a id="17446" href="SymbolicModel.Helpers.html#17083" class="Module">H₆″</a> <a id="17450" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a> <a id="17456" href="SecureCompilation.Coherence.html#16149" class="Bound">ad∈</a> <a id="17460" href="SecureCompilation.Coherence.html#16531" class="Bound">names⊆</a>

            <a id="17480" class="Comment">-- retrieve transaction for specific subterm</a>
            <a id="17537" href="SecureCompilation.Coherence.html#17537" class="Bound">d∗∈</a> <a id="17541" class="Symbol">:</a> <a id="17543" href="SecureCompilation.Coherence.html#15297" class="Bound">d∗</a> <a id="17546" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="17548" href="BitML.Contracts.Helpers.html#14969" class="Function">subtermsᶜ⁺</a> <a id="17559" href="SecureCompilation.Coherence.html#15066" class="Bound">C″</a>
            <a id="17574" href="SecureCompilation.Coherence.html#17537" class="Bound">d∗∈</a> <a id="17578" class="Symbol">=</a> <a id="17580" href="BitML.Contracts.Helpers.html#15721" class="Function">h-subᶜ</a> <a id="17587" class="Symbol">{</a><a id="17588" class="Argument">ds</a> <a id="17591" class="Symbol">=</a> <a id="17593" href="SecureCompilation.Coherence.html#15066" class="Bound">C″</a><a id="17595" class="Symbol">}</a> <a id="17597" href="SecureCompilation.Coherence.html#16172" class="Bound">d∈</a>

            <a id="17613" href="SecureCompilation.Coherence.html#17613" class="Bound">∃tx</a> <a id="17617" class="Symbol">:</a> <a id="17619" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="17624" href="SecureCompilation.Coherence.html#15297" class="Bound">d∗</a>
            <a id="17639" href="SecureCompilation.Coherence.html#17613" class="Bound">∃tx</a> <a id="17643" class="Symbol">=</a> <a id="17645" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="17651" class="Symbol">(</a><a id="17652" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="17667" class="Symbol">{</a><a id="17668" class="Argument">ad</a> <a id="17671" class="Symbol">=</a> <a id="17673" href="SecureCompilation.Coherence.html#15011" class="Bound">⟨G⟩C″</a><a id="17678" class="Symbol">}</a> <a id="17680" href="SecureCompilation.Coherence.html#15035" class="Bound">vad</a> <a id="17684" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="17693" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="17700" href="SecureCompilation.Coherence.html#17393" class="Bound">K</a> <a id="17702" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a><a id="17704" class="Symbol">)</a> <a id="17706" href="SecureCompilation.Coherence.html#17537" class="Bound">d∗∈</a>

            <a id="17723" href="SecureCompilation.Coherence.html#17723" class="Bound">∃tx¹</a> <a id="17728" class="Symbol">:</a> <a id="17730" href="SecureCompilation.Compiler.html#1804" class="Function">∃Tx¹</a>
            <a id="17747" href="SecureCompilation.Coherence.html#17723" class="Bound">∃tx¹</a> <a id="17752" class="Symbol">=</a> <a id="17754" href="SecureCompilation.Coherence.html#17613" class="Bound">∃tx</a> <a id="17758" href="Prelude.General.html#871" class="Function">:~</a> <a id="17761" href="SecureCompilation.Coherence.html#15962" class="Bound">d≡</a> <a id="17764" href="Prelude.General.html#871" class="Function">⟪</a> <a id="17766" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="17771" href="Prelude.General.html#871" class="Function">⟫</a>
          <a id="17783" class="Keyword">in</a>
            <a id="17798" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="17801" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="17804" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="17810" href="SecureCompilation.Coherence.html#17723" class="Bound">∃tx¹</a>

        <a id="17824" href="SecureCompilation.Coherence.html#17824" class="Bound">λᶜ</a> <a id="17827" class="Symbol">=</a> <a id="17829" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="17836" href="SecureCompilation.Coherence.html#17328" class="Bound">T</a>

        <a id="17847" class="Comment">-- (v) extend txout′ with {y′↦(T,0)}, sechash = sechash′, κ = κ′</a>
        <a id="17920" class="Keyword">open</a> <a id="17925" href="SymbolicModel.Helpers.html#16684" class="Module">H₆′</a> <a id="17929" class="Symbol">(</a><a id="17930" href="SecureCompilation.Coherence.html#17328" class="Bound">T</a> <a id="17932" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="17935" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="17937" class="Symbol">)</a>
      <a id="17945" class="Keyword">in</a>
      <a id="17954" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="18033" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="18041" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="18044" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="18046" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="18049" href="SecureCompilation.Coherence.html#17824" class="Bound">λᶜ</a> <a id="18052" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="18058" class="Comment">-- ** Contract actions: authorize reveal</a>
  <a id="coher₁₁.[7]"></a><a id="18101" href="SecureCompilation.Coherence.html#18101" class="InductiveConstructor">[7]</a> <a id="18105" class="Symbol">:</a> <a id="18107" class="Symbol">∀</a> <a id="18109" class="Symbol">{</a><a id="18110" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a><a id="18112" class="Symbol">}</a> <a id="18114" class="Symbol">{</a><a id="18115" href="SecureCompilation.Coherence.html#18115" class="Bound">𝕣</a> <a id="18117" class="Symbol">:</a> <a id="18119" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="18121" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a><a id="18123" class="Symbol">}</a> <a id="18125" class="Symbol">→</a> <a id="18127" class="Keyword">let</a> <a id="18131" class="Keyword">open</a> <a id="18136" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="18138" href="SecureCompilation.Coherence.html#18115" class="Bound">𝕣</a> <a id="18140" class="Keyword">in</a>
      <a id="18149" class="Symbol">∀</a> <a id="18151" class="Symbol">{</a><a id="18152" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18154" href="SecureCompilation.Coherence.html#18154" class="Bound">n</a><a id="18155" class="Symbol">}</a> <a id="18157" class="Symbol">→</a> <a id="18159" class="Keyword">let</a> <a id="18163" href="SecureCompilation.Coherence.html#18163" class="Bound">Γ</a> <a id="18165" class="Symbol">=</a> <a id="18167" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟨</a> <a id="18169" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="18171" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">∶</a> <a id="18173" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18175" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">♯</a> <a id="18177" href="Data.Maybe.Base.html#892" class="InductiveConstructor">just</a> <a id="18182" href="SecureCompilation.Coherence.html#18154" class="Bound">n</a> <a id="18184" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟩</a> <a id="18186" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="18188" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="18190" class="Symbol">;</a> <a id="18192" href="SecureCompilation.Coherence.html#18192" class="Bound">Γₜ</a> <a id="18195" class="Symbol">=</a> <a id="18197" href="SecureCompilation.Coherence.html#18163" class="Bound">Γ</a> <a id="18199" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="18202" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="18204" class="Keyword">in</a>
      <a id="18213" class="Symbol">∀</a> <a id="18215" class="Symbol">{</a><a id="18216" href="SecureCompilation.Coherence.html#18216" class="Bound">Δ×h̅</a> <a id="18221" class="Symbol">:</a> <a id="18223" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="18228" class="Symbol">(</a><a id="18229" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="18236" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="18238" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="18244" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="18246" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="18248" href="Agda.Builtin.Int.html#246" class="Datatype">ℤ</a><a id="18249" class="Symbol">)}</a> <a id="18252" class="Symbol">{</a><a id="18253" href="SecureCompilation.Coherence.html#18253" class="Bound">k⃗</a> <a id="18256" class="Symbol">:</a> <a id="18258" href="SymbolicModel.Collections.html#3602" class="Function">𝕂²′</a> <a id="18262" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a><a id="18266" class="Symbol">}</a> <a id="18268" class="Symbol">→</a> <a id="18270" class="Keyword">let</a> <a id="18274" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="18276" href="SecureCompilation.Coherence.html#18276" class="Bound">G</a> <a id="18278" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="18280" href="SecureCompilation.Coherence.html#18280" class="Bound">C</a> <a id="18282" class="Symbol">=</a> <a id="18284" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="18289" class="Keyword">in</a>

      <a id="18299" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣</a> <a id="18301" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a> <a id="18303" href="SecureCompilation.Coherence.html#1419" class="Postulate Operator">∣ᵐ</a> <a id="18306" href="Prelude.Ord.html#214" class="Field Operator">≤</a> <a id="18308" href="SecureCompilation.Coherence.html#659" class="Bound">η</a>
    <a id="18314" class="Symbol">→</a> <a id="18316" class="Symbol">(</a><a id="18317" href="SecureCompilation.Coherence.html#18317" class="Bound">cfg≈</a> <a id="18322" class="Symbol">:</a> <a id="18324" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a> <a id="18327" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="18330" href="SecureCompilation.Coherence.html#18192" class="Bound">Γₜ</a><a id="18332" class="Symbol">)</a>

    <a id="18339" class="Symbol">→</a> <a id="18341" class="Keyword">let</a>
        <a id="18353" href="SecureCompilation.Coherence.html#18353" class="Bound">α</a>   <a id="18357" class="Symbol">=</a> <a id="18359" href="BitML.Semantics.Label.html#1379" class="InductiveConstructor Operator">auth-rev⦅</a> <a id="18369" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="18371" href="BitML.Semantics.Label.html#1379" class="InductiveConstructor Operator">,</a> <a id="18373" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18375" href="BitML.Semantics.Label.html#1379" class="InductiveConstructor Operator">⦆</a>
        <a id="18385" href="SecureCompilation.Coherence.html#18385" class="Bound">Γ′</a>  <a id="18389" class="Symbol">=</a> <a id="18391" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="18393" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">∶</a> <a id="18395" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18397" href="BitML.Semantics.Configurations.Types.html#1237" class="InductiveConstructor Operator">♯</a> <a id="18399" href="SecureCompilation.Coherence.html#18154" class="Bound">n</a> <a id="18401" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="18403" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="18414" href="SecureCompilation.Coherence.html#18414" class="Bound">t′</a>  <a id="18418" class="Symbol">=</a> <a id="18420" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="18430" href="SecureCompilation.Coherence.html#18430" class="Bound">Γₜ′</a> <a id="18434" class="Symbol">=</a> <a id="18436" href="SecureCompilation.Coherence.html#18385" class="Bound">Γ′</a> <a id="18439" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="18442" href="SecureCompilation.Coherence.html#18414" class="Bound">t′</a>
      <a id="18451" class="Keyword">in</a>
      <a id="18460" class="Symbol">(</a><a id="18461" href="SecureCompilation.Coherence.html#18461" class="Bound">∃Γ≈</a> <a id="18465" class="Symbol">:</a> <a id="18467" href="Data.Product.html#1369" class="Function">∃</a> <a id="18469" class="Symbol">(</a><a id="18470" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="18474" href="SecureCompilation.Coherence.html#18385" class="Bound">Γ′</a><a id="18476" class="Symbol">))</a> <a id="18479" class="Symbol">→</a>
      <a id="18487" class="Keyword">let</a>
        <a id="18499" href="SecureCompilation.Coherence.html#18499" class="Bound">Γ→Γ′</a> <a id="18504" class="Symbol">:</a> <a id="18506" href="SecureCompilation.Coherence.html#18192" class="Bound">Γₜ</a> <a id="18509" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="18512" href="SecureCompilation.Coherence.html#18353" class="Bound">α</a> <a id="18514" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="18518" href="SecureCompilation.Coherence.html#18430" class="Bound">Γₜ′</a>
        <a id="18530" href="SecureCompilation.Coherence.html#18499" class="Bound">Γ→Γ′</a> <a id="18535" class="Symbol">=</a> <a id="18537" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="18546" href="BitML.Semantics.InferenceRules.html#5900" class="InductiveConstructor">[C-AuthRev]</a> <a id="18558" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="18572" href="SecureCompilation.Coherence.html#18572" class="Bound">C</a> <a id="18574" class="Symbol">:</a> <a id="18576" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="18592" href="SecureCompilation.Coherence.html#18572" class="Bound">C</a> <a id="18594" class="Symbol">=</a> <a id="18596" href="SecureCompilation.Coherence.html#1233" class="Postulate">encode</a> <a id="18603" class="Symbol">{</a><a id="18604" class="Argument">Rˢ</a> <a id="18607" class="Symbol">=</a> <a id="18609" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a><a id="18611" class="Symbol">}</a> <a id="18613" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="18620" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a>

        <a id="18634" href="SecureCompilation.Coherence.html#18634" class="Bound">Δ</a> <a id="18636" class="Symbol">:</a> <a id="18638" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="18643" class="Symbol">(</a><a id="18644" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="18651" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="18653" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="18659" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="18660" class="Symbol">)</a>
        <a id="18670" href="SecureCompilation.Coherence.html#18634" class="Bound">Δ</a> <a id="18672" class="Symbol">=</a> <a id="18674" href="Data.List.Base.html#1544" class="Function">map</a> <a id="18678" class="Symbol">(λ{</a> <a id="18682" class="Symbol">(</a><a id="18683" href="SecureCompilation.Coherence.html#18683" class="Bound">s</a> <a id="18685" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18687" href="SecureCompilation.Coherence.html#18687" class="Bound">mn</a> <a id="18690" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18692" class="Symbol">_)</a> <a id="18695" class="Symbol">→</a> <a id="18697" href="SecureCompilation.Coherence.html#18683" class="Bound">s</a> <a id="18699" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="18701" href="SecureCompilation.Coherence.html#18687" class="Bound">mn</a> <a id="18704" class="Symbol">})</a> <a id="18707" href="SecureCompilation.Coherence.html#18216" class="Bound">Δ×h̅</a>

        <a id="18721" href="SecureCompilation.Coherence.html#18721" class="Bound">h̅</a> <a id="18724" class="Symbol">:</a> <a id="18726" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="18742" href="SecureCompilation.Coherence.html#18721" class="Bound">h̅</a> <a id="18745" class="Symbol">=</a> <a id="18747" href="Data.List.Base.html#1544" class="Function">map</a> <a id="18751" class="Symbol">(</a><a id="18752" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="18758" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18760" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="18765" class="Symbol">)</a> <a id="18767" href="SecureCompilation.Coherence.html#18216" class="Bound">Δ×h̅</a>

        <a id="18781" href="SecureCompilation.Coherence.html#18781" class="Bound">k̅</a> <a id="18784" class="Symbol">:</a> <a id="18786" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="18802" href="SecureCompilation.Coherence.html#18781" class="Bound">k̅</a> <a id="18805" class="Symbol">=</a> <a id="18807" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="18817" class="Symbol">(</a><a id="18818" href="Data.List.Base.html#1544" class="Function">map</a> <a id="18822" href="Bitcoin.Crypto.html#377" class="Field">pub</a> <a id="18826" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="18828" href="Prelude.Lists.html#13104" class="Function">codom</a><a id="18833" class="Symbol">)</a> <a id="18835" class="Symbol">(</a><a id="18836" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="18842" href="SecureCompilation.Coherence.html#18253" class="Bound">k⃗</a><a id="18844" class="Symbol">)</a>

        <a id="18855" href="SecureCompilation.Coherence.html#18855" class="Bound">a∈</a> <a id="18858" class="Symbol">:</a> <a id="18860" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18862" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="18864" href="BitML.Contracts.Helpers.html#3593" class="Function">namesˡ</a> <a id="18871" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a>
        <a id="18882" href="SecureCompilation.Coherence.html#18855" class="Bound">a∈</a> <a id="18885" class="Symbol">=</a> <a id="18887" href="BitML.Semantics.Configurations.Helpers.html#7949" class="Function">∈namesˡ-resp-≈</a> <a id="18902" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="18904" class="Symbol">{</a><a id="18905" href="SecureCompilation.Coherence.html#18163" class="Bound">Γ</a><a id="18906" class="Symbol">}{</a><a id="18908" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="18912" class="Symbol">(</a><a id="18913" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a> <a id="18916" class="Symbol">.</a><a id="18917" href="Prelude.Traces.html#527" class="Field">end</a><a id="18920" class="Symbol">)}</a> <a id="18923" class="Symbol">(</a><a id="18924" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="18930" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="18932" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="18938" href="SecureCompilation.Coherence.html#18317" class="Bound">cfg≈</a><a id="18942" class="Symbol">)</a> <a id="18944" class="Symbol">(</a><a id="18945" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="18950" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="18954" class="Symbol">)</a>

        <a id="18965" class="Comment">-- T0D0: should we search for a signature of this message instead?</a>
        <a id="19040" href="SecureCompilation.Coherence.html#19040" class="Bound">C,h̅,k̅</a> <a id="19048" class="Symbol">:</a> <a id="19050" href="ComputationalModel.Strategy.html#790" class="Function">Message</a>
        <a id="19066" href="SecureCompilation.Coherence.html#19040" class="Bound">C,h̅,k̅</a> <a id="19074" class="Symbol">=</a> <a id="19076" href="SecureCompilation.Coherence.html#18572" class="Bound">C</a> <a id="19078" href="Prelude.Semigroup.html#134" class="Field Operator">◇</a> <a id="19080" href="SecureCompilation.Coherence.html#18721" class="Bound">h̅</a> <a id="19083" href="Prelude.Semigroup.html#134" class="Field Operator">◇</a> <a id="19085" href="SecureCompilation.Coherence.html#18781" class="Bound">k̅</a>

        <a id="19097" class="Comment">-- (i) some participant B broadcasts message m</a>
        <a id="19152" href="SecureCompilation.Coherence.html#19152" class="Bound">λᶜ</a> <a id="19155" class="Symbol">=</a> <a id="19157" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="19159" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="19163" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a>

        <a id="19174" class="Comment">-- (iii) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="19234" class="Keyword">open</a> <a id="19239" href="SymbolicModel.Helpers.html#17673" class="Module">H₇</a> <a id="19242" class="Symbol">{</a><a id="19243" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a><a id="19245" class="Symbol">}</a> <a id="19247" href="SecureCompilation.Coherence.html#18115" class="Bound">𝕣</a> <a id="19249" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="19251" href="SecureCompilation.Coherence.html#18353" class="Bound">α</a> <a id="19253" href="SecureCompilation.Coherence.html#18414" class="Bound">t′</a> <a id="19256" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="19258" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="19260" href="SecureCompilation.Coherence.html#18154" class="Bound">n</a> <a id="19262" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="19265" href="SecureCompilation.Coherence.html#18317" class="Bound">cfg≈</a> <a id="19270" href="SecureCompilation.Coherence.html#18499" class="Bound">Γ→Γ′</a> <a id="19275" href="SecureCompilation.Coherence.html#18461" class="Bound">∃Γ≈</a>
      <a id="19285" class="Keyword">in</a>
      <a id="19294" class="Comment">-- (ii) in Rᶜ we find ⋯ (B → O ∶ m) (O → B : sechash′(a)) for some B ⋯</a>
      <a id="19371" class="Symbol">(</a><a id="19372" href="Data.Product.html#1369" class="Function">∃</a> <a id="19374" class="Symbol">λ</a> <a id="19376" href="SecureCompilation.Coherence.html#19376" class="Bound">B</a> <a id="19378" class="Symbol">→</a> <a id="19380" class="Symbol">(</a><a id="19381" href="SecureCompilation.Coherence.html#19376" class="Bound">B</a> <a id="19383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="19385" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a> <a id="19387" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="19389" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="19391" href="SymbolicModel.Collections.html#4047" class="Field">sechash′</a> <a id="19400" class="Symbol">{</a><a id="19401" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a><a id="19402" class="Symbol">}</a> <a id="19404" href="SecureCompilation.Coherence.html#18855" class="Bound">a∈</a> <a id="19407" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="19408" class="Symbol">)</a> <a id="19410" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="19412" href="ComputationalModel.Strategy.html#3170" class="Function">oracleInteractions</a> <a id="19431" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="19433" class="Symbol">)</a>

      <a id="19442" class="Comment">-- (iv) in Rˢ, we find an A:{G}C,∆ action, with a in G</a>
    <a id="19501" class="Symbol">→</a> <a id="19503" class="Symbol">(</a><a id="19504" href="SecureCompilation.Coherence.html#19504" class="Bound">∃α</a> <a id="19507" class="Symbol">:</a> <a id="19509" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="19522" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="19524" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="19526" href="SecureCompilation.Coherence.html#1121" class="Generalizable">⟨G⟩C</a> <a id="19531" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="19533" href="SecureCompilation.Coherence.html#18634" class="Bound">Δ</a> <a id="19535" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">⦆</a> <a id="19537" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="19539" href="SymbolicModel.Collections.html#1281" class="Function">labels</a> <a id="19546" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a><a id="19548" class="Symbol">)</a>
    <a id="19554" class="Symbol">→</a> <a id="19556" href="SecureCompilation.Coherence.html#18152" class="Bound">a</a> <a id="19558" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="19560" href="BitML.Contracts.Helpers.html#3593" class="Function">namesˡ</a> <a id="19567" href="SecureCompilation.Coherence.html#18276" class="Bound">G</a>

      <a id="19576" class="Comment">-- ... with a corresponding broadcast of m′=(C,h̅,k̅) in Rᶜ</a>
    <a id="19640" class="Symbol">→</a> <a id="19642" class="Symbol">(</a><a id="19643" href="SecureCompilation.Coherence.html#19643" class="Bound">∃λ</a> <a id="19646" class="Symbol">:</a> <a id="19648" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="19652" class="Symbol">(λ</a> <a id="19655" href="SecureCompilation.Coherence.html#19655" class="Bound">l</a> <a id="19657" class="Symbol">→</a> <a id="19659" href="Data.Product.html#1369" class="Function">∃</a> <a id="19661" class="Symbol">λ</a> <a id="19663" href="SecureCompilation.Coherence.html#19663" class="Bound">B</a> <a id="19665" class="Symbol">→</a> <a id="19667" href="SecureCompilation.Coherence.html#19655" class="Bound">l</a> <a id="19669" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="19671" href="SecureCompilation.Coherence.html#19663" class="Bound">B</a> <a id="19673" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="19677" href="SecureCompilation.Coherence.html#19040" class="Bound">C,h̅,k̅</a><a id="19684" class="Symbol">)</a> <a id="19686" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="19688" class="Symbol">)</a>

      <a id="19697" class="Comment">-- (v) λᶜ is the first broadcast of m after the first broadcast of m′</a>
    <a id="19771" class="Symbol">→</a> <a id="19773" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="19777" class="Symbol">(λ</a> <a id="19780" href="SecureCompilation.Coherence.html#19780" class="Bound">l</a> <a id="19782" class="Symbol">→</a> <a id="19784" class="Symbol">∀</a> <a id="19786" href="SecureCompilation.Coherence.html#19786" class="Bound">X</a> <a id="19788" class="Symbol">→</a> <a id="19790" href="SecureCompilation.Coherence.html#19780" class="Bound">l</a> <a id="19792" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="19794" href="SecureCompilation.Coherence.html#19786" class="Bound">X</a> <a id="19796" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="19800" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a><a id="19801" class="Symbol">)</a> <a id="19803" class="Symbol">(</a><a id="19804" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="19813" href="SecureCompilation.Coherence.html#19643" class="Bound">∃λ</a><a id="19815" class="Symbol">)</a>
      <a id="19823" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="19900" class="Symbol">→</a> <a id="19902" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="19910" href="SecureCompilation.Coherence.html#18110" class="Bound">Rˢ</a> <a id="19913" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="19915" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="19918" href="SecureCompilation.Coherence.html#19152" class="Bound">λᶜ</a> <a id="19921" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="19927" class="Comment">-- ** Contract actions: split</a>
  <a id="coher₁₁.[8]"></a><a id="19959" href="SecureCompilation.Coherence.html#19959" class="InductiveConstructor">[8]</a> <a id="19963" class="Symbol">:</a> <a id="19965" class="Symbol">∀</a> <a id="19967" class="Symbol">{</a><a id="19968" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a> <a id="19974" class="Symbol">:</a> <a id="19976" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="19989" class="Symbol">}</a> <a id="19991" class="Symbol">{</a><a id="19992" href="SecureCompilation.Coherence.html#19992" class="Bound">vad</a> <a id="19996" class="Symbol">:</a> <a id="19998" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="20004" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a><a id="20009" class="Symbol">}</a> <a id="20011" class="Symbol">→</a> <a id="20013" class="Keyword">let</a> <a id="20017" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="20019" href="SecureCompilation.Coherence.html#20019" class="Bound">G</a> <a id="20021" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="20023" href="SecureCompilation.Coherence.html#20023" class="Bound">C′</a> <a id="20026" class="Symbol">=</a> <a id="20028" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a><a id="20033" class="Symbol">;</a> <a id="20035" href="SecureCompilation.Coherence.html#20035" class="Bound">partG</a> <a id="20041" class="Symbol">=</a> <a id="20043" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="20060" href="SecureCompilation.Coherence.html#20019" class="Bound">G</a> <a id="20062" class="Keyword">in</a>
        <a id="20073" class="Symbol">∀</a> <a id="20075" class="Symbol">{</a><a id="20076" href="SecureCompilation.Coherence.html#20076" class="Bound">i</a> <a id="20078" class="Symbol">:</a> <a id="20080" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="20086" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a><a id="20087" class="Symbol">}</a> <a id="20089" class="Symbol">→</a> <a id="20091" class="Keyword">let</a> <a id="20095" href="SecureCompilation.Coherence.html#20095" class="Bound">d</a> <a id="20097" class="Symbol">=</a> <a id="20099" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="20101" href="Prelude.Lists.html#1259" class="Function Operator">‼</a> <a id="20103" href="SecureCompilation.Coherence.html#20076" class="Bound">i</a><a id="20104" class="Symbol">;</a> <a id="20106" href="SecureCompilation.Coherence.html#20106" class="Bound">d∗</a> <a id="20109" class="Symbol">=</a> <a id="20111" href="BitML.Contracts.Helpers.html#12737" class="Function">removeTopDecorations</a> <a id="20132" href="SecureCompilation.Coherence.html#20095" class="Bound">d</a><a id="20133" class="Symbol">;</a> <a id="20135" href="SecureCompilation.Coherence.html#20135" class="Bound">As</a> <a id="20138" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20140" href="SecureCompilation.Coherence.html#20140" class="Bound">ts</a> <a id="20143" class="Symbol">=</a> <a id="20145" href="BitML.Contracts.Helpers.html#12472" class="Function">decorations</a> <a id="20157" href="SecureCompilation.Coherence.html#20095" class="Bound">d</a> <a id="20159" class="Keyword">in</a>
        <a id="20170" class="Symbol">∀</a> <a id="20172" class="Symbol">{</a><a id="20173" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a> <a id="20178" class="Symbol">:</a> <a id="20180" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="20185" class="Symbol">(</a><a id="20186" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="20194" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="20196" href="BitML.Contracts.Types.html#647" class="Function">Contracts</a> <a id="20206" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="20208" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="20210" class="Symbol">)}</a> <a id="20213" class="Symbol">→</a> <a id="20215" class="Keyword">let</a> <a id="20219" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="20222" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20224" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a> <a id="20227" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20229" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a> <a id="20232" class="Symbol">=</a> <a id="20234" href="Prelude.Lists.html#9130" class="Function">unzip₃</a> <a id="20241" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a><a id="20245" class="Symbol">;</a> <a id="20247" href="SecureCompilation.Coherence.html#20247" class="Bound">v</a> <a id="20249" class="Symbol">=</a> <a id="20251" href="Data.List.Base.html#4784" class="Function">sum</a> <a id="20255" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="20258" class="Keyword">in</a>
        <a id="20269" class="Symbol">∀</a> <a id="20271" class="Symbol">{</a><a id="20272" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a><a id="20273" class="Symbol">}</a> <a id="20275" class="Symbol">→</a> <a id="20277" class="Keyword">let</a> <a id="20281" href="SecureCompilation.Coherence.html#20281" class="Bound">Γ</a> <a id="20283" class="Symbol">=</a> <a id="20285" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="20287" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="20289" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="20291" href="SecureCompilation.Coherence.html#20247" class="Bound">v</a> <a id="20293" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="20297" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="20299" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="20301" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="20303" class="Symbol">;</a> <a id="20305" href="SecureCompilation.Coherence.html#20305" class="Bound">Γₜ</a> <a id="20308" class="Symbol">=</a> <a id="20310" href="SecureCompilation.Coherence.html#20281" class="Bound">Γ</a> <a id="20312" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="20315" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a> <a id="20317" class="Keyword">in</a>

      <a id="20327" class="Comment">-- (i) in Rˢ, α consumes ⟨D+C,v⟩y to obtain ⟨C₀,v₀⟩ₓ₀ | ⋯ | ⟨Cₖ,vₖ⟩ₓₖ</a>
      <a id="20403" class="Comment">--     where D = ⋯ : split vs → cs</a>
      <a id="20444" class="Comment">--     let t be the maximum deadline in an after in front of D</a>
      <a id="20513" class="Comment">--     T0D0: what should t′ be in case there are not after decorations?</a>
      <a id="20591" class="Symbol">(</a><a id="20592" href="SecureCompilation.Coherence.html#20592" class="Bound">d≡</a> <a id="20595" class="Symbol">:</a> <a id="20597" href="SecureCompilation.Coherence.html#20095" class="Bound">d</a> <a id="20599" href="BitML.Contracts.Helpers.html#12954" class="Function Operator">≡⋯∶</a> <a id="20603" href="BitML.Contracts.Types.html#1022" class="InductiveConstructor">split</a> <a id="20609" class="Symbol">(</a><a id="20610" href="Data.List.Base.html#3570" class="Function">zip</a> <a id="20614" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="20617" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a><a id="20619" class="Symbol">))</a>
    <a id="20626" class="Symbol">→</a> <a id="20628" class="Symbol">(</a><a id="20629" href="SecureCompilation.Coherence.html#20629" class="Bound">cfg≈</a> <a id="20634" class="Symbol">:</a> <a id="20636" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="20639" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="20642" href="SecureCompilation.Coherence.html#20305" class="Bound">Γₜ</a><a id="20644" class="Symbol">)</a>

      <a id="20653" class="Comment">-- (iii) {G}C′ is the ancestor of ⟨D+C,v⟩y in Rˢ</a>
    <a id="20706" class="Symbol">→</a> <a id="20708" class="Symbol">(</a><a id="20709" href="SecureCompilation.Coherence.html#20709" class="Bound">anc</a> <a id="20713" class="Symbol">:</a> <a id="20715" href="SymbolicModel.Collections.html#1540" class="Function">Ancestor</a> <a id="20724" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="20727" class="Symbol">(</a><a id="20728" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="20730" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20732" href="SecureCompilation.Coherence.html#20247" class="Bound">v</a> <a id="20734" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20736" href="BitML.BasicTypes.html#484" class="Generalizable">y</a><a id="20737" class="Symbol">)</a> <a id="20739" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a><a id="20744" class="Symbol">)</a>
    <a id="20750" class="Symbol">→</a> <a id="20752" class="Keyword">let</a> <a id="20756" href="SecureCompilation.Coherence.html#20756" class="Bound">d⊆</a> <a id="20759" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20761" href="SecureCompilation.Coherence.html#20761" class="Bound">ad∈</a> <a id="20765" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="20767" class="Symbol">_</a> <a id="20769" class="Symbol">=</a> <a id="20771" href="SecureCompilation.Coherence.html#20709" class="Bound">anc</a>

          <a id="20786" href="SecureCompilation.Coherence.html#20786" class="Bound">d∈</a> <a id="20789" class="Symbol">:</a> <a id="20791" href="SecureCompilation.Coherence.html#20095" class="Bound">d</a> <a id="20793" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="20795" href="BitML.Contracts.Helpers.html#14958" class="Function">subtermsᶜ′</a> <a id="20806" href="SecureCompilation.Coherence.html#20023" class="Bound">C′</a>
          <a id="20819" href="SecureCompilation.Coherence.html#20786" class="Bound">d∈</a> <a id="20822" class="Symbol">=</a> <a id="20824" href="SecureCompilation.Coherence.html#20756" class="Bound">d⊆</a> <a id="20827" class="Symbol">(</a><a id="20828" href="Data.List.Membership.Propositional.Properties.html#11093" class="Function">∈-lookup</a> <a id="20837" href="SecureCompilation.Coherence.html#20076" class="Bound">i</a><a id="20838" class="Symbol">)</a>
      <a id="20846" class="Keyword">in</a>
      <a id="20855" class="Comment">-- hypotheses from [Timeout]</a>
      <a id="20890" class="Symbol">(</a><a id="20891" href="SecureCompilation.Coherence.html#20891" class="Bound">As≡∅</a> <a id="20896" class="Symbol">:</a> <a id="20898" href="SecureCompilation.Coherence.html#20135" class="Bound">As</a> <a id="20901" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20903" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="20905" class="Symbol">)</a>
      <a id="20913" class="Comment">-- (∀≤t : All (_≤ t) ts)</a>
      <a id="20944" class="Symbol">(</a><a id="20945" href="SecureCompilation.Coherence.html#20945" class="Bound">t≡</a> <a id="20948" class="Symbol">:</a> <a id="20950" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a> <a id="20952" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="20954" href="Prelude.Ord.html#721" class="Function">maximum</a> <a id="20962" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a> <a id="20964" href="SecureCompilation.Coherence.html#20140" class="Bound">ts</a><a id="20966" class="Symbol">)</a>
      <a id="20974" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="21054" class="Comment">--   ∙  ...</a>
      <a id="21072" class="Symbol">(</a><a id="21073" href="SecureCompilation.Coherence.html#21073" class="Bound">names⊆</a> <a id="21080" class="Symbol">:</a> <a id="21082" href="SecureCompilation.Coherence.html#20019" class="Bound">G</a> <a id="21084" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="21095" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="21097" class="Symbol">)</a>

    <a id="21104" class="Symbol">→</a> <a id="21106" class="Keyword">let</a>
        <a id="21118" href="SecureCompilation.Coherence.html#21118" class="Bound">α</a>   <a id="21122" class="Symbol">=</a> <a id="21124" href="BitML.Semantics.Label.html#1343" class="InductiveConstructor Operator">split⦅</a> <a id="21131" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="21133" href="BitML.Semantics.Label.html#1343" class="InductiveConstructor Operator">⦆</a>
        <a id="21143" href="SecureCompilation.Coherence.html#21143" class="Bound">Γ′</a>  <a id="21147" class="Symbol">=</a> <a id="21149" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="21152" href="Data.List.Base.html#1544" class="Function">map</a> <a id="21156" class="Symbol">(λ{</a> <a id="21160" class="Symbol">(</a><a id="21161" href="SecureCompilation.Coherence.html#21161" class="Bound">vᵢ</a> <a id="21164" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="21166" href="SecureCompilation.Coherence.html#21166" class="Bound">cᵢ</a> <a id="21169" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="21171" href="SecureCompilation.Coherence.html#21171" class="Bound">xᵢ</a><a id="21173" class="Symbol">)</a> <a id="21175" class="Symbol">→</a> <a id="21177" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="21179" href="SecureCompilation.Coherence.html#21166" class="Bound">cᵢ</a> <a id="21182" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="21184" href="SecureCompilation.Coherence.html#21161" class="Bound">vᵢ</a> <a id="21187" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="21191" href="SecureCompilation.Coherence.html#21171" class="Bound">xᵢ</a> <a id="21194" class="Symbol">})</a> <a id="21197" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a> <a id="21202" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="21204" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="21215" href="SecureCompilation.Coherence.html#21215" class="Bound">t′</a>  <a id="21219" class="Symbol">=</a> <a id="21221" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a>
        <a id="21231" href="SecureCompilation.Coherence.html#21231" class="Bound">Γₜ′</a> <a id="21235" class="Symbol">=</a> <a id="21237" href="SecureCompilation.Coherence.html#21143" class="Bound">Γ′</a> <a id="21240" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="21243" href="SecureCompilation.Coherence.html#21215" class="Bound">t′</a>
      <a id="21252" class="Keyword">in</a>
      <a id="21261" class="Symbol">(</a><a id="21262" href="SecureCompilation.Coherence.html#21262" class="Bound">∃Γ≈</a> <a id="21266" class="Symbol">:</a> <a id="21268" href="Data.Product.html#1369" class="Function">∃</a> <a id="21270" class="Symbol">(</a><a id="21271" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="21275" href="SecureCompilation.Coherence.html#21143" class="Bound">Γ′</a><a id="21277" class="Symbol">))</a> <a id="21280" class="Symbol">→</a>
      <a id="21288" class="Keyword">let</a>
        <a id="21300" href="SecureCompilation.Coherence.html#21300" class="Bound">∀≤t</a> <a id="21304" class="Symbol">:</a> <a id="21306" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="21310" class="Symbol">(</a><a id="21311" href="Prelude.Ord.html#214" class="Field Operator">_≤</a> <a id="21314" href="SecureCompilation.Coherence.html#21215" class="Bound">t′</a><a id="21316" class="Symbol">)</a> <a id="21318" href="SecureCompilation.Coherence.html#20140" class="Bound">ts</a>
        <a id="21329" href="SecureCompilation.Coherence.html#21300" class="Bound">∀≤t</a> <a id="21333" class="Symbol">=</a> <a id="21335" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="21337" class="Symbol">(λ</a> <a id="21340" href="SecureCompilation.Coherence.html#21340" class="Bound">◆</a> <a id="21342" class="Symbol">→</a> <a id="21344" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="21348" class="Symbol">(</a><a id="21349" href="Prelude.Ord.html#214" class="Field Operator">_≤</a> <a id="21352" href="SecureCompilation.Coherence.html#21340" class="Bound">◆</a><a id="21353" class="Symbol">)</a> <a id="21355" href="SecureCompilation.Coherence.html#20140" class="Bound">ts</a><a id="21357" class="Symbol">)</a> <a id="21359" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="21361" href="SecureCompilation.Coherence.html#20945" class="Bound">t≡</a> <a id="21364" href="Prelude.General.html#1195" class="Function">~:</a> <a id="21367" href="Prelude.Ord.html#3184" class="Postulate">∀≤max</a> <a id="21373" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a> <a id="21375" href="SecureCompilation.Coherence.html#20140" class="Bound">ts</a>

        <a id="21387" href="SecureCompilation.Coherence.html#21387" class="Bound">Γ→Γ′</a> <a id="21392" class="Symbol">:</a> <a id="21394" href="SecureCompilation.Coherence.html#20305" class="Bound">Γₜ</a> <a id="21397" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="21400" href="SecureCompilation.Coherence.html#21118" class="Bound">α</a> <a id="21402" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="21406" href="SecureCompilation.Coherence.html#21231" class="Bound">Γₜ′</a>
        <a id="21418" href="SecureCompilation.Coherence.html#21387" class="Bound">Γ→Γ′</a> <a id="21423" class="Symbol">=</a> <a id="21425" href="BitML.Semantics.InferenceRules.html#8701" class="InductiveConstructor">[Timeout]</a> <a id="21435" href="SecureCompilation.Coherence.html#20891" class="Bound">As≡∅</a> <a id="21440" href="SecureCompilation.Coherence.html#21300" class="Bound">∀≤t</a> <a id="21444" class="Symbol">(</a><a id="21445" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="21447" class="Symbol">(λ</a> <a id="21450" href="SecureCompilation.Coherence.html#21450" class="Bound">◆</a> <a id="21452" class="Symbol">→</a> <a id="21454" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="21456" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="21458" href="SecureCompilation.Coherence.html#21450" class="Bound">◆</a> <a id="21460" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="21462" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="21464" href="SecureCompilation.Coherence.html#20247" class="Bound">v</a> <a id="21466" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="21470" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="21472" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="21474" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="21477" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">—[</a> <a id="21480" href="SecureCompilation.Coherence.html#21118" class="Bound">α</a> <a id="21482" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">]→</a> <a id="21485" href="SecureCompilation.Coherence.html#21143" class="Bound">Γ′</a><a id="21487" class="Symbol">)</a> <a id="21489" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="21491" href="SecureCompilation.Coherence.html#20592" class="Bound">d≡</a> <a id="21494" href="Prelude.General.html#1195" class="Function">~:</a> <a id="21497" href="BitML.Semantics.InferenceRules.html#5595" class="InductiveConstructor">[C-Split]</a> <a id="21507" class="Symbol">{</a><a id="21508" class="Argument">vcis</a> <a id="21513" class="Symbol">=</a> <a id="21515" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a><a id="21519" class="Symbol">})</a> <a id="21522" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="21536" class="Keyword">open</a> <a id="21541" href="SymbolicModel.Helpers.html#18057" class="Module">H₈</a> <a id="21544" class="Symbol">{</a><a id="21545" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="21547" class="Symbol">}</a> <a id="21549" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="21551" href="SecureCompilation.Coherence.html#20272" class="Bound">t</a> <a id="21553" href="SecureCompilation.Coherence.html#21118" class="Bound">α</a> <a id="21555" href="SecureCompilation.Coherence.html#21215" class="Bound">t′</a> <a id="21558" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="21560" href="SecureCompilation.Coherence.html#20247" class="Bound">v</a> <a id="21562" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="21564" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="21567" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a> <a id="21572" href="SecureCompilation.Coherence.html#20629" class="Bound">cfg≈</a> <a id="21577" href="SecureCompilation.Coherence.html#21387" class="Bound">Γ→Γ′</a> <a id="21582" href="SecureCompilation.Coherence.html#21262" class="Bound">∃Γ≈</a>

        <a id="21595" class="Comment">-- (iii) submit transaction T</a>
        <a id="21633" class="Comment">--       where ∙ (T′,o) = txout′(y)</a>
        <a id="21677" class="Comment">--             ∙ T is the first transaction in Bpar(cs,d,T′,o,partG,t)</a>
        <a id="21756" class="Comment">--       i.e. the one corresponding to subterm `d∗ = split (zip vs cs)`</a>
        <a id="21836" href="SecureCompilation.Coherence.html#21836" class="Bound">T</a> <a id="21838" class="Symbol">:</a> <a id="21840" href="Data.Product.html#1369" class="Function">∃</a> <a id="21842" class="Symbol">λ</a> <a id="21844" href="SecureCompilation.Coherence.html#21844" class="Bound">i</a> <a id="21846" class="Symbol">→</a> <a id="21848" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="21851" href="SecureCompilation.Coherence.html#21844" class="Bound">i</a> <a id="21853" class="Symbol">(</a><a id="21854" href="Data.List.Base.html#4864" class="Function">length</a> <a id="21861" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a><a id="21863" class="Symbol">)</a>
        <a id="21873" href="SecureCompilation.Coherence.html#21836" class="Bound">T</a> <a id="21875" class="Symbol">=</a>
          <a id="21887" class="Keyword">let</a> <a id="21891" class="Comment">-- invoke compiler</a>
            <a id="21922" href="SecureCompilation.Coherence.html#21922" class="Bound">K</a> <a id="21924" class="Symbol">:</a> <a id="21926" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="21928" href="SecureCompilation.Coherence.html#20019" class="Bound">G</a>
            <a id="21942" href="SecureCompilation.Coherence.html#21922" class="Bound">K</a> <a id="21944" class="Symbol">{</a><a id="21945" href="SecureCompilation.Coherence.html#21945" class="Bound">p</a><a id="21946" class="Symbol">}</a> <a id="21948" class="Symbol">_</a> <a id="21950" class="Symbol">=</a> <a id="21952" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="21955" href="SecureCompilation.Coherence.html#21945" class="Bound">p</a>

            <a id="21970" class="Keyword">open</a> <a id="21975" href="SymbolicModel.Helpers.html#20331" class="Module">H₈″</a> <a id="21979" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a> <a id="21985" href="SecureCompilation.Coherence.html#20761" class="Bound">ad∈</a> <a id="21989" href="SecureCompilation.Coherence.html#21073" class="Bound">names⊆</a>

            <a id="22009" class="Comment">-- retrieve transaction for specific subterm</a>
            <a id="22066" href="SecureCompilation.Coherence.html#22066" class="Bound">d∗∈</a> <a id="22070" class="Symbol">:</a> <a id="22072" href="SecureCompilation.Coherence.html#20106" class="Bound">d∗</a> <a id="22075" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="22077" href="BitML.Contracts.Helpers.html#14969" class="Function">subtermsᶜ⁺</a> <a id="22088" href="SecureCompilation.Coherence.html#20023" class="Bound">C′</a>
            <a id="22103" href="SecureCompilation.Coherence.html#22066" class="Bound">d∗∈</a> <a id="22107" class="Symbol">=</a> <a id="22109" href="BitML.Contracts.Helpers.html#15721" class="Function">h-subᶜ</a> <a id="22116" class="Symbol">{</a><a id="22117" class="Argument">ds</a> <a id="22120" class="Symbol">=</a> <a id="22122" href="SecureCompilation.Coherence.html#20023" class="Bound">C′</a><a id="22124" class="Symbol">}</a> <a id="22126" href="SecureCompilation.Coherence.html#20786" class="Bound">d∈</a>

            <a id="22142" href="SecureCompilation.Coherence.html#22142" class="Bound">∃tx</a> <a id="22146" class="Symbol">:</a> <a id="22148" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="22153" href="SecureCompilation.Coherence.html#20106" class="Bound">d∗</a>
            <a id="22168" href="SecureCompilation.Coherence.html#22142" class="Bound">∃tx</a> <a id="22172" class="Symbol">=</a> <a id="22174" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="22180" class="Symbol">(</a><a id="22181" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="22196" class="Symbol">{</a><a id="22197" class="Argument">ad</a> <a id="22200" class="Symbol">=</a> <a id="22202" href="SecureCompilation.Coherence.html#19968" class="Bound">⟨G⟩C′</a><a id="22207" class="Symbol">}</a> <a id="22209" href="SecureCompilation.Coherence.html#19992" class="Bound">vad</a> <a id="22213" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="22222" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="22229" href="SecureCompilation.Coherence.html#21922" class="Bound">K</a> <a id="22231" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a><a id="22233" class="Symbol">)</a> <a id="22235" href="SecureCompilation.Coherence.html#22066" class="Bound">d∗∈</a>

            <a id="22252" href="SecureCompilation.Coherence.html#22252" class="Bound">∃tx′</a> <a id="22257" class="Symbol">:</a> <a id="22259" href="Data.Product.html#1806" class="Function">∃[</a> <a id="22262" href="SecureCompilation.Coherence.html#22262" class="Bound">i</a> <a id="22264" href="Data.Product.html#1806" class="Function">]</a> <a id="22266" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="22269" href="SecureCompilation.Coherence.html#22262" class="Bound">i</a> <a id="22271" class="Symbol">(</a><a id="22272" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22279" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="22281" href="Data.List.Base.html#3570" class="Function">zip</a> <a id="22285" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="22288" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a><a id="22290" class="Symbol">)</a>
            <a id="22304" href="SecureCompilation.Coherence.html#22252" class="Bound">∃tx′</a> <a id="22309" class="Symbol">=</a> <a id="22311" href="SecureCompilation.Coherence.html#22142" class="Bound">∃tx</a> <a id="22315" href="Prelude.General.html#871" class="Function">:~</a> <a id="22318" href="SecureCompilation.Coherence.html#20592" class="Bound">d≡</a> <a id="22321" href="Prelude.General.html#871" class="Function">⟪</a> <a id="22323" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="22328" href="Prelude.General.html#871" class="Function">⟫</a>

            <a id="22343" class="Keyword">open</a> <a id="22348" href="Relation.Binary.PropositionalEquality.Core.html#2708" class="Module">≡-Reasoning</a>
            <a id="22372" href="SecureCompilation.Coherence.html#22372" class="Bound">vs≡</a> <a id="22376" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="22378" href="SecureCompilation.Coherence.html#22378" class="Bound">cs≡</a> <a id="22382" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="22384" href="SecureCompilation.Coherence.html#22384" class="Bound">xs≡</a> <a id="22388" class="Symbol">=</a> <a id="22390" href="Prelude.Lists.html#9212" class="Function">length-unzip₃</a> <a id="22404" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a>

            <a id="22422" href="SecureCompilation.Coherence.html#22422" class="Bound">l≡</a> <a id="22425" class="Symbol">:</a> <a id="22427" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22434" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a> <a id="22437" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="22439" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22446" class="Symbol">(</a><a id="22447" href="Data.List.Base.html#3570" class="Function">zip</a> <a id="22451" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="22454" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a><a id="22456" class="Symbol">)</a>
            <a id="22470" href="SecureCompilation.Coherence.html#22422" class="Bound">l≡</a> <a id="22473" class="Symbol">=</a> <a id="22475" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a>
               <a id="22494" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="22496" href="Relation.Binary.PropositionalEquality.Core.html#2806" class="Function Operator">begin</a> <a id="22502" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22509" class="Symbol">(</a><a id="22510" href="Data.List.Base.html#3570" class="Function">zip</a> <a id="22514" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="22517" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a><a id="22519" class="Symbol">)</a>    <a id="22524" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="22527" href="Data.List.Properties.html#10390" class="Function">L.length-zipWith</a> <a id="22544" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="22548" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="22551" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a> <a id="22554" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                       <a id="22579" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22586" href="SecureCompilation.Coherence.html#20219" class="Bound">vs</a> <a id="22589" href="Data.Nat.Base.html#3157" class="Function Operator">⊓</a> <a id="22591" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22598" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a> <a id="22601" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="22604" href="Data.Nat.Properties.html#29442" class="Function">Nat.m≥n⇒m⊓n≡n</a> <a id="22618" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="22620" href="Data.Nat.Properties.html#4459" class="Function">Nat.≤-reflexive</a> <a id="22636" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="22638" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="22644" href="SecureCompilation.Coherence.html#22378" class="Bound">cs≡</a> <a id="22648" class="Symbol">(</a><a id="22649" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="22653" href="SecureCompilation.Coherence.html#22372" class="Bound">vs≡</a><a id="22656" class="Symbol">)</a> <a id="22658" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                       <a id="22683" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22690" href="SecureCompilation.Coherence.html#20224" class="Bound">cs</a>             <a id="22705" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="22708" href="SecureCompilation.Coherence.html#22378" class="Bound">cs≡</a> <a id="22712" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                       <a id="22737" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22744" href="SecureCompilation.Coherence.html#20173" class="Bound">vcis</a>           <a id="22759" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">≡⟨</a> <a id="22762" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="22766" href="SecureCompilation.Coherence.html#22384" class="Bound">xs≡</a> <a id="22770" href="Relation.Binary.PropositionalEquality.Core.html#2923" class="Function">⟩</a>
                       <a id="22795" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22802" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a>             <a id="22817" href="Relation.Binary.PropositionalEquality.Core.html#3105" class="Function Operator">∎</a>

            <a id="22832" href="SecureCompilation.Coherence.html#22832" class="Bound">∃tx″</a> <a id="22837" class="Symbol">:</a> <a id="22839" href="Data.Product.html#1806" class="Function">∃[</a> <a id="22842" href="SecureCompilation.Coherence.html#22842" class="Bound">i</a> <a id="22844" href="Data.Product.html#1806" class="Function">]</a> <a id="22846" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="22849" href="SecureCompilation.Coherence.html#22842" class="Bound">i</a> <a id="22851" class="Symbol">(</a><a id="22852" href="Data.List.Base.html#4864" class="Function">length</a> <a id="22859" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a><a id="22861" class="Symbol">)</a>
            <a id="22875" href="SecureCompilation.Coherence.html#22832" class="Bound">∃tx″</a> <a id="22880" class="Symbol">=</a> <a id="22882" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="22884" class="Symbol">(λ</a> <a id="22887" href="SecureCompilation.Coherence.html#22887" class="Bound">◆</a> <a id="22889" class="Symbol">→</a> <a id="22891" href="Data.Product.html#1806" class="Function">∃[</a> <a id="22894" href="SecureCompilation.Coherence.html#22894" class="Bound">i</a> <a id="22896" href="Data.Product.html#1806" class="Function">]</a> <a id="22898" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="22901" href="SecureCompilation.Coherence.html#22894" class="Bound">i</a> <a id="22903" href="SecureCompilation.Coherence.html#22887" class="Bound">◆</a><a id="22904" class="Symbol">)</a> <a id="22906" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="22908" href="SecureCompilation.Coherence.html#22422" class="Bound">l≡</a> <a id="22911" href="Prelude.General.html#1195" class="Function">~:</a> <a id="22914" href="SecureCompilation.Coherence.html#22252" class="Bound">∃tx′</a>
          <a id="22929" class="Keyword">in</a>
            <a id="22944" href="SecureCompilation.Coherence.html#22832" class="Bound">∃tx″</a>

        <a id="22958" href="SecureCompilation.Coherence.html#22958" class="Bound">∃T</a> <a id="22961" class="Symbol">=</a> <a id="22963" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="22966" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="22969" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="22975" href="SecureCompilation.Coherence.html#21836" class="Bound">T</a>

        <a id="22986" href="SecureCompilation.Coherence.html#22986" class="Bound">λᶜ</a> <a id="22989" class="Symbol">=</a> <a id="22991" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="22998" href="SecureCompilation.Coherence.html#22958" class="Bound">∃T</a>

        <a id="23010" class="Comment">-- (iv) extend txout′ with {xᵢ ↦ (T,i)}, sechash = sechash′, κ = κ′</a>
        <a id="23086" href="SecureCompilation.Coherence.html#23086" class="Bound">txout⁺</a> <a id="23093" class="Symbol">:</a> <a id="23095" href="SecureCompilation.Coherence.html#20229" class="Bound">xs</a> <a id="23098" href="Prelude.Lists.html#12988" class="Function Operator">↦</a> <a id="23100" href="Bitcoin.Tx.Base.html#1793" class="Record">TxInput′</a>
        <a id="23117" href="SecureCompilation.Coherence.html#23086" class="Bound">txout⁺</a> <a id="23124" href="SecureCompilation.Coherence.html#23124" class="Bound">x∈</a> <a id="23127" class="Symbol">=</a> <a id="23129" href="SecureCompilation.Coherence.html#22958" class="Bound">∃T</a> <a id="23132" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="23135" class="Symbol">(</a><a id="23136" href="Data.List.Relation.Unary.Any.html#1817" class="Function">L.Any.index</a> <a id="23148" href="SecureCompilation.Coherence.html#23124" class="Bound">x∈</a><a id="23150" class="Symbol">)</a>

        <a id="23161" class="Keyword">open</a> <a id="23166" href="SymbolicModel.Helpers.html#19904" class="Module">H₈′</a> <a id="23170" href="SecureCompilation.Coherence.html#23086" class="Bound">txout⁺</a>
      <a id="23183" class="Keyword">in</a>
      <a id="23192" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="23271" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="23279" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="23282" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="23284" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="23287" href="SecureCompilation.Coherence.html#22986" class="Bound">λᶜ</a> <a id="23290" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="23296" class="Comment">-- ** Contract actions: withdraw</a>
  <a id="coher₁₁.[9]"></a><a id="23331" href="SecureCompilation.Coherence.html#23331" class="InductiveConstructor">[9]</a> <a id="23335" class="Symbol">:</a> <a id="23337" class="Symbol">∀</a> <a id="23339" class="Symbol">{</a><a id="23340" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a> <a id="23346" class="Symbol">:</a> <a id="23348" href="BitML.Contracts.Types.html#2400" class="Record">Advertisement</a><a id="23361" class="Symbol">}</a> <a id="23363" class="Symbol">{</a><a id="23364" href="SecureCompilation.Coherence.html#23364" class="Bound">vad</a> <a id="23368" class="Symbol">:</a> <a id="23370" href="Prelude.Validity.html#302" class="Field">Valid</a> <a id="23376" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a><a id="23381" class="Symbol">}</a> <a id="23383" class="Symbol">→</a> <a id="23385" class="Keyword">let</a> <a id="23389" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟨</a> <a id="23391" href="SecureCompilation.Coherence.html#23391" class="Bound">G</a> <a id="23393" href="BitML.Contracts.Types.html#2440" class="InductiveConstructor Operator">⟩</a> <a id="23395" href="SecureCompilation.Coherence.html#23395" class="Bound">C′</a> <a id="23398" class="Symbol">=</a> <a id="23400" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a><a id="23405" class="Symbol">;</a> <a id="23407" href="SecureCompilation.Coherence.html#23407" class="Bound">partG</a> <a id="23413" class="Symbol">=</a> <a id="23415" href="BitML.Contracts.Helpers.html#2510" class="Function">nub-participants</a> <a id="23432" href="SecureCompilation.Coherence.html#23391" class="Bound">G</a> <a id="23434" class="Keyword">in</a>
        <a id="23445" class="Symbol">∀</a> <a id="23447" class="Symbol">{</a><a id="23448" href="SecureCompilation.Coherence.html#23448" class="Bound">i</a> <a id="23450" class="Symbol">:</a> <a id="23452" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="23458" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a><a id="23459" class="Symbol">}</a> <a id="23461" class="Symbol">→</a> <a id="23463" class="Keyword">let</a> <a id="23467" href="SecureCompilation.Coherence.html#23467" class="Bound">d</a> <a id="23469" class="Symbol">=</a> <a id="23471" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="23473" href="Prelude.Lists.html#1259" class="Function Operator">‼</a> <a id="23475" href="SecureCompilation.Coherence.html#23448" class="Bound">i</a><a id="23476" class="Symbol">;</a> <a id="23478" href="SecureCompilation.Coherence.html#23478" class="Bound">d∗</a> <a id="23481" class="Symbol">=</a> <a id="23483" href="BitML.Contracts.Helpers.html#12737" class="Function">removeTopDecorations</a> <a id="23504" href="SecureCompilation.Coherence.html#23467" class="Bound">d</a><a id="23505" class="Symbol">;</a> <a id="23507" href="SecureCompilation.Coherence.html#23507" class="Bound">As</a> <a id="23510" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23512" href="SecureCompilation.Coherence.html#23512" class="Bound">ts</a> <a id="23515" class="Symbol">=</a> <a id="23517" href="BitML.Contracts.Helpers.html#12472" class="Function">decorations</a> <a id="23529" href="SecureCompilation.Coherence.html#23467" class="Bound">d</a> <a id="23531" class="Keyword">in</a>
        <a id="23542" class="Keyword">let</a> <a id="23546" href="SecureCompilation.Coherence.html#23546" class="Bound">Γ</a> <a id="23548" class="Symbol">=</a> <a id="23550" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="23552" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="23554" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="23556" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="23558" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="23562" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="23564" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="23566" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="23568" class="Symbol">;</a> <a id="23570" href="SecureCompilation.Coherence.html#23570" class="Bound">Γₜ</a> <a id="23573" class="Symbol">=</a> <a id="23575" href="SecureCompilation.Coherence.html#23546" class="Bound">Γ</a> <a id="23577" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="23580" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="23582" class="Keyword">in</a>

      <a id="23592" class="Comment">-- (i) in Rˢ, α consumes ⟨D+C,v⟩y to obtain ⟨A,v⟩ₓ (where D = ⋯ : withdraw A)</a>
      <a id="23676" class="Symbol">(</a><a id="23677" href="SecureCompilation.Coherence.html#23677" class="Bound">d≡</a> <a id="23680" class="Symbol">:</a> <a id="23682" href="SecureCompilation.Coherence.html#23467" class="Bound">d</a> <a id="23684" href="BitML.Contracts.Helpers.html#12954" class="Function Operator">≡⋯∶</a> <a id="23688" href="BitML.Contracts.Types.html#884" class="InductiveConstructor">withdraw</a> <a id="23697" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="23698" class="Symbol">)</a>
    <a id="23704" class="Symbol">→</a> <a id="23706" class="Symbol">(</a><a id="23707" href="SecureCompilation.Coherence.html#23707" class="Bound">cfg≈</a> <a id="23712" class="Symbol">:</a> <a id="23714" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="23717" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="23720" href="SecureCompilation.Coherence.html#23570" class="Bound">Γₜ</a><a id="23722" class="Symbol">)</a>

      <a id="23731" class="Comment">-- (ii) {G}C′ is the ancestor of ⟨D+C,v⟩y in Rˢ</a>
    <a id="23783" class="Symbol">→</a> <a id="23785" class="Symbol">(</a><a id="23786" href="SecureCompilation.Coherence.html#23786" class="Bound">anc</a> <a id="23790" class="Symbol">:</a> <a id="23792" href="SymbolicModel.Collections.html#1540" class="Function">Ancestor</a> <a id="23801" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="23804" class="Symbol">(</a><a id="23805" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="23807" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23809" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="23811" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23813" href="BitML.BasicTypes.html#484" class="Generalizable">y</a><a id="23814" class="Symbol">)</a> <a id="23816" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a><a id="23821" class="Symbol">)</a>
    <a id="23827" class="Symbol">→</a> <a id="23829" class="Keyword">let</a> <a id="23833" href="SecureCompilation.Coherence.html#23833" class="Bound">d⊆</a> <a id="23836" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23838" href="SecureCompilation.Coherence.html#23838" class="Bound">ad∈</a> <a id="23842" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="23844" class="Symbol">_</a> <a id="23846" class="Symbol">=</a> <a id="23848" href="SecureCompilation.Coherence.html#23786" class="Bound">anc</a>

          <a id="23863" href="SecureCompilation.Coherence.html#23863" class="Bound">d∈</a> <a id="23866" class="Symbol">:</a> <a id="23868" href="SecureCompilation.Coherence.html#23467" class="Bound">d</a> <a id="23870" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="23872" href="BitML.Contracts.Helpers.html#14958" class="Function">subtermsᶜ′</a> <a id="23883" href="SecureCompilation.Coherence.html#23395" class="Bound">C′</a>
          <a id="23896" href="SecureCompilation.Coherence.html#23863" class="Bound">d∈</a> <a id="23899" class="Symbol">=</a> <a id="23901" href="SecureCompilation.Coherence.html#23833" class="Bound">d⊆</a> <a id="23904" class="Symbol">(</a><a id="23905" href="Data.List.Membership.Propositional.Properties.html#11093" class="Function">∈-lookup</a> <a id="23914" href="SecureCompilation.Coherence.html#23448" class="Bound">i</a><a id="23915" class="Symbol">)</a>
      <a id="23923" class="Keyword">in</a>
      <a id="23932" class="Comment">-- hypotheses from [Timeout]</a>
      <a id="23967" class="Symbol">(</a><a id="23968" href="SecureCompilation.Coherence.html#23968" class="Bound">As≡∅</a> <a id="23973" class="Symbol">:</a> <a id="23975" href="SecureCompilation.Coherence.html#23507" class="Bound">As</a> <a id="23978" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="23980" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="23982" class="Symbol">)</a>
      <a id="23990" class="Symbol">(</a><a id="23991" href="SecureCompilation.Coherence.html#23991" class="Bound">∀≤t</a> <a id="23995" class="Symbol">:</a> <a id="23997" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="24001" class="Symbol">(</a><a id="24002" href="Prelude.Ord.html#214" class="Field Operator">_≤</a> <a id="24005" href="BitML.BasicTypes.html#520" class="Generalizable">t</a><a id="24006" class="Symbol">)</a> <a id="24008" href="SecureCompilation.Coherence.html#23512" class="Bound">ts</a><a id="24010" class="Symbol">)</a>
      <a id="24018" class="Comment">-- [T0D0] additional hypotheses, should hold since we know the following:</a>
      <a id="24098" class="Comment">--   ∙  ...</a>
      <a id="24116" class="Symbol">(</a><a id="24117" href="SecureCompilation.Coherence.html#24117" class="Bound">names⊆</a> <a id="24124" class="Symbol">:</a> <a id="24126" href="SecureCompilation.Coherence.html#23391" class="Bound">G</a> <a id="24128" href="SecureCompilation.Coherence.html#1869" class="Function Operator">⊆⦅ᵖnamesᶜ⦆</a> <a id="24139" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="24141" class="Symbol">)</a>

    <a id="24148" class="Symbol">→</a> <a id="24150" class="Keyword">let</a>
        <a id="24162" href="SecureCompilation.Coherence.html#24162" class="Bound">α</a>   <a id="24166" class="Symbol">=</a> <a id="24168" href="BitML.Semantics.Label.html#1489" class="InductiveConstructor Operator">withdraw⦅</a> <a id="24178" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="24180" href="BitML.Semantics.Label.html#1489" class="InductiveConstructor Operator">,</a> <a id="24182" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="24184" href="BitML.Semantics.Label.html#1489" class="InductiveConstructor Operator">,</a> <a id="24186" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="24188" href="BitML.Semantics.Label.html#1489" class="InductiveConstructor Operator">⦆</a>
        <a id="24198" href="SecureCompilation.Coherence.html#24198" class="Bound">Γ′</a>  <a id="24202" class="Symbol">=</a> <a id="24204" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="24206" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="24208" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="24212" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="24214" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="24218" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="24220" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="24222" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="24233" href="SecureCompilation.Coherence.html#24233" class="Bound">t′</a>  <a id="24237" class="Symbol">=</a> <a id="24239" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="24249" href="SecureCompilation.Coherence.html#24249" class="Bound">Γₜ′</a> <a id="24253" class="Symbol">=</a> <a id="24255" href="SecureCompilation.Coherence.html#24198" class="Bound">Γ′</a> <a id="24258" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="24261" href="SecureCompilation.Coherence.html#24233" class="Bound">t′</a>
      <a id="24270" class="Keyword">in</a>
      <a id="24279" class="Symbol">(</a><a id="24280" href="SecureCompilation.Coherence.html#24280" class="Bound">∃Γ≈</a> <a id="24284" class="Symbol">:</a> <a id="24286" href="Data.Product.html#1369" class="Function">∃</a> <a id="24288" class="Symbol">(</a><a id="24289" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="24293" href="SecureCompilation.Coherence.html#24198" class="Bound">Γ′</a><a id="24295" class="Symbol">))</a> <a id="24298" class="Symbol">→</a>
      <a id="24306" class="Keyword">let</a>

        <a id="24319" href="SecureCompilation.Coherence.html#24319" class="Bound">Γ→Γ′</a> <a id="24324" class="Symbol">:</a> <a id="24326" href="SecureCompilation.Coherence.html#23570" class="Bound">Γₜ</a> <a id="24329" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="24332" href="SecureCompilation.Coherence.html#24162" class="Bound">α</a> <a id="24334" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="24338" href="SecureCompilation.Coherence.html#24249" class="Bound">Γₜ′</a>
        <a id="24350" href="SecureCompilation.Coherence.html#24319" class="Bound">Γ→Γ′</a> <a id="24355" class="Symbol">=</a> <a id="24357" href="BitML.Semantics.InferenceRules.html#8701" class="InductiveConstructor">[Timeout]</a> <a id="24367" href="SecureCompilation.Coherence.html#23968" class="Bound">As≡∅</a> <a id="24372" href="SecureCompilation.Coherence.html#23991" class="Bound">∀≤t</a> <a id="24376" class="Symbol">(</a><a id="24377" href="Prelude.General.html#1195" class="Function">⟪</a> <a id="24379" class="Symbol">(λ</a> <a id="24382" href="SecureCompilation.Coherence.html#24382" class="Bound">◆</a> <a id="24384" class="Symbol">→</a> <a id="24386" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟨</a> <a id="24388" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="24390" href="SecureCompilation.Coherence.html#24382" class="Bound">◆</a> <a id="24392" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="24394" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">,</a> <a id="24396" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="24398" href="BitML.Semantics.Configurations.Types.html#825" class="InductiveConstructor Operator">⟩at</a> <a id="24402" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="24404" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="24406" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="24409" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">—[</a> <a id="24412" href="SecureCompilation.Coherence.html#24162" class="Bound">α</a> <a id="24414" href="BitML.Semantics.InferenceRules.html#1205" class="Datatype Operator">]→</a> <a id="24417" href="SecureCompilation.Coherence.html#24198" class="Bound">Γ′</a><a id="24419" class="Symbol">)</a> <a id="24421" href="Prelude.General.html#1195" class="Function">⟫</a> <a id="24423" href="SecureCompilation.Coherence.html#23677" class="Bound">d≡</a> <a id="24426" href="Prelude.General.html#1195" class="Function">~:</a> <a id="24429" href="BitML.Semantics.InferenceRules.html#6634" class="InductiveConstructor">[C-Withdraw]</a><a id="24441" class="Symbol">)</a> <a id="24443" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="24457" class="Keyword">open</a> <a id="24462" href="SymbolicModel.Helpers.html#20871" class="Module">H₉</a> <a id="24465" class="Symbol">{</a><a id="24466" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="24468" class="Symbol">}</a> <a id="24470" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="24472" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="24474" href="SecureCompilation.Coherence.html#24162" class="Bound">α</a> <a id="24476" href="SecureCompilation.Coherence.html#24233" class="Bound">t′</a> <a id="24479" href="BitML.Contracts.Types.html#1351" class="Generalizable">c</a> <a id="24481" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="24483" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="24485" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="24488" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="24490" href="BitML.BasicTypes.html#482" class="Generalizable">x</a> <a id="24492" href="SecureCompilation.Coherence.html#23707" class="Bound">cfg≈</a> <a id="24497" href="SecureCompilation.Coherence.html#24319" class="Bound">Γ→Γ′</a> <a id="24502" href="SecureCompilation.Coherence.html#24280" class="Bound">∃Γ≈</a>

        <a id="24515" class="Comment">--   ∙ T′ at o = txout′(x)</a>
        <a id="24550" class="Comment">--   ∙ T is the first transaction of Bd(d,d,T′,o,v,partG,0)</a>
        <a id="24618" class="Comment">-- i.e.</a>
        <a id="24634" class="Comment">-- (iii) submit transaction T</a>
        <a id="24672" class="Comment">--       where ∙ (T′,o) = txout′(y)</a>
        <a id="24716" class="Comment">--             ∙ T is the first transaction in Bd(d,d,T′,o,v,partG,0)</a>
        <a id="24794" class="Comment">--       i.e. the one corresponding to subterm `d∗ = withdraw A`</a>
        <a id="24867" href="SecureCompilation.Coherence.html#24867" class="Bound">T</a> <a id="24869" class="Symbol">:</a> <a id="24871" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="24883" href="SecureCompilation.Coherence.html#24867" class="Bound">T</a> <a id="24885" class="Symbol">=</a>
          <a id="24897" class="Keyword">let</a> <a id="24901" class="Comment">-- invoke compiler</a>
            <a id="24932" href="SecureCompilation.Coherence.html#24932" class="Bound">K</a> <a id="24934" class="Symbol">:</a> <a id="24936" href="SymbolicModel.Collections.html#3543" class="Function">𝕂</a> <a id="24938" href="SecureCompilation.Coherence.html#23391" class="Bound">G</a>
            <a id="24952" href="SecureCompilation.Coherence.html#24932" class="Bound">K</a> <a id="24954" class="Symbol">{</a><a id="24955" href="SecureCompilation.Coherence.html#24955" class="Bound">p</a><a id="24956" class="Symbol">}</a> <a id="24958" class="Symbol">_</a> <a id="24960" class="Symbol">=</a> <a id="24962" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="24965" href="SecureCompilation.Coherence.html#24955" class="Bound">p</a>

            <a id="24980" class="Keyword">open</a> <a id="24985" href="SymbolicModel.Helpers.html#21168" class="Module">H₉″</a> <a id="24989" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a> <a id="24995" href="SecureCompilation.Coherence.html#23838" class="Bound">ad∈</a> <a id="24999" href="SecureCompilation.Coherence.html#24117" class="Bound">names⊆</a>

            <a id="25019" class="Comment">-- retrieve transaction for specific subterm</a>
            <a id="25076" href="SecureCompilation.Coherence.html#25076" class="Bound">d∗∈</a> <a id="25080" class="Symbol">:</a> <a id="25082" href="SecureCompilation.Coherence.html#23478" class="Bound">d∗</a> <a id="25085" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="25087" href="BitML.Contracts.Helpers.html#14969" class="Function">subtermsᶜ⁺</a> <a id="25098" href="SecureCompilation.Coherence.html#23395" class="Bound">C′</a>
            <a id="25113" href="SecureCompilation.Coherence.html#25076" class="Bound">d∗∈</a> <a id="25117" class="Symbol">=</a> <a id="25119" href="BitML.Contracts.Helpers.html#15721" class="Function">h-subᶜ</a> <a id="25126" class="Symbol">{</a><a id="25127" class="Argument">ds</a> <a id="25130" class="Symbol">=</a> <a id="25132" href="SecureCompilation.Coherence.html#23395" class="Bound">C′</a><a id="25134" class="Symbol">}</a> <a id="25136" href="SecureCompilation.Coherence.html#23863" class="Bound">d∈</a>

            <a id="25152" href="SecureCompilation.Coherence.html#25152" class="Bound">∃tx</a> <a id="25156" class="Symbol">:</a> <a id="25158" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="25163" href="SecureCompilation.Coherence.html#23478" class="Bound">d∗</a>
            <a id="25178" href="SecureCompilation.Coherence.html#25152" class="Bound">∃tx</a> <a id="25182" class="Symbol">=</a> <a id="25184" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="25190" class="Symbol">(</a><a id="25191" href="SecureCompilation.Compiler.html#2055" class="Function">bitml-compiler</a> <a id="25206" class="Symbol">{</a><a id="25207" class="Argument">ad</a> <a id="25210" class="Symbol">=</a> <a id="25212" href="SecureCompilation.Coherence.html#23340" class="Bound">⟨G⟩C′</a><a id="25217" class="Symbol">}</a> <a id="25219" href="SecureCompilation.Coherence.html#23364" class="Bound">vad</a> <a id="25223" href="SymbolicModel.Helpers.html#2564" class="Function">sechash₀</a> <a id="25232" href="SymbolicModel.Helpers.html#2483" class="Function">txout₀</a> <a id="25239" href="SecureCompilation.Coherence.html#24932" class="Bound">K</a> <a id="25241" href="SymbolicModel.Helpers.html#2657" class="Function">κ₀</a><a id="25243" class="Symbol">)</a> <a id="25245" href="SecureCompilation.Coherence.html#25076" class="Bound">d∗∈</a>

            <a id="25262" href="SecureCompilation.Coherence.html#25262" class="Bound">∃tx¹</a> <a id="25267" class="Symbol">:</a> <a id="25269" href="SecureCompilation.Compiler.html#1804" class="Function">∃Tx¹</a>
            <a id="25286" href="SecureCompilation.Coherence.html#25262" class="Bound">∃tx¹</a> <a id="25291" class="Symbol">=</a> <a id="25293" href="SecureCompilation.Coherence.html#25152" class="Bound">∃tx</a> <a id="25297" href="Prelude.General.html#871" class="Function">:~</a> <a id="25300" href="SecureCompilation.Coherence.html#23677" class="Bound">d≡</a> <a id="25303" href="Prelude.General.html#871" class="Function">⟪</a> <a id="25305" href="SecureCompilation.Compiler.html#1990" class="Function">∃Txᶜ</a> <a id="25310" href="Prelude.General.html#871" class="Function">⟫</a>
          <a id="25322" class="Keyword">in</a>
            <a id="25337" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="25340" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="25343" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="25349" href="SecureCompilation.Coherence.html#25262" class="Bound">∃tx¹</a>

        <a id="25363" href="SecureCompilation.Coherence.html#25363" class="Bound">λᶜ</a> <a id="25366" class="Symbol">=</a> <a id="25368" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="25375" href="SecureCompilation.Coherence.html#24867" class="Bound">T</a>

        <a id="25386" class="Comment">-- (iv) extend txout′ with {x ↦ (T,0)}, sechash = sechash′, κ = κ′</a>
        <a id="25461" class="Keyword">open</a> <a id="25466" href="SymbolicModel.Helpers.html#20967" class="Module">H₉′</a> <a id="25470" class="Symbol">(</a><a id="25471" href="SecureCompilation.Coherence.html#24867" class="Bound">T</a> <a id="25473" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="25476" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="25478" class="Symbol">)</a>
      <a id="25486" class="Keyword">in</a>
      <a id="25495" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="25574" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="25582" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="25585" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="25587" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="25590" href="SecureCompilation.Coherence.html#25363" class="Bound">λᶜ</a> <a id="25593" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="25599" class="Comment">-- ** Deposits: authorize join</a>
  <a id="coher₁₁.[10]"></a><a id="25632" href="SecureCompilation.Coherence.html#25632" class="InductiveConstructor">[10]</a> <a id="25637" class="Symbol">:</a> <a id="25639" class="Symbol">∀</a> <a id="25641" class="Symbol">{</a><a id="25642" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a><a id="25644" class="Symbol">}</a> <a id="25646" class="Symbol">{</a><a id="25647" href="SecureCompilation.Coherence.html#25647" class="Bound">𝕣</a> <a id="25649" class="Symbol">:</a> <a id="25651" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="25653" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a><a id="25655" class="Symbol">}</a> <a id="25657" class="Symbol">→</a> <a id="25659" class="Keyword">let</a> <a id="25663" class="Keyword">open</a> <a id="25668" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="25670" href="SecureCompilation.Coherence.html#25647" class="Bound">𝕣</a> <a id="25672" class="Keyword">in</a>
       <a id="25682" class="Symbol">∀</a> <a id="25684" class="Symbol">{</a><a id="25685" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="25687" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="25690" class="Symbol">:</a> <a id="25692" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="25694" class="Symbol">}</a> <a id="25696" class="Symbol">→</a> <a id="25698" class="Keyword">let</a> <a id="25702" href="SecureCompilation.Coherence.html#25702" class="Bound">Γ</a> <a id="25704" class="Symbol">=</a> <a id="25706" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="25708" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25710" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="25714" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="25716" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="25720" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="25722" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="25724" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="25726" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25728" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="25732" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="25735" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="25739" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="25742" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="25744" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="25746" class="Symbol">;</a> <a id="25748" href="SecureCompilation.Coherence.html#25748" class="Bound">Γₜ</a> <a id="25751" class="Symbol">=</a> <a id="25753" href="SecureCompilation.Coherence.html#25702" class="Bound">Γ</a> <a id="25755" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="25758" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="25760" class="Keyword">in</a>

      <a id="25770" class="Symbol">(</a><a id="25771" href="SecureCompilation.Coherence.html#25771" class="Bound">cfg≈</a> <a id="25776" class="Symbol">:</a> <a id="25778" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a> <a id="25781" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="25784" href="SecureCompilation.Coherence.html#25748" class="Bound">Γₜ</a><a id="25786" class="Symbol">)</a>

    <a id="25793" class="Symbol">→</a> <a id="25795" class="Keyword">let</a>
        <a id="25807" href="SecureCompilation.Coherence.html#25807" class="Bound">α</a>   <a id="25811" class="Symbol">=</a> <a id="25813" href="BitML.Semantics.Label.html#557" class="InductiveConstructor Operator">auth-join⦅</a> <a id="25824" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25826" href="BitML.Semantics.Label.html#557" class="InductiveConstructor Operator">,</a> <a id="25828" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="25830" href="BitML.Semantics.Label.html#557" class="InductiveConstructor Operator">↔</a> <a id="25832" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="25835" href="BitML.Semantics.Label.html#557" class="InductiveConstructor Operator">⦆</a>
        <a id="25845" href="SecureCompilation.Coherence.html#25845" class="Bound">Γ′</a>  <a id="25849" class="Symbol">=</a> <a id="25851" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="25853" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25855" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="25859" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="25861" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="25865" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="25867" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="25869" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="25871" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25873" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="25877" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="25880" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="25884" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="25887" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="25889" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25891" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="25897" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="25899" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">↔</a> <a id="25901" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="25904" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">▷⟨</a> <a id="25907" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="25909" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">,</a> <a id="25911" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="25913" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="25915" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="25918" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">⟩</a> <a id="25920" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="25922" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="25924" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="25935" href="SecureCompilation.Coherence.html#25935" class="Bound">t′</a>  <a id="25939" class="Symbol">=</a> <a id="25941" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="25951" href="SecureCompilation.Coherence.html#25951" class="Bound">Γₜ′</a> <a id="25955" class="Symbol">=</a> <a id="25957" href="SecureCompilation.Coherence.html#25845" class="Bound">Γ′</a> <a id="25960" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="25963" href="SecureCompilation.Coherence.html#25935" class="Bound">t′</a>
      <a id="25972" class="Keyword">in</a>
      <a id="25981" class="Symbol">(</a><a id="25982" href="SecureCompilation.Coherence.html#25982" class="Bound">∃Γ≈</a> <a id="25986" class="Symbol">:</a> <a id="25988" href="Data.Product.html#1369" class="Function">∃</a> <a id="25990" class="Symbol">(</a><a id="25991" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="25995" href="SecureCompilation.Coherence.html#25845" class="Bound">Γ′</a><a id="25997" class="Symbol">))</a> <a id="26000" class="Symbol">→</a>
      <a id="26008" class="Keyword">let</a>
        <a id="26020" href="SecureCompilation.Coherence.html#26020" class="Bound">Γ→Γ′</a> <a id="26025" class="Symbol">:</a> <a id="26027" href="SecureCompilation.Coherence.html#25748" class="Bound">Γₜ</a> <a id="26030" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="26033" href="SecureCompilation.Coherence.html#25807" class="Bound">α</a> <a id="26035" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="26039" href="SecureCompilation.Coherence.html#25951" class="Bound">Γₜ′</a>
        <a id="26051" href="SecureCompilation.Coherence.html#26020" class="Bound">Γ→Γ′</a> <a id="26056" class="Symbol">=</a> <a id="26058" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="26067" href="BitML.Semantics.InferenceRules.html#1329" class="InductiveConstructor">[DEP-AuthJoin]</a> <a id="26082" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="26096" href="SecureCompilation.Coherence.html#26096" class="Bound">x∈</a> <a id="26099" class="Symbol">:</a> <a id="26101" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="26103" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="26105" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="26112" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a>
        <a id="26123" href="SecureCompilation.Coherence.html#26096" class="Bound">x∈</a> <a id="26126" class="Symbol">=</a> <a id="26128" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="26143" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="26145" class="Symbol">{</a><a id="26146" href="SecureCompilation.Coherence.html#25702" class="Bound">Γ</a><a id="26147" class="Symbol">}{</a><a id="26149" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="26153" class="Symbol">(</a><a id="26154" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a> <a id="26157" class="Symbol">.</a><a id="26158" href="Prelude.Traces.html#527" class="Field">end</a><a id="26161" class="Symbol">)}</a> <a id="26164" class="Symbol">(</a><a id="26165" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="26171" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="26173" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="26179" href="SecureCompilation.Coherence.html#25771" class="Bound">cfg≈</a><a id="26183" class="Symbol">)</a> <a id="26185" class="Symbol">(</a><a id="26186" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="26191" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="26195" class="Symbol">)</a>

        <a id="26206" href="SecureCompilation.Coherence.html#26206" class="Bound">x′∈</a> <a id="26210" class="Symbol">:</a> <a id="26212" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="26215" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="26217" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="26224" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a>
        <a id="26235" href="SecureCompilation.Coherence.html#26206" class="Bound">x′∈</a> <a id="26239" class="Symbol">=</a> <a id="26241" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="26256" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="26259" class="Symbol">{</a><a id="26260" href="SecureCompilation.Coherence.html#25702" class="Bound">Γ</a><a id="26261" class="Symbol">}{</a><a id="26263" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="26267" class="Symbol">(</a><a id="26268" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a> <a id="26271" class="Symbol">.</a><a id="26272" href="Prelude.Traces.html#527" class="Field">end</a><a id="26275" class="Symbol">)}</a> <a id="26278" class="Symbol">(</a><a id="26279" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="26285" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="26287" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="26293" href="SecureCompilation.Coherence.html#25771" class="Bound">cfg≈</a><a id="26297" class="Symbol">)</a> <a id="26299" class="Symbol">(</a><a id="26300" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="26306" class="Symbol">(</a><a id="26307" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="26312" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="26316" class="Symbol">))</a>
      <a id="26325" class="Keyword">in</a>
      <a id="26334" class="Symbol">(</a><a id="26335" href="SecureCompilation.Coherence.html#26335" class="Bound">∃λ</a> <a id="26338" class="Symbol">:</a> <a id="26340" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="26344" class="Symbol">(λ</a> <a id="26347" href="SecureCompilation.Coherence.html#26347" class="Bound">l</a> <a id="26349" class="Symbol">→</a> <a id="26351" href="Data.Product.html#1369" class="Function">∃</a> <a id="26353" class="Symbol">λ</a> <a id="26355" href="SecureCompilation.Coherence.html#26355" class="Bound">B</a> <a id="26357" class="Symbol">→</a> <a id="26359" href="Data.Product.html#1369" class="Function">∃</a> <a id="26361" class="Symbol">λ</a> <a id="26363" href="SecureCompilation.Coherence.html#26363" class="Bound">T</a>
                <a id="26381" class="Symbol">→</a> <a id="26383" class="Symbol">(</a><a id="26384" href="SecureCompilation.Coherence.html#26347" class="Bound">l</a> <a id="26386" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26388" href="SecureCompilation.Coherence.html#26355" class="Bound">B</a> <a id="26390" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="26394" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="26396" href="SecureCompilation.Coherence.html#26363" class="Bound">T</a> <a id="26398" href="Bitcoin.Crypto.html#826" class="Field Operator">♯</a> <a id="26400" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="26401" class="Symbol">)</a>
                <a id="26419" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="26421" class="Symbol">(</a><a id="26422" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="26430" href="SecureCompilation.Coherence.html#26363" class="Bound">T</a> <a id="26432" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26434" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="26442" class="Symbol">(</a><a id="26443" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="26450" class="Symbol">{</a><a id="26451" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a><a id="26452" class="Symbol">}</a> <a id="26454" href="SecureCompilation.Coherence.html#26096" class="Bound">x∈</a><a id="26456" class="Symbol">)</a> <a id="26458" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="26460" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="26468" class="Symbol">(</a><a id="26469" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="26476" class="Symbol">{</a><a id="26477" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a><a id="26479" class="Symbol">}</a> <a id="26481" href="SecureCompilation.Coherence.html#26206" class="Bound">x′∈</a><a id="26484" class="Symbol">)</a> <a id="26486" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="26488" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="26490" class="Symbol">)</a>
                <a id="26508" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="26510" class="Symbol">(</a><a id="26511" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="26519" href="SecureCompilation.Coherence.html#26363" class="Bound">T</a> <a id="26521" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="26523" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="26527" href="Bitcoin.Script.Base.html#375" class="InductiveConstructor">Ctx</a> <a id="26531" class="Number">1</a> <a id="26533" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="26535" class="Keyword">record</a> <a id="26542" class="Symbol">{</a><a id="26543" href="Bitcoin.Tx.Base.html#658" class="Field">value</a> <a id="26549" class="Symbol">=</a> <a id="26551" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="26553" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="26555" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="26557" class="Symbol">;</a> <a id="26559" href="Bitcoin.Tx.Base.html#680" class="Field">validator</a> <a id="26569" class="Symbol">=</a> <a id="26571" href="Bitcoin.Script.Base.html#2174" class="InductiveConstructor Operator">ƛ</a> <a id="26573" class="Symbol">(</a><a id="26574" href="Bitcoin.Script.Base.html#1413" class="InductiveConstructor">versig</a> <a id="26581" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="26583" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="26586" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="26588" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="26590" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="26592" href="Data.Fin.html#730" class="Function Operator">#</a> <a id="26594" class="Number">0</a> <a id="26596" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="26597" class="Symbol">)}</a> <a id="26600" href="Data.Vec.Base.html#5750" class="Function Operator">]</a><a id="26601" class="Symbol">)</a>
                <a id="26619" class="Symbol">)</a> <a id="26621" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="26623" class="Symbol">)</a>
    <a id="26629" class="Symbol">→</a> <a id="26631" class="Keyword">let</a>
        <a id="26643" href="SecureCompilation.Coherence.html#26643" class="Bound">T</a> <a id="26645" class="Symbol">:</a> <a id="26647" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="26659" href="SecureCompilation.Coherence.html#26643" class="Bound">T</a> <a id="26661" class="Symbol">=</a> <a id="26663" class="Number">2</a> <a id="26665" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="26667" class="Number">1</a> <a id="26669" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="26671" class="Symbol">(</a><a id="26672" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="26678" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="26680" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="26686" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="26688" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="26694" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="26696" href="Data.List.Relation.Unary.Any.html#2251" class="Function">L.Any.satisfied</a> <a id="26712" href="SecureCompilation.Coherence.html#26335" class="Bound">∃λ</a><a id="26714" class="Symbol">)</a>

        <a id="26725" class="Comment">-- (iii) broadcast transaction T, signed by A</a>
        <a id="26779" href="SecureCompilation.Coherence.html#26779" class="Bound">m′</a> <a id="26782" class="Symbol">=</a> <a id="26784" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="26786" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="26790" class="Symbol">(</a><a id="26791" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="26794" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="26795" class="Symbol">)</a> <a id="26797" href="SecureCompilation.Coherence.html#26643" class="Bound">T</a> <a id="26799" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="26809" href="SecureCompilation.Coherence.html#26809" class="Bound">λᶜ</a> <a id="26812" class="Symbol">=</a> <a id="26814" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="26816" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="26820" href="SecureCompilation.Coherence.html#26779" class="Bound">m′</a>

        <a id="26832" class="Comment">-- (v) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="26890" class="Keyword">open</a> <a id="26895" href="SymbolicModel.Helpers.html#21787" class="Module">H₁₀</a> <a id="26899" class="Symbol">{</a><a id="26900" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a><a id="26902" class="Symbol">}</a> <a id="26904" href="SecureCompilation.Coherence.html#25647" class="Bound">𝕣</a> <a id="26906" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="26908" href="SecureCompilation.Coherence.html#25807" class="Bound">α</a> <a id="26910" href="SecureCompilation.Coherence.html#25935" class="Bound">t′</a> <a id="26913" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="26915" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="26917" href="SecureCompilation.Coherence.html#25685" class="Bound">x</a> <a id="26919" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="26922" href="SecureCompilation.Coherence.html#25687" class="Bound">x′</a> <a id="26925" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="26928" href="SecureCompilation.Coherence.html#25771" class="Bound">cfg≈</a> <a id="26933" href="SecureCompilation.Coherence.html#26020" class="Bound">Γ→Γ′</a> <a id="26938" href="SecureCompilation.Coherence.html#25982" class="Bound">∃Γ≈</a>
      <a id="26948" class="Keyword">in</a>
      <a id="26957" class="Comment">-- (iv) λᶜ is the first broadcast of m′ in Rᶜ after the first broadcast of T</a>
      <a id="27040" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="27044" class="Symbol">(λ</a> <a id="27047" href="SecureCompilation.Coherence.html#27047" class="Bound">l</a> <a id="27049" class="Symbol">→</a> <a id="27051" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="27053" href="Data.Product.html#1369" class="Function">∃</a> <a id="27055" class="Symbol">λ</a> <a id="27057" href="SecureCompilation.Coherence.html#27057" class="Bound">B</a> <a id="27059" class="Symbol">→</a> <a id="27061" href="SecureCompilation.Coherence.html#27047" class="Bound">l</a> <a id="27063" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="27065" href="SecureCompilation.Coherence.html#27057" class="Bound">B</a> <a id="27067" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="27071" href="SecureCompilation.Coherence.html#26779" class="Bound">m′</a><a id="27073" class="Symbol">)</a> <a id="27075" class="Symbol">(</a><a id="27076" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="27085" href="SecureCompilation.Coherence.html#26335" class="Bound">∃λ</a><a id="27087" class="Symbol">)</a>
      <a id="27095" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="27172" class="Symbol">→</a> <a id="27174" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="27182" href="SecureCompilation.Coherence.html#25642" class="Bound">Rˢ</a> <a id="27185" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="27187" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="27190" href="SecureCompilation.Coherence.html#26809" class="Bound">λᶜ</a> <a id="27193" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="27199" class="Comment">-- ** Deposits: join</a>
  <a id="coher₁₁.[11]"></a><a id="27222" href="SecureCompilation.Coherence.html#27222" class="InductiveConstructor">[11]</a> <a id="27227" class="Symbol">:</a> <a id="27229" class="Symbol">∀</a> <a id="27231" class="Symbol">{</a><a id="27232" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a><a id="27234" class="Symbol">}</a> <a id="27236" class="Symbol">{</a><a id="27237" href="SecureCompilation.Coherence.html#27237" class="Bound">𝕣</a> <a id="27239" class="Symbol">:</a> <a id="27241" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="27243" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a><a id="27245" class="Symbol">}</a> <a id="27247" class="Symbol">→</a> <a id="27249" class="Keyword">let</a> <a id="27253" class="Keyword">open</a> <a id="27258" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="27260" href="SecureCompilation.Coherence.html#27237" class="Bound">𝕣</a> <a id="27262" class="Keyword">in</a>
       <a id="27272" class="Symbol">∀</a> <a id="27274" class="Symbol">{</a><a id="27275" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27277" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27280" class="Symbol">:</a> <a id="27282" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="27284" class="Symbol">}</a> <a id="27286" class="Symbol">→</a> <a id="27288" class="Keyword">let</a> <a id="27292" href="SecureCompilation.Coherence.html#27292" class="Bound">Γ</a> <a id="27294" class="Symbol">=</a> <a id="27296" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="27298" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27300" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="27304" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="27306" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="27310" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27312" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="27314" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="27316" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27318" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="27322" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="27325" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="27329" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27332" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="27334" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27336" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="27342" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27344" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">↔</a> <a id="27346" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27349" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">▷⟨</a> <a id="27352" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27354" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">,</a> <a id="27356" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="27358" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="27360" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="27363" href="BitML.Semantics.Action.html#835" class="InductiveConstructor Operator">⟩</a> <a id="27365" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="27367" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="27369" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="27371" class="Symbol">;</a> <a id="27373" href="SecureCompilation.Coherence.html#27373" class="Bound">Γₜ</a> <a id="27376" class="Symbol">=</a> <a id="27378" href="SecureCompilation.Coherence.html#27292" class="Bound">Γ</a> <a id="27380" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="27383" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="27385" class="Keyword">in</a>

      <a id="27395" class="Symbol">(</a><a id="27396" href="SecureCompilation.Coherence.html#27396" class="Bound">cfg≈</a> <a id="27401" class="Symbol">:</a> <a id="27403" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a> <a id="27406" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="27409" href="SecureCompilation.Coherence.html#27373" class="Bound">Γₜ</a><a id="27411" class="Symbol">)</a>

    <a id="27418" class="Symbol">→</a> <a id="27420" class="Keyword">let</a>
        <a id="27432" href="SecureCompilation.Coherence.html#27432" class="Bound">α</a>   <a id="27436" class="Symbol">=</a> <a id="27438" href="BitML.Semantics.Label.html#617" class="InductiveConstructor Operator">join⦅</a> <a id="27444" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27446" href="BitML.Semantics.Label.html#617" class="InductiveConstructor Operator">↔</a> <a id="27448" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27451" href="BitML.Semantics.Label.html#617" class="InductiveConstructor Operator">⦆</a>
        <a id="27461" href="SecureCompilation.Coherence.html#27461" class="Bound">Γ′</a>  <a id="27465" class="Symbol">=</a> <a id="27467" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="27469" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27471" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="27475" class="Symbol">(</a><a id="27476" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="27478" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="27480" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="27482" class="Symbol">)</a> <a id="27484" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="27488" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="27490" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="27492" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="27503" href="SecureCompilation.Coherence.html#27503" class="Bound">t′</a>  <a id="27507" class="Symbol">=</a> <a id="27509" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="27519" href="SecureCompilation.Coherence.html#27519" class="Bound">Γₜ′</a> <a id="27523" class="Symbol">=</a> <a id="27525" href="SecureCompilation.Coherence.html#27461" class="Bound">Γ′</a> <a id="27528" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="27531" href="SecureCompilation.Coherence.html#27503" class="Bound">t′</a>
      <a id="27540" class="Keyword">in</a>
      <a id="27549" class="Symbol">(</a><a id="27550" href="SecureCompilation.Coherence.html#27550" class="Bound">∃Γ≈</a> <a id="27554" class="Symbol">:</a> <a id="27556" href="Data.Product.html#1369" class="Function">∃</a> <a id="27558" class="Symbol">(</a><a id="27559" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="27563" href="SecureCompilation.Coherence.html#27461" class="Bound">Γ′</a><a id="27565" class="Symbol">))</a> <a id="27568" class="Symbol">→</a>
      <a id="27576" class="Keyword">let</a>
        <a id="27588" href="SecureCompilation.Coherence.html#27588" class="Bound">Γ→Γ′</a> <a id="27593" class="Symbol">:</a> <a id="27595" href="SecureCompilation.Coherence.html#27373" class="Bound">Γₜ</a> <a id="27598" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="27601" href="SecureCompilation.Coherence.html#27432" class="Bound">α</a> <a id="27603" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="27607" href="SecureCompilation.Coherence.html#27519" class="Bound">Γₜ′</a>
        <a id="27619" href="SecureCompilation.Coherence.html#27588" class="Bound">Γ→Γ′</a> <a id="27624" class="Symbol">=</a> <a id="27626" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="27635" href="BitML.Semantics.InferenceRules.html#1591" class="InductiveConstructor">[DEP-Join]</a> <a id="27646" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="27660" href="SecureCompilation.Coherence.html#27660" class="Bound">x∈</a> <a id="27663" class="Symbol">:</a> <a id="27665" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27667" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="27669" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="27676" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a>
        <a id="27687" href="SecureCompilation.Coherence.html#27660" class="Bound">x∈</a> <a id="27690" class="Symbol">=</a> <a id="27692" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="27707" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="27709" class="Symbol">{</a><a id="27710" href="SecureCompilation.Coherence.html#27292" class="Bound">Γ</a><a id="27711" class="Symbol">}{</a><a id="27713" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="27717" class="Symbol">(</a><a id="27718" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a> <a id="27721" class="Symbol">.</a><a id="27722" href="Prelude.Traces.html#527" class="Field">end</a><a id="27725" class="Symbol">)}</a> <a id="27728" class="Symbol">(</a><a id="27729" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="27735" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="27737" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="27743" href="SecureCompilation.Coherence.html#27396" class="Bound">cfg≈</a><a id="27747" class="Symbol">)</a> <a id="27749" class="Symbol">(</a><a id="27750" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="27755" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="27759" class="Symbol">)</a>

        <a id="27770" href="SecureCompilation.Coherence.html#27770" class="Bound">x′∈</a> <a id="27774" class="Symbol">:</a> <a id="27776" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27779" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="27781" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="27788" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a>
        <a id="27799" href="SecureCompilation.Coherence.html#27770" class="Bound">x′∈</a> <a id="27803" class="Symbol">=</a> <a id="27805" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="27820" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="27823" class="Symbol">{</a><a id="27824" href="SecureCompilation.Coherence.html#27292" class="Bound">Γ</a><a id="27825" class="Symbol">}{</a><a id="27827" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="27831" class="Symbol">(</a><a id="27832" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a> <a id="27835" class="Symbol">.</a><a id="27836" href="Prelude.Traces.html#527" class="Field">end</a><a id="27839" class="Symbol">)}</a> <a id="27842" class="Symbol">(</a><a id="27843" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="27849" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="27851" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="27857" href="SecureCompilation.Coherence.html#27396" class="Bound">cfg≈</a><a id="27861" class="Symbol">)</a> <a id="27863" class="Symbol">(</a><a id="27864" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="27870" class="Symbol">(</a><a id="27871" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="27876" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="27880" class="Symbol">))</a>

        <a id="27892" class="Comment">-- (ii) submit transaction T</a>
        <a id="27929" href="SecureCompilation.Coherence.html#27929" class="Bound">T</a> <a id="27931" class="Symbol">:</a> <a id="27933" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="27945" href="SecureCompilation.Coherence.html#27929" class="Bound">T</a>  <a id="27948" class="Symbol">=</a> <a id="27950" class="Number">2</a> <a id="27952" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="27954" class="Number">1</a> <a id="27956" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="27958" href="Bitcoin.Tx.Crypto.html#907" class="Function">sig⋆</a> <a id="27963" class="Symbol">(</a><a id="27964" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="27976" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="27978" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="27981" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="27983" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="27984" class="Symbol">)</a> <a id="27986" class="Keyword">record</a>
           <a id="28004" class="Symbol">{</a> <a id="28006" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="28014" class="Symbol">=</a> <a id="28016" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="28024" class="Symbol">(</a><a id="28025" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="28032" class="Symbol">{</a><a id="28033" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a><a id="28034" class="Symbol">}</a> <a id="28036" href="SecureCompilation.Coherence.html#27660" class="Bound">x∈</a><a id="28038" class="Symbol">)</a> <a id="28040" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="28042" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="28050" class="Symbol">(</a><a id="28051" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="28058" class="Symbol">{</a><a id="28059" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a><a id="28061" class="Symbol">}</a> <a id="28063" href="SecureCompilation.Coherence.html#27770" class="Bound">x′∈</a><a id="28066" class="Symbol">)</a> <a id="28068" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="28070" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a>
           <a id="28084" class="Symbol">;</a> <a id="28086" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="28094" class="Symbol">=</a> <a id="28096" href="Bitcoin.Tx.Crypto.html#520" class="Function">wit⊥</a>
           <a id="28112" class="Symbol">;</a> <a id="28114" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="28122" class="Symbol">=</a> <a id="28124" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="28136" class="Number">0</a>
           <a id="28149" class="Symbol">;</a> <a id="28151" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="28159" class="Symbol">=</a> <a id="28161" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="28165" class="Symbol">(</a><a id="28166" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28168" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="28170" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="28172" class="Symbol">)</a> <a id="28174" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="28191" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="28194" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28196" href="Data.Vec.Base.html#5750" class="Function Operator">]</a>
           <a id="28209" class="Symbol">;</a> <a id="28211" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="28219" class="Symbol">=</a> <a id="28221" class="Number">0</a> <a id="28223" class="Symbol">}</a>
        <a id="28233" href="SecureCompilation.Coherence.html#28233" class="Bound">λᶜ</a> <a id="28236" class="Symbol">=</a> <a id="28238" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="28245" href="SecureCompilation.Coherence.html#27929" class="Bound">T</a>

        <a id="28256" class="Comment">-- (iii) extend txout′ with y↦T₀ (removing {x↦_;x′↦_}), sechash = sechash′, κ = κ′</a>
        <a id="28347" class="Keyword">open</a> <a id="28352" href="SymbolicModel.Helpers.html#22114" class="Module">H₁₁</a> <a id="28356" class="Symbol">{</a><a id="28357" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a><a id="28359" class="Symbol">}</a> <a id="28361" href="SecureCompilation.Coherence.html#27237" class="Bound">𝕣</a> <a id="28363" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="28365" href="SecureCompilation.Coherence.html#27432" class="Bound">α</a> <a id="28367" href="SecureCompilation.Coherence.html#27503" class="Bound">t′</a> <a id="28370" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28372" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28374" href="SecureCompilation.Coherence.html#27275" class="Bound">x</a> <a id="28376" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="28379" href="SecureCompilation.Coherence.html#27277" class="Bound">x′</a> <a id="28382" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="28384" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="28387" href="SecureCompilation.Coherence.html#27396" class="Bound">cfg≈</a> <a id="28392" class="Symbol">(</a><a id="28393" href="SecureCompilation.Coherence.html#27929" class="Bound">T</a> <a id="28395" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="28398" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="28400" class="Symbol">)</a> <a id="28402" href="SecureCompilation.Coherence.html#27588" class="Bound">Γ→Γ′</a> <a id="28407" href="SecureCompilation.Coherence.html#27550" class="Bound">∃Γ≈</a>
      <a id="28417" class="Keyword">in</a>
      <a id="28426" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="28505" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="28513" href="SecureCompilation.Coherence.html#27232" class="Bound">Rˢ</a> <a id="28516" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="28518" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="28521" href="SecureCompilation.Coherence.html#28233" class="Bound">λᶜ</a> <a id="28524" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="28530" class="Comment">-- ** Deposits: authorize divide (similar to [10])</a>
  <a id="coher₁₁.[12]"></a><a id="28583" href="SecureCompilation.Coherence.html#28583" class="InductiveConstructor">[12]</a> <a id="28588" class="Symbol">:</a> <a id="28590" class="Symbol">∀</a> <a id="28592" class="Symbol">{</a><a id="28593" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a><a id="28595" class="Symbol">}</a> <a id="28597" class="Symbol">{</a><a id="28598" href="SecureCompilation.Coherence.html#28598" class="Bound">𝕣</a> <a id="28600" class="Symbol">:</a> <a id="28602" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="28604" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a><a id="28606" class="Symbol">}</a> <a id="28608" class="Symbol">→</a> <a id="28610" class="Keyword">let</a> <a id="28614" class="Keyword">open</a> <a id="28619" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="28621" href="SecureCompilation.Coherence.html#28598" class="Bound">𝕣</a> <a id="28623" class="Keyword">in</a>
       <a id="28633" class="Symbol">∀</a> <a id="28635" class="Symbol">{</a><a id="28636" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="28638" class="Symbol">:</a> <a id="28640" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="28642" class="Symbol">}</a> <a id="28644" class="Symbol">→</a> <a id="28646" class="Keyword">let</a> <a id="28650" href="SecureCompilation.Coherence.html#28650" class="Bound">Γ</a> <a id="28652" class="Symbol">=</a> <a id="28654" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="28656" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28658" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="28662" class="Symbol">(</a><a id="28663" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28665" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="28667" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="28669" class="Symbol">)</a> <a id="28671" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="28675" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="28677" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="28679" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="28681" class="Symbol">;</a> <a id="28683" href="SecureCompilation.Coherence.html#28683" class="Bound">Γₜ</a> <a id="28686" class="Symbol">=</a> <a id="28688" href="SecureCompilation.Coherence.html#28650" class="Bound">Γ</a> <a id="28690" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="28693" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="28695" class="Keyword">in</a>

      <a id="28705" class="Symbol">(</a><a id="28706" href="SecureCompilation.Coherence.html#28706" class="Bound">cfg≈</a> <a id="28711" class="Symbol">:</a> <a id="28713" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a> <a id="28716" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="28719" href="SecureCompilation.Coherence.html#28683" class="Bound">Γₜ</a><a id="28721" class="Symbol">)</a>

    <a id="28728" class="Symbol">→</a> <a id="28730" class="Keyword">let</a>
        <a id="28742" href="SecureCompilation.Coherence.html#28742" class="Bound">α</a>   <a id="28746" class="Symbol">=</a> <a id="28748" href="BitML.Semantics.Label.html#661" class="InductiveConstructor Operator">auth-divide⦅</a> <a id="28761" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28763" href="BitML.Semantics.Label.html#661" class="InductiveConstructor Operator">,</a> <a id="28765" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="28767" href="BitML.Semantics.Label.html#661" class="InductiveConstructor Operator">▷</a> <a id="28769" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28771" href="BitML.Semantics.Label.html#661" class="InductiveConstructor Operator">,</a> <a id="28773" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="28776" href="BitML.Semantics.Label.html#661" class="InductiveConstructor Operator">⦆</a>
        <a id="28786" href="SecureCompilation.Coherence.html#28786" class="Bound">Γ′</a>  <a id="28790" class="Symbol">=</a> <a id="28792" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="28794" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28796" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="28800" class="Symbol">(</a><a id="28801" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28803" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="28805" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="28807" class="Symbol">)</a> <a id="28809" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="28813" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="28815" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="28817" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28819" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="28825" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="28827" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">▷⟨</a> <a id="28830" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="28832" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="28834" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="28836" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="28838" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="28841" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">⟩</a> <a id="28843" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="28845" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="28847" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="28858" href="SecureCompilation.Coherence.html#28858" class="Bound">t′</a>  <a id="28862" class="Symbol">=</a> <a id="28864" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="28874" href="SecureCompilation.Coherence.html#28874" class="Bound">Γₜ′</a> <a id="28878" class="Symbol">=</a> <a id="28880" href="SecureCompilation.Coherence.html#28786" class="Bound">Γ′</a> <a id="28883" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="28886" href="SecureCompilation.Coherence.html#28858" class="Bound">t′</a>
      <a id="28895" class="Keyword">in</a>
      <a id="28904" class="Symbol">(</a><a id="28905" href="SecureCompilation.Coherence.html#28905" class="Bound">∃Γ≈</a> <a id="28909" class="Symbol">:</a> <a id="28911" href="Data.Product.html#1369" class="Function">∃</a> <a id="28913" class="Symbol">(</a><a id="28914" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="28918" href="SecureCompilation.Coherence.html#28786" class="Bound">Γ′</a><a id="28920" class="Symbol">))</a> <a id="28923" class="Symbol">→</a>
      <a id="28931" class="Keyword">let</a>
        <a id="28943" href="SecureCompilation.Coherence.html#28943" class="Bound">Γ→Γ′</a> <a id="28948" class="Symbol">:</a> <a id="28950" href="SecureCompilation.Coherence.html#28683" class="Bound">Γₜ</a> <a id="28953" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="28956" href="SecureCompilation.Coherence.html#28742" class="Bound">α</a> <a id="28958" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="28962" href="SecureCompilation.Coherence.html#28874" class="Bound">Γₜ′</a>
        <a id="28974" href="SecureCompilation.Coherence.html#28943" class="Bound">Γ→Γ′</a> <a id="28979" class="Symbol">=</a> <a id="28981" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="28990" href="BitML.Semantics.InferenceRules.html#1828" class="InductiveConstructor">[DEP-AuthDivide]</a> <a id="29007" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="29021" href="SecureCompilation.Coherence.html#29021" class="Bound">x∈</a> <a id="29024" class="Symbol">:</a> <a id="29026" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="29028" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="29030" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="29037" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a>
        <a id="29048" href="SecureCompilation.Coherence.html#29021" class="Bound">x∈</a> <a id="29051" class="Symbol">=</a> <a id="29053" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="29068" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="29070" class="Symbol">{</a><a id="29071" href="SecureCompilation.Coherence.html#28650" class="Bound">Γ</a><a id="29072" class="Symbol">}{</a><a id="29074" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="29078" class="Symbol">(</a><a id="29079" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a> <a id="29082" class="Symbol">.</a><a id="29083" href="Prelude.Traces.html#527" class="Field">end</a><a id="29086" class="Symbol">)}</a> <a id="29089" class="Symbol">(</a><a id="29090" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="29096" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="29098" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="29104" href="SecureCompilation.Coherence.html#28706" class="Bound">cfg≈</a><a id="29108" class="Symbol">)</a> <a id="29110" class="Symbol">(</a><a id="29111" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="29116" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="29120" class="Symbol">)</a>
      <a id="29128" class="Keyword">in</a>
      <a id="29137" class="Symbol">(</a><a id="29138" href="SecureCompilation.Coherence.html#29138" class="Bound">∃λ</a> <a id="29141" class="Symbol">:</a> <a id="29143" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="29147" class="Symbol">(λ</a> <a id="29150" href="SecureCompilation.Coherence.html#29150" class="Bound">l</a> <a id="29152" class="Symbol">→</a> <a id="29154" href="Data.Product.html#1369" class="Function">∃</a> <a id="29156" class="Symbol">λ</a> <a id="29158" href="SecureCompilation.Coherence.html#29158" class="Bound">B</a> <a id="29160" class="Symbol">→</a> <a id="29162" href="Data.Product.html#1369" class="Function">∃</a> <a id="29164" class="Symbol">λ</a> <a id="29166" href="SecureCompilation.Coherence.html#29166" class="Bound">T</a>
                <a id="29184" class="Symbol">→</a> <a id="29186" class="Symbol">(</a><a id="29187" href="SecureCompilation.Coherence.html#29150" class="Bound">l</a> <a id="29189" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="29191" href="SecureCompilation.Coherence.html#29158" class="Bound">B</a> <a id="29193" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="29197" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="29199" href="SecureCompilation.Coherence.html#29166" class="Bound">T</a> <a id="29201" href="Bitcoin.Crypto.html#826" class="Field Operator">♯</a> <a id="29203" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="29204" class="Symbol">)</a>
                <a id="29222" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="29224" class="Symbol">(</a><a id="29225" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="29233" href="SecureCompilation.Coherence.html#29166" class="Bound">T</a> <a id="29235" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="29237" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="29241" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="29249" class="Symbol">(</a><a id="29250" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="29257" class="Symbol">{</a><a id="29258" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a><a id="29259" class="Symbol">}</a> <a id="29261" href="SecureCompilation.Coherence.html#29021" class="Bound">x∈</a><a id="29263" class="Symbol">)</a> <a id="29265" href="Data.Vec.Base.html#5750" class="Function Operator">]</a><a id="29266" class="Symbol">)</a>
                <a id="29284" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="29286" class="Symbol">(</a><a id="29287" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="29295" href="SecureCompilation.Coherence.html#29166" class="Bound">T</a> <a id="29297" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="29299" class="Symbol">(</a><a id="29300" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="29302" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="29319" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="29322" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="29323" class="Symbol">)</a> <a id="29325" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="29327" class="Symbol">(</a><a id="29328" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="29331" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="29348" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="29351" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="29352" class="Symbol">)</a> <a id="29354" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="29356" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a><a id="29358" class="Symbol">)</a>
                <a id="29376" class="Symbol">)</a> <a id="29378" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="29380" class="Symbol">)</a>
    <a id="29386" class="Symbol">→</a> <a id="29388" class="Keyword">let</a>
        <a id="29400" href="SecureCompilation.Coherence.html#29400" class="Bound">T</a> <a id="29402" class="Symbol">:</a> <a id="29404" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="29416" href="SecureCompilation.Coherence.html#29400" class="Bound">T</a> <a id="29418" class="Symbol">=</a> <a id="29420" class="Number">1</a> <a id="29422" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="29424" class="Number">2</a> <a id="29426" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="29428" class="Symbol">(</a><a id="29429" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="29435" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="29437" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="29443" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="29445" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="29451" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="29453" href="Data.List.Relation.Unary.Any.html#2251" class="Function">L.Any.satisfied</a> <a id="29469" href="SecureCompilation.Coherence.html#29138" class="Bound">∃λ</a><a id="29471" class="Symbol">)</a>

        <a id="29482" class="Comment">-- (iii) broadcast transaction T, signed by A</a>
        <a id="29536" href="SecureCompilation.Coherence.html#29536" class="Bound">m′</a> <a id="29539" class="Symbol">=</a> <a id="29541" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="29543" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="29547" class="Symbol">(</a><a id="29548" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="29551" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="29552" class="Symbol">)</a> <a id="29554" href="SecureCompilation.Coherence.html#29400" class="Bound">T</a> <a id="29556" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="29566" href="SecureCompilation.Coherence.html#29566" class="Bound">λᶜ</a> <a id="29569" class="Symbol">=</a> <a id="29571" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="29573" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="29577" href="SecureCompilation.Coherence.html#29536" class="Bound">m′</a>

        <a id="29589" class="Comment">-- (v) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="29647" class="Keyword">open</a> <a id="29652" href="SymbolicModel.Helpers.html#22548" class="Module">H₁₂</a> <a id="29656" class="Symbol">{</a><a id="29657" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a><a id="29659" class="Symbol">}</a> <a id="29661" href="SecureCompilation.Coherence.html#28598" class="Bound">𝕣</a> <a id="29663" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="29665" href="SecureCompilation.Coherence.html#28742" class="Bound">α</a> <a id="29667" href="SecureCompilation.Coherence.html#28858" class="Bound">t′</a> <a id="29670" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="29672" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="29674" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="29677" href="SecureCompilation.Coherence.html#28636" class="Bound">x</a> <a id="29679" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="29682" href="SecureCompilation.Coherence.html#28706" class="Bound">cfg≈</a> <a id="29687" href="SecureCompilation.Coherence.html#28943" class="Bound">Γ→Γ′</a> <a id="29692" href="SecureCompilation.Coherence.html#28905" class="Bound">∃Γ≈</a>
      <a id="29702" class="Keyword">in</a>
      <a id="29711" class="Comment">-- (iv) λᶜ is the first broadcast of m′ in Rᶜ after the first broadcast of T</a>
      <a id="29794" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="29798" class="Symbol">(λ</a> <a id="29801" href="SecureCompilation.Coherence.html#29801" class="Bound">l</a> <a id="29803" class="Symbol">→</a> <a id="29805" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="29807" href="Data.Product.html#1369" class="Function">∃</a> <a id="29809" class="Symbol">λ</a> <a id="29811" href="SecureCompilation.Coherence.html#29811" class="Bound">B</a> <a id="29813" class="Symbol">→</a> <a id="29815" href="SecureCompilation.Coherence.html#29801" class="Bound">l</a> <a id="29817" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="29819" href="SecureCompilation.Coherence.html#29811" class="Bound">B</a> <a id="29821" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="29825" href="SecureCompilation.Coherence.html#29536" class="Bound">m′</a><a id="29827" class="Symbol">)</a> <a id="29829" class="Symbol">(</a><a id="29830" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="29839" href="SecureCompilation.Coherence.html#29138" class="Bound">∃λ</a><a id="29841" class="Symbol">)</a>
      <a id="29849" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="29926" class="Symbol">→</a> <a id="29928" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="29936" href="SecureCompilation.Coherence.html#28593" class="Bound">Rˢ</a> <a id="29939" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="29941" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="29944" href="SecureCompilation.Coherence.html#29566" class="Bound">λᶜ</a> <a id="29947" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="29953" class="Comment">-- ** Deposits: divide (dimilar to [11])</a>
  <a id="coher₁₁.[13]"></a><a id="29996" href="SecureCompilation.Coherence.html#29996" class="InductiveConstructor">[13]</a> <a id="30001" class="Symbol">:</a> <a id="30003" class="Symbol">∀</a> <a id="30005" class="Symbol">{</a><a id="30006" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a><a id="30008" class="Symbol">}</a> <a id="30010" class="Symbol">{</a><a id="30011" href="SecureCompilation.Coherence.html#30011" class="Bound">𝕣</a> <a id="30013" class="Symbol">:</a> <a id="30015" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="30017" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a><a id="30019" class="Symbol">}</a> <a id="30021" class="Symbol">→</a> <a id="30023" class="Keyword">let</a> <a id="30027" class="Keyword">open</a> <a id="30032" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="30034" href="SecureCompilation.Coherence.html#30011" class="Bound">𝕣</a> <a id="30036" class="Keyword">in</a>
       <a id="30046" class="Symbol">∀</a> <a id="30048" class="Symbol">{</a><a id="30049" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30051" class="Symbol">:</a> <a id="30053" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="30055" class="Symbol">}</a> <a id="30057" class="Symbol">→</a> <a id="30059" class="Keyword">let</a> <a id="30063" href="SecureCompilation.Coherence.html#30063" class="Bound">Γ</a> <a id="30065" class="Symbol">=</a> <a id="30067" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="30069" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30071" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="30075" class="Symbol">(</a><a id="30076" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="30078" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="30080" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a><a id="30082" class="Symbol">)</a> <a id="30084" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="30088" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30090" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="30092" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30094" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="30100" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30102" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">▷⟨</a> <a id="30105" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30107" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="30109" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="30111" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">,</a> <a id="30113" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="30116" href="BitML.Semantics.Action.html#911" class="InductiveConstructor Operator">⟩</a> <a id="30118" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="30120" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="30122" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="30124" class="Symbol">;</a> <a id="30126" href="SecureCompilation.Coherence.html#30126" class="Bound">Γₜ</a> <a id="30129" class="Symbol">=</a> <a id="30131" href="SecureCompilation.Coherence.html#30063" class="Bound">Γ</a> <a id="30133" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="30136" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="30138" class="Keyword">in</a>

      <a id="30148" class="Symbol">(</a><a id="30149" href="SecureCompilation.Coherence.html#30149" class="Bound">cfg≈</a> <a id="30154" class="Symbol">:</a> <a id="30156" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a> <a id="30159" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="30162" href="SecureCompilation.Coherence.html#30126" class="Bound">Γₜ</a><a id="30164" class="Symbol">)</a>

    <a id="30171" class="Symbol">→</a> <a id="30173" class="Keyword">let</a>
        <a id="30185" href="SecureCompilation.Coherence.html#30185" class="Bound">α</a>   <a id="30189" class="Symbol">=</a> <a id="30191" href="BitML.Semantics.Label.html#739" class="InductiveConstructor Operator">divide⦅</a> <a id="30199" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30201" href="BitML.Semantics.Label.html#739" class="InductiveConstructor Operator">▷</a> <a id="30203" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="30205" href="BitML.Semantics.Label.html#739" class="InductiveConstructor Operator">,</a> <a id="30207" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="30210" href="BitML.Semantics.Label.html#739" class="InductiveConstructor Operator">⦆</a>
        <a id="30220" href="SecureCompilation.Coherence.html#30220" class="Bound">Γ′</a>  <a id="30224" class="Symbol">=</a> <a id="30226" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="30228" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30230" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="30234" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="30236" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="30240" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="30242" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="30244" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="30246" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30248" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="30252" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="30255" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="30259" href="BitML.BasicTypes.html#491" class="Generalizable">y′</a> <a id="30262" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="30264" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="30275" href="SecureCompilation.Coherence.html#30275" class="Bound">t′</a>  <a id="30279" class="Symbol">=</a> <a id="30281" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="30291" href="SecureCompilation.Coherence.html#30291" class="Bound">Γₜ′</a> <a id="30295" class="Symbol">=</a> <a id="30297" href="SecureCompilation.Coherence.html#30220" class="Bound">Γ′</a> <a id="30300" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="30303" href="SecureCompilation.Coherence.html#30275" class="Bound">t′</a>
      <a id="30312" class="Keyword">in</a>
      <a id="30321" class="Symbol">(</a><a id="30322" href="SecureCompilation.Coherence.html#30322" class="Bound">∃Γ≈</a> <a id="30326" class="Symbol">:</a> <a id="30328" href="Data.Product.html#1369" class="Function">∃</a> <a id="30330" class="Symbol">(</a><a id="30331" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="30335" href="SecureCompilation.Coherence.html#30220" class="Bound">Γ′</a><a id="30337" class="Symbol">))</a> <a id="30340" class="Symbol">→</a>
      <a id="30348" class="Keyword">let</a>
        <a id="30360" href="SecureCompilation.Coherence.html#30360" class="Bound">Γ→Γ′</a> <a id="30365" class="Symbol">:</a> <a id="30367" href="SecureCompilation.Coherence.html#30126" class="Bound">Γₜ</a> <a id="30370" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="30373" href="SecureCompilation.Coherence.html#30185" class="Bound">α</a> <a id="30375" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="30379" href="SecureCompilation.Coherence.html#30291" class="Bound">Γₜ′</a>
        <a id="30391" href="SecureCompilation.Coherence.html#30360" class="Bound">Γ→Γ′</a> <a id="30396" class="Symbol">=</a> <a id="30398" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="30407" href="BitML.Semantics.InferenceRules.html#2071" class="InductiveConstructor">[DEP-Divide]</a> <a id="30420" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="30434" href="SecureCompilation.Coherence.html#30434" class="Bound">x∈</a> <a id="30437" class="Symbol">:</a> <a id="30439" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30441" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="30443" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="30450" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a>
        <a id="30461" href="SecureCompilation.Coherence.html#30434" class="Bound">x∈</a> <a id="30464" class="Symbol">=</a> <a id="30466" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="30481" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="30483" class="Symbol">{</a><a id="30484" href="SecureCompilation.Coherence.html#30063" class="Bound">Γ</a><a id="30485" class="Symbol">}{</a><a id="30487" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="30491" class="Symbol">(</a><a id="30492" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a> <a id="30495" class="Symbol">.</a><a id="30496" href="Prelude.Traces.html#527" class="Field">end</a><a id="30499" class="Symbol">)}</a> <a id="30502" class="Symbol">(</a><a id="30503" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="30509" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="30511" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="30517" href="SecureCompilation.Coherence.html#30149" class="Bound">cfg≈</a><a id="30521" class="Symbol">)</a> <a id="30523" class="Symbol">(</a><a id="30524" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="30529" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="30533" class="Symbol">)</a>

        <a id="30544" class="Comment">-- (iii) submit transaction T</a>
        <a id="30582" href="SecureCompilation.Coherence.html#30582" class="Bound">T</a>  <a id="30585" class="Symbol">=</a> <a id="30587" class="Number">1</a> <a id="30589" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="30591" class="Number">2</a> <a id="30593" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="30595" href="Bitcoin.Tx.Crypto.html#907" class="Function">sig⋆</a> <a id="30600" class="Symbol">(</a><a id="30601" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="30613" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="30615" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="30618" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="30620" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="30621" class="Symbol">)</a> <a id="30623" class="Keyword">record</a>
           <a id="30641" class="Symbol">{</a> <a id="30643" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="30651" class="Symbol">=</a> <a id="30653" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="30657" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="30665" class="Symbol">(</a><a id="30666" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="30673" class="Symbol">{</a><a id="30674" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a><a id="30675" class="Symbol">}</a> <a id="30677" href="SecureCompilation.Coherence.html#30434" class="Bound">x∈</a><a id="30679" class="Symbol">)</a> <a id="30681" href="Data.Vec.Base.html#5750" class="Function Operator">]</a>
           <a id="30694" class="Symbol">;</a> <a id="30696" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="30704" class="Symbol">=</a> <a id="30706" href="Bitcoin.Tx.Crypto.html#520" class="Function">wit⊥</a>
           <a id="30722" class="Symbol">;</a> <a id="30724" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="30732" class="Symbol">=</a> <a id="30734" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="30746" class="Number">0</a>
           <a id="30759" class="Symbol">;</a> <a id="30761" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="30769" class="Symbol">=</a> <a id="30771" class="Symbol">(</a><a id="30772" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="30774" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="30791" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="30794" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="30795" class="Symbol">)</a> <a id="30797" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="30799" class="Symbol">(</a><a id="30800" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="30803" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="30820" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="30823" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="30824" class="Symbol">)</a> <a id="30826" href="Data.Vec.Base.html#1053" class="InductiveConstructor Operator">∷</a> <a id="30828" href="Data.Vec.Base.html#1034" class="InductiveConstructor">[]</a>
           <a id="30842" class="Symbol">;</a> <a id="30844" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="30852" class="Symbol">=</a> <a id="30854" class="Number">0</a> <a id="30856" class="Symbol">}</a>
        <a id="30866" href="SecureCompilation.Coherence.html#30866" class="Bound">λᶜ</a> <a id="30869" class="Symbol">=</a> <a id="30871" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="30878" href="SecureCompilation.Coherence.html#30582" class="Bound">T</a>

        <a id="30889" class="Comment">-- (v) extend txout′ with {y↦T₀, y′↦T₁} (removing x↦T₀), sechash = sechash′, κ = κ′</a>
        <a id="30981" class="Keyword">open</a> <a id="30986" href="SymbolicModel.Helpers.html#22870" class="Module">H₁₃</a> <a id="30990" class="Symbol">{</a><a id="30991" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a><a id="30993" class="Symbol">}</a> <a id="30995" href="SecureCompilation.Coherence.html#30011" class="Bound">𝕣</a> <a id="30997" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="30999" href="SecureCompilation.Coherence.html#30185" class="Bound">α</a> <a id="31001" href="SecureCompilation.Coherence.html#30275" class="Bound">t′</a> <a id="31004" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="31006" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="31008" href="BitML.BasicTypes.html#414" class="Generalizable">v′</a> <a id="31011" href="SecureCompilation.Coherence.html#30049" class="Bound">x</a> <a id="31013" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="31016" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="31018" href="BitML.BasicTypes.html#491" class="Generalizable">y′</a> <a id="31021" href="SecureCompilation.Coherence.html#30149" class="Bound">cfg≈</a> <a id="31026" class="Symbol">(</a><a id="31027" href="SecureCompilation.Coherence.html#30582" class="Bound">T</a> <a id="31029" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="31032" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="31034" class="Symbol">)</a> <a id="31036" class="Symbol">(</a><a id="31037" href="SecureCompilation.Coherence.html#30582" class="Bound">T</a> <a id="31039" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="31042" href="Data.Fin.Patterns.html#408" class="InductiveConstructor">1F</a><a id="31044" class="Symbol">)</a> <a id="31046" href="SecureCompilation.Coherence.html#30360" class="Bound">Γ→Γ′</a> <a id="31051" href="SecureCompilation.Coherence.html#30322" class="Bound">∃Γ≈</a>
      <a id="31061" class="Keyword">in</a>
      <a id="31070" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="31149" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="31157" href="SecureCompilation.Coherence.html#30006" class="Bound">Rˢ</a> <a id="31160" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="31162" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="31165" href="SecureCompilation.Coherence.html#30866" class="Bound">λᶜ</a> <a id="31168" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="31174" class="Comment">-- ** Deposits: authorize donate (similar to [10])</a>
  <a id="coher₁₁.[14]"></a><a id="31227" href="SecureCompilation.Coherence.html#31227" class="InductiveConstructor">[14]</a> <a id="31232" class="Symbol">:</a> <a id="31234" class="Symbol">∀</a> <a id="31236" class="Symbol">{</a><a id="31237" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a><a id="31239" class="Symbol">}</a> <a id="31241" class="Symbol">{</a><a id="31242" href="SecureCompilation.Coherence.html#31242" class="Bound">𝕣</a> <a id="31244" class="Symbol">:</a> <a id="31246" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="31248" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a><a id="31250" class="Symbol">}</a> <a id="31252" class="Symbol">→</a> <a id="31254" class="Keyword">let</a> <a id="31258" class="Keyword">open</a> <a id="31263" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="31265" href="SecureCompilation.Coherence.html#31242" class="Bound">𝕣</a> <a id="31267" class="Keyword">in</a>
       <a id="31277" class="Symbol">∀</a> <a id="31279" class="Symbol">{</a><a id="31280" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31282" class="Symbol">:</a> <a id="31284" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="31286" class="Symbol">}</a> <a id="31288" class="Symbol">→</a> <a id="31290" class="Keyword">let</a> <a id="31294" href="SecureCompilation.Coherence.html#31294" class="Bound">Γ</a> <a id="31296" class="Symbol">=</a> <a id="31298" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="31300" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="31302" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="31306" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="31308" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="31312" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31314" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="31316" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="31318" class="Symbol">;</a> <a id="31320" href="SecureCompilation.Coherence.html#31320" class="Bound">Γₜ</a> <a id="31323" class="Symbol">=</a> <a id="31325" href="SecureCompilation.Coherence.html#31294" class="Bound">Γ</a> <a id="31327" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="31330" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="31332" class="Keyword">in</a>

      <a id="31342" class="Symbol">(</a><a id="31343" href="SecureCompilation.Coherence.html#31343" class="Bound">cfg≈</a> <a id="31348" class="Symbol">:</a> <a id="31350" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a> <a id="31353" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="31356" href="SecureCompilation.Coherence.html#31320" class="Bound">Γₜ</a><a id="31358" class="Symbol">)</a>

    <a id="31365" class="Symbol">→</a> <a id="31367" class="Keyword">let</a>
        <a id="31379" href="SecureCompilation.Coherence.html#31379" class="Bound">α</a>   <a id="31383" class="Symbol">=</a> <a id="31385" href="BitML.Semantics.Label.html#803" class="InductiveConstructor Operator">auth-donate⦅</a> <a id="31398" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="31400" href="BitML.Semantics.Label.html#803" class="InductiveConstructor Operator">,</a> <a id="31402" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31404" href="BitML.Semantics.Label.html#803" class="InductiveConstructor Operator">▷ᵈ</a> <a id="31407" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="31410" href="BitML.Semantics.Label.html#803" class="InductiveConstructor Operator">⦆</a>
        <a id="31420" href="SecureCompilation.Coherence.html#31420" class="Bound">Γ′</a>  <a id="31424" class="Symbol">=</a> <a id="31426" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="31428" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="31430" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="31434" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="31436" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="31440" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31442" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="31444" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="31446" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="31452" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31454" href="BitML.Semantics.Action.html#1003" class="InductiveConstructor Operator">▷ᵈ</a> <a id="31457" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="31460" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="31462" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="31464" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="31475" href="SecureCompilation.Coherence.html#31475" class="Bound">t′</a>  <a id="31479" class="Symbol">=</a> <a id="31481" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="31491" href="SecureCompilation.Coherence.html#31491" class="Bound">Γₜ′</a> <a id="31495" class="Symbol">=</a> <a id="31497" href="SecureCompilation.Coherence.html#31420" class="Bound">Γ′</a> <a id="31500" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="31503" href="SecureCompilation.Coherence.html#31475" class="Bound">t′</a>
      <a id="31512" class="Keyword">in</a>
      <a id="31521" class="Symbol">(</a><a id="31522" href="SecureCompilation.Coherence.html#31522" class="Bound">∃Γ≈</a> <a id="31526" class="Symbol">:</a> <a id="31528" href="Data.Product.html#1369" class="Function">∃</a> <a id="31530" class="Symbol">(</a><a id="31531" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="31535" href="SecureCompilation.Coherence.html#31420" class="Bound">Γ′</a><a id="31537" class="Symbol">))</a> <a id="31540" class="Symbol">→</a>
      <a id="31548" class="Keyword">let</a>
        <a id="31560" href="SecureCompilation.Coherence.html#31560" class="Bound">Γ→Γ′</a> <a id="31565" class="Symbol">:</a> <a id="31567" href="SecureCompilation.Coherence.html#31320" class="Bound">Γₜ</a> <a id="31570" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="31573" href="SecureCompilation.Coherence.html#31379" class="Bound">α</a> <a id="31575" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="31579" href="SecureCompilation.Coherence.html#31491" class="Bound">Γₜ′</a>
        <a id="31591" href="SecureCompilation.Coherence.html#31560" class="Bound">Γ→Γ′</a> <a id="31596" class="Symbol">=</a> <a id="31598" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="31607" href="BitML.Semantics.InferenceRules.html#2314" class="InductiveConstructor">[DEP-AuthDonate]</a> <a id="31624" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="31638" href="SecureCompilation.Coherence.html#31638" class="Bound">x∈</a> <a id="31641" class="Symbol">:</a> <a id="31643" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31645" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="31647" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="31654" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a>
        <a id="31665" href="SecureCompilation.Coherence.html#31638" class="Bound">x∈</a> <a id="31668" class="Symbol">=</a> <a id="31670" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="31685" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="31687" class="Symbol">{</a><a id="31688" href="SecureCompilation.Coherence.html#31294" class="Bound">Γ</a><a id="31689" class="Symbol">}{</a><a id="31691" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="31695" class="Symbol">(</a><a id="31696" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a> <a id="31699" class="Symbol">.</a><a id="31700" href="Prelude.Traces.html#527" class="Field">end</a><a id="31703" class="Symbol">)}</a> <a id="31706" class="Symbol">(</a><a id="31707" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="31713" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="31715" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="31721" href="SecureCompilation.Coherence.html#31343" class="Bound">cfg≈</a><a id="31725" class="Symbol">)</a> <a id="31727" class="Symbol">(</a><a id="31728" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="31733" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="31737" class="Symbol">)</a>
      <a id="31745" class="Keyword">in</a>
      <a id="31754" class="Symbol">(</a><a id="31755" href="SecureCompilation.Coherence.html#31755" class="Bound">∃λ</a> <a id="31758" class="Symbol">:</a> <a id="31760" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="31764" class="Symbol">(λ</a> <a id="31767" href="SecureCompilation.Coherence.html#31767" class="Bound">l</a> <a id="31769" class="Symbol">→</a> <a id="31771" href="Data.Product.html#1369" class="Function">∃</a> <a id="31773" class="Symbol">λ</a> <a id="31775" href="SecureCompilation.Coherence.html#31775" class="Bound">B</a> <a id="31777" class="Symbol">→</a> <a id="31779" href="Data.Product.html#1369" class="Function">∃</a> <a id="31781" class="Symbol">λ</a> <a id="31783" href="SecureCompilation.Coherence.html#31783" class="Bound">T</a>
                <a id="31801" class="Symbol">→</a> <a id="31803" class="Symbol">(</a><a id="31804" href="SecureCompilation.Coherence.html#31767" class="Bound">l</a> <a id="31806" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="31808" href="SecureCompilation.Coherence.html#31775" class="Bound">B</a> <a id="31810" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="31814" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="31816" href="SecureCompilation.Coherence.html#31783" class="Bound">T</a> <a id="31818" href="Bitcoin.Crypto.html#826" class="Field Operator">♯</a> <a id="31820" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="31821" class="Symbol">)</a>
                <a id="31839" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="31841" class="Symbol">(</a><a id="31842" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="31850" href="SecureCompilation.Coherence.html#31783" class="Bound">T</a> <a id="31852" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="31854" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="31858" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="31866" class="Symbol">(</a><a id="31867" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="31874" class="Symbol">{</a><a id="31875" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a><a id="31876" class="Symbol">}</a> <a id="31878" href="SecureCompilation.Coherence.html#31638" class="Bound">x∈</a><a id="31880" class="Symbol">)</a> <a id="31882" href="Data.Vec.Base.html#5750" class="Function Operator">]</a><a id="31883" class="Symbol">)</a>
                <a id="31901" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="31903" class="Symbol">(</a><a id="31904" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="31912" href="SecureCompilation.Coherence.html#31783" class="Bound">T</a> <a id="31914" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="31916" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="31920" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="31922" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="31939" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="31942" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="31945" href="Data.Vec.Base.html#5750" class="Function Operator">]</a><a id="31946" class="Symbol">)</a>
                <a id="31964" class="Symbol">)</a> <a id="31966" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="31968" class="Symbol">)</a>
    <a id="31974" class="Symbol">→</a> <a id="31976" class="Keyword">let</a>
        <a id="31988" href="SecureCompilation.Coherence.html#31988" class="Bound">T</a> <a id="31990" class="Symbol">:</a> <a id="31992" href="Bitcoin.Tx.Base.html#1255" class="Function">∃Tx</a>
        <a id="32004" href="SecureCompilation.Coherence.html#31988" class="Bound">T</a> <a id="32006" class="Symbol">=</a> <a id="32008" class="Number">1</a> <a id="32010" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="32012" class="Number">1</a> <a id="32014" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="32016" class="Symbol">(</a><a id="32017" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="32023" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="32025" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="32031" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="32033" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="32039" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="32041" href="Data.List.Relation.Unary.Any.html#2251" class="Function">L.Any.satisfied</a> <a id="32057" href="SecureCompilation.Coherence.html#31755" class="Bound">∃λ</a><a id="32059" class="Symbol">)</a>

        <a id="32070" class="Comment">-- (iii) broadcast transaction T, signed by A</a>
        <a id="32124" href="SecureCompilation.Coherence.html#32124" class="Bound">m′</a> <a id="32127" class="Symbol">=</a> <a id="32129" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="32131" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="32135" class="Symbol">(</a><a id="32136" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="32139" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a><a id="32140" class="Symbol">)</a> <a id="32142" href="SecureCompilation.Coherence.html#31988" class="Bound">T</a> <a id="32144" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="32154" href="SecureCompilation.Coherence.html#32154" class="Bound">λᶜ</a> <a id="32157" class="Symbol">=</a> <a id="32159" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="32161" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="32165" href="SecureCompilation.Coherence.html#32124" class="Bound">m′</a>

        <a id="32177" class="Comment">-- (v) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="32235" class="Keyword">open</a> <a id="32240" href="SymbolicModel.Helpers.html#23280" class="Module">H₁₄</a> <a id="32244" class="Symbol">{</a><a id="32245" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a><a id="32247" class="Symbol">}</a> <a id="32249" href="SecureCompilation.Coherence.html#31242" class="Bound">𝕣</a> <a id="32251" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="32253" href="SecureCompilation.Coherence.html#31379" class="Bound">α</a> <a id="32255" href="SecureCompilation.Coherence.html#31475" class="Bound">t′</a> <a id="32258" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32260" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="32262" href="SecureCompilation.Coherence.html#31280" class="Bound">x</a> <a id="32264" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="32267" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="32270" href="SecureCompilation.Coherence.html#31343" class="Bound">cfg≈</a> <a id="32275" href="SecureCompilation.Coherence.html#31560" class="Bound">Γ→Γ′</a> <a id="32280" href="SecureCompilation.Coherence.html#31522" class="Bound">∃Γ≈</a>
      <a id="32290" class="Keyword">in</a>
      <a id="32299" class="Comment">-- (iv) λᶜ is the first broadcast of m′ in Rᶜ after the first broadcast of T</a>
      <a id="32382" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="32386" class="Symbol">(λ</a> <a id="32389" href="SecureCompilation.Coherence.html#32389" class="Bound">l</a> <a id="32391" class="Symbol">→</a> <a id="32393" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="32395" href="Data.Product.html#1369" class="Function">∃</a> <a id="32397" class="Symbol">λ</a> <a id="32399" href="SecureCompilation.Coherence.html#32399" class="Bound">B</a> <a id="32401" class="Symbol">→</a> <a id="32403" href="SecureCompilation.Coherence.html#32389" class="Bound">l</a> <a id="32405" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="32407" href="SecureCompilation.Coherence.html#32399" class="Bound">B</a> <a id="32409" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="32413" href="SecureCompilation.Coherence.html#32124" class="Bound">m′</a><a id="32415" class="Symbol">)</a> <a id="32417" class="Symbol">(</a><a id="32418" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="32427" href="SecureCompilation.Coherence.html#31755" class="Bound">∃λ</a><a id="32429" class="Symbol">)</a>
      <a id="32437" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="32514" class="Symbol">→</a> <a id="32516" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="32524" href="SecureCompilation.Coherence.html#31237" class="Bound">Rˢ</a> <a id="32527" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="32529" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="32532" href="SecureCompilation.Coherence.html#32154" class="Bound">λᶜ</a> <a id="32535" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="32541" class="Comment">-- ** Deposits: donate (similar to [11])</a>
  <a id="coher₁₁.[15]"></a><a id="32584" href="SecureCompilation.Coherence.html#32584" class="InductiveConstructor">[15]</a> <a id="32589" class="Symbol">:</a> <a id="32591" class="Symbol">∀</a> <a id="32593" class="Symbol">{</a><a id="32594" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a><a id="32596" class="Symbol">}</a> <a id="32598" class="Symbol">{</a><a id="32599" href="SecureCompilation.Coherence.html#32599" class="Bound">𝕣</a> <a id="32601" class="Symbol">:</a> <a id="32603" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="32605" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a><a id="32607" class="Symbol">}</a> <a id="32609" class="Symbol">→</a> <a id="32611" class="Keyword">let</a> <a id="32615" class="Keyword">open</a> <a id="32620" href="SymbolicModel.Collections.html#3950" class="Module">ℝ</a> <a id="32622" href="SecureCompilation.Coherence.html#32599" class="Bound">𝕣</a> <a id="32624" class="Keyword">in</a>
       <a id="32634" class="Symbol">∀</a> <a id="32636" class="Symbol">{</a><a id="32637" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="32639" class="Symbol">:</a> <a id="32641" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="32643" class="Symbol">}</a> <a id="32645" class="Symbol">→</a> <a id="32647" class="Keyword">let</a> <a id="32651" href="SecureCompilation.Coherence.html#32651" class="Bound">Γ</a> <a id="32653" class="Symbol">=</a> <a id="32655" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="32657" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32659" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="32663" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="32665" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="32669" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="32671" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="32673" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="32675" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="32681" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="32683" href="BitML.Semantics.Action.html#1003" class="InductiveConstructor Operator">▷ᵈ</a> <a id="32686" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="32689" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="32691" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="32693" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a><a id="32695" class="Symbol">;</a> <a id="32697" href="SecureCompilation.Coherence.html#32697" class="Bound">Γₜ</a> <a id="32700" class="Symbol">=</a> <a id="32702" href="SecureCompilation.Coherence.html#32651" class="Bound">Γ</a> <a id="32704" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="32707" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="32709" class="Keyword">in</a>

      <a id="32719" class="Symbol">(</a><a id="32720" href="SecureCompilation.Coherence.html#32720" class="Bound">cfg≈</a> <a id="32725" class="Symbol">:</a> <a id="32727" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a> <a id="32730" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="32733" href="SecureCompilation.Coherence.html#32697" class="Bound">Γₜ</a><a id="32735" class="Symbol">)</a>

    <a id="32742" class="Symbol">→</a> <a id="32744" class="Keyword">let</a>
        <a id="32756" href="SecureCompilation.Coherence.html#32756" class="Bound">α</a>   <a id="32760" class="Symbol">=</a> <a id="32762" href="BitML.Semantics.Label.html#875" class="InductiveConstructor Operator">donate⦅</a> <a id="32770" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="32772" href="BitML.Semantics.Label.html#875" class="InductiveConstructor Operator">▷ᵈ</a> <a id="32775" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="32778" href="BitML.Semantics.Label.html#875" class="InductiveConstructor Operator">⦆</a>
        <a id="32788" href="SecureCompilation.Coherence.html#32788" class="Bound">Γ′</a>  <a id="32792" class="Symbol">=</a> <a id="32794" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="32796" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="32799" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="32803" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="32805" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="32809" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="32811" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="32813" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="32824" href="SecureCompilation.Coherence.html#32824" class="Bound">t′</a>  <a id="32828" class="Symbol">=</a> <a id="32830" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="32840" href="SecureCompilation.Coherence.html#32840" class="Bound">Γₜ′</a> <a id="32844" class="Symbol">=</a> <a id="32846" href="SecureCompilation.Coherence.html#32788" class="Bound">Γ′</a> <a id="32849" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="32852" href="SecureCompilation.Coherence.html#32824" class="Bound">t′</a>
      <a id="32861" class="Keyword">in</a>
      <a id="32870" class="Symbol">(</a><a id="32871" href="SecureCompilation.Coherence.html#32871" class="Bound">∃Γ≈</a> <a id="32875" class="Symbol">:</a> <a id="32877" href="Data.Product.html#1369" class="Function">∃</a> <a id="32879" class="Symbol">(</a><a id="32880" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="32884" href="SecureCompilation.Coherence.html#32788" class="Bound">Γ′</a><a id="32886" class="Symbol">))</a> <a id="32889" class="Symbol">→</a>
      <a id="32897" class="Keyword">let</a>
        <a id="32909" href="SecureCompilation.Coherence.html#32909" class="Bound">Γ→Γ′</a> <a id="32914" class="Symbol">:</a> <a id="32916" href="SecureCompilation.Coherence.html#32697" class="Bound">Γₜ</a> <a id="32919" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="32922" href="SecureCompilation.Coherence.html#32756" class="Bound">α</a> <a id="32924" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="32928" href="SecureCompilation.Coherence.html#32840" class="Bound">Γₜ′</a>
        <a id="32940" href="SecureCompilation.Coherence.html#32909" class="Bound">Γ→Γ′</a> <a id="32945" class="Symbol">=</a> <a id="32947" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="32956" href="BitML.Semantics.InferenceRules.html#2528" class="InductiveConstructor">[DEP-Donate]</a> <a id="32969" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="32983" href="SecureCompilation.Coherence.html#32983" class="Bound">x∈</a> <a id="32986" class="Symbol">:</a> <a id="32988" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="32990" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="32992" href="BitML.Contracts.Helpers.html#3662" class="Function">namesʳ</a> <a id="32999" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a>
        <a id="33010" href="SecureCompilation.Coherence.html#32983" class="Bound">x∈</a> <a id="33013" class="Symbol">=</a> <a id="33015" href="BitML.Semantics.Configurations.Helpers.html#8022" class="Function">∈namesʳ-resp-≈</a> <a id="33030" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="33032" class="Symbol">{</a><a id="33033" href="SecureCompilation.Coherence.html#32651" class="Bound">Γ</a><a id="33034" class="Symbol">}{</a><a id="33036" href="BitML.Semantics.Configurations.Types.html#1764" class="Field">cfg</a> <a id="33040" class="Symbol">(</a><a id="33041" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a> <a id="33044" class="Symbol">.</a><a id="33045" href="Prelude.Traces.html#527" class="Field">end</a><a id="33048" class="Symbol">)}</a> <a id="33051" class="Symbol">(</a><a id="33052" href="Data.List.Relation.Binary.Permutation.Propositional.html#1455" class="Function">↭-sym</a> <a id="33058" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="33060" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="33066" href="SecureCompilation.Coherence.html#32720" class="Bound">cfg≈</a><a id="33070" class="Symbol">)</a> <a id="33072" class="Symbol">(</a><a id="33073" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="33078" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="33082" class="Symbol">)</a>

        <a id="33093" class="Comment">-- (iii) submit transaction T</a>
        <a id="33131" href="SecureCompilation.Coherence.html#33131" class="Bound">T</a>  <a id="33134" class="Symbol">=</a> <a id="33136" class="Number">1</a> <a id="33138" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="33140" class="Number">1</a> <a id="33142" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="33144" href="Bitcoin.Tx.Crypto.html#907" class="Function">sig⋆</a> <a id="33149" class="Symbol">(</a><a id="33150" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="33162" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="33164" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="33167" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="33169" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="33170" class="Symbol">)</a> <a id="33172" class="Keyword">record</a>
           <a id="33190" class="Symbol">{</a> <a id="33192" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a>  <a id="33200" class="Symbol">=</a> <a id="33202" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="33206" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="33214" class="Symbol">(</a><a id="33215" href="SymbolicModel.Collections.html#4024" class="Field">txout′</a> <a id="33222" class="Symbol">{</a><a id="33223" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a><a id="33224" class="Symbol">}</a> <a id="33226" href="SecureCompilation.Coherence.html#32983" class="Bound">x∈</a><a id="33228" class="Symbol">)</a> <a id="33230" href="Data.Vec.Base.html#5750" class="Function Operator">]</a>
           <a id="33243" class="Symbol">;</a> <a id="33245" href="Bitcoin.Tx.Base.html#981" class="Field">wit</a>     <a id="33253" class="Symbol">=</a> <a id="33255" href="Bitcoin.Tx.Crypto.html#520" class="Function">wit⊥</a>
           <a id="33271" class="Symbol">;</a> <a id="33273" href="Bitcoin.Tx.Base.html#1036" class="Field">relLock</a> <a id="33281" class="Symbol">=</a> <a id="33283" href="Data.Vec.Base.html#5784" class="Function">V.replicate</a> <a id="33295" class="Number">0</a>
           <a id="33308" class="Symbol">;</a> <a id="33310" href="Bitcoin.Tx.Base.html#1090" class="Field">outputs</a> <a id="33318" class="Symbol">=</a> <a id="33320" href="Data.Vec.Base.html#5750" class="Function Operator">V.[</a> <a id="33324" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="33326" href="SecureCompilation.Coherence.html#1439" class="Function Operator">-redeemableWith-</a> <a id="33343" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="33346" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="33349" href="Data.Vec.Base.html#5750" class="Function Operator">]</a>
           <a id="33362" class="Symbol">;</a> <a id="33364" href="Bitcoin.Tx.Base.html#1132" class="Field">absLock</a> <a id="33372" class="Symbol">=</a> <a id="33374" class="Number">0</a> <a id="33376" class="Symbol">}</a>
        <a id="33386" href="SecureCompilation.Coherence.html#33386" class="Bound">λᶜ</a> <a id="33389" class="Symbol">=</a> <a id="33391" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="33398" href="SecureCompilation.Coherence.html#33131" class="Bound">T</a>

        <a id="33409" class="Comment">-- (v) extend txout′ with y↦T₀ (removing x↦T₀), sechash = sechash′, κ = κ′</a>
        <a id="33492" class="Keyword">open</a> <a id="33497" href="SymbolicModel.Helpers.html#23563" class="Module">H₁₅</a> <a id="33501" class="Symbol">{</a><a id="33502" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a><a id="33504" class="Symbol">}</a> <a id="33506" href="SecureCompilation.Coherence.html#32599" class="Bound">𝕣</a> <a id="33508" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="33510" href="SecureCompilation.Coherence.html#32756" class="Bound">α</a> <a id="33512" href="SecureCompilation.Coherence.html#32824" class="Bound">t′</a> <a id="33515" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="33517" href="BitML.BasicTypes.html#412" class="Generalizable">v</a> <a id="33519" href="SecureCompilation.Coherence.html#32637" class="Bound">x</a> <a id="33521" href="BitML.Contracts.Types.html#522" class="Generalizable">B′</a> <a id="33524" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="33527" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="33529" href="SecureCompilation.Coherence.html#32720" class="Bound">cfg≈</a> <a id="33534" class="Symbol">(</a><a id="33535" href="SecureCompilation.Coherence.html#33131" class="Bound">T</a> <a id="33537" href="Bitcoin.Tx.Base.html#1828" class="InductiveConstructor Operator">at</a> <a id="33540" href="Data.Fin.Patterns.html#390" class="InductiveConstructor">0F</a><a id="33542" class="Symbol">)</a> <a id="33544" href="SecureCompilation.Coherence.html#32909" class="Bound">Γ→Γ′</a> <a id="33549" href="SecureCompilation.Coherence.html#32871" class="Bound">∃Γ≈</a>
      <a id="33559" class="Keyword">in</a>
      <a id="33568" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
      <a id="33647" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="33655" href="SecureCompilation.Coherence.html#32594" class="Bound">Rˢ</a> <a id="33658" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="33660" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="33663" href="SecureCompilation.Coherence.html#33386" class="Bound">λᶜ</a> <a id="33666" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="33672" class="Comment">-- ** After</a>
  <a id="coher₁₁.[18]"></a><a id="33686" href="SecureCompilation.Coherence.html#33686" class="InductiveConstructor">[18]</a> <a id="33691" class="Symbol">:</a>
    <a id="33697" class="Symbol">(</a><a id="33698" href="SecureCompilation.Coherence.html#33698" class="Bound">δ&gt;0</a> <a id="33702" class="Symbol">:</a> <a id="33704" href="BitML.BasicTypes.html#525" class="Generalizable">δ</a> <a id="33706" href="Prelude.Ord.html#286" class="Function Operator">&gt;</a> <a id="33708" class="Number">0</a><a id="33709" class="Symbol">)</a> <a id="33711" class="Symbol">→</a>
    <a id="33717" class="Keyword">let</a>
      <a id="33727" href="SecureCompilation.Coherence.html#33727" class="Bound">Γₜ</a><a id="33729" class="Symbol">@(</a><a id="33731" href="SecureCompilation.Coherence.html#33731" class="Bound">Γ</a> <a id="33733" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="33736" href="SecureCompilation.Coherence.html#33736" class="Bound">t</a><a id="33737" class="Symbol">)</a> <a id="33739" class="Symbol">=</a> <a id="33741" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="33744" class="Symbol">.</a><a id="33745" href="Prelude.Traces.html#527" class="Field">end</a>
      <a id="33755" href="SecureCompilation.Coherence.html#33755" class="Bound">α</a>   <a id="33759" class="Symbol">=</a> <a id="33761" href="BitML.Semantics.Label.html#1632" class="InductiveConstructor Operator">delay⦅</a> <a id="33768" href="BitML.BasicTypes.html#525" class="Generalizable">δ</a> <a id="33770" href="BitML.Semantics.Label.html#1632" class="InductiveConstructor Operator">⦆</a>
      <a id="33778" href="SecureCompilation.Coherence.html#33778" class="Bound">t′</a>  <a id="33782" class="Symbol">=</a> <a id="33784" class="Symbol">(</a><a id="33785" href="SecureCompilation.Coherence.html#33736" class="Bound">t</a> <a id="33787" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="33789" href="BitML.BasicTypes.html#525" class="Generalizable">δ</a><a id="33790" class="Symbol">)</a>
      <a id="33798" href="SecureCompilation.Coherence.html#33798" class="Bound">Γₜ′</a> <a id="33802" class="Symbol">=</a> <a id="33804" href="SecureCompilation.Coherence.html#33731" class="Bound">Γ</a> <a id="33806" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="33809" href="SecureCompilation.Coherence.html#33778" class="Bound">t′</a>
      <a id="33818" href="SecureCompilation.Coherence.html#33818" class="Bound">λᶜ</a>  <a id="33822" class="Symbol">=</a> <a id="33824" href="ComputationalModel.Strategy.html#970" class="InductiveConstructor">delay</a> <a id="33830" href="BitML.BasicTypes.html#525" class="Generalizable">δ</a>
    <a id="33836" class="Keyword">in</a>
    <a id="33843" class="Symbol">(</a><a id="33844" href="SecureCompilation.Coherence.html#33844" class="Bound">∃Γ≈</a> <a id="33848" class="Symbol">:</a> <a id="33850" href="Data.Product.html#1369" class="Function">∃</a> <a id="33852" class="Symbol">(</a><a id="33853" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="33857" href="SecureCompilation.Coherence.html#33731" class="Bound">Γ</a><a id="33858" class="Symbol">))</a> <a id="33861" class="Symbol">→</a>
    <a id="33867" class="Keyword">let</a>
      <a id="33877" href="SecureCompilation.Coherence.html#33877" class="Bound">Γ→Γ′</a> <a id="33882" class="Symbol">:</a> <a id="33884" href="SecureCompilation.Coherence.html#33727" class="Bound">Γₜ</a> <a id="33887" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="33890" href="SecureCompilation.Coherence.html#33755" class="Bound">α</a> <a id="33892" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="33896" href="SecureCompilation.Coherence.html#33798" class="Bound">Γₜ′</a>
      <a id="33906" href="SecureCompilation.Coherence.html#33877" class="Bound">Γ→Γ′</a> <a id="33911" class="Symbol">=</a> <a id="33913" href="BitML.Semantics.InferenceRules.html#8551" class="InductiveConstructor">[Delay]</a> <a id="33921" href="SecureCompilation.Coherence.html#33698" class="Bound">δ&gt;0</a>

      <a id="33932" class="Keyword">open</a> <a id="33937" href="SymbolicModel.Helpers.html#26836" class="Module">H₁₈</a> <a id="33941" class="Symbol">{</a><a id="33942" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="33944" class="Symbol">}</a> <a id="33946" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="33948" href="SecureCompilation.Coherence.html#33736" class="Bound">t</a> <a id="33950" href="SecureCompilation.Coherence.html#33755" class="Bound">α</a> <a id="33952" href="SecureCompilation.Coherence.html#33778" class="Bound">t′</a> <a id="33955" href="SecureCompilation.Coherence.html#33731" class="Bound">Γ</a> <a id="33957" class="Symbol">(</a><a id="33958" href="SymbolicModel.Run.html#1870" class="Function">≈ᵗ-refl</a> <a id="33966" class="Symbol">{</a><a id="33967" href="SecureCompilation.Coherence.html#33727" class="Bound">Γₜ</a><a id="33969" class="Symbol">})</a> <a id="33972" href="SecureCompilation.Coherence.html#33877" class="Bound">Γ→Γ′</a> <a id="33977" href="SecureCompilation.Coherence.html#33844" class="Bound">∃Γ≈</a>
    <a id="33985" class="Keyword">in</a>
    <a id="33992" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="34069" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="34077" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="34080" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="34082" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="34085" href="SecureCompilation.Coherence.html#33818" class="Bound">λᶜ</a> <a id="34088" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

<a id="34092" class="Keyword">data</a> <a id="34097" href="SecureCompilation.Coherence.html#2291" class="Datatype">coher₁₂</a> <a id="34105" class="Keyword">where</a>

  <a id="34114" class="Comment">-- ** Deposits: authorize destroy</a>
  <a id="coher₁₂.[16]"></a><a id="34150" href="SecureCompilation.Coherence.html#34150" class="InductiveConstructor">[16]</a> <a id="34155" class="Symbol">:</a> <a id="34157" class="Symbol">∀</a> <a id="34159" class="Symbol">{</a><a id="34160" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a> <a id="34163" class="Symbol">:</a> <a id="34165" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="34170" class="Symbol">(</a><a id="34171" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="34183" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="34185" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="34193" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="34195" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="34197" class="Symbol">)}</a> <a id="34200" class="Symbol">{</a><a id="34201" href="SecureCompilation.Coherence.html#34201" class="Bound">j</a> <a id="34203" class="Symbol">:</a> <a id="34205" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="34211" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a><a id="34213" class="Symbol">}</a> <a id="34215" class="Symbol">{</a><a id="34216" href="SecureCompilation.Coherence.html#34216" class="Bound">xs</a> <a id="34219" class="Symbol">:</a> <a id="34221" href="BitML.BasicTypes.html#314" class="Function">Ids</a><a id="34224" class="Symbol">}</a>

    <a id="34231" class="Symbol">→</a> <a id="34233" class="Keyword">let</a>
        <a id="34245" href="SecureCompilation.Coherence.html#34245" class="Bound">k</a>  <a id="34248" class="Symbol">=</a> <a id="34250" href="Data.List.Base.html#4864" class="Function">length</a> <a id="34257" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a>
        <a id="34268" href="SecureCompilation.Coherence.html#34268" class="Bound">xs</a> <a id="34271" class="Symbol">=</a> <a id="34273" href="Data.List.Base.html#1544" class="Function">map</a> <a id="34277" class="Symbol">(</a><a id="34278" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="34284" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="34286" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="34291" class="Symbol">)</a> <a id="34293" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a>
        <a id="34304" href="SecureCompilation.Coherence.html#34304" class="Bound">A</a>  <a id="34307" class="Symbol">=</a> <a id="34309" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="34315" class="Symbol">(</a><a id="34316" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a> <a id="34319" href="Prelude.Lists.html#1259" class="Function Operator">‼</a> <a id="34321" href="SecureCompilation.Coherence.html#34201" class="Bound">j</a><a id="34322" class="Symbol">)</a>
        <a id="34332" href="SecureCompilation.Coherence.html#34332" class="Bound">j′</a> <a id="34335" class="Symbol">=</a> <a id="34337" href="Prelude.Lists.html#4855" class="Function">‼-map</a> <a id="34343" class="Symbol">{</a><a id="34344" class="Argument">xs</a> <a id="34347" class="Symbol">=</a> <a id="34349" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a><a id="34351" class="Symbol">}</a> <a id="34353" href="SecureCompilation.Coherence.html#34201" class="Bound">j</a>
        <a id="34363" href="SecureCompilation.Coherence.html#34363" class="Bound">Δ</a>  <a id="34366" class="Symbol">=</a> <a id="34368" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="34371" href="Data.List.Base.html#1544" class="Function">map</a> <a id="34375" class="Symbol">(λ{</a> <a id="34379" class="Symbol">(</a><a id="34380" href="SecureCompilation.Coherence.html#34380" class="Bound">Bᵢ</a> <a id="34383" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="34385" href="SecureCompilation.Coherence.html#34385" class="Bound">vᵢ</a> <a id="34388" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="34390" href="SecureCompilation.Coherence.html#34390" class="Bound">xᵢ</a><a id="34392" class="Symbol">)</a> <a id="34394" class="Symbol">→</a> <a id="34396" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="34398" href="SecureCompilation.Coherence.html#34380" class="Bound">Bᵢ</a> <a id="34401" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="34405" href="SecureCompilation.Coherence.html#34385" class="Bound">vᵢ</a> <a id="34408" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="34412" href="SecureCompilation.Coherence.html#34390" class="Bound">xᵢ</a> <a id="34415" class="Symbol">})</a> <a id="34418" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a>
        <a id="34429" href="SecureCompilation.Coherence.html#34429" class="Bound">Γ</a>  <a id="34432" class="Symbol">=</a> <a id="34434" href="SecureCompilation.Coherence.html#34363" class="Bound">Δ</a> <a id="34436" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="34438" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="34449" href="SecureCompilation.Coherence.html#34449" class="Bound">Γₜ</a> <a id="34452" class="Symbol">=</a> <a id="34454" href="SecureCompilation.Coherence.html#34429" class="Bound">Γ</a> <a id="34456" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="34459" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
      <a id="34467" class="Keyword">in</a>
      <a id="34476" class="Comment">-- (ii) in Rˢ we find ⟨Bᵢ,vᵢ⟩yᵢ for i ∈ 1..k</a>
      <a id="34527" class="Symbol">(</a><a id="34528" href="SecureCompilation.Coherence.html#34528" class="Bound">cfg≈</a> <a id="34533" class="Symbol">:</a> <a id="34535" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="34538" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="34541" href="SecureCompilation.Coherence.html#34449" class="Bound">Γₜ</a><a id="34543" class="Symbol">)</a>

    <a id="34550" class="Symbol">→</a> <a id="34552" class="Keyword">let</a>
        <a id="34564" href="SecureCompilation.Coherence.html#34564" class="Bound">α</a>   <a id="34568" class="Symbol">=</a> <a id="34570" href="BitML.Semantics.Label.html#933" class="InductiveConstructor Operator">auth-destroy⦅</a> <a id="34584" href="SecureCompilation.Coherence.html#34304" class="Bound">A</a> <a id="34586" href="BitML.Semantics.Label.html#933" class="InductiveConstructor Operator">,</a> <a id="34588" href="SecureCompilation.Coherence.html#34268" class="Bound">xs</a> <a id="34591" href="BitML.Semantics.Label.html#933" class="InductiveConstructor Operator">,</a> <a id="34593" href="SecureCompilation.Coherence.html#34332" class="Bound">j′</a> <a id="34596" href="BitML.Semantics.Label.html#933" class="InductiveConstructor Operator">⦆</a>
        <a id="34606" href="SecureCompilation.Coherence.html#34606" class="Bound">Γ′</a>  <a id="34610" class="Symbol">=</a> <a id="34612" href="SecureCompilation.Coherence.html#34363" class="Bound">Δ</a> <a id="34614" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="34616" href="SecureCompilation.Coherence.html#34304" class="Bound">A</a> <a id="34618" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="34624" href="SecureCompilation.Coherence.html#34268" class="Bound">xs</a> <a id="34627" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">,</a> <a id="34629" href="SecureCompilation.Coherence.html#34332" class="Bound">j′</a> <a id="34632" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">▷ᵈˢ</a> <a id="34636" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="34638" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="34640" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="34642" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="34653" href="SecureCompilation.Coherence.html#34653" class="Bound">t′</a>  <a id="34657" class="Symbol">=</a> <a id="34659" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="34669" href="SecureCompilation.Coherence.html#34669" class="Bound">Γₜ′</a> <a id="34673" class="Symbol">=</a> <a id="34675" href="SecureCompilation.Coherence.html#34606" class="Bound">Γ′</a> <a id="34678" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="34681" href="SecureCompilation.Coherence.html#34653" class="Bound">t′</a>
      <a id="34690" class="Keyword">in</a>
      <a id="34699" class="Symbol">(</a><a id="34700" href="SecureCompilation.Coherence.html#34700" class="Bound">∃Γ≈</a> <a id="34704" class="Symbol">:</a> <a id="34706" href="Data.Product.html#1369" class="Function">∃</a> <a id="34708" class="Symbol">(</a><a id="34709" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="34713" href="SecureCompilation.Coherence.html#34606" class="Bound">Γ′</a><a id="34715" class="Symbol">))</a> <a id="34718" class="Symbol">→</a>
      <a id="34726" class="Keyword">let</a>
        <a id="34738" href="SecureCompilation.Coherence.html#34738" class="Bound">Γ→Γ′</a> <a id="34743" class="Symbol">:</a> <a id="34745" href="SecureCompilation.Coherence.html#34449" class="Bound">Γₜ</a> <a id="34748" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="34751" href="SecureCompilation.Coherence.html#34564" class="Bound">α</a> <a id="34753" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="34757" href="SecureCompilation.Coherence.html#34669" class="Bound">Γₜ′</a>
        <a id="34769" href="SecureCompilation.Coherence.html#34738" class="Bound">Γ→Γ′</a> <a id="34774" class="Symbol">=</a> <a id="34776" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="34785" href="BitML.Semantics.InferenceRules.html#2729" class="InductiveConstructor">[DEP-AuthDestroy]</a> <a id="34803" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="34817" class="Comment">-- (vii) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="34877" class="Keyword">open</a> <a id="34882" href="SymbolicModel.Helpers.html#24119" class="Module">H₁₆</a> <a id="34886" class="Symbol">{</a><a id="34887" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="34889" class="Symbol">}</a> <a id="34891" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="34893" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="34895" href="SecureCompilation.Coherence.html#34564" class="Bound">α</a> <a id="34897" href="SecureCompilation.Coherence.html#34653" class="Bound">t′</a> <a id="34900" href="SecureCompilation.Coherence.html#34160" class="Bound">ds</a> <a id="34903" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>  <a id="34907" href="SecureCompilation.Coherence.html#34201" class="Bound">j</a> <a id="34909" href="SecureCompilation.Coherence.html#34304" class="Bound">A</a> <a id="34911" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="34913" href="SecureCompilation.Coherence.html#34528" class="Bound">cfg≈</a> <a id="34918" href="SecureCompilation.Coherence.html#34738" class="Bound">Γ→Γ′</a> <a id="34923" href="SecureCompilation.Coherence.html#34700" class="Bound">∃Γ≈</a>
      <a id="34933" class="Keyword">in</a>
      <a id="34942" class="Comment">-- (iii) in Rᶜ we find B → ∗ ∶ T, for some T having txout′(yᵢ) as inputs (+ possibly others)</a>
      <a id="35041" class="Symbol">(</a><a id="35042" href="SecureCompilation.Coherence.html#35042" class="Bound">T</a> <a id="35044" class="Symbol">:</a> <a id="35046" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="35049" href="Bitcoin.Tx.Base.html#1914" class="Generalizable">i</a> <a id="35051" class="Number">0</a><a id="35052" class="Symbol">)</a>
    <a id="35058" class="Symbol">→</a> <a id="35060" class="Symbol">(</a><a id="35061" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="35069" href="Category.Functor.html#608" class="Field Operator">&lt;$&gt;</a> <a id="35073" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="35079" href="SymbolicModel.Helpers.html#24418" class="Function">xs↦</a><a id="35082" class="Symbol">)</a> <a id="35084" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="35086" href="Data.Vec.Base.html#7438" class="Function">V.toList</a> <a id="35095" class="Symbol">(</a><a id="35096" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a> <a id="35103" href="SecureCompilation.Coherence.html#35042" class="Bound">T</a><a id="35104" class="Symbol">)</a>
    <a id="35110" class="Symbol">→</a> <a id="35112" class="Symbol">(</a><a id="35113" href="SecureCompilation.Coherence.html#35113" class="Bound">T∈</a> <a id="35116" class="Symbol">:</a> <a id="35118" href="Data.List.Relation.Unary.Any.html#1156" class="Datatype">Any</a> <a id="35122" class="Symbol">(λ</a> <a id="35125" href="SecureCompilation.Coherence.html#35125" class="Bound">l</a> <a id="35127" class="Symbol">→</a> <a id="35129" href="Data.Product.html#1369" class="Function">∃</a> <a id="35131" class="Symbol">λ</a> <a id="35133" href="SecureCompilation.Coherence.html#35133" class="Bound">B</a> <a id="35135" class="Symbol">→</a> <a id="35137" href="SecureCompilation.Coherence.html#35125" class="Bound">l</a> <a id="35139" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="35141" href="SecureCompilation.Coherence.html#35133" class="Bound">B</a> <a id="35143" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="35147" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="35149" href="SecureCompilation.Coherence.html#35042" class="Bound">T</a> <a id="35151" href="Bitcoin.Crypto.html#826" class="Field Operator">♯</a> <a id="35153" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="35154" class="Symbol">)</a> <a id="35156" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a><a id="35158" class="Symbol">)</a>

    <a id="35165" class="Symbol">→</a> <a id="35167" class="Keyword">let</a>
        <a id="35179" class="Comment">-- (iv) broadcast transaction T, signed by A</a>
        <a id="35232" href="SecureCompilation.Coherence.html#35232" class="Bound">m</a> <a id="35234" class="Symbol">=</a> <a id="35236" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="35238" href="Bitcoin.Crypto.html#654" class="Postulate">SIG</a> <a id="35242" class="Symbol">(</a><a id="35243" href="ComputationalModel.KeyPairs.html#297" class="Function">K̂</a> <a id="35246" href="SecureCompilation.Coherence.html#34304" class="Bound">A</a><a id="35247" class="Symbol">)</a> <a id="35249" href="SecureCompilation.Coherence.html#35042" class="Bound">T</a> <a id="35251" href="Data.List.Base.html#5025" class="Function Operator">]</a>
        <a id="35261" href="SecureCompilation.Coherence.html#35261" class="Bound">λᶜ</a> <a id="35264" class="Symbol">=</a> <a id="35266" href="BitML.Contracts.Types.html#517" class="Generalizable">B</a> <a id="35268" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="35272" href="SecureCompilation.Coherence.html#35232" class="Bound">m</a>
      <a id="35280" class="Keyword">in</a>
      <a id="35289" class="Comment">-- (v) λᶜ is the first broadcast of m in Rᶜ after the first broadcast of T</a>
      <a id="35370" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="35374" class="Symbol">(λ</a> <a id="35377" href="SecureCompilation.Coherence.html#35377" class="Bound">l</a> <a id="35379" class="Symbol">→</a> <a id="35381" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="35383" href="Data.Product.html#1369" class="Function">∃</a> <a id="35385" class="Symbol">λ</a> <a id="35387" href="SecureCompilation.Coherence.html#35387" class="Bound">B</a> <a id="35389" class="Symbol">→</a> <a id="35391" href="SecureCompilation.Coherence.html#35377" class="Bound">l</a> <a id="35393" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="35395" href="SecureCompilation.Coherence.html#35387" class="Bound">B</a> <a id="35397" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="35401" href="SecureCompilation.Coherence.html#35232" class="Bound">m</a><a id="35402" class="Symbol">)</a> <a id="35404" class="Symbol">(</a><a id="35405" href="Prelude.Lists.html#24124" class="Function">Any-tail</a> <a id="35414" href="SecureCompilation.Coherence.html#35113" class="Bound">T∈</a><a id="35416" class="Symbol">)</a>

      <a id="35425" class="Comment">-- (vi) λᶜ does not correspond to any *other* symbolic move</a>
    <a id="35489" class="Symbol">→</a> <a id="35491" class="Symbol">(∀</a> <a id="35494" href="SecureCompilation.Coherence.html#35494" class="Bound">Γₜ′</a> <a id="35498" class="Symbol">(</a><a id="35499" href="SecureCompilation.Coherence.html#35499" class="Bound">𝕒′</a> <a id="35502" class="Symbol">:</a> <a id="35504" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="35506" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="35509" href="SecureCompilation.Coherence.html#35494" class="Bound">Γₜ′</a><a id="35512" class="Symbol">)</a> <a id="35514" class="Symbol">(</a><a id="35515" href="SecureCompilation.Coherence.html#35515" class="Bound">𝕣</a> <a id="35517" class="Symbol">:</a> <a id="35519" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="35521" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="35523" class="Symbol">)</a> <a id="35525" class="Symbol">(</a><a id="35526" href="SecureCompilation.Coherence.html#35526" class="Bound">𝕣′</a> <a id="35529" class="Symbol">:</a> <a id="35531" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="35533" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="35535" href="SecureCompilation.Coherence.html#35494" class="Bound">Γₜ′</a> <a id="35539" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="35541" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="35544" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="35546" href="SecureCompilation.Coherence.html#35499" class="Bound">𝕒′</a><a id="35548" class="Symbol">)</a>
         <a id="35559" class="Symbol">→</a> <a id="35561" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="35567" href="SecureCompilation.Coherence.html#35499" class="Bound">𝕒′</a> <a id="35570" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="35572" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="35578" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a>
         <a id="35589" class="Symbol">→</a> <a id="35591" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="35593" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="35601" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="35604" href="SecureCompilation.Coherence.html#35499" class="Bound">𝕒′</a> <a id="35607" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="35610" href="SecureCompilation.Coherence.html#35261" class="Bound">λᶜ</a> <a id="35613" href="SecureCompilation.Coherence.html#35526" class="Bound">𝕣′</a><a id="35615" class="Symbol">)</a>
      <a id="35623" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="35700" class="Symbol">→</a> <a id="35702" href="SecureCompilation.Coherence.html#2291" class="Datatype">coher₁₂</a> <a id="35710" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="35713" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="35715" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="35718" href="SecureCompilation.Coherence.html#35261" class="Bound">λᶜ</a> <a id="35721" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

  <a id="35727" class="Comment">-- ** Deposits: destroy</a>
  <a id="coher₁₂.[17]"></a><a id="35753" href="SecureCompilation.Coherence.html#35753" class="InductiveConstructor">[17]</a> <a id="35758" class="Symbol">:</a> <a id="35760" class="Symbol">∀</a> <a id="35762" class="Symbol">{</a><a id="35763" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a> <a id="35766" class="Symbol">:</a> <a id="35768" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="35773" class="Symbol">(</a><a id="35774" href="SecureCompilation.Coherence.html#488" class="Bound">Participant</a> <a id="35786" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="35788" href="BitML.BasicTypes.html#229" class="Function">S.Value</a> <a id="35796" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="35798" href="BitML.BasicTypes.html#301" class="Function">Id</a><a id="35800" class="Symbol">)}</a> <a id="35803" class="Symbol">{</a><a id="35804" href="SecureCompilation.Coherence.html#35804" class="Bound">j</a> <a id="35806" class="Symbol">:</a> <a id="35808" href="Prelude.Lists.html#1153" class="Function">Index</a> <a id="35814" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a><a id="35816" class="Symbol">}</a> <a id="35818" class="Symbol">{</a><a id="35819" href="SecureCompilation.Coherence.html#35819" class="Bound">xs</a> <a id="35822" class="Symbol">:</a> <a id="35824" href="BitML.BasicTypes.html#314" class="Function">Ids</a><a id="35827" class="Symbol">}</a>

    <a id="35834" class="Symbol">→</a> <a id="35836" class="Keyword">let</a>
        <a id="35848" href="SecureCompilation.Coherence.html#35848" class="Bound">xs</a> <a id="35851" class="Symbol">=</a> <a id="35853" href="Data.List.Base.html#1544" class="Function">map</a> <a id="35857" class="Symbol">(</a><a id="35858" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="35864" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="35866" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="35871" class="Symbol">)</a> <a id="35873" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a>
        <a id="35884" href="SecureCompilation.Coherence.html#35884" class="Bound">Δ</a>  <a id="35887" class="Symbol">=</a> <a id="35889" href="BitML.Semantics.Configurations.Types.html#1580" class="Function Operator">||</a> <a id="35892" href="Data.List.Base.html#1544" class="Function">map</a> <a id="35896" class="Symbol">(λ{</a> <a id="35900" class="Symbol">(</a><a id="35901" href="SecureCompilation.Coherence.html#35901" class="Bound">i</a> <a id="35903" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="35905" href="SecureCompilation.Coherence.html#35905" class="Bound">Aᵢ</a> <a id="35908" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="35910" href="SecureCompilation.Coherence.html#35910" class="Bound">vᵢ</a> <a id="35913" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="35915" href="SecureCompilation.Coherence.html#35915" class="Bound">xᵢ</a><a id="35917" class="Symbol">)</a> <a id="35919" class="Symbol">→</a> <a id="35921" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟨</a> <a id="35923" href="SecureCompilation.Coherence.html#35905" class="Bound">Aᵢ</a> <a id="35926" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">has</a> <a id="35930" href="SecureCompilation.Coherence.html#35910" class="Bound">vᵢ</a> <a id="35933" href="BitML.Semantics.Configurations.Types.html#937" class="InductiveConstructor Operator">⟩at</a> <a id="35937" href="SecureCompilation.Coherence.html#35915" class="Bound">xᵢ</a> <a id="35940" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="35942" href="SecureCompilation.Coherence.html#35905" class="Bound">Aᵢ</a> <a id="35945" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">auth[</a> <a id="35951" href="SecureCompilation.Coherence.html#35848" class="Bound">xs</a> <a id="35954" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">,</a> <a id="35956" href="Prelude.Lists.html#4855" class="Function">‼-map</a> <a id="35962" class="Symbol">{</a><a id="35963" class="Argument">xs</a> <a id="35966" class="Symbol">=</a> <a id="35968" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a><a id="35970" class="Symbol">}</a> <a id="35972" href="SecureCompilation.Coherence.html#35901" class="Bound">i</a> <a id="35974" href="BitML.Semantics.Action.html#1081" class="InductiveConstructor Operator">▷ᵈˢ</a> <a id="35978" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="35980" href="BitML.Semantics.Configurations.Types.html#1052" class="InductiveConstructor Operator">]</a> <a id="35982" class="Symbol">})</a> <a id="35985" class="Symbol">(</a><a id="35986" href="Prelude.Lists.html#2177" class="Function">enumerate</a> <a id="35996" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a><a id="35998" class="Symbol">)</a>
        <a id="36008" href="SecureCompilation.Coherence.html#36008" class="Bound">Γ</a>  <a id="36011" class="Symbol">=</a> <a id="36013" href="SecureCompilation.Coherence.html#35884" class="Bound">Δ</a> <a id="36015" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="36017" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="36028" href="SecureCompilation.Coherence.html#36028" class="Bound">Γₜ</a> <a id="36031" class="Symbol">=</a> <a id="36033" href="SecureCompilation.Coherence.html#36008" class="Bound">Γ</a> <a id="36035" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="36038" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
      <a id="36046" class="Keyword">in</a>
      <a id="36055" class="Comment">-- (ii) in Rˢ, α assumes ⟨Aᵢ,vᵢ⟩xᵢ to obtain 0</a>
      <a id="36108" class="Symbol">(</a><a id="36109" href="SecureCompilation.Coherence.html#36109" class="Bound">cfg≈</a> <a id="36114" class="Symbol">:</a> <a id="36116" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="36119" href="SymbolicModel.Run.html#1476" class="Function Operator">≈⋯</a> <a id="36122" href="SecureCompilation.Coherence.html#36028" class="Bound">Γₜ</a><a id="36124" class="Symbol">)</a>

    <a id="36131" class="Symbol">→</a> <a id="36133" class="Keyword">let</a>
        <a id="36145" href="SecureCompilation.Coherence.html#36145" class="Bound">α</a>   <a id="36149" class="Symbol">=</a> <a id="36151" href="BitML.Semantics.Label.html#1010" class="InductiveConstructor Operator">destroy⦅</a> <a id="36160" href="SecureCompilation.Coherence.html#35848" class="Bound">xs</a> <a id="36163" href="BitML.Semantics.Label.html#1010" class="InductiveConstructor Operator">⦆</a>
        <a id="36173" href="SecureCompilation.Coherence.html#36173" class="Bound">Γ′</a>  <a id="36177" class="Symbol">=</a> <a id="36179" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a>
        <a id="36190" href="SecureCompilation.Coherence.html#36190" class="Bound">t′</a>  <a id="36194" class="Symbol">=</a> <a id="36196" href="BitML.BasicTypes.html#520" class="Generalizable">t</a>
        <a id="36206" href="SecureCompilation.Coherence.html#36206" class="Bound">Γₜ′</a> <a id="36210" class="Symbol">=</a> <a id="36212" href="SecureCompilation.Coherence.html#36173" class="Bound">Γ′</a> <a id="36215" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="36218" href="SecureCompilation.Coherence.html#36190" class="Bound">t′</a>
      <a id="36227" class="Keyword">in</a>
      <a id="36236" class="Symbol">(</a><a id="36237" href="SecureCompilation.Coherence.html#36237" class="Bound">∃Γ≈</a> <a id="36241" class="Symbol">:</a> <a id="36243" href="Data.Product.html#1369" class="Function">∃</a> <a id="36245" class="Symbol">(</a><a id="36246" href="SecureCompilation.Coherence.html#4109" class="Function Operator">_≈ᶜ</a> <a id="36250" href="SecureCompilation.Coherence.html#36173" class="Bound">Γ′</a><a id="36252" class="Symbol">))</a> <a id="36255" class="Symbol">→</a>
      <a id="36263" class="Keyword">let</a>
        <a id="36275" href="SecureCompilation.Coherence.html#36275" class="Bound">Γ→Γ′</a> <a id="36280" class="Symbol">:</a> <a id="36282" href="SecureCompilation.Coherence.html#36028" class="Bound">Γₜ</a> <a id="36285" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">—[</a> <a id="36288" href="SecureCompilation.Coherence.html#36145" class="Bound">α</a> <a id="36290" href="BitML.Semantics.InferenceRules.html#8279" class="Datatype Operator">]→ₜ</a> <a id="36294" href="SecureCompilation.Coherence.html#36206" class="Bound">Γₜ′</a>
        <a id="36306" href="SecureCompilation.Coherence.html#36275" class="Bound">Γ→Γ′</a> <a id="36311" class="Symbol">=</a> <a id="36313" href="BitML.Semantics.InferenceRules.html#8386" class="InductiveConstructor">[Action]</a> <a id="36322" href="BitML.Semantics.InferenceRules.html#3136" class="InductiveConstructor">[DEP-Destroy]</a> <a id="36336" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

        <a id="36350" class="Comment">-- (v) txout = txout′, sechash = sechash′, κ = κ′</a>
        <a id="36408" class="Comment">-- remove {⋯ xᵢ ↦ (Tᵢ,j) ⋯} from txout′</a>
        <a id="36456" class="Keyword">open</a> <a id="36461" href="SymbolicModel.Helpers.html#25839" class="Module">H₁₇</a> <a id="36465" class="Symbol">{</a><a id="36466" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a><a id="36468" class="Symbol">}</a> <a id="36470" href="SecureCompilation.Coherence.html#1192" class="Generalizable">𝕣</a> <a id="36472" href="BitML.BasicTypes.html#520" class="Generalizable">t</a> <a id="36474" href="SecureCompilation.Coherence.html#36145" class="Bound">α</a> <a id="36476" href="SecureCompilation.Coherence.html#36190" class="Bound">t′</a> <a id="36479" href="SecureCompilation.Coherence.html#35763" class="Bound">ds</a> <a id="36482" href="BitML.Semantics.Configurations.Types.html#1528" class="Generalizable">Γ₀</a> <a id="36485" href="BitML.BasicTypes.html#484" class="Generalizable">y</a> <a id="36487" href="SecureCompilation.Coherence.html#36109" class="Bound">cfg≈</a> <a id="36492" href="SecureCompilation.Coherence.html#36275" class="Bound">Γ→Γ′</a> <a id="36497" href="SecureCompilation.Coherence.html#36237" class="Bound">∃Γ≈</a>
      <a id="36507" class="Keyword">in</a>
      <a id="36516" class="Symbol">(</a><a id="36517" href="SecureCompilation.Coherence.html#36517" class="Bound">T</a> <a id="36519" class="Symbol">:</a> <a id="36521" href="Bitcoin.Tx.Base.html#903" class="Record">Tx</a> <a id="36524" href="Bitcoin.Tx.Base.html#1914" class="Generalizable">i</a> <a id="36526" class="Number">0</a><a id="36527" class="Symbol">)</a>
    <a id="36533" class="Symbol">→</a> <a id="36535" class="Symbol">(</a><a id="36536" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="36544" href="Category.Functor.html#608" class="Field Operator">&lt;$&gt;</a> <a id="36548" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="36554" href="SymbolicModel.Helpers.html#26139" class="Function">xs↦</a><a id="36557" class="Symbol">)</a> <a id="36559" href="Data.List.Relation.Binary.Subset.Setoid.html#739" class="Function Operator">⊆</a> <a id="36561" href="Data.Vec.Base.html#7438" class="Function">V.toList</a> <a id="36570" class="Symbol">(</a><a id="36571" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a> <a id="36578" href="SecureCompilation.Coherence.html#36517" class="Bound">T</a><a id="36579" class="Symbol">)</a>

    <a id="36586" class="Symbol">→</a> <a id="36588" class="Keyword">let</a>
        <a id="36600" class="Comment">-- (iii) submit transaction T</a>
        <a id="36638" href="SecureCompilation.Coherence.html#36638" class="Bound">λᶜ</a> <a id="36641" class="Symbol">=</a> <a id="36643" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="36650" class="Symbol">(_</a> <a id="36653" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36655" class="Symbol">_</a> <a id="36657" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="36659" href="SecureCompilation.Coherence.html#36517" class="Bound">T</a><a id="36660" class="Symbol">)</a>
      <a id="36668" class="Keyword">in</a>

      <a id="36678" class="Comment">-- (iv) λᶜ does not correspond to any *other* symbolic move</a>
      <a id="36744" class="Symbol">(∀</a> <a id="36747" href="SecureCompilation.Coherence.html#36747" class="Bound">Γₜ′</a> <a id="36751" class="Symbol">(</a><a id="36752" href="SecureCompilation.Coherence.html#36752" class="Bound">𝕒′</a> <a id="36755" class="Symbol">:</a> <a id="36757" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="36759" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="36762" href="SecureCompilation.Coherence.html#36747" class="Bound">Γₜ′</a><a id="36765" class="Symbol">)</a> <a id="36767" class="Symbol">(</a><a id="36768" href="SecureCompilation.Coherence.html#36768" class="Bound">𝕣′</a> <a id="36771" class="Symbol">:</a> <a id="36773" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="36775" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="36777" href="SecureCompilation.Coherence.html#36747" class="Bound">Γₜ′</a> <a id="36781" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="36783" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="36786" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="36788" href="SecureCompilation.Coherence.html#36752" class="Bound">𝕒′</a><a id="36790" class="Symbol">)</a>
         <a id="36801" class="Symbol">→</a> <a id="36803" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="36809" href="SecureCompilation.Coherence.html#36752" class="Bound">𝕒′</a> <a id="36812" href="Relation.Binary.PropositionalEquality.Core.html#830" class="Function Operator">≢</a> <a id="36814" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="36820" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a>
         <a id="36831" class="Symbol">→</a> <a id="36833" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="36835" href="SecureCompilation.Coherence.html#2188" class="Datatype">coher₁₁</a> <a id="36843" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="36846" href="SecureCompilation.Coherence.html#36752" class="Bound">𝕒′</a> <a id="36849" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="36852" href="SecureCompilation.Coherence.html#36638" class="Bound">λᶜ</a> <a id="36855" href="SecureCompilation.Coherence.html#36768" class="Bound">𝕣′</a><a id="36857" class="Symbol">)</a>
      <a id="36865" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="36942" class="Symbol">→</a> <a id="36944" href="SecureCompilation.Coherence.html#2291" class="Datatype">coher₁₂</a> <a id="36952" href="SymbolicModel.Run.html#742" class="Generalizable">Rˢ</a> <a id="36955" href="SymbolicModel.Helpers.html#2078" class="Function">𝕒</a> <a id="36957" href="ComputationalModel.Strategy.html#1215" class="Generalizable">Rᶜ</a> <a id="36960" href="SecureCompilation.Coherence.html#36638" class="Bound">λᶜ</a> <a id="36963" href="SymbolicModel.Helpers.html#2018" class="Function">𝕣′</a>

<a id="36967" class="Keyword">data</a> <a id="36972" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="36979" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="36982" href="SecureCompilation.Coherence.html#36982" class="Bound">txout</a> <a id="36988" class="Keyword">where</a>

  <a id="coher₂.[1]"></a><a id="36997" href="SecureCompilation.Coherence.html#36997" class="InductiveConstructor">[1]</a> <a id="37001" class="Symbol">:</a>

      <a id="37010" href="Data.List.Relation.Binary.Disjoint.Setoid.html#842" class="Function">Disjoint</a> <a id="37019" class="Symbol">(</a><a id="37020" href="Data.Vec.Base.html#7438" class="Function">V.toList</a> <a id="37029" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="37031" href="Bitcoin.Tx.Base.html#940" class="Field">inputs</a> <a id="37038" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="37040" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="37046" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="37048" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="37054" href="SecureCompilation.Coherence.html#1158" class="Generalizable">T</a><a id="37055" class="Symbol">)</a> <a id="37057" class="Symbol">(</a><a id="37058" href="Bitcoin.Tx.Crypto.html#2689" class="Function">hashTxⁱ</a> <a id="37066" href="Category.Functor.html#608" class="Field Operator">&lt;$&gt;</a> <a id="37070" href="Prelude.Lists.html#13104" class="Function">codom</a> <a id="37076" href="SecureCompilation.Coherence.html#36982" class="Bound">txout</a><a id="37081" class="Symbol">)</a>
      <a id="37089" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="37166" class="Symbol">→</a> <a id="37168" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="37175" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37178" href="SecureCompilation.Coherence.html#36982" class="Bound">txout</a> <a id="37184" class="Symbol">(</a><a id="37185" href="ComputationalModel.Strategy.html#925" class="InductiveConstructor">submit</a> <a id="37192" href="SecureCompilation.Coherence.html#1158" class="Generalizable">T</a><a id="37193" class="Symbol">)</a>

  <a id="coher₂.[2]"></a><a id="37198" href="SecureCompilation.Coherence.html#37198" class="InductiveConstructor">[2]</a> <a id="37202" class="Symbol">:</a>

      <a id="37211" class="Symbol">(</a><a id="37212" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="37215" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="37217" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="37219" href="ComputationalModel.Strategy.html#1027" class="InductiveConstructor Operator">→O∶</a> <a id="37223" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a><a id="37224" class="Symbol">)</a>
    <a id="37230" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="37232" class="Symbol">(</a><a id="37233" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a> <a id="37236" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="37238" href="ComputationalModel.Strategy.html#1099" class="InductiveConstructor Operator">O→</a> <a id="37241" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="37243" href="ComputationalModel.Strategy.html#1099" class="InductiveConstructor Operator">∶</a> <a id="37245" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a><a id="37246" class="Symbol">)</a>
      <a id="37254" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="37331" class="Symbol">→</a> <a id="37333" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="37340" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37343" href="SecureCompilation.Coherence.html#36982" class="Bound">txout</a> <a id="37349" href="ComputationalModel.Strategy.html#1226" class="Generalizable">λᶜ</a>

  <a id="coher₂.[3]"></a><a id="37355" href="SecureCompilation.Coherence.html#37355" class="InductiveConstructor">[3]</a> <a id="37359" class="Symbol">:</a> <a id="37361" class="Keyword">let</a> <a id="37365" href="SecureCompilation.Coherence.html#37365" class="Bound">λᶜ</a> <a id="37368" class="Symbol">=</a> <a id="37370" href="BitML.Contracts.Types.html#515" class="Generalizable">A</a> <a id="37372" href="ComputationalModel.Strategy.html#856" class="InductiveConstructor Operator">→∗∶</a> <a id="37376" href="ComputationalModel.Strategy.html#1190" class="Generalizable">m</a> <a id="37378" class="Keyword">in</a>

      <a id="37388" class="Comment">-- λᶜ does not correspond to any symbolic move</a>
      <a id="37441" class="Symbol">(∀</a> <a id="37444" href="SecureCompilation.Coherence.html#37444" class="Bound">Γₜ</a> <a id="37447" href="SecureCompilation.Coherence.html#37447" class="Bound">Rᶜ</a> <a id="37450" class="Symbol">(</a><a id="37451" href="SecureCompilation.Coherence.html#37451" class="Bound">𝕒</a> <a id="37453" class="Symbol">:</a> <a id="37455" href="SymbolicModel.Run.html#1575" class="Function">𝔸</a> <a id="37457" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37460" href="SecureCompilation.Coherence.html#37444" class="Bound">Γₜ</a><a id="37462" class="Symbol">)</a> <a id="37464" class="Symbol">(</a><a id="37465" href="SecureCompilation.Coherence.html#37465" class="Bound">𝕣′</a> <a id="37468" class="Symbol">:</a> <a id="37470" href="SymbolicModel.Collections.html#3950" class="Record">ℝ</a> <a id="37472" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="37474" href="SecureCompilation.Coherence.html#37444" class="Bound">Γₜ</a> <a id="37477" href="SymbolicModel.Run.html#1701" class="Function Operator">∷</a> <a id="37479" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37482" href="SymbolicModel.Run.html#1701" class="Function Operator">⊣</a> <a id="37484" href="SecureCompilation.Coherence.html#37451" class="Bound">𝕒</a><a id="37485" class="Symbol">)</a>
         <a id="37496" class="Symbol">→</a> <a id="37498" href="Relation.Nullary.html#656" class="Function Operator">¬</a> <a id="37500" href="SecureCompilation.Coherence.html#2086" class="Datatype">coher₁</a> <a id="37507" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37510" href="SecureCompilation.Coherence.html#37451" class="Bound">𝕒</a> <a id="37512" href="SecureCompilation.Coherence.html#37447" class="Bound">Rᶜ</a> <a id="37515" href="SecureCompilation.Coherence.html#37365" class="Bound">λᶜ</a> <a id="37518" href="SecureCompilation.Coherence.html#37465" class="Bound">𝕣′</a><a id="37520" class="Symbol">)</a>
      <a id="37528" class="Comment">--——————————————————————————————————————————————————————————————————————</a>
    <a id="37605" class="Symbol">→</a> <a id="37607" href="SecureCompilation.Coherence.html#2394" class="Datatype">coher₂</a> <a id="37614" href="SecureCompilation.Coherence.html#36979" class="Bound">Rˢ</a> <a id="37617" href="SecureCompilation.Coherence.html#36982" class="Bound">txout</a> <a id="37623" href="SecureCompilation.Coherence.html#37365" class="Bound">λᶜ</a>

<a id="37627" class="Comment">{-
T0D0: enforce common naming scheme via a module that re-exports names in a systematic way
e.g. [1]: open —→⟨ (advertise[ ⟨G⟩C ]) ≈ (A →∗∶ C) ⟩ (` ⟨G⟩C ∣ Γ) AT t

module —→⟨_≈_⟩_AT_
  (`α : S.Label) (`λᶜ : C.Label)
  (`Γ′ : Cfg) (`t′ : S.Time)
  where
    private
      α   = `α
      Γ′  = `Γ′
      t′  = `t′
      Γₜ′ = `Γ′ at `t′
      λᶜ  = `λᶜ
-}</a>
</pre></body></html>