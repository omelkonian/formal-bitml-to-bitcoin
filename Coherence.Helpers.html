<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Coherence.Helpers</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml-to-bitcoin/tree/master/Coherence/Helpers.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="25" class="Symbol">;</a> <a id="27" class="Keyword">open</a> <a id="32" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="42" class="Keyword">open</a> <a id="47" href="Prelude.Init.html#7254" class="Module">L.Mem</a>
<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Prelude.Lists.Mappings.html" class="Module">Prelude.Lists.Mappings</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Prelude.Lists.Indexed.html" class="Module">Prelude.Lists.Indexed</a>
<a id="122" class="Keyword">open</a> <a id="127" class="Keyword">import</a> <a id="134" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>
<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="176" class="Keyword">open</a> <a id="181" class="Keyword">import</a> <a id="188" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Prelude.FromN.html" class="Module">Prelude.FromN</a>

<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="SecureCompilation.ModuleParameters.html" class="Module">SecureCompilation.ModuleParameters</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="SecureCompilation.ModuleParameters.html#209" class="Record">⋯</a><a id="318" class="Symbol">)</a>
<a id="320" class="Keyword">module</a> <a id="327" href="Coherence.Helpers.html" class="Module">Coherence.Helpers</a> <a id="345" class="Symbol">(</a><a id="346" href="Coherence.Helpers.html#346" class="Bound">⋯</a> <a id="348" class="Symbol">:</a> <a id="350" href="SecureCompilation.ModuleParameters.html#209" class="Record">⋯</a><a id="351" class="Symbol">)</a> <a id="353" class="Symbol">(</a><a id="354" class="Keyword">let</a> <a id="358" class="Keyword">open</a> <a id="363" href="SecureCompilation.ModuleParameters.html#209" class="Module">⋯</a> <a id="365" href="Coherence.Helpers.html#346" class="Bound">⋯</a><a id="366" class="Symbol">)</a> <a id="368" class="Keyword">where</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="400" href="SecureCompilation.ModuleParameters.html#282" class="Field">⋯′</a> <a id="403" class="Keyword">hiding</a> <a id="410" class="Symbol">(</a><a id="411" href="BitML.Contracts.Types.html#1222" class="Generalizable">d</a><a id="412" class="Symbol">)</a>
<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="ComputationalModel.html" class="Module">ComputationalModel</a> <a id="445" href="SecureCompilation.ModuleParameters.html#282" class="Field">⋯′</a> <a id="448" href="SecureCompilation.ModuleParameters.html#450" class="Field">finPart</a> <a id="456" href="SecureCompilation.ModuleParameters.html#487" class="Field">keypairs</a>
<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Compiler.html" class="Module">Compiler</a> <a id="486" href="SecureCompilation.ModuleParameters.html#282" class="Field">⋯′</a> <a id="489" href="SecureCompilation.ModuleParameters.html#357" class="Field">η</a>

<a id="label≢"></a><a id="492" href="Coherence.Helpers.html#492" class="Function">label≢</a> <a id="499" class="Symbol">:</a> <a id="501" class="Symbol">∀</a> <a id="503" class="Symbol">{</a><a id="504" href="Coherence.Helpers.html#504" class="Bound">A</a> <a id="506" href="Coherence.Helpers.html#506" class="Bound">m</a> <a id="508" href="Coherence.Helpers.html#508" class="Bound">B</a> <a id="510" href="Coherence.Helpers.html#510" class="Bound">m′</a><a id="512" class="Symbol">}</a> <a id="514" class="Symbol">→</a>
  <a id="518" href="Coherence.Helpers.html#506" class="Bound">m</a> <a id="520" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="522" href="Coherence.Helpers.html#510" class="Bound">m′</a>
  <a id="527" href="Prelude.InferenceRules.html#14187" class="Function Operator">──────────────────</a>
  <a id="548" href="Coherence.Helpers.html#504" class="Bound">A</a> <a id="550" href="ComputationalModel.Strategy.html#1025" class="InductiveConstructor Operator">→∗∶</a> <a id="554" href="Coherence.Helpers.html#506" class="Bound">m</a> <a id="556" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="558" href="Coherence.Helpers.html#508" class="Bound">B</a> <a id="560" href="ComputationalModel.Strategy.html#1025" class="InductiveConstructor Operator">→∗∶</a> <a id="564" href="Coherence.Helpers.html#510" class="Bound">m′</a>
<a id="567" href="Coherence.Helpers.html#492" class="Function">label≢</a> <a id="574" href="Coherence.Helpers.html#574" class="Bound">m≢</a> <a id="577" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="582" class="Symbol">=</a> <a id="584" href="Coherence.Helpers.html#574" class="Bound">m≢</a> <a id="587" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="∣_∣ᵐ"></a><a id="593" href="Coherence.Helpers.html#593" class="Function Operator">∣_∣ᵐ</a> <a id="598" class="Symbol">:</a> <a id="600" href="ComputationalModel.Strategy.html#935" class="Function">Message</a> <a id="608" class="Symbol">→</a> <a id="610" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
<a id="612" href="Coherence.Helpers.html#593" class="Function Operator">∣</a> <a id="614" href="Coherence.Helpers.html#614" class="Bound">m</a> <a id="616" href="Coherence.Helpers.html#593" class="Function Operator">∣ᵐ</a> <a id="619" class="Symbol">=</a> <a id="621" href="Data.Nat.Binary.Base.html#3730" class="Function">Nat.Bin.size</a> <a id="634" class="Symbol">(</a><a id="635" href="Prelude.FromN.html#171" class="Field">fromℕ</a> <a id="641" href="Data.Integer.Base.html#1757" class="Function Operator">Integer.∣</a> <a id="651" href="Coherence.Helpers.html#614" class="Bound">m</a> <a id="653" href="Data.Integer.Base.html#1757" class="Function Operator">∣</a><a id="654" class="Symbol">)</a>

<a id="657" class="Comment">-- Checking past oracle interactions.</a>
<a id="CheckInteractions"></a><a id="695" href="Coherence.Helpers.html#695" class="Function">CheckInteractions</a> <a id="713" class="Symbol">:</a> <a id="715" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="720" href="ComputationalModel.Strategy.html#5148" class="Function">OracleInteraction</a> <a id="738" class="Symbol">→</a> <a id="740" href="Prelude.Init.html#13767" class="Function">Pred₀</a> <a id="746" class="Symbol">(</a><a id="747" href="BitML.BasicTypes.html#303" class="Function">Secret</a> <a id="754" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="756" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="762" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="764" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="766" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a><a id="772" class="Symbol">)</a>
<a id="774" href="Coherence.Helpers.html#695" class="Function">CheckInteractions</a> <a id="792" href="Coherence.Helpers.html#792" class="Bound">os</a> <a id="795" class="Symbol">=</a> <a id="797" class="Symbol">λ</a> <a id="799" class="Keyword">where</a>
  <a id="807" class="Symbol">(_</a> <a id="810" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="812" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="817" href="Coherence.Helpers.html#817" class="Bound">Nᵢ</a> <a id="820" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="822" href="Coherence.Helpers.html#822" class="Bound">hᵢ</a><a id="824" class="Symbol">)</a> <a id="826" class="Symbol">→</a>
    <a id="832" href="Data.Product.html#1378" class="Function">∃</a> <a id="834" class="Symbol">λ</a> <a id="836" href="Coherence.Helpers.html#836" class="Bound">B</a> <a id="838" class="Symbol">→</a> <a id="840" href="Data.Product.html#1378" class="Function">∃</a> <a id="842" class="Symbol">λ</a> <a id="844" href="Coherence.Helpers.html#844" class="Bound">mᵢ</a> <a id="847" class="Symbol">→</a> <a id="849" class="Symbol">((</a><a id="851" href="Coherence.Helpers.html#836" class="Bound">B</a> <a id="853" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="855" href="Coherence.Helpers.html#844" class="Bound">mᵢ</a> <a id="858" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="860" href="Coherence.Helpers.html#822" class="Bound">hᵢ</a><a id="862" class="Symbol">)</a> <a id="864" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="866" href="Coherence.Helpers.html#792" class="Bound">os</a><a id="868" class="Symbol">)</a> <a id="870" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="872" class="Symbol">(</a><a id="873" href="Coherence.Helpers.html#593" class="Function Operator">∣</a> <a id="875" href="Coherence.Helpers.html#844" class="Bound">mᵢ</a> <a id="878" href="Coherence.Helpers.html#593" class="Function Operator">∣ᵐ</a> <a id="881" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="883" href="SecureCompilation.ModuleParameters.html#357" class="Field">η</a> <a id="885" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="887" href="Coherence.Helpers.html#817" class="Bound">Nᵢ</a><a id="889" class="Symbol">)</a>
  <a id="893" class="Symbol">(_</a> <a id="896" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="898" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="906" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="908" href="Coherence.Helpers.html#908" class="Bound">hᵢ</a><a id="910" class="Symbol">)</a> <a id="912" class="Symbol">→</a>
    <a id="918" href="Coherence.Helpers.html#908" class="Bound">hᵢ</a> <a id="921" href="Data.List.Membership.Setoid.html#945" class="Function Operator">∉</a> <a id="923" href="Data.List.Base.html#1553" class="Function">map</a> <a id="927" href="Prelude.Nary.html#3005" class="Function">select₃</a> <a id="935" class="Symbol">(</a><a id="936" href="Data.List.Base.html#8101" class="Function">filter</a> <a id="943" class="Symbol">((</a><a id="945" href="SecureCompilation.ModuleParameters.html#357" class="Field">η</a> <a id="947" href="Prelude.Ord.Dec.html#430" class="Function Operator">≤?_</a><a id="950" class="Symbol">)</a> <a id="952" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="954" href="Coherence.Helpers.html#593" class="Function Operator">∣_∣ᵐ</a> <a id="959" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="961" href="Prelude.Nary.html#2292" class="Function">select₂</a><a id="968" class="Symbol">)</a> <a id="970" href="Coherence.Helpers.html#792" class="Bound">os</a><a id="972" class="Symbol">)</a>

<a id="CheckOracleInteractions"></a><a id="975" href="Coherence.Helpers.html#975" class="Function">CheckOracleInteractions</a> <a id="999" class="Symbol">:</a> <a id="1001" href="ComputationalModel.Strategy.html#4247" class="Datatype">CRun</a> <a id="1006" class="Symbol">→</a> <a id="1008" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1013" class="Symbol">(</a><a id="1014" href="BitML.BasicTypes.html#303" class="Function">Secret</a> <a id="1021" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1023" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1029" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1031" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1033" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a><a id="1039" class="Symbol">)</a> <a id="1041" class="Symbol">→</a> <a id="1043" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="1047" href="Coherence.Helpers.html#975" class="Function">CheckOracleInteractions</a> <a id="1071" href="Coherence.Helpers.html#1071" class="Bound">Rᶜ</a> <a id="1074" class="Symbol">=</a> <a id="1076" href="Data.List.Relation.Unary.All.html#1453" class="Datatype">All</a> <a id="1080" class="Symbol">(</a><a id="1081" href="Coherence.Helpers.html#695" class="Function">CheckInteractions</a> <a id="1099" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="1101" href="ComputationalModel.Strategy.html#5964" class="Function">oracleInteractionsᶜ</a> <a id="1121" href="Coherence.Helpers.html#1071" class="Bound">Rᶜ</a><a id="1123" class="Symbol">)</a>

<a id="1126" class="Comment">-- Convenient wrappers for calling the BitML compiler.</a>

<a id="COMPILE"></a><a id="1182" href="Coherence.Helpers.html#1182" class="Function">COMPILE</a> <a id="1190" class="Symbol">:</a> <a id="1192" class="Symbol">∀</a> <a id="1194" class="Symbol">{</a><a id="1195" href="Coherence.Helpers.html#1195" class="Bound">ad</a><a id="1197" class="Symbol">}</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="SymbolicModel.Mappings.Base.html#1314" class="Function">𝔾</a> <a id="1203" href="Coherence.Helpers.html#1195" class="Bound">ad</a> <a id="1206" class="Symbol">→</a> <a id="1208" href="Compiler.Outputs.html#206" class="Function">InitTx</a> <a id="1215" class="Symbol">(</a><a id="1216" href="Coherence.Helpers.html#1195" class="Bound">ad</a> <a id="1219" class="Symbol">.</a><a id="1220" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1221" class="Symbol">)</a> <a id="1223" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1225" class="Symbol">(</a><a id="1226" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="1235" href="Coherence.Helpers.html#1195" class="Bound">ad</a> <a id="1238" href="Prelude.Lists.Mappings.html#654" class="Function Operator">↦′</a> <a id="1241" href="Compiler.Outputs.html#504" class="Function">BranchTx</a> <a id="1250" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1252" href="Compiler.Subterms.html#622" class="Field Operator">_∗</a><a id="1254" class="Symbol">)</a>
<a id="1256" href="Coherence.Helpers.html#1182" class="Function">COMPILE</a> <a id="1264" class="Symbol">{</a><a id="1265" class="Argument">ad</a> <a id="1268" class="Symbol">=</a> <a id="1270" href="Coherence.Helpers.html#1270" class="Bound">ad</a><a id="1272" class="Symbol">}</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Coherence.Helpers.html#1275" class="Bound">vad</a> <a id="1279" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1281" href="Coherence.Helpers.html#1281" class="Bound">txout₀</a> <a id="1288" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1290" href="Coherence.Helpers.html#1290" class="Bound">sechash₀</a> <a id="1299" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1301" href="Coherence.Helpers.html#1301" class="Bound">κ₀</a><a id="1303" class="Symbol">)</a> <a id="1305" class="Symbol">=</a>
  <a id="1309" class="Keyword">let</a>
    <a id="1317" href="Coherence.Helpers.html#1317" class="Bound">K</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="Compiler.Mappings.html#394" class="Function">𝕂</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Coherence.Helpers.html#1270" class="Bound">ad</a> <a id="1327" class="Symbol">.</a><a id="1328" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1329" class="Symbol">)</a>
    <a id="1335" href="Coherence.Helpers.html#1317" class="Bound">K</a> <a id="1337" class="Symbol">{</a><a id="1338" href="Coherence.Helpers.html#1338" class="Bound">p</a><a id="1339" class="Symbol">}</a> <a id="1341" class="Symbol">_</a> <a id="1343" class="Symbol">=</a> <a id="1345" href="ComputationalModel.KeyPairs.html#208" class="Function">K̂</a> <a id="1348" href="Coherence.Helpers.html#1338" class="Bound">p</a>

    <a id="1355" href="Coherence.Helpers.html#1355" class="Bound">T</a> <a id="1357" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1359" href="Coherence.Helpers.html#1359" class="Bound">∀d</a> <a id="1362" class="Symbol">=</a> <a id="1364" href="Compiler.Translation.html#1219" class="Function">bitml-compiler</a> <a id="1379" class="Symbol">{</a><a id="1380" class="Argument">ad</a> <a id="1383" class="Symbol">=</a> <a id="1385" href="Coherence.Helpers.html#1270" class="Bound">ad</a><a id="1387" class="Symbol">}</a> <a id="1389" href="Coherence.Helpers.html#1275" class="Bound">vad</a> <a id="1393" href="Coherence.Helpers.html#1290" class="Bound">sechash₀</a> <a id="1402" href="Coherence.Helpers.html#1281" class="Bound">txout₀</a> <a id="1409" href="Coherence.Helpers.html#1317" class="Bound">K</a> <a id="1411" href="Coherence.Helpers.html#1301" class="Bound">κ₀</a>
  <a id="1416" class="Keyword">in</a>
    <a id="1423" href="Coherence.Helpers.html#1355" class="Bound">T</a> <a id="1425" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1427" href="Compiler.Subterms.html#2649" class="Function">weaken-sub</a> <a id="1438" class="Symbol">{</a><a id="1439" href="Coherence.Helpers.html#1270" class="Bound">ad</a><a id="1441" class="Symbol">}</a> <a id="1443" href="Coherence.Helpers.html#1359" class="Bound">∀d</a>

<a id="COMPILE-INIT"></a><a id="1447" href="Coherence.Helpers.html#1447" class="Function">COMPILE-INIT</a> <a id="1460" class="Symbol">:</a> <a id="1462" class="Symbol">∀</a> <a id="1464" class="Symbol">{</a><a id="1465" href="Coherence.Helpers.html#1465" class="Bound">ad</a><a id="1467" class="Symbol">}</a> <a id="1469" class="Symbol">→</a> <a id="1471" href="SymbolicModel.Mappings.Base.html#1314" class="Function">𝔾</a> <a id="1473" href="Coherence.Helpers.html#1465" class="Bound">ad</a> <a id="1476" class="Symbol">→</a> <a id="1478" href="Compiler.Outputs.html#206" class="Function">InitTx</a> <a id="1485" class="Symbol">(</a><a id="1486" href="Coherence.Helpers.html#1465" class="Bound">ad</a> <a id="1489" class="Symbol">.</a><a id="1490" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1491" class="Symbol">)</a>
<a id="1493" href="Coherence.Helpers.html#1447" class="Function">COMPILE-INIT</a> <a id="1506" class="Symbol">=</a> <a id="1508" href="Agda.Builtin.Sigma.html#234" class="Field">proj₁</a> <a id="1514" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1516" href="Coherence.Helpers.html#1182" class="Function">COMPILE</a>

<a id="COMPILE-SUB"></a><a id="1525" href="Coherence.Helpers.html#1525" class="Function">COMPILE-SUB</a> <a id="1537" class="Symbol">:</a> <a id="1539" class="Symbol">∀</a> <a id="1541" class="Symbol">{</a><a id="1542" href="Coherence.Helpers.html#1542" class="Bound">ad</a><a id="1544" class="Symbol">}</a> <a id="1546" class="Symbol">→</a> <a id="1548" href="SymbolicModel.Mappings.Base.html#1314" class="Function">𝔾</a> <a id="1550" href="Coherence.Helpers.html#1542" class="Bound">ad</a> <a id="1553" class="Symbol">→</a> <a id="1555" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="1564" href="Coherence.Helpers.html#1542" class="Bound">ad</a> <a id="1567" href="Prelude.Lists.Mappings.html#654" class="Function Operator">↦′</a> <a id="1570" href="Compiler.Outputs.html#504" class="Function">BranchTx</a> <a id="1579" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1581" href="Compiler.Subterms.html#622" class="Field Operator">_∗</a>
<a id="1584" href="Coherence.Helpers.html#1525" class="Function">COMPILE-SUB</a> <a id="1596" class="Symbol">=</a> <a id="1598" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="1604" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="1606" href="Coherence.Helpers.html#1182" class="Function">COMPILE</a>

<a id="COMPILE-ANCESTOR"></a><a id="1615" href="Coherence.Helpers.html#1615" class="Function">COMPILE-ANCESTOR</a> <a id="1632" class="Symbol">:</a> <a id="1634" class="Symbol">∀</a> <a id="1636" class="Symbol">{</a><a id="1637" href="Coherence.Helpers.html#1637" class="Bound">R</a> <a id="1639" href="Coherence.Helpers.html#1639" class="Bound">c</a> <a id="1641" href="Coherence.Helpers.html#1641" class="Bound">v</a> <a id="1643" href="Coherence.Helpers.html#1643" class="Bound">x</a> <a id="1645" href="Coherence.Helpers.html#1645" class="Bound">Γ</a> <a id="1647" href="Coherence.Helpers.html#1647" class="Bound">t</a><a id="1648" class="Symbol">}</a> <a id="1650" class="Symbol">{</a><a id="1651" href="Coherence.Helpers.html#1651" class="Bound">i</a> <a id="1653" class="Symbol">:</a> <a id="1655" href="Prelude.Lists.Indexed.html#542" class="Function">Index</a> <a id="1661" href="Coherence.Helpers.html#1639" class="Bound">c</a><a id="1662" class="Symbol">}</a> <a id="1664" class="Symbol">(</a><a id="1665" class="Keyword">open</a> <a id="1670" href="BitML.Contracts.ModuleMacros.html#549" class="Module">∣SELECT</a> <a id="1678" href="Coherence.Helpers.html#1639" class="Bound">c</a> <a id="1680" href="Coherence.Helpers.html#1651" class="Bound">i</a><a id="1681" class="Symbol">)</a> <a id="1683" class="Symbol">→</a>
  <a id="1687" href="Prelude.InferenceRules.html#56141" class="Function Operator">∙</a> <a id="1689" href="Coherence.Helpers.html#1637" class="Bound">R</a> <a id="1691" href="SymbolicModel.Run.Base.html#1946" class="Function Operator">≈⋯</a> <a id="1694" href="Coherence.Helpers.html#1645" class="Bound">Γ</a> <a id="1696" class="InductiveConstructor Operator">at</a> <a id="1699" href="Coherence.Helpers.html#1647" class="Bound">t</a>
  <a id="1703" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1705" href="BitML.Semantics.Configurations.Types.html#597" class="InductiveConstructor Operator">⟨</a> <a id="1707" href="Coherence.Helpers.html#1639" class="Bound">c</a> <a id="1709" href="BitML.Semantics.Configurations.Types.html#597" class="InductiveConstructor Operator">,</a> <a id="1711" href="Coherence.Helpers.html#1641" class="Bound">v</a> <a id="1713" href="BitML.Semantics.Configurations.Types.html#597" class="InductiveConstructor Operator">⟩at</a> <a id="1717" href="Coherence.Helpers.html#1643" class="Bound">x</a> <a id="1719" href="BitML.Semantics.Configurations.Helpers.html#3965" class="Function Operator">∈ᶜ</a> <a id="1722" href="Coherence.Helpers.html#1645" class="Bound">Γ</a>
  <a id="1726" href="Prelude.InferenceRules.html#56072" class="Function Operator">∙</a> <a id="1728" href="SymbolicModel.Mappings.Base.html#743" class="Function">ℝ</a> <a id="1730" href="Coherence.Helpers.html#1637" class="Bound">R</a>
    <a id="1736" href="Prelude.InferenceRules.html#13137" class="Function Operator">──────────────────────────────────────────────</a>
    <a id="1787" href="Compiler.Outputs.html#504" class="Function">BranchTx</a> <a id="1796" class="Symbol">(</a><a id="1797" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a> <a id="1799" href="Compiler.Subterms.html#622" class="Field Operator">∗</a><a id="1800" class="Symbol">)</a> <a id="1802" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="1804" class="Symbol">(</a><a id="1805" href="BitML.Contracts.Collections.html#14015" class="Function">authDecorations</a> <a id="1821" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a> <a id="1823" href="Prelude.Lists.Mappings.html#778" class="Function Operator">↦</a> <a id="1825" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1832" class="Symbol">)</a>
<a id="1834" href="Coherence.Helpers.html#1615" class="Function">COMPILE-ANCESTOR</a> <a id="1851" class="Symbol">{</a><a id="1852" href="Coherence.Helpers.html#1852" class="Bound">R</a><a id="1853" class="Symbol">}{</a><a id="1855" href="Coherence.Helpers.html#1855" class="Bound">c</a><a id="1856" class="Symbol">}{</a><a id="1858" href="Coherence.Helpers.html#1858" class="Bound">v</a><a id="1859" class="Symbol">}{</a><a id="1861" href="Coherence.Helpers.html#1861" class="Bound">x</a><a id="1862" class="Symbol">}{</a><a id="1864" href="Coherence.Helpers.html#1864" class="Bound">Γ</a><a id="1865" class="Symbol">}{</a><a id="1867" href="Coherence.Helpers.html#1867" class="Bound">t</a><a id="1868" class="Symbol">}{</a><a id="1870" href="Coherence.Helpers.html#1870" class="Bound">i</a><a id="1871" class="Symbol">}</a> <a id="1873" href="Coherence.Helpers.html#1873" class="Bound">R≈</a> <a id="1876" href="Coherence.Helpers.html#1876" class="Bound">c∈</a> <a id="1879" href="Coherence.Helpers.html#1879" class="Bound">𝕣</a> <a id="1881" class="Symbol">=</a>
  <a id="1885" class="Keyword">let</a>
    <a id="1893" class="Comment">-- (ii) {G}C is the ancestor of ⟨C, v⟩ₓ in Rˢ</a>
    <a id="1943" href="Coherence.Helpers.html#1943" class="Bound">⟨G⟩C</a> <a id="1948" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1950" href="Coherence.Helpers.html#1950" class="Bound">vad</a> <a id="1954" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1956" href="Coherence.Helpers.html#1956" class="Bound">ad∈</a> <a id="1960" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1962" href="Coherence.Helpers.html#1962" class="Bound">c⊆</a> <a id="1965" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1967" href="Coherence.Helpers.html#1967" class="Bound">anc</a> <a id="1971" class="Symbol">=</a> <a id="1973" href="SymbolicModel.Helpers.html#2475" class="Function">ANCESTOR</a> <a id="1982" class="Symbol">{</a><a id="1983" class="Argument">R</a> <a id="1985" class="Symbol">=</a> <a id="1987" href="Coherence.Helpers.html#1852" class="Bound">R</a><a id="1988" class="Symbol">}</a> <a id="1990" class="Symbol">{</a><a id="1991" class="Argument">Γ</a> <a id="1993" class="Symbol">=</a> <a id="1995" href="Coherence.Helpers.html#1864" class="Bound">Γ</a><a id="1996" class="Symbol">}</a> <a id="1998" href="Coherence.Helpers.html#1873" class="Bound">R≈</a> <a id="2001" href="Coherence.Helpers.html#1876" class="Bound">c∈</a>
    <a id="2008" class="Keyword">open</a> <a id="2013" href="BitML.Contracts.ModuleMacros.html#761" class="Module">∣AD</a> <a id="2017" href="Coherence.Helpers.html#1943" class="Bound">⟨G⟩C</a><a id="2021" class="Symbol">;</a> <a id="2023" class="Keyword">open</a> <a id="2028" href="BitML.Contracts.ModuleMacros.html#549" class="Module">∣SELECT</a> <a id="2036" href="Coherence.Helpers.html#1855" class="Bound">c</a> <a id="2038" href="Coherence.Helpers.html#1870" class="Bound">i</a><a id="2039" class="Symbol">;</a> <a id="2041" class="Keyword">open</a> <a id="2046" href="SymbolicModel.Mappings.Base.html#768" class="Module">ℝ</a> <a id="2048" href="Coherence.Helpers.html#1879" class="Bound">𝕣</a>

    <a id="2055" href="Coherence.Helpers.html#2055" class="Bound">d∈</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a> <a id="2062" href="Data.List.Membership.Setoid.html#896" class="Function Operator">∈</a> <a id="2064" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="2073" href="Coherence.Helpers.html#1943" class="Bound">⟨G⟩C</a>
    <a id="2082" href="Coherence.Helpers.html#2055" class="Bound">d∈</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Coherence.Helpers.html#1962" class="Bound">c⊆</a> <a id="2090" class="Symbol">(</a><a id="2091" href="Data.List.Membership.Propositional.Properties.html#11102" class="Function">L.Mem.∈-lookup</a> <a id="2106" href="Coherence.Helpers.html#1870" class="Bound">i</a><a id="2107" class="Symbol">)</a>

    <a id="2114" href="Coherence.Helpers.html#2114" class="Bound">A∈</a> <a id="2117" class="Symbol">:</a> <a id="2119" href="BitML.Contracts.Collections.html#14015" class="Function">authDecorations</a> <a id="2135" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a> <a id="2137" href="Data.List.Relation.Binary.Subset.Setoid.html#748" class="Function Operator">⊆</a> <a id="2139" href="BitML.Contracts.ModuleMacros.html#813" class="Function">partG</a>
    <a id="2149" href="Coherence.Helpers.html#2114" class="Bound">A∈</a> <a id="2152" class="Symbol">=</a> <a id="2154" href="Prelude.Lists.Dec.html#4157" class="Function">∈-nub⁺</a> <a id="2161" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2163" href="BitML.Contracts.Subterms.html#9999" class="Function">subterms-part⊆ᵃ</a> <a id="2179" href="Coherence.Helpers.html#1950" class="Bound">vad</a> <a id="2183" href="Coherence.Helpers.html#2055" class="Bound">d∈</a> <a id="2186" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2188" href="BitML.Contracts.Collections.html#14174" class="Function">auth⊆part</a> <a id="2198" class="Symbol">{</a><a id="2199" class="Argument">d</a> <a id="2201" class="Symbol">=</a> <a id="2203" href="BitML.Contracts.ModuleMacros.html#594" class="Function">d</a><a id="2204" class="Symbol">}</a>

    <a id="2211" class="Symbol">_</a> <a id="2213" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2215" href="Coherence.Helpers.html#2215" class="Bound">∀d∗</a> <a id="2219" class="Symbol">=</a> <a id="2221" href="Coherence.Helpers.html#1182" class="Function">COMPILE</a> <a id="2229" class="Symbol">(</a><a id="2230" href="SymbolicModel.Helpers.html#4275" class="Function">LIFTᶜ</a> <a id="2236" href="Coherence.Helpers.html#1879" class="Bound">𝕣</a> <a id="2238" href="Coherence.Helpers.html#1967" class="Bound">anc</a><a id="2241" class="Symbol">)</a>
  <a id="2245" class="Keyword">in</a>
    <a id="2252" href="Coherence.Helpers.html#2215" class="Bound">∀d∗</a> <a id="2256" href="Coherence.Helpers.html#2055" class="Bound">d∈</a> <a id="2259" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2261" href="SymbolicModel.Mappings.Base.html#857" class="Field">κ′</a> <a id="2264" href="Coherence.Helpers.html#1956" class="Bound">ad∈</a> <a id="2268" href="Coherence.Helpers.html#2055" class="Bound">d∈</a> <a id="2271" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="2273" href="Coherence.Helpers.html#2114" class="Bound">A∈</a>
</pre></body></html>