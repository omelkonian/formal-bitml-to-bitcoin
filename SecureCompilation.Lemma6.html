<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Lemma6</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Pragma">--allow-incomplete-matches</a> <a id="63" class="Symbol">#-}</a>
<a id="67" class="Comment">-- {-# OPTIONS --auto-inline #-}</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Prelude.Init.html" class="Module">Prelude.Init</a>
<a id="125" class="Keyword">open</a> <a id="130" class="Keyword">import</a> <a id="137" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="235" class="Keyword">open</a> <a id="240" class="Keyword">import</a> <a id="247" href="Prelude.ToN.html" class="Module">Prelude.ToN</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Prelude.General.html" class="Module">Prelude.General</a>
<a id="287" class="Keyword">open</a> <a id="292" class="Keyword">import</a> <a id="299" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Prelude.Sets.html" class="Module">Prelude.Sets</a> <a id="339" class="Keyword">hiding</a> <a id="346" class="Symbol">(</a><a id="347" href="Prelude.Sets.Interface.html#3991" class="Function">toList</a><a id="353" class="Symbol">)</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="Prelude.Sets.html" class="Module">Prelude.Sets</a>
<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Prelude.Accessors.html" class="Module">Prelude.Accessors</a>
<a id="473" class="Keyword">open</a> <a id="478" class="Keyword">import</a> <a id="485" href="Prelude.Nary.html" class="Module">Prelude.Nary</a>

<a id="499" class="Keyword">import</a> <a id="506" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="521" class="Symbol">as</a> <a id="524" class="Module">BTC</a>

<a id="529" class="Keyword">module</a> <a id="536" href="SecureCompilation.Lemma6.html" class="Module">SecureCompilation.Lemma6</a>
  <a id="563" class="Symbol">(</a><a id="564" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="576" class="Symbol">:</a> <a id="578" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="581" class="Symbol">)</a>
  <a id="585" class="Symbol">‚¶É</a> <a id="587" href="SecureCompilation.Lemma6.html#587" class="Bound">_</a> <a id="589" class="Symbol">:</a> <a id="591" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="597" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="609" class="Symbol">‚¶Ñ</a>
  <a id="613" class="Symbol">(</a><a id="614" href="SecureCompilation.Lemma6.html#614" class="Bound">Honest</a> <a id="621" class="Symbol">:</a> <a id="623" href="Data.List.NonEmpty.Base.html#1079" class="Record">List‚Å∫</a> <a id="629" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a><a id="640" class="Symbol">)</a>

  <a id="645" class="Symbol">(</a><a id="646" href="SecureCompilation.Lemma6.html#646" class="Bound">finPart</a> <a id="654" class="Symbol">:</a> <a id="656" href="Prelude.Lists.html#2284" class="Function">Finite</a> <a id="663" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a><a id="674" class="Symbol">)</a>
  <a id="678" class="Symbol">(</a><a id="679" href="SecureCompilation.Lemma6.html#679" class="Bound">keypairs</a> <a id="688" class="Symbol">:</a> <a id="690" class="Symbol">‚àÄ</a> <a id="692" class="Symbol">(</a><a id="693" href="SecureCompilation.Lemma6.html#693" class="Bound">A</a> <a id="695" class="Symbol">:</a> <a id="697" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a><a id="708" class="Symbol">)</a> <a id="710" class="Symbol">‚Üí</a> <a id="712" href="Bitcoin.Crypto.html#345" class="Record">BTC.KeyPair</a> <a id="724" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="726" href="Bitcoin.Crypto.html#345" class="Record">BTC.KeyPair</a><a id="737" class="Symbol">)</a>

  <a id="742" class="Symbol">(</a><a id="743" href="SecureCompilation.Lemma6.html#743" class="Bound">Œ∑</a> <a id="745" class="Symbol">:</a> <a id="747" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a><a id="748" class="Symbol">)</a> <a id="750" class="Comment">-- security parameter</a>
  <a id="774" class="Keyword">where</a>

<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="807" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="819" href="SecureCompilation.Lemma6.html#614" class="Bound">Honest</a> as <a id="S"></a><a id="829" href="SecureCompilation.Lemma6.html#829" class="Module">S</a>
  <a id="833" class="Keyword">hiding</a> <a id="840" class="Symbol">(</a><a id="841" href="BitML.Contracts.Types.html#1319" class="Generalizable">d</a><a id="842" class="Symbol">;</a> <a id="844" href="BitML.Semantics.Label.html#1777" class="Generalizable">Œ±</a><a id="845" class="Symbol">;</a> <a id="847" href="BitML.Semantics.Configurations.Types.html#1520" class="Generalizable">Œì</a><a id="848" class="Symbol">;</a> <a id="850" href="BitML.Semantics.Configurations.Types.html#1522" class="Generalizable">Œì‚Ä≤</a><a id="852" class="Symbol">;</a> <a id="854" href="BitML.Semantics.Configurations.Types.html#1525" class="Generalizable">Œì‚Ä≥</a><a id="856" class="Symbol">;</a> <a id="858" href="BitML.Semantics.Configurations.Types.html#1919" class="Generalizable">Œì‚Çú</a><a id="860" class="Symbol">;</a> <a id="862" href="BitML.Semantics.Configurations.Types.html#1922" class="Generalizable">Œì‚Çú‚Ä≤</a><a id="865" class="Symbol">;</a> <a id="867" href="BitML.BasicTypes.html#547" class="Generalizable">t</a><a id="868" class="Symbol">;</a> <a id="870" href="BitML.BasicTypes.html#551" class="Generalizable">t‚Ä≤</a><a id="872" class="Symbol">)</a>
<a id="874" class="Keyword">open</a> <a id="879" class="Keyword">import</a> <a id="886" href="ComputationalModel.html" class="Module">ComputationalModel</a> <a id="905" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="917" href="SecureCompilation.Lemma6.html#614" class="Bound">Honest</a> <a id="924" href="SecureCompilation.Lemma6.html#646" class="Bound">finPart</a> <a id="932" href="SecureCompilation.Lemma6.html#679" class="Bound">keypairs</a> as <a id="C"></a><a id="944" href="SecureCompilation.Lemma6.html#944" class="Module">C</a>
  <a id="948" class="Keyword">hiding</a> <a id="955" class="Symbol">(</a><a id="956" href="Bitcoin.Script.Base.html#1293" class="InductiveConstructor Operator">‚à£_‚à£</a><a id="959" class="Symbol">;</a> <a id="961" href="Bitcoin.Script.Base.html#917" class="InductiveConstructor">`</a><a id="962" class="Symbol">;</a> <a id="964" href="Bitcoin.BasicTypes.html#313" class="Generalizable">t</a><a id="965" class="Symbol">;</a> <a id="967" href="Bitcoin.BasicTypes.html#315" class="Generalizable">t‚Ä≤</a><a id="969" class="Symbol">)</a>
<a id="971" class="Keyword">open</a> <a id="976" class="Keyword">import</a> <a id="983" href="SecureCompilation.Compiler.html" class="Module">SecureCompilation.Compiler</a> <a id="1010" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="1022" href="SecureCompilation.Lemma6.html#614" class="Bound">Honest</a> <a id="1029" href="SecureCompilation.Lemma6.html#743" class="Bound">Œ∑</a>
<a id="1031" class="Keyword">open</a> <a id="1036" class="Keyword">import</a> <a id="1043" href="SecureCompilation.Coherence.html" class="Module">SecureCompilation.Coherence</a> <a id="1071" href="SecureCompilation.Lemma6.html#564" class="Bound">Participant</a> <a id="1083" href="SecureCompilation.Lemma6.html#614" class="Bound">Honest</a> <a id="1090" href="SecureCompilation.Lemma6.html#646" class="Bound">finPart</a> <a id="1098" href="SecureCompilation.Lemma6.html#679" class="Bound">keypairs</a> <a id="1107" href="SecureCompilation.Lemma6.html#743" class="Bound">Œ∑</a>

<a id="txout-preserves-value"></a><a id="1110" href="SecureCompilation.Lemma6.html#1110" class="Function">txout-preserves-value</a> <a id="1132" class="Symbol">:</a> <a id="1134" class="Symbol">‚àÄ</a> <a id="1136" class="Symbol">{</a><a id="1137" href="SecureCompilation.Lemma6.html#1137" class="Bound">ùï£‚àó</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="SymbolicModel.Helpers.html#1447" class="Datatype">‚Ñù‚àó</a> <a id="1145" href="SymbolicModel.Run.Base.html#443" class="Generalizable">RÀ¢</a><a id="1147" class="Symbol">}</a> <a id="1149" class="Symbol">‚Üí</a>
  <a id="1153" href="Prelude.InferenceRules.html#56094" class="Function Operator">‚àô</a> <a id="1155" href="SecureCompilation.Lemma6.html#1137" class="Bound">ùï£‚àó</a> <a id="1158" href="SecureCompilation.Coherence.html#33038" class="Datatype Operator">~‚Ä≤</a> <a id="1161" href="ComputationalModel.Strategy.html#1237" class="Generalizable">R·∂ú</a>
    <a id="1168" href="Prelude.InferenceRules.html#13683" class="Function Operator">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</a>
    <a id="1206" href="SymbolicModel.ValuePreservation.html#3306" class="Function">ValuePreserving ≥</a> <a id="1223" class="Symbol">(</a><a id="1224" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="1229" href="SecureCompilation.Lemma6.html#1137" class="Bound">ùï£‚àó</a><a id="1231" class="Symbol">)</a>
<a id="1233" href="SecureCompilation.Lemma6.html#1110" class="Function">txout-preserves-value</a> <a id="1255" class="Symbol">(</a><a id="1256" href="SecureCompilation.Coherence.html#33876" class="InductiveConstructor">step‚ÇÅ</a> <a id="1262" class="Symbol">{</a><a id="1263" class="Argument">RÀ¢</a> <a id="1266" class="Symbol">=</a> <a id="1268" href="SecureCompilation.Lemma6.html#1268" class="Bound">RÀ¢</a><a id="1270" class="Symbol">}{</a><a id="1272" href="SecureCompilation.Lemma6.html#1272" class="Bound">ùï£‚àó</a><a id="1274" class="Symbol">}{</a><a id="1276" class="Argument">ŒªÀ¢</a> <a id="1279" class="Symbol">=</a> <a id="1281" class="Symbol">(</a><a id="1282" href="SecureCompilation.Lemma6.html#1282" class="Bound">Œ±</a> <a id="1284" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1286" href="SecureCompilation.Lemma6.html#1286" class="Bound">Œì</a> <a id="1288" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="1291" href="SecureCompilation.Lemma6.html#1291" class="Bound">t</a> <a id="1293" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1295" class="Symbol">_</a> <a id="1297" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="1300" href="SecureCompilation.Lemma6.html#1300" class="Bound">t‚Ä≤</a> <a id="1303" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1305" href="SecureCompilation.Lemma6.html#1305" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="1310" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1312" class="Symbol">_</a> <a id="1314" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1316" href="SecureCompilation.Lemma6.html#1316" class="Bound">R‚âà</a><a id="1318" class="Symbol">)</a> <a id="1320" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1322" class="Symbol">_}</a> <a id="1325" href="SecureCompilation.Lemma6.html#1325" class="Bound">RÀ¢~R·∂ú</a> <a id="1331" href="SecureCompilation.Lemma6.html#1331" class="Bound">coh</a><a id="1334" class="Symbol">)</a>
  <a id="1338" class="Keyword">with</a> <a id="1343" href="SecureCompilation.Lemma6.html#1331" class="Bound">coh</a>
<a id="1347" class="CoverageProblem Symbol">...</a><a id="1350" class="CoverageProblem"> </a><a id="1351" class="CoverageProblem Symbol">|</a><a id="1352" class="CoverageProblem"> </a><a id="1353" href="SecureCompilation.Coherence.html#32124" class="CoverageProblem InductiveConstructor Operator">[L]</a><a id="1356" class="CoverageProblem"> </a><a id="1357" href="SecureCompilation.Coherence.html#1986" class="CoverageProblem InductiveConstructor">[1]</a><a id="1360" class="CoverageProblem"> </a><a id="1361" class="CoverageProblem Symbol">{</a><a id="1362" class="CoverageProblem Argument">‚ü®G‚ü©C</a><a id="1366" class="CoverageProblem"> </a><a id="1367" class="CoverageProblem Symbol">=</a><a id="1368" class="CoverageProblem"> </a><a id="1369" href="SecureCompilation.Lemma6.html#1369" class="CoverageProblem Bound">‚ü®G‚ü©C</a><a id="1373" class="CoverageProblem Symbol">}</a><a id="1374" class="CoverageProblem"> </a><a id="1375" class="CoverageProblem Symbol">_</a><a id="1376" class="CoverageProblem"> </a><a id="1377" href="SecureCompilation.Lemma6.html#1377" class="CoverageProblem Bound">‚àÉŒì‚âà</a><a id="1380" class="CoverageProblem"> </a><a id="1381" class="CoverageProblem Symbol">_</a><a id="1382" class="CoverageProblem"> </a><a id="1383" class="CoverageProblem Symbol">_</a><a id="1384" class="CoverageProblem"> </a><a id="1385" class="CoverageProblem Symbol">_</a>
  <a id="1389" class="Symbol">=</a> <a id="1391" href="SymbolicModel.Helpers.html#7153" class="Function">value-preserving‚áí</a> <a id="1409" class="Symbol">(</a><a id="1410" href="SecureCompilation.Lemma6.html#1110" class="Function">txout-preserves-value</a> <a id="1432" class="Bound">RÀ¢~R·∂ú</a><a id="1437" class="Symbol">)</a>
  <a id="1441" class="Keyword">where</a> <a id="1447" class="Keyword">open</a> <a id="1452" href="SymbolicModel.Helpers.html#6661" class="Module">H‚ÇÅ</a> <a id="1455" class="Symbol">(</a><a id="1456" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="1461" class="Bound">ùï£‚àó</a><a id="1463" class="Symbol">)</a> <a id="1465" class="Bound">t</a> <a id="1467" class="Bound">Œ±</a> <a id="1469" class="Bound">t</a> <a id="1471" class="Bound">Œì</a> <a id="1473" class="Bound">R‚âà</a> <a id="1476" href="SecureCompilation.Lemma6.html#1369" class="Bound">‚ü®G‚ü©C</a> <a id="1481" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="1486" href="SecureCompilation.Lemma6.html#1377" class="Bound">‚àÉŒì‚âà</a>
<a id="1490" class="CoverageProblem Symbol">...</a><a id="1493" class="CoverageProblem"> </a><a id="1494" class="CoverageProblem Symbol">|</a><a id="1495" class="CoverageProblem"> </a><a id="1496" href="SecureCompilation.Coherence.html#32124" class="CoverageProblem InductiveConstructor Operator">[L]</a><a id="1499" class="CoverageProblem"> </a><a id="1500" href="SecureCompilation.Coherence.html#2875" class="CoverageProblem InductiveConstructor">[2]</a><a id="1503" class="CoverageProblem"> </a><a id="1504" class="CoverageProblem Symbol">{</a><a id="1505" class="CoverageProblem Argument">‚ü®G‚ü©C</a><a id="1509" class="CoverageProblem"> </a><a id="1510" class="CoverageProblem Symbol">=</a><a id="1511" class="CoverageProblem"> </a><a id="1512" href="SecureCompilation.Lemma6.html#1512" class="CoverageProblem Bound">‚ü®G‚ü©C</a><a id="1516" class="CoverageProblem Symbol">}</a><a id="1517" class="CoverageProblem"> </a><a id="1518" class="CoverageProblem Symbol">{</a><a id="1519" class="CoverageProblem Argument">A</a><a id="1520" class="CoverageProblem"> </a><a id="1521" class="CoverageProblem Symbol">=</a><a id="1522" class="CoverageProblem"> </a><a id="1523" href="SecureCompilation.Lemma6.html#1523" class="CoverageProblem Bound">A</a><a id="1524" class="CoverageProblem Symbol">}</a><a id="1525" class="CoverageProblem"> </a><a id="1526" class="CoverageProblem Symbol">{</a><a id="1527" class="CoverageProblem Argument">Œî√óhÃÖ</a><a id="1531" class="CoverageProblem"> </a><a id="1532" class="CoverageProblem Symbol">=</a><a id="1533" class="CoverageProblem"> </a><a id="1534" href="SecureCompilation.Lemma6.html#1534" class="CoverageProblem Bound">Œî√óhÃÖ</a><a id="1538" class="CoverageProblem"> </a><a id="1539" class="CoverageProblem Symbol">}</a><a id="1540" class="CoverageProblem"> </a><a id="1541" class="CoverageProblem Symbol">{</a><a id="1542" class="CoverageProblem Argument">k‚Éó</a><a id="1544" class="CoverageProblem"> </a><a id="1545" class="CoverageProblem Symbol">=</a><a id="1546" class="CoverageProblem"> </a><a id="1547" href="SecureCompilation.Lemma6.html#1547" class="CoverageProblem Bound">k‚Éó</a><a id="1549" class="CoverageProblem Symbol">}</a><a id="1550" class="CoverageProblem"> </a><a id="1551" href="SecureCompilation.Lemma6.html#1551" class="CoverageProblem Bound">R‚âà</a><a id="1553" class="CoverageProblem"> </a><a id="1554" href="SecureCompilation.Lemma6.html#1554" class="CoverageProblem Bound">‚àÉŒì‚âà</a><a id="1557" class="CoverageProblem"> </a><a id="1558" href="SecureCompilation.Lemma6.html#1558" class="CoverageProblem Bound">as‚â°</a><a id="1561" class="CoverageProblem"> </a><a id="1562" href="SecureCompilation.Lemma6.html#1562" class="CoverageProblem Bound">All‚àâ</a><a id="1566" class="CoverageProblem"> </a><a id="1567" href="SecureCompilation.Lemma6.html#1567" class="CoverageProblem Bound">Hon‚áí</a><a id="1571" class="CoverageProblem"> </a><a id="1572" class="CoverageProblem Symbol">_</a><a id="1573" class="CoverageProblem"> </a><a id="1574" class="CoverageProblem Symbol">_</a><a id="1575" class="CoverageProblem"> </a><a id="1576" class="CoverageProblem Symbol">_</a><a id="1577" class="CoverageProblem"> </a><a id="1578" class="CoverageProblem Symbol">_</a><a id="1579" class="CoverageProblem"> </a><a id="1580" class="CoverageProblem Symbol">_</a>
  <a id="1584" class="Symbol">=</a> <a id="1586" href="SymbolicModel.Helpers.html#12947" class="Function">value-preserving‚áí</a> <a id="1604" class="Symbol">(</a><a id="1605" href="SecureCompilation.Lemma6.html#1110" class="Function">txout-preserves-value</a> <a id="1627" class="Bound">RÀ¢~R·∂ú</a><a id="1632" class="Symbol">)</a>
  <a id="1636" class="Keyword">where</a>
    <a id="1646" href="SecureCompilation.Lemma6.html#1646" class="Function Operator">_Œî</a> <a id="1649" class="Symbol">:</a> <a id="1651" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1656" class="Symbol">(</a><a id="1657" href="BitML.BasicTypes.html#261" class="Function">Secret</a> <a id="1664" href="Data.Product.html#1167" class="Function Operator">√ó</a> <a id="1666" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1672" href="Agda.Builtin.Nat.html#192" class="Datatype">‚Ñï</a><a id="1673" class="Symbol">)</a>
    <a id="1679" href="SecureCompilation.Lemma6.html#1646" class="Function Operator">_Œî</a> <a id="1682" class="Symbol">=</a> <a id="1684" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1688" class="Symbol">(Œª{</a> <a id="1692" class="Symbol">(</a><a id="1693" href="SecureCompilation.Lemma6.html#1693" class="Bound">s</a> <a id="1695" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1697" href="SecureCompilation.Lemma6.html#1697" class="Bound">mn</a> <a id="1700" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1702" class="Symbol">_)</a> <a id="1705" class="Symbol">‚Üí</a> <a id="1707" href="SecureCompilation.Lemma6.html#1693" class="Bound">s</a> <a id="1709" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1711" href="SecureCompilation.Lemma6.html#1697" class="Bound">mn</a> <a id="1714" class="Symbol">})</a> <a id="1717" href="SecureCompilation.Lemma6.html#1534" class="Bound">Œî√óhÃÖ</a>

    <a id="1727" href="SecureCompilation.Lemma6.html#1727" class="Function">sechash‚Å∫</a> <a id="1736" class="Symbol">:</a> <a id="1738" class="Symbol">(</a><a id="1739" href="Agda.Builtin.Sigma.html#252" class="Field">proj‚ÇÅ</a> <a id="1745" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1747" href="Data.List.Base.html#3699" class="Function">unzip</a> <a id="1753" href="SecureCompilation.Lemma6.html#1646" class="Function Operator">_Œî</a><a id="1755" class="Symbol">)</a> <a id="1757" href="Prelude.Lists.Mappings.html#708" class="Function Operator">‚Ü¶</a> <a id="1759" href="Agda.Builtin.Int.html#246" class="Datatype">‚Ñ§</a>
    <a id="1765" href="SecureCompilation.Lemma6.html#1727" class="Function">sechash‚Å∫</a> <a id="1774" href="SecureCompilation.Lemma6.html#1774" class="Bound">a‚àà</a> <a id="1777" class="Symbol">=</a>
      <a id="1785" class="Keyword">let</a> <a id="1789" class="Symbol">_</a> <a id="1791" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1793" href="SecureCompilation.Lemma6.html#1793" class="Bound">a√óm‚àà</a> <a id="1798" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1800" class="Symbol">_</a>    <a id="1805" class="Symbol">=</a> <a id="1807" href="Prelude.Lists.Core.html#1008" class="Function">‚àà-unzip‚ÅªÀ°</a> <a id="1817" href="SecureCompilation.Lemma6.html#1646" class="Function Operator">_Œî</a> <a id="1820" href="SecureCompilation.Lemma6.html#1774" class="Bound">a‚àà</a>
          <a id="1833" class="Symbol">(_</a> <a id="1836" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1838" class="Symbol">_</a> <a id="1840" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1842" href="SecureCompilation.Lemma6.html#1842" class="Bound">z</a><a id="1843" class="Symbol">)</a> <a id="1845" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1847" class="Symbol">_</a> <a id="1849" class="Symbol">=</a> <a id="1851" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">L.Mem.‚àà-map‚Åª</a> <a id="1864" class="Symbol">(Œª{</a> <a id="1868" class="Symbol">(</a><a id="1869" href="SecureCompilation.Lemma6.html#1869" class="Bound">s</a> <a id="1871" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1873" href="SecureCompilation.Lemma6.html#1873" class="Bound">mn</a> <a id="1876" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1878" class="Symbol">_)</a> <a id="1881" class="Symbol">‚Üí</a> <a id="1883" href="SecureCompilation.Lemma6.html#1869" class="Bound">s</a> <a id="1885" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1887" href="SecureCompilation.Lemma6.html#1873" class="Bound">mn</a> <a id="1890" class="Symbol">})</a> <a id="1893" href="SecureCompilation.Lemma6.html#1793" class="Bound">a√óm‚àà</a>
      <a id="1904" class="Keyword">in</a> <a id="1907" href="SecureCompilation.Lemma6.html#1842" class="Bound">z</a>

    <a id="1914" class="Keyword">open</a> <a id="1919" href="SymbolicModel.Helpers.html#8393" class="Module">H‚ÇÇ</a> <a id="1922" class="Symbol">(</a><a id="1923" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="1928" class="Bound">ùï£‚àó</a><a id="1930" class="Symbol">)</a> <a id="1932" class="Bound">t</a> <a id="1934" class="Bound">Œ±</a> <a id="1936" class="Bound">t</a> <a id="1938" class="Symbol">_</a> <a id="1940" href="SecureCompilation.Lemma6.html#1551" class="Bound">R‚âà</a> <a id="1943" href="SecureCompilation.Lemma6.html#1523" class="Bound">A</a> <a id="1945" href="SecureCompilation.Lemma6.html#1523" class="Bound">A</a> <a id="1947" href="SecureCompilation.Lemma6.html#1512" class="Bound">‚ü®G‚ü©C</a> <a id="1952" href="SecureCompilation.Lemma6.html#1646" class="Function Operator">_Œî</a> <a id="1955" href="SecureCompilation.Lemma6.html#1727" class="Function">sechash‚Å∫</a> <a id="1964" href="SecureCompilation.Lemma6.html#1547" class="Bound">k‚Éó</a> <a id="1967" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="1972" href="SecureCompilation.Lemma6.html#1554" class="Bound">‚àÉŒì‚âà</a>
<a id="1976" class="Comment">-- T0D0: Typechecking case [6] hangs: figure out the correct level of abstraction.</a>
<a id="2059" class="Comment">-- ... | [L] [6] {c = c} {Œì‚ÇÄ = Œì‚ÇÄ} {c‚Ä≤ = c‚Ä≤} {y‚Ä≤ = y‚Ä≤}</a>
<a id="2114" class="Comment">--               {ds = ds}{ss}{i} {v = v}{y}</a>
<a id="2159" class="Comment">--               t‚â° d‚â° R‚âà ‚àÉŒì‚âà fresh-y‚Ä≤ p‚ü¶Œî‚üß‚â° As‚â°‚àÖ</a>
<a id="2209" class="Comment">--   = value-preserving‚áí (txout-preserves-value RÀ¢~R·∂ú)</a>
<a id="2264" class="Comment">--   where</a>
<a id="2275" class="Comment">--     open ‚à£SELECT c i</a>
<a id="2299" class="Comment">--     _Œî  = || map (uncurry‚ÇÉ _‚à∂_‚ôØ_) ss</a>
<a id="2339" class="Comment">--     Œì‚ÇÇ  = _Œî ‚à£ Œì‚ÇÄ</a>

<a id="2361" class="Comment">--     open H‚ÇÜ (‚Ñù‚àó‚áí‚Ñù ùï£‚àó) t Œ± t‚Ä≤ c v y ds Œì‚ÇÇ c‚Ä≤ y‚Ä≤ R‚âà Œì‚ÜíŒì‚Ä≤ ‚àÉŒì‚âà using (module H‚ÇÜ‚Ä≤; Lift·∂ú)</a>

<a id="2450" class="Comment">--     open H‚ÇÜ‚Ä≤ (</a>
<a id="2468" class="Comment">--       let</a>
<a id="2481" class="Comment">--         ‚ü®G‚ü©C‚Ä≥ , _ , _ , c‚äÜ , anc = ANCESTOR {R = RÀ¢} {Œì = Œì} R‚âà (here refl)</a>
<a id="2560" class="Comment">--         ‚ü® G ‚ü© C‚Ä≥ = ‚ü®G‚ü©C‚Ä≥</a>

<a id="2589" class="Comment">--         d‚àà : d ‚àà subterms·µÉ‚Ä≤ ‚ü®G‚ü©C‚Ä≥</a>
<a id="2626" class="Comment">--         d‚àà = c‚äÜ (L.Mem.‚àà-lookup i)</a>

<a id="2665" class="Comment">--         T : ‚àÉTx</a>
<a id="2684" class="Comment">--         T = let _ , ‚àÄd‚àó = COMPILE (Lift·∂ú anc)</a>
<a id="2733" class="Comment">--                 _ , T·µà = ‚àÄd‚àó d‚àà :~ d‚â° ‚ü™ ‚àÉTx·∂ú ‚ü´</a>
<a id="2783" class="Comment">--             in -, -, T·µà</a>
<a id="2810" class="Comment">--       in</a>
<a id="2822" class="Comment">--         T at 0F</a>
<a id="2841" class="Comment">--       )</a>
<a id="2852" class="CoverageProblem Symbol">...</a><a id="2855" class="CoverageProblem"> </a><a id="2856" class="CoverageProblem Symbol">|</a><a id="2857" class="CoverageProblem"> </a><a id="2858" href="SecureCompilation.Coherence.html#32124" class="CoverageProblem InductiveConstructor Operator">[L]</a><a id="2861" class="CoverageProblem"> </a><a id="2862" href="SecureCompilation.Coherence.html#28258" class="CoverageProblem InductiveConstructor">[18]</a><a id="2866" class="CoverageProblem"> </a><a id="2867" class="CoverageProblem Symbol">_</a><a id="2868" class="CoverageProblem"> </a><a id="2869" href="SecureCompilation.Lemma6.html#2869" class="CoverageProblem Bound">‚àÉŒì‚âà</a>
  <a id="2875" class="Symbol">=</a> <a id="2877" href="SymbolicModel.Helpers.html#38077" class="Function">value-preserving‚áí</a> <a id="2895" class="Symbol">(</a><a id="2896" href="SecureCompilation.Lemma6.html#1110" class="Function">txout-preserves-value</a> <a id="2918" class="Bound">RÀ¢~R·∂ú</a><a id="2923" class="Symbol">)</a>
  <a id="2927" class="Keyword">where</a> <a id="2933" class="Keyword">open</a> <a id="2938" href="SymbolicModel.Helpers.html#37569" class="Module">H‚ÇÅ‚Çà</a> <a id="2942" class="Symbol">(</a><a id="2943" href="SymbolicModel.Helpers.html#1693" class="Function">‚Ñù‚àó‚áí‚Ñù</a> <a id="2948" class="Bound">ùï£‚àó</a><a id="2950" class="Symbol">)</a> <a id="2952" class="Bound">t</a> <a id="2954" class="Bound">Œ±</a> <a id="2956" class="Bound">t‚Ä≤</a> <a id="2959" class="Bound">Œì</a> <a id="2961" class="Bound">R‚âà</a> <a id="2964" class="Bound">Œì‚ÜíŒì‚Ä≤</a> <a id="2969" href="SecureCompilation.Lemma6.html#2869" class="Bound">‚àÉŒì‚âà</a>

<a id="2974" href="SecureCompilation.Lemma6.html#1110" class="CatchallClause Function">txout-preserves-value</a><a id="2995" class="CatchallClause"> </a><a id="2996" class="CatchallClause Symbol">_</a> <a id="2998" class="Symbol">=</a> <a id="3000" class="Hole">{!!}</a>
<a id="3005" class="Comment">{-
... | [L] [2]  R‚âà ‚àÉŒì‚âà as‚â° All‚àâ Hon‚áí ‚àÉB h‚â° h‚ààO unique-h h‚ôØsechash = {!!}
... | [L] [3]  R‚âà ‚àÉŒì‚âà committedA A‚ààper ‚àÉB = {!!}
... | [L] [4]  R‚âà ‚àÉŒì‚âà fresh-z = {!!}
... | [L] [5]  d‚â° R‚âà ‚àÉŒì‚âà = {!!}
... | [L] [6]  t‚â° d‚â° R‚âà ‚àÉŒì‚âà fresh-y‚Ä≤ p‚ü¶Œî‚üß‚â° As‚â°‚àÖ = {!!}
... | [L] [7]  R‚âà ‚àÉŒì‚âà fresh-ys ‚àÉB ‚àÉŒ± a‚àà ‚àÉŒª first-Œª·∂ú = {!!}
... | [L] [8]  t‚â° d‚â° R‚âà fresh-xs As‚â°‚àÖ ‚àÉŒì‚âà = {!!}
... | [L] [9]  d‚â° R‚âà ‚àÉŒì‚âà frsg-x As‚â°‚àÖ ‚àÄ‚â§t = {!!}
... | [L] [10] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = {!!}
... | [L] [11] R‚âà ‚àÉŒì‚âà fresh-y = {!!}
... | [L] [12] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = {!!}
... | [L] [13] R‚âà ‚àÉŒì‚âà fresh-ys = {!!}
... | [L] [14] R‚âà ‚àÉŒì‚âà ‚àÉŒª first-Œª·∂ú = {!!}
... | [L] [15] R‚âà ‚àÉŒì‚âà fresh-y = {!!}
... | [R] [16] R‚âà ‚àÉŒì‚âà fresh-y T ‚äÜins T‚àà first-Œª·∂ú ¬¨coh = {!!}
... | [R] [17] R‚âà ‚àÉŒì‚âà T ‚äÜins ¬¨coh = {!!}
-}</a>

<a id="3750" class="Comment">-- _‚àà·µ§‚Çú‚Çì‚Çí_ : TxInput‚Ä≤ ‚Üí Blockchain ‚Üí Set</a>
<a id="3791" class="Comment">-- txi ‚àà·µ§‚Çú‚Çì‚Çí b = hashTx‚Å± txi ‚ààÀ¢ UTXO b</a>

<a id="3831" class="Comment">-- lemma6 :</a>
<a id="3843" class="Comment">--     (R~ : RÀ¢ ~ R·∂ú) ‚Üí let ùï£ = R~ .proj‚ÇÅ in</a>
<a id="3888" class="Comment">--     (c‚àà : RÀ¢ ‚âà‚ãØ ‚ü® c , v ‚ü©at x ‚ãØ)</a>
<a id="3924" class="Comment">--     --‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî</a>
<a id="3958" class="Comment">--   ‚Üí (ùï£ ‚àôtxoutC c‚àà) ‚àà·µ§‚Çú‚Çì‚Çí ùîπ R·∂ú</a>

<a id="3992" class="Comment">-- lemma6 (ùï£ , base init R‚âà cinit txout‚â° sechash‚àÖ Œ∫‚àÖ) c‚àà</a>
<a id="4049" class="Comment">--   = ‚ä•-elim</a>
<a id="4063" class="Comment">--   $ Initial‚áí‚àâ init</a>
<a id="4085" class="Comment">--   $ c‚àà :~ R‚âà ‚ü™ (Œª ‚óÜ ‚Üí _ ‚àà·∂ú ‚óÜ .end .cfg) ‚ü´</a>

<a id="4131" class="Comment">-- lemma6 (_ , step‚ÇÅ {‚àÉùï£@(RÀ¢ , ùï£)}{Œì‚Çú}{R·∂ú}{Œª·∂ú}{ùïí}{ùï£‚Ä≤} R~ coh) c‚àà</a>
<a id="4196" class="Comment">--   = {!!}</a>

<a id="4209" class="Comment">-- -- lemma6 {v = v} {x = x} {c = c} (ùï£ , step‚ÇÇ {Œª·∂ú} R~ coh) c‚àà</a>
<a id="4273" class="Comment">-- --   = let txi@((_ , _ , T) at o) , T‚àà , ‚â°v , T‚ôØ‚â° = lemma6 (ùï£ , R~) c‚àà</a>
<a id="4347" class="Comment">-- --     in  txi , {!‚àà-‚à™‚Å∫À° (T ‚ôØ at o) (UTXO txs ‚îÄ STXO‚Çú‚Çì tx) (UTXO‚Çú‚Çì tx) !} , ‚â°v , T‚ôØ‚â°</a>
<a id="4435" class="Comment">-- -- lemma6 {RÀ¢}{R·∂ú = ùïì@(.(submit T) ‚à∑ ls)} {c = c} {v = v} {x = x}</a>
<a id="4504" class="Comment">-- --        (ùï£@(record{ txout‚Ä≤ = txout}) , step‚ÇÇ {Œª·∂ú = .(submit T)} R~ ([1] {T = T} ins‚ôØ)) c‚àà</a>
<a id="4599" class="Comment">-- --   = let txi@((_ , _ , T‚Ä≤) at o) = ùï£ ‚àôtxoutC c‚àà</a>
<a id="4652" class="Comment">-- --         T‚àà‚Ä≤ , ‚â°v , T‚ôØ‚â° = lemma6 (ùï£ , R~) c‚àà</a>
<a id="4702" class="Comment">-- --         T‚Çí‚Ä≤ = T‚Ä≤ ‚ôØ at to‚Ñï o</a>

<a id="4737" class="Comment">-- --         T‚àâ : T‚Çí‚Ä≤ ‚àâÀ¢ STXO‚Çú‚Çì T</a>
<a id="4772" class="Comment">-- --         T‚àâ x‚àà =</a>
<a id="4794" class="Comment">-- --           let</a>
<a id="4814" class="Comment">-- --             x‚àà‚Ä≤ : T‚Çí‚Ä≤ ‚àà V.toList (T .proj‚ÇÇ .proj‚ÇÇ .inputs)</a>
<a id="4879" class="Comment">-- --             x‚àà‚Ä≤ = ‚ààÀ¢-fromList‚Åª x‚àà</a>

<a id="4920" class="Comment">-- --             Œì‚àà : ‚ü® c , v ‚ü©at x ‚àà allCfgs RÀ¢</a>
<a id="4970" class="Comment">-- --             Œì‚àà = {!!}</a>

<a id="4999" class="Comment">-- --             txi‚Ä≤ : TxInput‚Ä≤</a>
<a id="5033" class="Comment">-- --             txi‚Ä≤ = Txout‚àà txout {! end‚ààallCfgs·µó !} (here refl)</a>

<a id="5103" class="Comment">-- --             T‚Çí‚àà : T‚Çí‚Ä≤ ‚àà (hashTx‚Å± &lt;$&gt; codom txout)</a>
<a id="5159" class="Comment">-- --             T‚Çí‚àà = {!!}</a>
<a id="5188" class="Comment">-- --           in</a>
<a id="5207" class="Comment">-- --             ins‚ôØ (x‚àà‚Ä≤ , T‚Çí‚àà)</a>

<a id="5243" class="Comment">-- --         T‚àà : T‚Çí‚Ä≤ ‚ààÀ¢ UTXO (ùîπ ùïì)</a>
<a id="5280" class="Comment">-- --         T‚àà = ‚àà-‚à™‚Å∫À° T‚Çí‚Ä≤ (UTXO (ùîπ ls) ‚îÄ STXO‚Çú‚Çì T)</a>
<a id="5334" class="Comment">-- --                        (UTXO‚Çú‚Çì T)</a>
<a id="5374" class="Comment">-- --                        (‚àà-‚îÄ‚Å∫ _ (UTXO $ ùîπ ls) (STXO‚Çú‚Çì T) T‚àà‚Ä≤ T‚àâ)</a>
<a id="5444" class="Comment">-- --     in  txi , T‚àà , ‚â°v , T‚ôØ‚â°</a>


<a id="5480" class="Comment">-- -- lemma6 (ùï£ , step‚ÇÇ {Œª·∂ú = .(A ‚ÜíO‚à∂ m)}  R~ ([2] {A = A}{m} (inj‚ÇÅ refl))) c‚àà = lemma6 (ùï£ , R~) c‚àà</a>
<a id="5580" class="Comment">-- -- lemma6 (ùï£ , step‚ÇÇ {Œª·∂ú = .(O‚Üí A ‚à∂ m)} R~ ([2] {A = A}{m} (inj‚ÇÇ refl))) c‚àà = lemma6 (ùï£ , R~) c‚àà</a>
<a id="5680" class="Comment">-- -- lemma6 (ùï£ , step‚ÇÇ {Œª·∂ú = .(A ‚Üí‚àó‚à∂ m)}  R~ ([3] {A}{m} _))               c‚àà = lemma6 (ùï£ , R~) c‚àà</a>
</pre></body></html>