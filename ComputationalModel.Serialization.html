<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ComputationalModel.Serialization</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml-to-bitcoin/tree/master/ComputationalModel/Serialization.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="ComputationalModel.Serialization.html" class="Module">ComputationalModel.Serialization</a> <a id="41" class="Keyword">where</a>

<a id="48" class="Keyword">open</a> <a id="53" class="Keyword">import</a> <a id="60" href="Prelude.Init.html" class="Module">Prelude.Init</a><a id="72" class="Symbol">;</a> <a id="74" class="Keyword">open</a> <a id="79" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Prelude.Newtype.html" class="Module">Prelude.Newtype</a>

<a id="118" class="Keyword">open</a> <a id="123" class="Keyword">import</a> <a id="130" href="Bitcoin.html" class="Module">Bitcoin</a>
<a id="138" class="Keyword">open</a> <a id="143" class="Keyword">import</a> <a id="150" href="Prelude.Serializable.html" class="Module">Prelude.Serializable</a> <a id="171" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a> <a id="178" class="Keyword">public</a>

<a id="186" class="Keyword">private</a> <a id="194" class="Keyword">variable</a>
  <a id="205" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="207" class="Symbol">:</a> <a id="209" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="214" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="215" class="Symbol">;</a> <a id="217" href="ComputationalModel.Serialization.html#217" class="Generalizable">Y</a> <a id="219" class="Symbol">:</a> <a id="221" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="226" href="Prelude.Init.html#263" class="Generalizable">ℓ′</a><a id="228" class="Symbol">;</a> <a id="230" href="ComputationalModel.Serialization.html#230" class="Generalizable">P</a> <a id="232" class="Symbol">:</a> <a id="234" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="236" class="Symbol">→</a> <a id="238" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="243" href="Prelude.Init.html#263" class="Generalizable">ℓ′</a>
  <a id="248" href="ComputationalModel.Serialization.html#248" class="Generalizable">A</a> <a id="250" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a> <a id="252" class="Symbol">:</a> <a id="254" href="Agda.Primitive.html#320" class="Primitive">Type</a>
  <a id="261" href="ComputationalModel.Serialization.html#261" class="Generalizable">x</a> <a id="263" class="Symbol">:</a> <a id="265" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a><a id="266" class="Symbol">;</a> <a id="268" href="ComputationalModel.Serialization.html#268" class="Generalizable">y</a> <a id="270" class="Symbol">:</a> <a id="272" href="ComputationalModel.Serialization.html#217" class="Generalizable">Y</a>
  <a id="276" href="ComputationalModel.Serialization.html#276" class="Generalizable">k</a> <a id="278" href="ComputationalModel.Serialization.html#278" class="Generalizable">k′</a> <a id="281" class="Symbol">:</a> <a id="283" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>

<a id="292" class="Keyword">postulate</a> <a id="302" class="Keyword">instance</a>
  <a id="Serializable-⊎"></a><a id="313" href="ComputationalModel.Serialization.html#313" class="Postulate">Serializable-⊎</a> <a id="328" class="Symbol">:</a> <a id="330" class="Symbol">⦃</a> <a id="332" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="345" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="347" class="Symbol">⦄</a> <a id="349" class="Symbol">→</a> <a id="351" class="Symbol">⦃</a> <a id="353" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="366" href="ComputationalModel.Serialization.html#217" class="Generalizable">Y</a> <a id="368" class="Symbol">⦄</a> <a id="370" class="Symbol">→</a> <a id="372" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="385" class="Symbol">(</a><a id="386" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="388" href="Data.Sum.Base.html#743" class="Datatype Operator">⊎</a> <a id="390" href="ComputationalModel.Serialization.html#217" class="Generalizable">Y</a><a id="391" class="Symbol">)</a>
  <a id="Serializable-Σ"></a><a id="395" href="ComputationalModel.Serialization.html#395" class="Postulate">Serializable-Σ</a> <a id="410" class="Symbol">:</a> <a id="412" class="Symbol">⦃</a> <a id="414" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="427" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="429" class="Symbol">⦄</a> <a id="431" class="Symbol">→</a> <a id="433" class="Symbol">⦃</a> <a id="435" class="Symbol">∀</a> <a id="437" class="Symbol">{</a><a id="438" href="ComputationalModel.Serialization.html#438" class="Bound">x</a><a id="439" class="Symbol">}</a> <a id="441" class="Symbol">→</a> <a id="443" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="456" class="Symbol">(</a><a id="457" href="ComputationalModel.Serialization.html#230" class="Generalizable">P</a> <a id="459" href="ComputationalModel.Serialization.html#438" class="Bound">x</a><a id="460" class="Symbol">)</a> <a id="462" class="Symbol">⦄</a> <a id="464" class="Symbol">→</a>
    <a id="470" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="483" class="Symbol">(</a><a id="484" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a> <a id="486" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="488" href="ComputationalModel.Serialization.html#230" class="Generalizable">P</a><a id="489" class="Symbol">)</a>
  <a id="Serializable-List"></a><a id="493" href="ComputationalModel.Serialization.html#493" class="Postulate">Serializable-List</a> <a id="511" class="Symbol">:</a> <a id="513" class="Symbol">⦃</a> <a id="515" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="528" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a> <a id="530" class="Symbol">⦄</a> <a id="532" class="Symbol">→</a> <a id="534" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="547" class="Symbol">(</a><a id="548" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="553" href="ComputationalModel.Serialization.html#205" class="Generalizable">X</a><a id="554" class="Symbol">)</a>

  <a id="Serialiazable-String"></a><a id="559" href="ComputationalModel.Serialization.html#559" class="Postulate">Serialiazable-String</a> <a id="580" class="Symbol">:</a> <a id="582" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="595" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
  <a id="Serializable-ℕ"></a><a id="604" href="ComputationalModel.Serialization.html#604" class="Postulate">Serializable-ℕ</a>       <a id="625" class="Symbol">:</a> <a id="627" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="640" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a>
  <a id="Serializable-Bool"></a><a id="644" href="ComputationalModel.Serialization.html#644" class="Postulate">Serializable-Bool</a>    <a id="665" class="Symbol">:</a> <a id="667" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="680" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a>
  <a id="Serializable-ℤ"></a><a id="687" href="ComputationalModel.Serialization.html#687" class="Postulate">Serializable-ℤ</a>       <a id="708" class="Symbol">:</a> <a id="710" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="723" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="Serialiazable-Tx"></a><a id="727" href="ComputationalModel.Serialization.html#727" class="Postulate">Serialiazable-Tx</a>     <a id="748" class="Symbol">:</a> <a id="750" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="763" class="Symbol">(</a><a id="764" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="767" href="Bitcoin.Tx.Base.html#2058" class="Generalizable">i</a> <a id="769" href="Bitcoin.Tx.Base.html#2063" class="Generalizable">o</a><a id="770" class="Symbol">)</a>

<a id="773" class="Keyword">private</a>
  <a id="783" href="ComputationalModel.Serialization.html#783" class="Function">_</a> <a id="785" class="Symbol">=</a> <a id="787" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="800" href="Bitcoin.Tx.Base.html#1326" class="Function">∃Tx</a>    <a id="807" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="809" href="Function.Base.html#4821" class="Function">it</a>
  <a id="814" href="ComputationalModel.Serialization.html#814" class="Function">_</a> <a id="816" class="Symbol">=</a> <a id="818" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="831" href="Bitcoin.BasicTypes.html#351" class="Function">HashId</a> <a id="838" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="840" href="Function.Base.html#4821" class="Function">it</a>

<a id="_≢′_"></a><a id="844" href="ComputationalModel.Serialization.html#844" class="Function Operator">_≢′_</a> <a id="849" class="Symbol">:</a> <a id="851" class="Symbol">∀</a> <a id="853" class="Symbol">{</a><a id="854" href="ComputationalModel.Serialization.html#854" class="Bound">A</a> <a id="856" class="Symbol">:</a> <a id="858" href="Agda.Primitive.html#320" class="Primitive">Type</a> <a id="863" href="Prelude.Init.html#261" class="Generalizable">ℓ</a><a id="864" class="Symbol">}</a> <a id="866" class="Symbol">→</a> <a id="868" href="Relation.Binary.Core.html#891" class="Function">Rel</a> <a id="872" href="ComputationalModel.Serialization.html#854" class="Bound">A</a> <a id="874" class="Symbol">_</a>
<a id="876" href="ComputationalModel.Serialization.html#844" class="Function Operator">_≢′_</a> <a id="881" class="Symbol">=</a> <a id="883" href="Prelude.Newtype.html#723" class="Function">newtype²</a> <a id="892" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">_≢_</a>

<a id="897" class="Keyword">postulate</a>
  <a id="909" class="Comment">-- signing with different keys never collides</a>
  <a id="SIG≢"></a><a id="957" href="ComputationalModel.Serialization.html#957" class="Postulate">SIG≢</a> <a id="962" class="Symbol">:</a> <a id="964" class="Symbol">⦃</a> <a id="966" href="ComputationalModel.Serialization.html#276" class="Generalizable">k</a> <a id="968" href="ComputationalModel.Serialization.html#844" class="Function Operator">≢′</a> <a id="971" href="ComputationalModel.Serialization.html#278" class="Generalizable">k′</a> <a id="974" class="Symbol">⦄</a> <a id="976" class="Symbol">→</a> <a id="978" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="982" href="ComputationalModel.Serialization.html#276" class="Generalizable">k</a> <a id="984" href="ComputationalModel.Serialization.html#261" class="Generalizable">x</a> <a id="986" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="988" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="992" href="ComputationalModel.Serialization.html#278" class="Generalizable">k′</a> <a id="995" href="ComputationalModel.Serialization.html#268" class="Generalizable">y</a>

  <a id="1000" class="Comment">-- encodings of different values of different types never collide</a>
  <a id="encode≢"></a><a id="1068" href="ComputationalModel.Serialization.html#1068" class="Postulate">encode≢</a> <a id="1076" class="Symbol">:</a> <a id="1078" class="Symbol">⦃</a> <a id="1080" href="ComputationalModel.Serialization.html#1080" class="Bound">_</a> <a id="1082" class="Symbol">:</a> <a id="1084" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="1097" href="ComputationalModel.Serialization.html#248" class="Generalizable">A</a> <a id="1099" class="Symbol">⦄</a> <a id="1101" class="Symbol">⦃</a> <a id="1103" href="ComputationalModel.Serialization.html#1103" class="Bound">_</a> <a id="1105" class="Symbol">:</a> <a id="1107" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="1120" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a> <a id="1122" class="Symbol">⦄</a> <a id="1124" class="Symbol">{</a><a id="1125" href="ComputationalModel.Serialization.html#1125" class="Bound">a</a> <a id="1127" class="Symbol">:</a> <a id="1129" href="ComputationalModel.Serialization.html#248" class="Generalizable">A</a><a id="1130" class="Symbol">}</a> <a id="1132" class="Symbol">{</a><a id="1133" href="ComputationalModel.Serialization.html#1133" class="Bound">b</a> <a id="1135" class="Symbol">:</a> <a id="1137" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a><a id="1138" class="Symbol">}</a> <a id="1140" class="Symbol">→</a>
    <a id="1146" class="Symbol">⦃</a> <a id="1148" href="ComputationalModel.Serialization.html#248" class="Generalizable">A</a> <a id="1150" href="ComputationalModel.Serialization.html#844" class="Function Operator">≢′</a> <a id="1153" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a> <a id="1155" class="Symbol">⦄</a> <a id="1157" class="Symbol">→</a> <a id="1159" href="Prelude.Serializable.html#183" class="Field">encode</a> <a id="1166" href="ComputationalModel.Serialization.html#1125" class="Bound">a</a> <a id="1168" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1170" href="Prelude.Serializable.html#183" class="Field">encode</a> <a id="1177" href="ComputationalModel.Serialization.html#1133" class="Bound">b</a>

  <a id="SIG≢encode"></a><a id="1182" href="ComputationalModel.Serialization.html#1182" class="Postulate">SIG≢encode</a> <a id="1193" class="Symbol">:</a> <a id="1195" class="Symbol">∀</a> <a id="1197" class="Symbol">⦃</a> <a id="1199" href="ComputationalModel.Serialization.html#1199" class="Bound">_</a> <a id="1201" class="Symbol">:</a> <a id="1203" href="Prelude.Serializable.html#134" class="Record">Serializable</a> <a id="1216" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a> <a id="1218" class="Symbol">⦄</a> <a id="1220" class="Symbol">{</a><a id="1221" href="ComputationalModel.Serialization.html#1221" class="Bound">k</a><a id="1222" class="Symbol">}</a> <a id="1224" class="Symbol">{</a><a id="1225" href="ComputationalModel.Serialization.html#1225" class="Bound">x</a> <a id="1227" class="Symbol">:</a> <a id="1229" href="ComputationalModel.Serialization.html#248" class="Generalizable">A</a><a id="1230" class="Symbol">}</a> <a id="1232" class="Symbol">{</a><a id="1233" href="ComputationalModel.Serialization.html#1233" class="Bound">y</a> <a id="1235" class="Symbol">:</a> <a id="1237" href="ComputationalModel.Serialization.html#250" class="Generalizable">B</a><a id="1238" class="Symbol">}</a> <a id="1240" class="Symbol">→</a>
    <a id="1246" href="Bitcoin.Crypto.html#668" class="Postulate">SIG</a> <a id="1250" href="ComputationalModel.Serialization.html#1221" class="Bound">k</a> <a id="1252" href="ComputationalModel.Serialization.html#1225" class="Bound">x</a> <a id="1254" href="Relation.Binary.PropositionalEquality.Core.html#839" class="Function Operator">≢</a> <a id="1256" href="Prelude.Serializable.html#183" class="Field">encode</a> <a id="1263" href="ComputationalModel.Serialization.html#1233" class="Bound">y</a>
</pre></body></html>