<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SymbolicModel.Stripping</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Comment">------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Stripping sensitive information from runs (as well as other elements).</a>
<a id="187" class="Comment">------------------------------------------------------------------------</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="285" class="Keyword">hiding</a> <a id="292" class="Symbol">(</a><a id="293" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a><a id="294" class="Symbol">)</a>
<a id="296" class="Keyword">open</a> <a id="301" class="Keyword">import</a> <a id="308" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Prelude.Collections.html" class="Module">Prelude.Collections</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="441" class="Keyword">open</a> <a id="446" class="Keyword">import</a> <a id="453" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Prelude.Closures.html" class="Module">Prelude.Closures</a>
<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>

<a id="527" class="Keyword">module</a> <a id="534" href="SymbolicModel.Stripping.html" class="Module">SymbolicModel.Stripping</a>
  <a id="560" class="Symbol">(</a><a id="561" href="SymbolicModel.Stripping.html#561" class="Bound">Participant</a> <a id="573" class="Symbol">:</a> <a id="575" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="578" class="Symbol">)</a>
  <a id="582" class="Symbol">⦃</a> <a id="584" href="SymbolicModel.Stripping.html#584" class="Bound">_</a> <a id="586" class="Symbol">:</a> <a id="588" href="Prelude.DecEq.Core.html#97" class="Record">DecEq</a> <a id="594" href="SymbolicModel.Stripping.html#561" class="Bound">Participant</a> <a id="606" class="Symbol">⦄</a>
  <a id="610" class="Symbol">(</a><a id="611" href="SymbolicModel.Stripping.html#611" class="Bound">Honest</a> <a id="618" class="Symbol">:</a> <a id="620" href="Data.List.NonEmpty.Base.html#1079" class="Record">List⁺</a> <a id="626" href="SymbolicModel.Stripping.html#561" class="Bound">Participant</a><a id="637" class="Symbol">)</a>
  <a id="641" class="Keyword">where</a>

<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="SymbolicModel.Run.html" class="Module">SymbolicModel.Run</a> <a id="678" href="SymbolicModel.Stripping.html#561" class="Bound">Participant</a> <a id="690" href="SymbolicModel.Stripping.html#611" class="Bound">Honest</a>

<a id="698" class="Keyword">record</a> <a id="Strippable"></a><a id="705" href="SymbolicModel.Stripping.html#705" class="Record">Strippable</a> <a id="716" class="Symbol">(</a><a id="717" href="SymbolicModel.Stripping.html#717" class="Bound">A</a> <a id="719" class="Symbol">:</a> <a id="721" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="724" class="Symbol">)</a> <a id="726" class="Symbol">:</a> <a id="728" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="732" class="Keyword">where</a>
  <a id="740" class="Keyword">field</a> <a id="Strippable._∗"></a><a id="746" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="749" class="Symbol">:</a> <a id="751" href="SymbolicModel.Stripping.html#717" class="Bound">A</a> <a id="753" class="Symbol">→</a> <a id="755" href="SymbolicModel.Stripping.html#717" class="Bound">A</a>
<a id="757" class="Keyword">open</a> <a id="762" href="SymbolicModel.Stripping.html#705" class="Module">Strippable</a> <a id="773" class="Symbol">⦃...⦄</a> <a id="779" class="Keyword">public</a>

<a id="787" class="Keyword">instance</a>
  <a id="∗ᶜ"></a><a id="798" href="SymbolicModel.Stripping.html#798" class="Function">∗ᶜ</a> <a id="801" class="Symbol">:</a> <a id="803" href="SymbolicModel.Stripping.html#705" class="Record">Strippable</a> <a id="814" href="BitML.Semantics.Configurations.Types.html#670" class="Datatype">Configuration</a>
  <a id="830" href="SymbolicModel.Stripping.html#798" class="Function">∗ᶜ</a> <a id="833" class="Symbol">.</a><a id="834" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="837" href="SymbolicModel.Stripping.html#837" class="Bound">c</a> <a id="839" class="Keyword">with</a> <a id="844" href="SymbolicModel.Stripping.html#837" class="Bound">c</a>
  <a id="848" class="Symbol">...</a> <a id="852" class="Symbol">|</a> <a id="854" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟨</a> <a id="856" href="SymbolicModel.Stripping.html#856" class="Bound">p</a> <a id="858" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">∶</a> <a id="860" href="SymbolicModel.Stripping.html#860" class="Bound">a</a> <a id="862" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">♯</a> <a id="864" class="Symbol">_</a> <a id="866" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟩</a> <a id="868" class="Symbol">=</a> <a id="870" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟨</a> <a id="872" href="SymbolicModel.Stripping.html#856" class="Bound">p</a> <a id="874" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">∶</a> <a id="876" href="SymbolicModel.Stripping.html#860" class="Bound">a</a> <a id="878" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">♯</a> <a id="880" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="888" href="BitML.Semantics.Configurations.Types.html#1137" class="InductiveConstructor Operator">⟩</a>
  <a id="892" class="Symbol">...</a> <a id="896" class="Symbol">|</a> <a id="898" href="SymbolicModel.Stripping.html#898" class="Bound">l</a> <a id="900" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="902" href="SymbolicModel.Stripping.html#902" class="Bound">r</a>         <a id="912" class="Symbol">=</a> <a id="914" href="SymbolicModel.Stripping.html#898" class="Bound">l</a> <a id="916" href="SymbolicModel.Stripping.html#746" class="Field Operator">∗</a> <a id="918" href="BitML.Semantics.Configurations.Types.html#1333" class="InductiveConstructor Operator">∣</a> <a id="920" href="SymbolicModel.Stripping.html#902" class="Bound">r</a> <a id="922" href="SymbolicModel.Stripping.html#746" class="Field Operator">∗</a>
  <a id="926" class="CatchallClause Symbol">...</a><a id="929" class="CatchallClause"> </a><a id="930" class="CatchallClause Symbol">|</a><a id="931" class="CatchallClause"> </a><a id="932" class="CatchallClause Symbol">_</a>             <a id="946" class="Symbol">=</a> <a id="948" class="Bound">c</a>

  <a id="∗ᵗ"></a><a id="953" href="SymbolicModel.Stripping.html#953" class="Function">∗ᵗ</a> <a id="956" class="Symbol">:</a> <a id="958" href="SymbolicModel.Stripping.html#705" class="Record">Strippable</a> <a id="969" href="BitML.Semantics.Configurations.Types.html#1702" class="Record">TimedConfiguration</a>
  <a id="990" href="SymbolicModel.Stripping.html#953" class="Function">∗ᵗ</a> <a id="993" class="Symbol">.</a><a id="994" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="997" class="Symbol">(</a><a id="998" href="SymbolicModel.Stripping.html#998" class="Bound">Γ</a> <a id="1000" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="1003" href="SymbolicModel.Stripping.html#1003" class="Bound">t</a><a id="1004" class="Symbol">)</a> <a id="1006" class="Symbol">=</a> <a id="1008" class="Symbol">(</a><a id="1009" href="SymbolicModel.Stripping.html#998" class="Bound">Γ</a> <a id="1011" href="SymbolicModel.Stripping.html#746" class="Field Operator">∗</a><a id="1012" class="Symbol">)</a> <a id="1014" href="BitML.Semantics.Configurations.Types.html#1747" class="InductiveConstructor Operator">at</a> <a id="1017" href="SymbolicModel.Stripping.html#1003" class="Bound">t</a>

  <a id="∗ˡ"></a><a id="1022" href="SymbolicModel.Stripping.html#1022" class="Function">∗ˡ</a> <a id="1025" class="Symbol">:</a> <a id="1027" href="SymbolicModel.Stripping.html#705" class="Record">Strippable</a> <a id="1038" href="BitML.Semantics.Label.html#537" class="Datatype">Label</a>
  <a id="1046" href="SymbolicModel.Stripping.html#1022" class="Function">∗ˡ</a> <a id="1049" class="Symbol">.</a><a id="1050" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="1053" href="SymbolicModel.Stripping.html#1053" class="Bound">l</a> <a id="1055" class="Keyword">with</a> <a id="1060" href="SymbolicModel.Stripping.html#1053" class="Bound">l</a>
  <a id="1064" class="Symbol">...</a> <a id="1068" class="Symbol">|</a> <a id="1070" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="1083" href="SymbolicModel.Stripping.html#1083" class="Bound">p</a> <a id="1085" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="1087" href="SymbolicModel.Stripping.html#1087" class="Bound">ad</a> <a id="1090" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="1092" class="Symbol">_</a> <a id="1094" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">⦆</a> <a id="1096" class="Symbol">=</a> <a id="1098" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="1111" href="SymbolicModel.Stripping.html#1083" class="Bound">p</a> <a id="1113" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="1115" href="SymbolicModel.Stripping.html#1087" class="Bound">ad</a> <a id="1118" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">,</a> <a id="1120" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1123" href="BitML.Semantics.Label.html#1111" class="InductiveConstructor Operator">⦆</a>
  <a id="1127" class="CatchallClause Symbol">...</a><a id="1130" class="CatchallClause"> </a><a id="1131" class="CatchallClause Symbol">|</a><a id="1132" class="CatchallClause"> </a><a id="1133" class="CatchallClause Symbol">_</a>                         <a id="1159" class="Symbol">=</a> <a id="1161" class="Bound">l</a>

  <a id="∗ʳ"></a><a id="1166" href="SymbolicModel.Stripping.html#1166" class="Function">∗ʳ</a> <a id="1169" class="Symbol">:</a> <a id="1171" href="SymbolicModel.Stripping.html#705" class="Record">Strippable</a> <a id="1182" href="SymbolicModel.Run.Base.html#408" class="Function">Run</a>
  <a id="1188" href="SymbolicModel.Stripping.html#1166" class="Function">∗ʳ</a> <a id="1191" class="Symbol">.</a><a id="1192" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="1195" class="Symbol">=</a> <a id="1197" href="SymbolicModel.Stripping.html#1228" class="Function">mapRun</a> <a id="1204" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a> <a id="1207" href="SymbolicModel.Stripping.html#746" class="Field Operator">_∗</a>
    <a id="1214" class="Keyword">where</a>
        <a id="1228" href="SymbolicModel.Stripping.html#1228" class="Function">mapRun</a> <a id="1235" class="Symbol">:</a> <a id="1237" class="Symbol">(</a><a id="1238" href="BitML.Semantics.Configurations.Types.html#1702" class="Record">TimedConfiguration</a> <a id="1257" class="Symbol">→</a> <a id="1259" href="BitML.Semantics.Configurations.Types.html#1702" class="Record">TimedConfiguration</a><a id="1277" class="Symbol">)</a> <a id="1279" class="Symbol">→</a> <a id="1281" class="Symbol">(</a><a id="1282" href="BitML.Semantics.Label.html#537" class="Datatype">Label</a> <a id="1288" class="Symbol">→</a> <a id="1290" href="BitML.Semantics.Label.html#537" class="Datatype">Label</a><a id="1295" class="Symbol">)</a> <a id="1297" class="Symbol">→</a> <a id="1299" class="Symbol">(</a><a id="1300" href="SymbolicModel.Run.Base.html#408" class="Function">Run</a> <a id="1304" class="Symbol">→</a> <a id="1306" href="SymbolicModel.Run.Base.html#408" class="Function">Run</a><a id="1309" class="Symbol">)</a>
        <a id="1319" href="SymbolicModel.Stripping.html#1228" class="Function">mapRun</a> <a id="1326" href="SymbolicModel.Stripping.html#1326" class="Bound">f</a> <a id="1328" href="SymbolicModel.Stripping.html#1328" class="Bound">g</a> <a id="1330" class="Keyword">record</a> <a id="1337" class="Symbol">{</a> <a id="1339" href="Prelude.Traces.html#521" class="Field">start</a> <a id="1345" class="Symbol">=</a> <a id="1347" href="SymbolicModel.Stripping.html#1347" class="Bound">s</a> <a id="1349" class="Symbol">;</a> <a id="1351" href="Prelude.Traces.html#527" class="Field">end</a> <a id="1355" class="Symbol">=</a> <a id="1357" class="DottedPattern Symbol">.</a><a id="1358" href="SymbolicModel.Stripping.html#1347" class="DottedPattern Bound">s</a> <a id="1360" class="Symbol">;</a> <a id="1362" href="Prelude.Traces.html#541" class="Field">trace</a> <a id="1368" class="Symbol">=</a> <a id="1370" class="Symbol">(</a><a id="1371" class="DottedPattern Symbol">.</a><a id="1372" href="BitML.Semantics.Configurations.Types.html#2720" class="DottedPattern InductiveConstructor">`∅ᶜ</a> <a id="1376" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1378" class="Symbol">(</a><a id="1379" class="DottedPattern Symbol">.</a><a id="1380" href="SymbolicModel.Stripping.html#1347" class="DottedPattern Bound">s</a> <a id="1382" href="Prelude.Closures.html#5608" class="InductiveConstructor Operator">∎</a><a id="1383" class="Symbol">));</a> <a id="1387" href="Prelude.Traces.html#599" class="Field">init</a> <a id="1392" class="Symbol">=</a> <a id="1394" href="SymbolicModel.Stripping.html#1394" class="Bound">init</a> <a id="1399" class="Symbol">}</a>
          <a id="1411" class="Symbol">=</a> <a id="1413" class="Keyword">let</a> <a id="1417" href="SymbolicModel.Stripping.html#1417" class="Bound">s′</a> <a id="1420" class="Symbol">=</a> <a id="1422" href="SymbolicModel.Stripping.html#1326" class="Bound">f</a> <a id="1424" href="SymbolicModel.Stripping.html#1347" class="Bound">s</a> <a id="1426" class="Keyword">in</a>
            <a id="1441" class="Keyword">record</a> <a id="1448" class="Symbol">{</a><a id="1449" href="Prelude.Traces.html#521" class="Field">start</a> <a id="1455" class="Symbol">=</a> <a id="1457" href="SymbolicModel.Stripping.html#1417" class="Bound">s′</a><a id="1459" class="Symbol">;</a> <a id="1461" href="Prelude.Traces.html#527" class="Field">end</a> <a id="1465" class="Symbol">=</a> <a id="1467" href="SymbolicModel.Stripping.html#1417" class="Bound">s′</a><a id="1469" class="Symbol">;</a> <a id="1471" href="Prelude.Traces.html#541" class="Field">trace</a> <a id="1477" class="Symbol">=</a> <a id="1479" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1482" class="Symbol">(</a><a id="1483" href="SymbolicModel.Stripping.html#1417" class="Bound">s′</a> <a id="1486" href="BitML.Semantics.InferenceRules.html#10245" class="InductiveConstructor Operator">∎ₜ</a><a id="1488" class="Symbol">);</a> <a id="1491" href="Prelude.Traces.html#599" class="Field">init</a> <a id="1496" class="Symbol">=</a> <a id="1498" class="Hole">{!init!}</a><a id="1506" class="Symbol">}</a>
        <a id="1516" href="SymbolicModel.Stripping.html#1228" class="Function">mapRun</a> <a id="1523" href="SymbolicModel.Stripping.html#1523" class="Bound">f</a> <a id="1525" href="SymbolicModel.Stripping.html#1525" class="Bound">g</a> <a id="1527" class="Keyword">record</a> <a id="1534" class="Symbol">{</a> <a id="1536" href="Prelude.Traces.html#521" class="Field">start</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="SymbolicModel.Stripping.html#1544" class="Bound">start</a> <a id="1550" class="Symbol">;</a> <a id="1552" href="Prelude.Traces.html#527" class="Field">end</a> <a id="1556" class="Symbol">=</a> <a id="1558" href="SymbolicModel.Stripping.html#1558" class="Bound">end</a> <a id="1562" class="Symbol">;</a> <a id="1564" href="Prelude.Traces.html#541" class="Field">trace</a> <a id="1570" class="Symbol">=</a> <a id="1572" class="Symbol">(</a><a id="1573" class="DottedPattern Symbol">.(_</a> <a id="1577" href="Agda.Builtin.List.html#200" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="1579" class="DottedPattern Symbol">_)</a> <a id="1582" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1584" class="Symbol">(</a><a id="1585" class="DottedPattern Symbol">.(</a><a id="1587" href="SymbolicModel.Stripping.html#1544" class="DottedPattern Bound">start</a><a id="1592" class="DottedPattern Symbol">)</a> <a id="1594" href="Prelude.Closures.html#5636" class="InductiveConstructor Operator">—→⟨</a> <a id="1598" href="SymbolicModel.Stripping.html#1598" class="Bound">x</a> <a id="1600" href="Prelude.Closures.html#5636" class="InductiveConstructor Operator">⟩</a> <a id="1602" href="SymbolicModel.Stripping.html#1602" class="Bound">x₁</a> <a id="1605" href="Prelude.Closures.html#5636" class="InductiveConstructor Operator">⊢</a> <a id="1607" href="SymbolicModel.Stripping.html#1607" class="Bound">snd</a><a id="1610" class="Symbol">))</a> <a id="1613" class="Symbol">;</a> <a id="1615" href="Prelude.Traces.html#599" class="Field">init</a> <a id="1620" class="Symbol">=</a> <a id="1622" href="SymbolicModel.Stripping.html#1622" class="Bound">init</a> <a id="1627" class="Symbol">}</a>
          <a id="1639" class="Symbol">=</a> <a id="1641" class="Hole">{!!}</a>
        <a id="1654" class="Comment">-- mapRun f _ (tc ∎)        = f tc ∎</a>
        <a id="1699" class="Comment">-- mapRun f g (tc ∷⟦ α ⟧ s) = f tc ∷⟦ g α ⟧ mapRun f g s</a>

<a id="prefixRuns"></a><a id="1757" href="SymbolicModel.Stripping.html#1757" class="Function">prefixRuns</a> <a id="1768" class="Symbol">:</a> <a id="1770" href="SymbolicModel.Run.Base.html#408" class="Function">Run</a> <a id="1774" class="Symbol">→</a> <a id="1776" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1781" href="SymbolicModel.Run.Base.html#408" class="Function">Run</a>
<a id="1785" href="SymbolicModel.Stripping.html#1757" class="Function">prefixRuns</a> <a id="1796" class="Keyword">record</a> <a id="1803" class="Symbol">{</a> <a id="1805" href="Prelude.Traces.html#521" class="Field">start</a> <a id="1811" class="Symbol">=</a> <a id="1813" href="SymbolicModel.Stripping.html#1813" class="Bound">start</a> <a id="1819" class="Symbol">;</a> <a id="1821" href="Prelude.Traces.html#527" class="Field">end</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="SymbolicModel.Stripping.html#1827" class="Bound">end</a> <a id="1831" class="Symbol">;</a> <a id="1833" href="Prelude.Traces.html#541" class="Field">trace</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="SymbolicModel.Stripping.html#1841" class="Bound">trace</a> <a id="1847" class="Symbol">;</a> <a id="1849" href="Prelude.Traces.html#599" class="Field">init</a> <a id="1854" class="Symbol">=</a> <a id="1856" href="SymbolicModel.Stripping.html#1856" class="Bound">init</a> <a id="1861" class="Symbol">}</a> <a id="1863" class="Symbol">=</a> <a id="1865" class="Hole">{!!}</a>
<a id="1870" class="Comment">-- prefixRuns (tc ∙)        = [ tc ∙ ]</a>
<a id="1909" class="Comment">-- prefixRuns (tc ∷⟦ α ⟧ R) = let rs = prefixRuns R in rs ++ map (tc ∷⟦ α ⟧_) rs</a>

<a id="1991" class="Comment">-- _∈ʳ_ : Configuration → Run → Set</a>
<a id="2027" class="Comment">-- _∈ʳ_ c R = c ∈ᶜ cfg (lastCfgᵗ (R ∗))</a>
</pre></body></html>