<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SymbolicModel.Stripping</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml-to-bitcoin/tree/master/SymbolicModel/Stripping.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>
<a id="40" class="Comment">------------------------------------------------------------------------</a>
<a id="113" class="Comment">-- Stripping sensitive information from runs (as well as other elements).</a>
<a id="187" class="Comment">------------------------------------------------------------------------</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="285" class="Keyword">hiding</a> <a id="292" class="Symbol">(</a><a id="293" href="Agda.Builtin.Sigma.html#148" class="Record">Σ</a><a id="294" class="Symbol">)</a>
<a id="296" class="Keyword">open</a> <a id="301" class="Keyword">import</a> <a id="308" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Prelude.Bifunctor.html" class="Module">Prelude.Bifunctor</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Prelude.Lists.Collections.html" class="Module">Prelude.Lists.Collections</a>
<a id="416" class="Keyword">open</a> <a id="421" class="Keyword">import</a> <a id="428" href="Prelude.Membership.html" class="Module">Prelude.Membership</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="476" class="Keyword">open</a> <a id="481" class="Keyword">import</a> <a id="488" href="Prelude.Closures.html" class="Module">Prelude.Closures</a>
<a id="505" class="Keyword">open</a> <a id="510" class="Keyword">import</a> <a id="517" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>

<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a> <a id="562" class="Keyword">using</a> <a id="568" class="Symbol">(</a><a id="569" href="BitML.BasicTypes.html#631" class="Record">⋯</a><a id="570" class="Symbol">)</a>

<a id="573" class="Keyword">module</a> <a id="580" href="SymbolicModel.Stripping.html" class="Module">SymbolicModel.Stripping</a> <a id="604" class="Symbol">(</a><a id="605" href="SymbolicModel.Stripping.html#605" class="Bound">⋯</a> <a id="607" class="Symbol">:</a> <a id="609" href="BitML.BasicTypes.html#631" class="Record">⋯</a><a id="610" class="Symbol">)</a> <a id="612" class="Keyword">where</a>

<a id="619" class="Keyword">open</a> <a id="624" class="Keyword">import</a> <a id="631" href="SymbolicModel.Run.html" class="Module">SymbolicModel.Run</a> <a id="649" href="SymbolicModel.Stripping.html#605" class="Bound">⋯</a>

<a id="652" class="Keyword">record</a> <a id="Strippable"></a><a id="659" href="SymbolicModel.Stripping.html#659" class="Record">Strippable</a> <a id="670" class="Symbol">(</a><a id="671" href="SymbolicModel.Stripping.html#671" class="Bound">A</a> <a id="673" class="Symbol">:</a> <a id="675" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="678" class="Symbol">)</a> <a id="680" class="Symbol">:</a> <a id="682" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="686" class="Keyword">where</a>
  <a id="694" class="Keyword">field</a> <a id="Strippable._∗"></a><a id="700" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="703" class="Symbol">:</a> <a id="705" href="SymbolicModel.Stripping.html#671" class="Bound">A</a> <a id="707" class="Symbol">→</a> <a id="709" href="SymbolicModel.Stripping.html#671" class="Bound">A</a>
<a id="711" class="Keyword">open</a> <a id="716" href="SymbolicModel.Stripping.html#659" class="Module">Strippable</a> <a id="727" class="Symbol">⦃...⦄</a> <a id="733" class="Keyword">public</a>

<a id="741" class="Keyword">instance</a>
  <a id="∗ᶜ"></a><a id="752" href="SymbolicModel.Stripping.html#752" class="Function">∗ᶜ</a> <a id="755" class="Symbol">:</a> <a id="757" href="SymbolicModel.Stripping.html#659" class="Record">Strippable</a> <a id="768" href="BitML.Semantics.Configurations.Types.html#482" class="Datatype">Cfg</a>
  <a id="774" href="SymbolicModel.Stripping.html#752" class="Function">∗ᶜ</a> <a id="777" class="Symbol">.</a><a id="778" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="781" href="SymbolicModel.Stripping.html#781" class="Bound">c</a> <a id="783" class="Keyword">with</a> <a id="788" href="SymbolicModel.Stripping.html#781" class="Bound">c</a>
  <a id="792" class="Symbol">...</a> <a id="796" class="Symbol">|</a> <a id="798" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">⟨</a> <a id="800" href="SymbolicModel.Stripping.html#800" class="Bound">p</a> <a id="802" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">∶</a> <a id="804" href="SymbolicModel.Stripping.html#804" class="Bound">a</a> <a id="806" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">♯</a> <a id="808" class="Symbol">_</a> <a id="810" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">⟩</a> <a id="812" class="Symbol">=</a> <a id="814" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">⟨</a> <a id="816" href="SymbolicModel.Stripping.html#800" class="Bound">p</a> <a id="818" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">∶</a> <a id="820" href="SymbolicModel.Stripping.html#804" class="Bound">a</a> <a id="822" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">♯</a> <a id="824" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="832" href="BitML.Semantics.Configurations.Types.html#878" class="InductiveConstructor Operator">⟩</a>
  <a id="836" class="Symbol">...</a> <a id="840" class="Symbol">|</a> <a id="842" href="SymbolicModel.Stripping.html#842" class="Bound">l</a> <a id="844" href="BitML.Semantics.Configurations.Types.html#1054" class="InductiveConstructor Operator">∣</a> <a id="846" href="SymbolicModel.Stripping.html#846" class="Bound">r</a>         <a id="856" class="Symbol">=</a> <a id="858" href="SymbolicModel.Stripping.html#842" class="Bound">l</a> <a id="860" href="SymbolicModel.Stripping.html#700" class="Field Operator">∗</a> <a id="862" href="BitML.Semantics.Configurations.Types.html#1054" class="InductiveConstructor Operator">∣</a> <a id="864" href="SymbolicModel.Stripping.html#846" class="Bound">r</a> <a id="866" href="SymbolicModel.Stripping.html#700" class="Field Operator">∗</a>
  <a id="870" class="CatchallClause Symbol">...</a><a id="873" class="CatchallClause"> </a><a id="874" class="CatchallClause Symbol">|</a><a id="875" class="CatchallClause"> </a><a id="876" class="CatchallClause Symbol">_</a>             <a id="890" class="Symbol">=</a> <a id="892" class="Bound">c</a>

  <a id="∗ᵗ"></a><a id="897" href="SymbolicModel.Stripping.html#897" class="Function">∗ᵗ</a> <a id="900" class="Symbol">:</a> <a id="902" href="SymbolicModel.Stripping.html#659" class="Record">Strippable</a> <a id="913" href="BitML.Semantics.Configurations.Types.html#1290" class="Record">Cfgᵗ</a>
  <a id="920" href="SymbolicModel.Stripping.html#897" class="Function">∗ᵗ</a> <a id="923" class="Symbol">.</a><a id="924" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="927" class="Symbol">(</a><a id="928" href="SymbolicModel.Stripping.html#928" class="Bound">Γ</a> <a id="930" href="BitML.Semantics.Configurations.Types.html#1322" class="InductiveConstructor Operator">at</a> <a id="933" href="SymbolicModel.Stripping.html#933" class="Bound">t</a><a id="934" class="Symbol">)</a> <a id="936" class="Symbol">=</a> <a id="938" class="Symbol">(</a><a id="939" href="SymbolicModel.Stripping.html#928" class="Bound">Γ</a> <a id="941" href="SymbolicModel.Stripping.html#700" class="Field Operator">∗</a><a id="942" class="Symbol">)</a> <a id="944" href="BitML.Semantics.Configurations.Types.html#1322" class="InductiveConstructor Operator">at</a> <a id="947" href="SymbolicModel.Stripping.html#933" class="Bound">t</a>

  <a id="∗ˡ"></a><a id="952" href="SymbolicModel.Stripping.html#952" class="Function">∗ˡ</a> <a id="955" class="Symbol">:</a> <a id="957" href="SymbolicModel.Stripping.html#659" class="Record">Strippable</a> <a id="968" href="BitML.Semantics.Label.html#459" class="Datatype">Label</a>
  <a id="976" href="SymbolicModel.Stripping.html#952" class="Function">∗ˡ</a> <a id="979" class="Symbol">.</a><a id="980" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="983" href="SymbolicModel.Stripping.html#983" class="Bound">l</a> <a id="985" class="Keyword">with</a> <a id="990" href="SymbolicModel.Stripping.html#983" class="Bound">l</a>
  <a id="994" class="Symbol">...</a> <a id="998" class="Symbol">|</a> <a id="1000" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="1013" href="SymbolicModel.Stripping.html#1013" class="Bound">p</a> <a id="1015" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">,</a> <a id="1017" href="SymbolicModel.Stripping.html#1017" class="Bound">ad</a> <a id="1020" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">,</a> <a id="1022" class="Symbol">_</a> <a id="1024" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">⦆</a> <a id="1026" class="Symbol">=</a> <a id="1028" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">auth-commit⦅</a> <a id="1041" href="SymbolicModel.Stripping.html#1013" class="Bound">p</a> <a id="1043" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">,</a> <a id="1045" href="SymbolicModel.Stripping.html#1017" class="Bound">ad</a> <a id="1048" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">,</a> <a id="1050" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1053" href="BitML.Semantics.Label.html#1023" class="InductiveConstructor Operator">⦆</a>
  <a id="1057" class="CatchallClause Symbol">...</a><a id="1060" class="CatchallClause"> </a><a id="1061" class="CatchallClause Symbol">|</a><a id="1062" class="CatchallClause"> </a><a id="1063" class="CatchallClause Symbol">_</a>                         <a id="1089" class="Symbol">=</a> <a id="1091" class="Bound">l</a>

  <a id="∗ʳ"></a><a id="1096" href="SymbolicModel.Stripping.html#1096" class="Function">∗ʳ</a> <a id="1099" class="Symbol">:</a> <a id="1101" href="SymbolicModel.Stripping.html#659" class="Record">Strippable</a> <a id="1112" href="SymbolicModel.Run.Base.html#404" class="Function">Run</a>
  <a id="1118" href="SymbolicModel.Stripping.html#1096" class="Function">∗ʳ</a> <a id="1121" class="Symbol">.</a><a id="1122" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="1125" class="Symbol">=</a> <a id="1127" href="SymbolicModel.Stripping.html#1158" class="Function">mapRun</a> <a id="1134" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a> <a id="1137" href="SymbolicModel.Stripping.html#700" class="Field Operator">_∗</a>
    <a id="1144" class="Keyword">where</a>
        <a id="1158" href="SymbolicModel.Stripping.html#1158" class="Function">mapRun</a> <a id="1165" class="Symbol">:</a> <a id="1167" class="Symbol">(</a><a id="1168" href="BitML.Semantics.Configurations.Types.html#1290" class="Record">Cfgᵗ</a> <a id="1173" class="Symbol">→</a> <a id="1175" href="BitML.Semantics.Configurations.Types.html#1290" class="Record">Cfgᵗ</a><a id="1179" class="Symbol">)</a> <a id="1181" class="Symbol">→</a> <a id="1183" class="Symbol">(</a><a id="1184" href="BitML.Semantics.Label.html#459" class="Datatype">Label</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="BitML.Semantics.Label.html#459" class="Datatype">Label</a><a id="1197" class="Symbol">)</a> <a id="1199" class="Symbol">→</a> <a id="1201" class="Symbol">(</a><a id="1202" href="SymbolicModel.Run.Base.html#404" class="Function">Run</a> <a id="1206" class="Symbol">→</a> <a id="1208" href="SymbolicModel.Run.Base.html#404" class="Function">Run</a><a id="1211" class="Symbol">)</a>
        <a id="1221" href="SymbolicModel.Stripping.html#1158" class="Function">mapRun</a> <a id="1228" href="SymbolicModel.Stripping.html#1228" class="Bound">f</a> <a id="1230" href="SymbolicModel.Stripping.html#1230" class="Bound">g</a> <a id="1232" class="Keyword">record</a> <a id="1239" class="Symbol">{</a> <a id="1241" href="Prelude.Traces.html#562" class="Field">start</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="SymbolicModel.Stripping.html#1249" class="Bound">s</a> <a id="1251" class="Symbol">;</a> <a id="1253" href="Prelude.Traces.html#568" class="Field">end</a> <a id="1257" class="Symbol">=</a> <a id="1259" class="DottedPattern Symbol">.</a><a id="1260" href="SymbolicModel.Stripping.html#1249" class="DottedPattern Bound">s</a> <a id="1262" class="Symbol">;</a> <a id="1264" href="Prelude.Traces.html#582" class="Field">trace</a> <a id="1270" class="Symbol">=</a> <a id="1272" class="Symbol">(</a><a id="1273" class="DottedPattern Symbol">.</a><a id="1274" href="BitML.Semantics.Configurations.Types.html#2269" class="DottedPattern InductiveConstructor">`∅ᶜ</a> <a id="1278" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1280" class="Symbol">(</a><a id="1281" class="DottedPattern Symbol">.</a><a id="1282" href="SymbolicModel.Stripping.html#1249" class="DottedPattern Bound">s</a> <a id="1284" href="Prelude.Closures.html#5661" class="InductiveConstructor Operator">∎</a><a id="1285" class="Symbol">));</a> <a id="1289" href="Prelude.Traces.html#640" class="Field">init</a> <a id="1294" class="Symbol">=</a> <a id="1296" href="SymbolicModel.Stripping.html#1296" class="Bound">init</a> <a id="1301" class="Symbol">}</a>
          <a id="1313" class="Symbol">=</a> <a id="1315" class="Keyword">let</a> <a id="1319" href="SymbolicModel.Stripping.html#1319" class="Bound">s′</a> <a id="1322" class="Symbol">=</a> <a id="1324" href="SymbolicModel.Stripping.html#1228" class="Bound">f</a> <a id="1326" href="SymbolicModel.Stripping.html#1249" class="Bound">s</a> <a id="1328" class="Keyword">in</a>
            <a id="1343" class="Keyword">record</a> <a id="1350" class="Symbol">{</a><a id="1351" href="Prelude.Traces.html#562" class="Field">start</a> <a id="1357" class="Symbol">=</a> <a id="1359" href="SymbolicModel.Stripping.html#1319" class="Bound">s′</a><a id="1361" class="Symbol">;</a> <a id="1363" href="Prelude.Traces.html#568" class="Field">end</a> <a id="1367" class="Symbol">=</a> <a id="1369" href="SymbolicModel.Stripping.html#1319" class="Bound">s′</a><a id="1371" class="Symbol">;</a> <a id="1373" href="Prelude.Traces.html#582" class="Field">trace</a> <a id="1379" class="Symbol">=</a> <a id="1381" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1384" class="Symbol">(</a><a id="1385" href="SymbolicModel.Stripping.html#1319" class="Bound">s′</a> <a id="1388" href="BitML.Semantics.InferenceRules.html#8773" class="InductiveConstructor Operator">∎ₜ</a><a id="1390" class="Symbol">);</a> <a id="1393" href="Prelude.Traces.html#640" class="Field">init</a> <a id="1398" class="Symbol">=</a> <a id="1400" class="Hole">{!init!}</a><a id="1408" class="Symbol">}</a>
        <a id="1418" href="SymbolicModel.Stripping.html#1158" class="Function">mapRun</a> <a id="1425" href="SymbolicModel.Stripping.html#1425" class="Bound">f</a> <a id="1427" href="SymbolicModel.Stripping.html#1427" class="Bound">g</a> <a id="1429" class="Keyword">record</a> <a id="1436" class="Symbol">{</a> <a id="1438" href="Prelude.Traces.html#562" class="Field">start</a> <a id="1444" class="Symbol">=</a> <a id="1446" href="SymbolicModel.Stripping.html#1446" class="Bound">start</a> <a id="1452" class="Symbol">;</a> <a id="1454" href="Prelude.Traces.html#568" class="Field">end</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="SymbolicModel.Stripping.html#1460" class="Bound">end</a> <a id="1464" class="Symbol">;</a> <a id="1466" href="Prelude.Traces.html#582" class="Field">trace</a> <a id="1472" class="Symbol">=</a> <a id="1474" class="Symbol">(</a><a id="1475" class="DottedPattern Symbol">.(_</a> <a id="1479" href="Agda.Builtin.List.html#182" class="DottedPattern InductiveConstructor Operator">∷</a> <a id="1481" class="DottedPattern Symbol">_)</a> <a id="1484" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1486" class="Symbol">(</a><a id="1487" class="DottedPattern Symbol">.(</a><a id="1489" href="SymbolicModel.Stripping.html#1446" class="DottedPattern Bound">start</a><a id="1494" class="DottedPattern Symbol">)</a> <a id="1496" href="Prelude.Closures.html#5689" class="InductiveConstructor Operator">—→⟨</a> <a id="1500" href="SymbolicModel.Stripping.html#1500" class="Bound">x</a> <a id="1502" href="Prelude.Closures.html#5689" class="InductiveConstructor Operator">⟩</a> <a id="1504" href="SymbolicModel.Stripping.html#1504" class="Bound">x₁</a> <a id="1507" href="Prelude.Closures.html#5689" class="InductiveConstructor Operator">⊢</a> <a id="1509" href="SymbolicModel.Stripping.html#1509" class="Bound">snd</a><a id="1512" class="Symbol">))</a> <a id="1515" class="Symbol">;</a> <a id="1517" href="Prelude.Traces.html#640" class="Field">init</a> <a id="1522" class="Symbol">=</a> <a id="1524" href="SymbolicModel.Stripping.html#1524" class="Bound">init</a> <a id="1529" class="Symbol">}</a>
          <a id="1541" class="Symbol">=</a> <a id="1543" class="Hole">{!!}</a>
        <a id="1556" class="Comment">-- mapRun f _ (tc ∎)        = f tc ∎</a>
        <a id="1601" class="Comment">-- mapRun f g (tc ∷⟦ α ⟧ s) = f tc ∷⟦ g α ⟧ mapRun f g s</a>

<a id="prefixRuns"></a><a id="1659" href="SymbolicModel.Stripping.html#1659" class="Function">prefixRuns</a> <a id="1670" class="Symbol">:</a> <a id="1672" href="SymbolicModel.Run.Base.html#404" class="Function">Run</a> <a id="1676" class="Symbol">→</a> <a id="1678" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1683" href="SymbolicModel.Run.Base.html#404" class="Function">Run</a>
<a id="1687" href="SymbolicModel.Stripping.html#1659" class="Function">prefixRuns</a> <a id="1698" class="Keyword">record</a> <a id="1705" class="Symbol">{</a> <a id="1707" href="Prelude.Traces.html#562" class="Field">start</a> <a id="1713" class="Symbol">=</a> <a id="1715" href="SymbolicModel.Stripping.html#1715" class="Bound">start</a> <a id="1721" class="Symbol">;</a> <a id="1723" href="Prelude.Traces.html#568" class="Field">end</a> <a id="1727" class="Symbol">=</a> <a id="1729" href="SymbolicModel.Stripping.html#1729" class="Bound">end</a> <a id="1733" class="Symbol">;</a> <a id="1735" href="Prelude.Traces.html#582" class="Field">trace</a> <a id="1741" class="Symbol">=</a> <a id="1743" href="SymbolicModel.Stripping.html#1743" class="Bound">trace</a> <a id="1749" class="Symbol">;</a> <a id="1751" href="Prelude.Traces.html#640" class="Field">init</a> <a id="1756" class="Symbol">=</a> <a id="1758" href="SymbolicModel.Stripping.html#1758" class="Bound">init</a> <a id="1763" class="Symbol">}</a> <a id="1765" class="Symbol">=</a> <a id="1767" class="Hole">{!!}</a>
<a id="1772" class="Comment">-- prefixRuns (tc ∙)        = [ tc ∙ ]</a>
<a id="1811" class="Comment">-- prefixRuns (tc ∷⟦ α ⟧ R) = let rs = prefixRuns R in rs ++ map (tc ∷⟦ α ⟧_) rs</a>

<a id="1893" class="Comment">-- _∈ʳ_ : Cfg → Run → Set</a>
<a id="1919" class="Comment">-- _∈ʳ_ c R = c ∈ᶜ cfg (lastCfgᵗ (R ∗))</a>
</pre></body></html>