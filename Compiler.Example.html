<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Compiler.Example</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml-to-bitcoin/tree/master/Compiler/Example.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">----------------------------------------------------------------------------</a>
<a id="78" class="Comment">-- Example contract compilation.</a>
<a id="111" class="Comment">----------------------------------------------------------------------------</a>
<a id="188" class="Keyword">module</a> <a id="195" href="Compiler.Example.html" class="Module">Compiler.Example</a> <a id="212" class="Keyword">where</a>

<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="244" class="Keyword">hiding</a> <a id="251" class="Symbol">(</a><a id="252" href="Data.Bool.Base.html#1460" class="Function">T</a><a id="253" class="Symbol">);</a> <a id="256" class="Keyword">open</a> <a id="261" href="Prelude.Init.html#504" class="Module">SetAsType</a>
<a id="271" class="Keyword">open</a> <a id="276" href="Prelude.Init.html#7254" class="Module">L.Mem</a> <a id="282" class="Keyword">using</a> <a id="288" class="Symbol">(</a><a id="289" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Prelude.Membership.Patterns.html" class="Module">Prelude.Membership.Patterns</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>

<a id="424" class="Comment">-- BitML</a>
<a id="433" class="Keyword">open</a> <a id="438" class="Keyword">import</a> <a id="445" href="BitML.Example.TimedCommitment.html" class="Module">BitML.Example.TimedCommitment</a>
  <a id="477" class="Keyword">using</a> <a id="483" class="Symbol">(</a><a id="484" href="BitML.Example.TimedCommitment.html#365" class="Datatype">Participant</a><a id="495" class="Symbol">;</a> <a id="497" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a><a id="498" class="Symbol">;</a> <a id="500" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a><a id="501" class="Symbol">;</a> <a id="503" href="BitML.Example.TimedCommitment.html#475" class="Function">Honest</a><a id="509" class="Symbol">)</a>
<a id="511" class="Keyword">import</a> <a id="518" href="BitML.BasicTypes.html" class="Module">BitML.BasicTypes</a> <a id="535" class="Symbol">as</a> <a id="538" class="Module">BitML-params</a>
<a id="⋯"></a><a id="551" href="Compiler.Example.html#551" class="Function">⋯</a> <a id="553" class="Symbol">=</a> <a id="555" href="BitML.BasicTypes.html#661" class="InductiveConstructor Operator">BitML-params.⋯_,_⋯</a> <a id="574" href="BitML.Example.TimedCommitment.html#365" class="Datatype">Participant</a> <a id="586" href="BitML.Example.TimedCommitment.html#475" class="Function">Honest</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="BitML.html" class="Module">BitML</a> <a id="611" href="Compiler.Example.html#551" class="Function">⋯</a>
  <a id="615" class="Keyword">hiding</a> <a id="622" class="Symbol">(</a> <a id="624" href="BitML.BasicTypes.html#578" class="Generalizable">t</a><a id="625" class="Symbol">;</a> <a id="627" href="BitML.BasicTypes.html#484" class="Generalizable">a</a><a id="628" class="Symbol">;</a> <a id="630" href="BitML.BasicTypes.html#443" class="Generalizable">v</a><a id="631" class="Symbol">;</a> <a id="633" href="BitML.Contracts.Types.html#371" class="Generalizable">A</a><a id="634" class="Symbol">;</a> <a id="636" href="BitML.Contracts.Types.html#373" class="Generalizable">B</a><a id="637" class="Symbol">;</a> <a id="639" href="BitML.BasicTypes.html#527" class="Generalizable">x</a><a id="640" class="Symbol">;</a> <a id="642" href="BitML.BasicTypes.html#529" class="Generalizable">y</a><a id="643" class="Symbol">;</a> <a id="645" href="BitML.BasicTypes.html#533" class="Generalizable">x′</a><a id="647" class="Symbol">;</a> <a id="649" href="BitML.BasicTypes.html#536" class="Generalizable">y′</a><a id="651" class="Symbol">;</a> <a id="653" href="BitML.Semantics.Configurations.Types.html#1146" class="Generalizable">Γ₀</a><a id="655" class="Symbol">;</a> <a id="657" href="BitML.Semantics.Configurations.Types.html#1467" class="Generalizable">Γₜ₀</a><a id="660" class="Symbol">;</a> <a id="662" href="BitML.Semantics.Configurations.Types.html#1157" class="Generalizable">Δ</a><a id="663" class="Symbol">;</a> <a id="665" href="BitML.Semantics.Configurations.Types.html#1456" class="Generalizable">Γₜ</a><a id="667" class="Symbol">;</a> <a id="669" href="BitML.Semantics.Configurations.Types.html#1459" class="Generalizable">Γₜ′</a><a id="672" class="Symbol">;</a> <a id="674" href="BitML.BasicTypes.html#503" class="Generalizable">as</a><a id="676" class="Symbol">;</a> <a id="678" href="BitML.Semantics.Label.html#1651" class="Generalizable">α</a><a id="679" class="Symbol">;</a> <a id="681" href="BitML.Semantics.Configurations.Types.html#1138" class="Generalizable">Γ</a><a id="682" class="Symbol">;</a> <a id="684" href="BitML.Semantics.Configurations.Types.html#1140" class="Generalizable">Γ′</a>
         <a id="696" class="Symbol">;</a> <a id="698" href="BitML.Predicate.html#634" class="InductiveConstructor Operator">_`=_</a><a id="702" class="Symbol">;</a> <a id="704" href="BitML.Predicate.html#586" class="InductiveConstructor Operator">_`∧_</a><a id="708" class="Symbol">;</a> <a id="710" href="BitML.Predicate.html#876" class="Function Operator">_`∨_</a><a id="714" class="Symbol">;</a> <a id="716" href="BitML.Semantics.Configurations.Types.html#552" class="InductiveConstructor Operator">`_</a><a id="718" class="Symbol">;</a> <a id="720" href="BitML.Predicate.html#526" class="InductiveConstructor">`true</a><a id="725" class="Symbol">;</a> <a id="727" href="BitML.Predicate.html#639" class="InductiveConstructor Operator">_`&lt;_</a>
         <a id="741" class="Symbol">)</a>

<a id="744" class="Comment">-- BitML compiler</a>
<a id="η"></a><a id="762" href="Compiler.Example.html#762" class="Function">η</a> <a id="764" class="Symbol">=</a> <a id="766" class="Number">1024</a>
<a id="771" class="Keyword">open</a> <a id="776" class="Keyword">import</a> <a id="783" href="Compiler.html" class="Module">Compiler</a> <a id="792" href="Compiler.Example.html#551" class="Function">⋯</a> <a id="794" href="Compiler.Example.html#762" class="Function">η</a>

<a id="finPart"></a><a id="797" href="Compiler.Example.html#797" class="Function">finPart</a> <a id="805" class="Symbol">:</a> <a id="807" href="Prelude.Lists.html#2011" class="Function">Finite</a> <a id="814" href="BitML.Example.TimedCommitment.html#365" class="Datatype">Participant</a>
<a id="826" href="Compiler.Example.html#797" class="Function">finPart</a> <a id="834" class="Symbol">=</a> <a id="836" class="Number">2</a> <a id="838" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="840" href="Function.Bundles.html#10505" class="Function">Fun.mk↔</a>
  <a id="850" class="Symbol">{</a><a id="851" class="Argument">f</a>   <a id="855" class="Symbol">=</a> <a id="857" class="Symbol">λ</a> <a id="859" class="Keyword">where</a> <a id="865" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a> <a id="867" class="Symbol">→</a> <a id="869" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a><a id="871" class="Symbol">;</a> <a id="873" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a> <a id="875" class="Symbol">→</a> <a id="877" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a><a id="879" class="Symbol">}</a>
  <a id="883" class="Symbol">{</a><a id="884" class="Argument">f⁻¹</a> <a id="888" class="Symbol">=</a> <a id="890" class="Symbol">λ</a> <a id="892" class="Keyword">where</a> <a id="898" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="901" class="Symbol">→</a> <a id="903" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a><a id="904" class="Symbol">;</a> <a id="906" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="909" class="Symbol">→</a> <a id="911" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a><a id="912" class="Symbol">}</a>
  <a id="916" class="Symbol">((λ</a> <a id="920" class="Keyword">where</a> <a id="926" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="929" class="Symbol">→</a> <a id="931" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="935" class="Symbol">;</a> <a id="937" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a> <a id="940" class="Symbol">→</a> <a id="942" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="946" class="Symbol">)</a> <a id="948" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="950" class="Symbol">(λ</a> <a id="953" class="Keyword">where</a> <a id="959" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a> <a id="961" class="Symbol">→</a> <a id="963" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="967" class="Symbol">;</a> <a id="969" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a> <a id="971" class="Symbol">→</a> <a id="973" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="977" class="Symbol">))</a>

<a id="981" class="Comment">-- Bitcoin</a>
<a id="992" class="Keyword">open</a> <a id="997" class="Keyword">import</a> <a id="1004" href="Bitcoin.html" class="Module">Bitcoin</a> <a id="1012" class="Keyword">hiding</a> <a id="1019" class="Symbol">(</a><a id="1020" href="Bitcoin.BasicTypes.html#429" class="Generalizable">t</a><a id="1021" class="Symbol">)</a>
<a id="1023" class="Keyword">postulate</a> <a id="Kᵃ"></a><a id="1033" href="Compiler.Example.html#1033" class="Postulate">Kᵃ</a> <a id="Kᵇ"></a><a id="1036" href="Compiler.Example.html#1036" class="Postulate">Kᵇ</a> <a id="K̂ᵃ"></a><a id="1039" href="Compiler.Example.html#1039" class="Postulate">K̂ᵃ</a> <a id="K̂ᵇ"></a><a id="1043" href="Compiler.Example.html#1043" class="Postulate">K̂ᵇ</a> <a id="1047" class="Symbol">:</a> <a id="1049" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>

<a id="1058" class="Keyword">module</a> <a id="Section7"></a><a id="1065" href="Compiler.Example.html#1065" class="Module">Section7</a> <a id="1074" class="Keyword">where</a> <a id="1080" class="Comment">-- (see BitML paper, Section 7).</a>

  <a id="Section7.x"></a><a id="1116" href="Compiler.Example.html#1116" class="Function">x</a> <a id="1118" class="Symbol">=</a> <a id="1120" class="String">&quot;x&quot;</a><a id="1123" class="Symbol">;</a> <a id="Section7.y"></a><a id="1125" href="Compiler.Example.html#1125" class="Function">y</a> <a id="1127" class="Symbol">=</a> <a id="1129" class="String">&quot;y&quot;</a><a id="1132" class="Symbol">;</a> <a id="Section7.x′"></a><a id="1134" href="Compiler.Example.html#1134" class="Function">x′</a> <a id="1137" class="Symbol">=</a> <a id="1139" class="String">&quot;x′&quot;</a><a id="1143" class="Symbol">;</a> <a id="Section7.y′"></a><a id="1145" href="Compiler.Example.html#1145" class="Function">y′</a> <a id="1148" class="Symbol">=</a> <a id="1150" class="String">&quot;y′&quot;</a><a id="1154" class="Symbol">;</a> <a id="Section7.x₁"></a><a id="1156" href="Compiler.Example.html#1156" class="Function">x₁</a> <a id="1159" class="Symbol">=</a> <a id="1161" class="String">&quot;x₁&quot;</a>

  <a id="Section7.ex-ad"></a><a id="1169" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1175" class="Symbol">:</a> <a id="1177" href="BitML.Contracts.Types.html#2283" class="Record">Ad</a>
  <a id="1182" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1188" class="Symbol">=</a> <a id="1190" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟨</a> <a id="1192" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a> <a id="1194" href="BitML.Contracts.Types.html#1876" class="InductiveConstructor Operator">:!</a> <a id="1197" class="Number">1</a> <a id="1199" href="BitML.Contracts.Types.html#1876" class="InductiveConstructor Operator">at</a> <a id="1202" href="Compiler.Example.html#1116" class="Function">x</a> <a id="1204" href="BitML.Contracts.Types.html#2051" class="InductiveConstructor Operator">∣</a> <a id="1206" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a> <a id="1208" href="BitML.Contracts.Types.html#1876" class="InductiveConstructor Operator">:!</a> <a id="1211" class="Number">1</a> <a id="1213" href="BitML.Contracts.Types.html#1876" class="InductiveConstructor Operator">at</a> <a id="1216" href="Compiler.Example.html#1125" class="Function">y</a> <a id="1218" href="BitML.Contracts.Types.html#2313" class="InductiveConstructor Operator">⟩</a> <a id="1220" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1222" href="BitML.Contracts.Types.html#805" class="InductiveConstructor">withdraw</a> <a id="1231" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a> <a id="1233" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>

  <a id="Section7.partG"></a><a id="1238" href="Compiler.Example.html#1238" class="Function">partG</a> <a id="1244" class="Symbol">=</a> <a id="1246" href="BitML.Contracts.Collections.html#2548" class="Function">nub-participants</a> <a id="1263" class="Symbol">(</a><a id="1264" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1270" class="Symbol">.</a><a id="1271" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1272" class="Symbol">)</a>

  <a id="1277" class="Keyword">postulate</a> <a id="Section7.Kʷᵇ"></a><a id="1287" href="Compiler.Example.html#1287" class="Postulate">Kʷᵇ</a> <a id="1291" class="Symbol">:</a> <a id="1293" href="BitML.Example.TimedCommitment.html#365" class="Datatype">Participant</a> <a id="1305" class="Symbol">→</a> <a id="1307" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>

  <a id="Section7.T₀"></a><a id="1318" href="Compiler.Example.html#1318" class="Function">T₀</a> <a id="1321" class="Symbol">:</a> <a id="1323" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="1326" class="Number">0</a> <a id="1328" class="Number">2</a>
  <a id="1332" href="Compiler.Example.html#1318" class="Function">T₀</a> <a id="1335" class="Symbol">=</a> <a id="1337" class="Keyword">record</a>
    <a id="1348" class="Symbol">{</a> <a id="1350" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="1358" class="Symbol">=</a> <a id="1360" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
    <a id="1367" class="Symbol">;</a> <a id="1369" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="1377" class="Symbol">=</a> <a id="1379" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="1388" class="Symbol">;</a> <a id="1390" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="1398" class="Symbol">=</a> <a id="1400" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="1412" class="Number">0</a>
    <a id="1418" class="Symbol">;</a> <a id="1420" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="1428" class="Symbol">=</a> <a id="1430" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="1432" class="Symbol">(</a><a id="1433" class="Number">1</a> <a id="1435" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1437" class="Number">1</a> <a id="1439" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="1449" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="1459" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1461" href="Compiler.Example.html#1039" class="Postulate">K̂ᵃ</a> <a id="1465" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="1467" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1469" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="1471" class="Number">0</a> <a id="1473" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a><a id="1474" class="Symbol">))</a>
                <a id="1493" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="1495" class="Symbol">(</a><a id="1496" class="Number">1</a> <a id="1498" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1500" class="Number">1</a> <a id="1502" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="1512" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="1514" class="Symbol">(</a><a id="1515" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="1522" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1524" href="Compiler.Example.html#1043" class="Postulate">K̂ᵇ</a> <a id="1528" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="1530" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="1532" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="1534" class="Number">0</a> <a id="1536" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a><a id="1537" class="Symbol">))</a>
                <a id="1556" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
    <a id="1562" class="Symbol">;</a> <a id="1564" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="1572" class="Symbol">=</a> <a id="1574" class="Number">0</a> <a id="1576" class="Symbol">}</a>

  <a id="1581" class="Comment">-- pre-existing deposits</a>
  <a id="Section7.Tˣ"></a><a id="1608" href="Compiler.Example.html#1608" class="Function">Tˣ</a> <a id="Section7.Tʸ"></a><a id="1611" href="Compiler.Example.html#1611" class="Function">Tʸ</a> <a id="1614" class="Symbol">:</a> <a id="1616" href="Bitcoin.Tx.Base.html#1867" class="Record">TxInput′</a>
  <a id="1627" href="Compiler.Example.html#1608" class="Function">Tˣ</a> <a id="1630" class="Symbol">=</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1636" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1639" href="Compiler.Example.html#1318" class="Function">T₀</a><a id="1641" class="Symbol">)</a> <a id="1643" href="Bitcoin.Tx.Base.html#1903" class="InductiveConstructor Operator">at</a> <a id="1646" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
  <a id="1651" href="Compiler.Example.html#1611" class="Function">Tʸ</a> <a id="1654" class="Symbol">=</a> <a id="1656" class="Symbol">(</a><a id="1657" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1660" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="1663" href="Compiler.Example.html#1318" class="Function">T₀</a><a id="1665" class="Symbol">)</a> <a id="1667" href="Bitcoin.Tx.Base.html#1903" class="InductiveConstructor Operator">at</a> <a id="1670" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a>

  <a id="Section7.sechash"></a><a id="1676" href="Compiler.Example.html#1676" class="Function">sechash</a> <a id="1684" class="Symbol">:</a> <a id="1686" href="BitML.Contracts.Collections.html#4075" class="Function">namesˡ</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1700" class="Symbol">.</a><a id="1701" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1702" class="Symbol">)</a> <a id="1704" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="1706" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="1710" href="Compiler.Example.html#1676" class="Function">sechash</a> <a id="1718" class="Symbol">()</a>

  <a id="Section7.txout"></a><a id="1724" href="Compiler.Example.html#1724" class="Function">txout</a> <a id="1730" class="Symbol">:</a> <a id="1732" href="BitML.Contracts.Collections.html#4144" class="Function">namesʳ</a> <a id="1739" class="Symbol">(</a><a id="1740" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1746" class="Symbol">.</a><a id="1747" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="1748" class="Symbol">)</a> <a id="1750" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="1752" href="Bitcoin.Tx.Base.html#1867" class="Record">TxInput′</a>
  <a id="1763" href="Compiler.Example.html#1724" class="Function">txout</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="1779" class="Symbol">λ</a> <a id="1781" class="Keyword">where</a>
    <a id="1791" class="Comment">{- &quot;x&quot; -}</a> <a id="1801" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Compiler.Example.html#1608" class="Function">Tˣ</a>
    <a id="1812" class="Comment">{- &quot;y&quot; -}</a> <a id="1822" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="1824" class="Symbol">→</a> <a id="1826" href="Compiler.Example.html#1611" class="Function">Tʸ</a>

  <a id="Section7.K"></a><a id="1832" href="Compiler.Example.html#1832" class="Function">K</a> <a id="1834" class="Symbol">:</a> <a id="1836" href="Compiler.Example.html#1238" class="Function">partG</a> <a id="1842" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="1844" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>
  <a id="1854" href="Compiler.Example.html#1832" class="Function">K</a> <a id="1856" class="Symbol">=</a> <a id="1858" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="1866" class="Symbol">λ</a> <a id="1868" class="Keyword">where</a>
    <a id="1878" class="Comment">{- A -}</a> <a id="1886" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="1888" class="Symbol">→</a> <a id="1890" href="Compiler.Example.html#1033" class="Postulate">Kᵃ</a>
    <a id="1897" class="Comment">{- B -}</a> <a id="1905" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="1907" class="Symbol">→</a> <a id="1909" href="Compiler.Example.html#1036" class="Postulate">Kᵇ</a>

  <a id="Section7.K²"></a><a id="1915" href="Compiler.Example.html#1915" class="Function">K²</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="1936" class="Symbol">.</a><a id="1937" href="BitML.Contracts.Types.html#2351" class="Field">C</a><a id="1938" class="Symbol">)</a> <a id="1940" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Compiler.Example.html#1238" class="Function">partG</a> <a id="1949" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="1951" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="1958" class="Symbol">)</a>
  <a id="1962" href="Compiler.Example.html#1915" class="Function">K²</a> <a id="1965" class="Symbol">=</a> <a id="1967" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="1975" class="Symbol">λ</a> <a id="1977" class="Keyword">where</a>
    <a id="1987" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="1989" class="Symbol">→</a> <a id="1991" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="1999" class="Symbol">λ</a> <a id="2001" class="Keyword">where</a>
      <a id="2013" class="Comment">{- A -}</a> <a id="2021" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="2023" class="Symbol">→</a> <a id="2025" href="Compiler.Example.html#1287" class="Postulate">Kʷᵇ</a> <a id="2029" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a>
      <a id="2037" class="Comment">{- B -}</a> <a id="2045" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="2047" class="Symbol">→</a> <a id="2049" href="Compiler.Example.html#1287" class="Postulate">Kʷᵇ</a> <a id="2053" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a>

  <a id="Section7.Ks"></a><a id="2058" href="Compiler.Example.html#2058" class="Function">Ks</a> <a id="2061" class="Symbol">:</a> <a id="2063" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2068" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>
  <a id="2078" href="Compiler.Example.html#2058" class="Function">Ks</a> <a id="2081" class="Symbol">=</a> <a id="2083" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="2092" href="Compiler.Example.html#1238" class="Function">partG</a> <a id="2098" class="Symbol">(</a><a id="2099" href="Compiler.Example.html#1915" class="Function">K²</a> <a id="2102" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="2104" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="2109" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2113" class="Symbol">)</a>

  <a id="Section7.Tᵢₙᵢₜ"></a><a id="2118" href="Compiler.Example.html#2118" class="Function">Tᵢₙᵢₜ</a> <a id="2124" class="Symbol">:</a> <a id="2126" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="2129" class="Number">2</a> <a id="2131" class="Number">1</a>
  <a id="2135" href="Compiler.Example.html#2118" class="Function">Tᵢₙᵢₜ</a> <a id="2141" class="Symbol">=</a> <a id="2143" class="Keyword">record</a>
    <a id="2154" class="Symbol">{</a> <a id="2156" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="2164" class="Symbol">=</a> <a id="2166" href="Bitcoin.Tx.Crypto.html#657" class="Function">hashTxⁱ</a> <a id="2174" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="2178" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="2180" href="Compiler.Example.html#1608" class="Function">Tˣ</a> <a id="2183" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="2185" href="Compiler.Example.html#1611" class="Function">Tʸ</a> <a id="2188" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
    <a id="2194" class="Symbol">;</a> <a id="2196" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="2204" class="Symbol">=</a> <a id="2206" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="2215" class="Symbol">;</a> <a id="2217" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="2225" class="Symbol">=</a> <a id="2227" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="2239" class="Number">0</a>
    <a id="2245" class="Symbol">;</a> <a id="2247" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="2255" class="Symbol">=</a> <a id="2257" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2259" class="Number">2</a> <a id="2261" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2263" class="Number">2</a> <a id="2265" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="2275" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="2277" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="2284" href="Compiler.Example.html#2058" class="Function">Ks</a> <a id="2287" class="Symbol">(</a><a id="2288" href="Data.List.Base.html#6333" class="Function">allFin</a> <a id="2295" class="Symbol">_)</a><a id="2297" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="2303" class="Symbol">;</a> <a id="2305" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="2313" class="Symbol">=</a> <a id="2315" class="Number">0</a> <a id="2317" class="Symbol">}</a>
  <a id="Section7.Tᵢₙᵢₜ♯"></a><a id="2321" href="Compiler.Example.html#2321" class="Function">Tᵢₙᵢₜ♯</a> <a id="2328" class="Symbol">=</a> <a id="2330" class="Symbol">(</a><a id="2331" href="Bitcoin.Tx.Base.html#1326" class="Function">∃Tx</a> <a id="2335" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2337" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="2340" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="2343" href="Compiler.Example.html#2118" class="Function">Tᵢₙᵢₜ</a><a id="2348" class="Symbol">)</a> <a id="2350" href="Bitcoin.Crypto.html#609" class="Postulate Operator">♯</a>

  <a id="Section7.Tᵇ"></a><a id="2355" href="Compiler.Example.html#2355" class="Function">Tᵇ</a> <a id="2358" class="Symbol">:</a> <a id="2360" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="2363" class="Number">1</a> <a id="2365" class="Number">1</a>
  <a id="2369" href="Compiler.Example.html#2355" class="Function">Tᵇ</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="2379" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2381" href="Compiler.Example.html#2058" class="Function">Ks</a> <a id="2384" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2386" class="Keyword">record</a>
    <a id="2397" class="Symbol">{</a> <a id="2399" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="2407" class="Symbol">=</a> <a id="2409" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2411" href="Compiler.Example.html#2321" class="Function">Tᵢₙᵢₜ♯</a> <a id="2418" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="2421" class="Number">0</a> <a id="2423" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="2429" class="Symbol">;</a> <a id="2431" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="2439" class="Symbol">=</a> <a id="2441" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="2450" class="Symbol">;</a> <a id="2452" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="2460" class="Symbol">=</a> <a id="2462" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="2474" class="Number">0</a>
    <a id="2480" class="Symbol">;</a> <a id="2482" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="2490" class="Symbol">=</a> <a id="2492" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2494" class="Number">1</a> <a id="2496" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2498" class="Number">2</a> <a id="2500" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="2510" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="2512" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="2519" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2521" href="Compiler.Example.html#1832" class="Function">K</a> <a id="2523" class="Symbol">(</a><a id="2524" href="Data.List.Relation.Unary.Any.html#1281" class="InductiveConstructor">there</a> <a id="2530" class="Symbol">(</a><a id="2531" href="Data.List.Relation.Unary.Any.html#1228" class="InductiveConstructor">here</a> <a id="2536" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="2540" class="Symbol">))</a> <a id="2543" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2545" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="2547" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a> <a id="2550" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="2552" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="2558" class="Symbol">;</a> <a id="2560" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="2568" class="Symbol">=</a> <a id="2570" class="Number">0</a> <a id="2572" class="Symbol">}</a>

  <a id="Section7.out"></a><a id="2577" href="Compiler.Example.html#2577" class="Function">out</a> <a id="2581" class="Symbol">:</a> <a id="2583" href="Compiler.Outputs.html#224" class="Function">∃Tx¹</a> <a id="2588" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2590" class="Symbol">(</a><a id="2591" href="BitML.Contracts.Subterms.html#656" class="Function">subterms⁺</a> <a id="2601" href="Compiler.Example.html#1169" class="Function">ex-ad</a> <a id="2607" href="Prelude.Lists.Mappings.html#627" class="Function Operator">↦′</a> <a id="2610" href="Compiler.Outputs.html#411" class="Function">∃Txᵈ</a><a id="2614" class="Symbol">)</a>
  <a id="2618" href="Compiler.Example.html#2577" class="Function">out</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Compiler.Translation.html#1196" class="Function">bitml-compiler</a> <a id="2639" class="Symbol">{</a><a id="2640" class="Argument">ad</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Compiler.Example.html#1169" class="Function">ex-ad</a><a id="2650" class="Symbol">}</a> <a id="2652" href="Prelude.Decidable.Core.html#181" class="Function">auto</a> <a id="2657" href="Compiler.Example.html#1676" class="Function">sechash</a> <a id="2665" href="Compiler.Example.html#1724" class="Function">txout</a> <a id="2671" href="Compiler.Example.html#1832" class="Function">K</a> <a id="2673" href="Compiler.Example.html#1915" class="Function">K²</a>

  <a id="Section7.outTxs"></a><a id="2679" href="Compiler.Example.html#2679" class="Function">outTxs</a> <a id="2686" class="Symbol">:</a> <a id="2688" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="2691" class="Number">2</a> <a id="2693" class="Number">1</a> <a id="2695" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="2697" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="2700" class="Number">1</a> <a id="2702" class="Number">1</a>
  <a id="2706" href="Compiler.Example.html#2679" class="Function">outTxs</a> <a id="2713" class="Symbol">=</a> <a id="2715" class="Keyword">let</a> <a id="2719" href="Compiler.Example.html#2719" class="Bound">t₀</a> <a id="2722" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2724" href="Compiler.Example.html#2724" class="Bound">m</a> <a id="2726" class="Symbol">=</a> <a id="2728" href="Compiler.Example.html#2577" class="Function">out</a> <a id="2732" class="Keyword">in</a> <a id="2735" href="Compiler.Example.html#2719" class="Bound">t₀</a> <a id="2738" class="Symbol">.</a><a id="2739" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a> <a id="2745" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2747" href="Compiler.Example.html#2724" class="Bound">m</a> <a id="2749" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="2751" class="Symbol">.</a><a id="2752" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>

  <a id="2761" href="Compiler.Example.html#2761" class="Function">_</a> <a id="2763" class="Symbol">=</a> <a id="2765" href="Compiler.Example.html#2679" class="Function">outTxs</a> <a id="2772" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="2774" class="Symbol">(</a><a id="2775" href="Compiler.Example.html#2118" class="Function">Tᵢₙᵢₜ</a> <a id="2781" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2783" href="Compiler.Example.html#2355" class="Function">Tᵇ</a><a id="2785" class="Symbol">)</a>
    <a id="2791" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="2793" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="2799" class="Keyword">module</a> <a id="TimedCommitment"></a><a id="2806" href="Compiler.Example.html#2806" class="Module">TimedCommitment</a> <a id="2822" class="Keyword">where</a> <a id="2828" class="Comment">-- (see BitML, Appendix A.5)</a>

  <a id="2860" class="Keyword">open</a> <a id="2865" class="Keyword">import</a> <a id="2872" href="BitML.Example.TimedCommitment.html" class="Module">BitML.Example.TimedCommitment</a>

  <a id="2905" class="Comment">-- t = 42 ;</a>
  <a id="TimedCommitment.v"></a><a id="2919" href="Compiler.Example.html#2919" class="Function">v</a> <a id="2921" class="Symbol">=</a> <a id="2923" class="Number">1</a> <a id="2925" class="Symbol">;</a> <a id="TimedCommitment.Ha"></a><a id="2927" href="Compiler.Example.html#2927" class="Function">Ha</a> <a id="2930" class="Symbol">=</a> <a id="2932" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="2934" class="Number">9</a>

  <a id="TimedCommitment.partG"></a><a id="2939" href="Compiler.Example.html#2939" class="Function">partG</a> <a id="2945" class="Symbol">=</a> <a id="2947" href="BitML.Contracts.Collections.html#2548" class="Function">nub-participants</a> <a id="2964" class="Symbol">(</a><a id="2965" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="2968" class="Symbol">.</a><a id="2969" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="2970" class="Symbol">)</a>

  <a id="2975" class="Keyword">postulate</a> <a id="TimedCommitment.Kᵈ¹"></a><a id="2985" href="Compiler.Example.html#2985" class="Postulate">Kᵈ¹</a> <a id="TimedCommitment.Kᵈ²"></a><a id="2989" href="Compiler.Example.html#2989" class="Postulate">Kᵈ²</a> <a id="TimedCommitment.Kʷᵃ"></a><a id="2993" href="Compiler.Example.html#2993" class="Postulate">Kʷᵃ</a> <a id="2997" class="Symbol">:</a> <a id="2999" href="BitML.Example.TimedCommitment.html#365" class="Datatype">Participant</a> <a id="3011" class="Symbol">→</a> <a id="3013" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>

  <a id="TimedCommitment.T₀"></a><a id="3024" href="Compiler.Example.html#3024" class="Function">T₀</a> <a id="3027" class="Symbol">:</a> <a id="3029" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="3032" class="Number">0</a> <a id="3034" class="Number">2</a>
  <a id="3038" href="Compiler.Example.html#3024" class="Function">T₀</a> <a id="3041" class="Symbol">=</a> <a id="3043" class="Keyword">record</a>
    <a id="3054" class="Symbol">{</a> <a id="3056" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="3064" class="Symbol">=</a> <a id="3066" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
    <a id="3073" class="Symbol">;</a> <a id="3075" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="3083" class="Symbol">=</a> <a id="3085" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="3094" class="Symbol">;</a> <a id="3096" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="3104" class="Symbol">=</a> <a id="3106" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="3118" class="Number">0</a>
    <a id="3124" class="Symbol">;</a> <a id="3126" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="3134" class="Symbol">=</a> <a id="3136" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="3138" class="Symbol">(</a><a id="3139" class="Number">1</a> <a id="3141" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3143" class="Number">1</a> <a id="3145" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="3155" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="3157" class="Symbol">(</a><a id="3158" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="3165" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3167" href="Compiler.Example.html#1039" class="Postulate">K̂ᵃ</a> <a id="3171" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="3173" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3175" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="3177" class="Number">0</a> <a id="3179" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a><a id="3180" class="Symbol">))</a>
                <a id="3199" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="3201" class="Symbol">(</a><a id="3202" class="Number">1</a> <a id="3204" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3206" class="Number">0</a> <a id="3208" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="3218" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="3220" class="Symbol">(</a><a id="3221" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="3228" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3230" href="Compiler.Example.html#1043" class="Postulate">K̂ᵇ</a> <a id="3234" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="3236" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="3238" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="3240" class="Number">0</a> <a id="3242" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a><a id="3243" class="Symbol">))</a>
                <a id="3262" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
    <a id="3268" class="Symbol">;</a> <a id="3270" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="3278" class="Symbol">=</a> <a id="3280" class="Number">0</a> <a id="3282" class="Symbol">}</a>

  <a id="3287" class="Comment">-- pre-existing deposits</a>
  <a id="TimedCommitment.Tᵃ"></a><a id="3314" href="Compiler.Example.html#3314" class="Function">Tᵃ</a> <a id="TimedCommitment.Tᵇ"></a><a id="3317" href="Compiler.Example.html#3317" class="Function">Tᵇ</a> <a id="3320" class="Symbol">:</a> <a id="3322" href="Bitcoin.Tx.Base.html#1867" class="Record">TxInput′</a>
  <a id="3333" href="Compiler.Example.html#3314" class="Function">Tᵃ</a> <a id="3336" class="Symbol">=</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="3342" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="3345" href="Compiler.Example.html#3024" class="Function">T₀</a><a id="3347" class="Symbol">)</a> <a id="3349" href="Bitcoin.Tx.Base.html#1903" class="InductiveConstructor Operator">at</a> <a id="3352" href="Data.Fin.Patterns.html#399" class="InductiveConstructor">0F</a>
  <a id="3357" href="Compiler.Example.html#3317" class="Function">Tᵇ</a> <a id="3360" class="Symbol">=</a> <a id="3362" class="Symbol">(</a><a id="3363" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="3366" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="3369" href="Compiler.Example.html#3024" class="Function">T₀</a><a id="3371" class="Symbol">)</a> <a id="3373" href="Bitcoin.Tx.Base.html#1903" class="InductiveConstructor Operator">at</a> <a id="3376" href="Data.Fin.Patterns.html#417" class="InductiveConstructor">1F</a>

  <a id="TimedCommitment.sechash"></a><a id="3382" href="Compiler.Example.html#3382" class="Function">sechash</a> <a id="3390" class="Symbol">:</a> <a id="3392" href="BitML.Contracts.Collections.html#4075" class="Function">namesˡ</a> <a id="3399" class="Symbol">(</a><a id="3400" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="3403" class="Symbol">.</a><a id="3404" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="3405" class="Symbol">)</a> <a id="3407" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="3409" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a>
  <a id="3413" href="Compiler.Example.html#3382" class="Function">sechash</a> <a id="3421" class="Symbol">=</a> <a id="3423" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3431" class="Symbol">λ</a> <a id="3433" class="Keyword">where</a>
    <a id="3443" class="Comment">{- &quot;a&quot; -}</a> <a id="3453" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3455" class="Symbol">→</a> <a id="3457" href="Compiler.Example.html#2927" class="Function">Ha</a>

  <a id="TimedCommitment.txout"></a><a id="3463" href="Compiler.Example.html#3463" class="Function">txout</a> <a id="3469" class="Symbol">:</a> <a id="3471" href="BitML.Contracts.Collections.html#4144" class="Function">namesʳ</a> <a id="3478" class="Symbol">(</a><a id="3479" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="3482" class="Symbol">.</a><a id="3483" href="BitML.Contracts.Types.html#2330" class="Field">G</a><a id="3484" class="Symbol">)</a> <a id="3486" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="3488" href="Bitcoin.Tx.Base.html#1867" class="Record">TxInput′</a>
  <a id="3499" href="Compiler.Example.html#3463" class="Function">txout</a> <a id="3505" class="Symbol">=</a> <a id="3507" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3515" class="Symbol">λ</a> <a id="3517" class="Keyword">where</a>
    <a id="3527" class="Comment">{- &quot;x&quot; -}</a> <a id="3537" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3539" class="Symbol">→</a> <a id="3541" href="Compiler.Example.html#3314" class="Function">Tᵃ</a>
    <a id="3548" class="Comment">{- &quot;y&quot; -}</a> <a id="3558" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="3560" class="Symbol">→</a> <a id="3562" href="Compiler.Example.html#3317" class="Function">Tᵇ</a>

  <a id="TimedCommitment.K"></a><a id="3568" href="Compiler.Example.html#3568" class="Function">K</a> <a id="3570" class="Symbol">:</a> <a id="3572" href="Compiler.Example.html#2939" class="Function">partG</a> <a id="3578" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="3580" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>
  <a id="3590" href="Compiler.Example.html#3568" class="Function">K</a> <a id="3592" class="Symbol">=</a> <a id="3594" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3602" class="Symbol">λ</a> <a id="3604" class="Keyword">where</a>
    <a id="3614" class="Comment">{- A -}</a> <a id="3622" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3624" class="Symbol">→</a> <a id="3626" href="Compiler.Example.html#1033" class="Postulate">Kᵃ</a>
    <a id="3633" class="Comment">{- B -}</a> <a id="3641" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="3643" class="Symbol">→</a> <a id="3645" href="Compiler.Example.html#1036" class="Postulate">Kᵇ</a>

  <a id="TimedCommitment.K²"></a><a id="3651" href="Compiler.Example.html#3651" class="Function">K²</a> <a id="3654" class="Symbol">:</a> <a id="3656" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="3665" class="Symbol">(</a><a id="3666" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="3669" class="Symbol">.</a><a id="3670" href="BitML.Contracts.Types.html#2351" class="Field">C</a><a id="3671" class="Symbol">)</a> <a id="3673" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="3675" class="Symbol">(</a><a id="3676" href="Compiler.Example.html#2939" class="Function">partG</a> <a id="3682" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="3684" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a><a id="3691" class="Symbol">)</a>
  <a id="3695" href="Compiler.Example.html#3651" class="Function">K²</a> <a id="3698" class="Symbol">=</a> <a id="3700" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3708" class="Symbol">λ</a> <a id="3710" class="Keyword">where</a>
    <a id="3720" class="Comment">{- reveal &quot;a&quot; ⇒ withdraw A -}</a>
    <a id="3754" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3756" class="Symbol">→</a> <a id="3758" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3766" class="Symbol">λ</a> <a id="3768" class="Keyword">where</a>
      <a id="3780" class="Comment">{- A -}</a> <a id="3788" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3790" class="Symbol">→</a> <a id="3792" href="Compiler.Example.html#2989" class="Postulate">Kᵈ²</a> <a id="3796" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a>
      <a id="3804" class="Comment">{- B -}</a> <a id="3812" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="3814" class="Symbol">→</a> <a id="3816" href="Compiler.Example.html#2989" class="Postulate">Kᵈ²</a> <a id="3820" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a>
    <a id="3826" class="Comment">{- withdraw A -}</a>
    <a id="3847" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="3849" class="Symbol">→</a> <a id="3851" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3859" class="Symbol">λ</a> <a id="3861" class="Keyword">where</a>
      <a id="3873" class="Comment">{- A -}</a> <a id="3881" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3883" class="Symbol">→</a> <a id="3885" href="Compiler.Example.html#2993" class="Postulate">Kʷᵃ</a> <a id="3889" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a>
      <a id="3897" class="Comment">{- B -}</a> <a id="3905" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="3907" class="Symbol">→</a> <a id="3909" href="Compiler.Example.html#2993" class="Postulate">Kʷᵃ</a> <a id="3913" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a>
    <a id="3919" class="Comment">{- after t ⇒ withdraw B -}</a>
    <a id="3950" href="Prelude.Membership.Patterns.html#164" class="InductiveConstructor">𝟚</a> <a id="3952" class="Symbol">→</a> <a id="3954" href="Function.Base.html#4130" class="Function Operator">case_of</a> <a id="3962" class="Symbol">λ</a> <a id="3964" class="Keyword">where</a>
      <a id="3976" class="Comment">{- A -}</a> <a id="3984" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="3986" class="Symbol">→</a> <a id="3988" href="Compiler.Example.html#2989" class="Postulate">Kᵈ²</a> <a id="3992" href="BitML.Example.TimedCommitment.html#392" class="InductiveConstructor">A</a>
      <a id="4000" class="Comment">{- B -}</a> <a id="4008" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="4010" class="Symbol">→</a> <a id="4012" href="Compiler.Example.html#2989" class="Postulate">Kᵈ²</a> <a id="4016" href="BitML.Example.TimedCommitment.html#394" class="InductiveConstructor">B</a>

  <a id="TimedCommitment.K⋆"></a><a id="4021" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4024" class="Symbol">:</a> <a id="4026" href="BitML.Contracts.Subterms.html#647" class="Function">subterms</a> <a id="4035" class="Symbol">(</a><a id="4036" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="4039" class="Symbol">.</a><a id="4040" href="BitML.Contracts.Types.html#2351" class="Field">C</a><a id="4041" class="Symbol">)</a> <a id="4043" href="Prelude.Lists.Mappings.html#751" class="Function Operator">↦</a> <a id="4045" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4050" href="Bitcoin.Crypto.html#346" class="Record">KeyPair</a>
  <a id="4060" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4063" class="Symbol">=</a> <a id="4065" href="Data.List.Membership.Setoid.html#1137" class="Function">mapWith∈</a> <a id="4074" href="Compiler.Example.html#2939" class="Function">partG</a> <a id="4080" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4082" href="Compiler.Example.html#3651" class="Function">K²</a>

  <a id="TimedCommitment.Tᵢₙᵢₜ"></a><a id="4088" href="Compiler.Example.html#4088" class="Function">Tᵢₙᵢₜ</a> <a id="4094" class="Symbol">:</a> <a id="4096" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="4099" class="Number">2</a> <a id="4101" class="Number">1</a>
  <a id="4105" href="Compiler.Example.html#4088" class="Function">Tᵢₙᵢₜ</a> <a id="4111" class="Symbol">=</a> <a id="4113" class="Keyword">record</a>
    <a id="4124" class="Symbol">{</a> <a id="4126" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="4134" class="Symbol">=</a> <a id="4136" href="Bitcoin.Tx.Crypto.html#657" class="Function">hashTxⁱ</a> <a id="4144" href="Prelude.Functor.html#382" class="Field Operator">&lt;$&gt;</a> <a id="4148" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="4150" href="Compiler.Example.html#3314" class="Function">Tᵃ</a> <a id="4153" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="4155" href="Compiler.Example.html#3317" class="Function">Tᵇ</a> <a id="4158" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
    <a id="4164" class="Symbol">;</a> <a id="4166" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="4174" class="Symbol">=</a> <a id="4176" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="4185" class="Symbol">;</a> <a id="4187" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="4195" class="Symbol">=</a> <a id="4197" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="4209" class="Number">0</a>
    <a id="4215" class="Symbol">;</a> <a id="4217" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="4225" class="Symbol">=</a> <a id="4227" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4229" class="Symbol">_</a> <a id="4231" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4233" href="Compiler.Example.html#2919" class="Function">v</a> <a id="4235" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="4245" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="4247" class="Symbol">(</a><a id="4248" href="Compiler.Example.html#4295" class="Function">e₁</a> <a id="4251" href="Bitcoin.Script.Base.html#1685" class="Function Operator">`∨</a> <a id="4254" href="Compiler.Example.html#4459" class="Function">e₂</a><a id="4256" class="Symbol">)</a><a id="4257" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="4263" class="Symbol">;</a> <a id="4265" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="4273" class="Symbol">=</a> <a id="4275" class="Number">0</a> <a id="4277" class="Symbol">}</a>
    <a id="4283" class="Keyword">where</a>
      <a id="4295" href="Compiler.Example.html#4295" class="Function">e₁</a> <a id="4298" class="Symbol">:</a> <a id="4300" href="Bitcoin.Script.Base.html#635" class="Datatype">Script</a> <a id="4307" class="Number">3</a> <a id="4309" href="Bitcoin.Script.Base.html#408" class="InductiveConstructor">`Bool</a>
      <a id="4321" href="Compiler.Example.html#4295" class="Function">e₁</a> <a id="4324" class="Symbol">=</a> <a id="4326" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="4333" class="Symbol">(</a><a id="4334" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4337" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a><a id="4338" class="Symbol">)</a> <a id="4340" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="4342" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4344" class="Number">0</a> <a id="4346" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="4348" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4350" class="Number">1</a> <a id="4352" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
        <a id="4362" href="Bitcoin.Script.Base.html#1586" class="Function Operator">`∧</a> <a id="4365" href="Bitcoin.Script.Base.html#1533" class="Function">`true</a>
        <a id="4379" href="Bitcoin.Script.Base.html#1586" class="Function Operator">`∧</a> <a id="4382" href="Bitcoin.Script.Base.html#3277" class="Function">⋀</a> <a id="4384" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4386" href="Bitcoin.Script.Base.html#1051" class="InductiveConstructor">hash</a> <a id="4391" class="Symbol">(</a><a id="4392" href="Bitcoin.Script.Base.html#729" class="InductiveConstructor">var</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4399" class="Number">2</a><a id="4400" class="Symbol">))</a> <a id="4403" href="Bitcoin.Script.Base.html#869" class="InductiveConstructor Operator">`=</a> <a id="4406" href="Bitcoin.Script.Base.html#797" class="InductiveConstructor">`</a> <a id="4408" class="Symbol">(</a><a id="4409" href="Compiler.Example.html#3382" class="Function">sechash</a> <a id="4417" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a><a id="4418" class="Symbol">)</a> <a id="4420" href="Bitcoin.Script.Base.html#1586" class="Function Operator">`∧</a> <a id="4423" class="Symbol">(</a><a id="4424" href="Bitcoin.Script.Base.html#797" class="InductiveConstructor">`</a> <a id="4426" class="Symbol">(</a><a id="4427" href="Agda.Builtin.Int.html#246" class="InductiveConstructor Operator">+</a> <a id="4429" href="Compiler.Example.html#762" class="Function">η</a><a id="4430" class="Symbol">)</a> <a id="4432" href="Bitcoin.Script.Base.html#874" class="InductiveConstructor Operator">`&lt;</a> <a id="4435" href="Bitcoin.Script.Base.html#1047" class="InductiveConstructor Operator">∣</a> <a id="4437" href="Bitcoin.Script.Base.html#729" class="InductiveConstructor">var</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4444" class="Number">2</a><a id="4445" class="Symbol">)</a> <a id="4447" href="Bitcoin.Script.Base.html#1047" class="InductiveConstructor Operator">∣</a><a id="4448" class="Symbol">)</a> <a id="4450" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>

      <a id="4459" href="Compiler.Example.html#4459" class="Function">e₂</a> <a id="4462" class="Symbol">:</a> <a id="4464" href="Bitcoin.Script.Base.html#635" class="Datatype">Script</a> <a id="4471" class="Number">3</a> <a id="4473" href="Bitcoin.Script.Base.html#408" class="InductiveConstructor">`Bool</a>
      <a id="4485" href="Compiler.Example.html#4459" class="Function">e₂</a> <a id="4488" class="Symbol">=</a> <a id="4490" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="4497" class="Symbol">(</a><a id="4498" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4501" href="Prelude.Membership.Patterns.html#164" class="InductiveConstructor">𝟚</a><a id="4502" class="Symbol">)</a> <a id="4504" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="4506" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4508" class="Number">0</a> <a id="4510" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="4512" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4514" class="Number">1</a> <a id="4516" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>
  <a id="TimedCommitment.Tᵢₙᵢₜ♯"></a><a id="4520" href="Compiler.Example.html#4520" class="Function">Tᵢₙᵢₜ♯</a> <a id="4527" class="Symbol">=</a> <a id="4529" class="Symbol">(</a><a id="4530" href="Bitcoin.Tx.Base.html#1326" class="Function">∃Tx</a> <a id="4534" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4536" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="4539" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="4542" href="Compiler.Example.html#4088" class="Function">Tᵢₙᵢₜ</a><a id="4547" class="Symbol">)</a> <a id="4549" href="Bitcoin.Crypto.html#609" class="Postulate Operator">♯</a>

  <a id="TimedCommitment.T′"></a><a id="4554" href="Compiler.Example.html#4554" class="Function">T′</a> <a id="4557" class="Symbol">:</a> <a id="4559" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="4562" class="Number">1</a> <a id="4564" class="Number">1</a>
  <a id="4568" href="Compiler.Example.html#4554" class="Function">T′</a> <a id="4571" class="Symbol">=</a> <a id="4573" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="4578" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4580" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4583" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="4585" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="4587" class="Keyword">record</a>
    <a id="4598" class="Symbol">{</a> <a id="4600" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="4608" class="Symbol">=</a> <a id="4610" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4612" href="Compiler.Example.html#4520" class="Function">Tᵢₙᵢₜ♯</a> <a id="4619" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="4622" class="Number">0</a> <a id="4624" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="4630" class="Symbol">;</a> <a id="4632" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="4640" class="Symbol">=</a> <a id="4642" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="4651" class="Symbol">;</a> <a id="4653" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="4661" class="Symbol">=</a> <a id="4663" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="4675" class="Number">0</a>
    <a id="4681" class="Symbol">;</a> <a id="4683" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="4691" class="Symbol">=</a> <a id="4693" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4695" class="Symbol">_</a> <a id="4697" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4699" href="Compiler.Example.html#2919" class="Function">v</a> <a id="4701" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="4711" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="4713" href="Compiler.Example.html#4754" class="Function">e′</a> <a id="4716" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="4722" class="Symbol">;</a> <a id="4724" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="4732" class="Symbol">=</a> <a id="4734" class="Number">0</a> <a id="4736" class="Symbol">}</a>
    <a id="4742" class="Keyword">where</a>
      <a id="4754" href="Compiler.Example.html#4754" class="Function">e′</a> <a id="4757" class="Symbol">:</a> <a id="4759" href="Bitcoin.Script.Base.html#635" class="Datatype">Script</a> <a id="4766" class="Number">2</a> <a id="4768" href="Bitcoin.Script.Base.html#408" class="InductiveConstructor">`Bool</a>
      <a id="4780" href="Compiler.Example.html#4754" class="Function">e′</a> <a id="4783" class="Symbol">=</a> <a id="4785" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="4792" class="Symbol">(</a><a id="4793" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4796" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a><a id="4797" class="Symbol">)</a> <a id="4799" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">[</a> <a id="4801" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4803" class="Number">0</a> <a id="4805" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">⨾</a> <a id="4807" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="4809" class="Number">1</a> <a id="4811" href="Prelude.Init.html#9897" class="InductiveConstructor Operator">]</a>

  <a id="TimedCommitment.T′ᵃ"></a><a id="4816" href="Compiler.Example.html#4816" class="Function">T′ᵃ</a> <a id="4820" class="Symbol">:</a> <a id="4822" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="4825" class="Number">1</a> <a id="4827" class="Number">1</a>
  <a id="4831" href="Compiler.Example.html#4816" class="Function">T′ᵃ</a> <a id="4835" class="Symbol">=</a> <a id="4837" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="4842" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4844" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="4847" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="4849" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="4851" class="Keyword">record</a>
    <a id="4862" class="Symbol">{</a> <a id="4864" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="4872" class="Symbol">=</a> <a id="4874" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4876" class="Symbol">((</a><a id="4878" href="Bitcoin.Tx.Base.html#1326" class="Function">∃Tx</a> <a id="4882" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="4884" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="4887" href="Data.Product.html#2256" class="Function Operator">-,</a> <a id="4890" href="Compiler.Example.html#4554" class="Function">T′</a><a id="4892" class="Symbol">)</a> <a id="4894" href="Bitcoin.Crypto.html#609" class="Postulate Operator">♯</a><a id="4895" class="Symbol">)</a> <a id="4897" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="4900" class="Number">0</a> <a id="4902" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="4908" class="Symbol">;</a> <a id="4910" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="4918" class="Symbol">=</a> <a id="4920" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="4929" class="Symbol">;</a> <a id="4931" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="4939" class="Symbol">=</a> <a id="4941" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="4953" class="Number">0</a>
    <a id="4959" class="Symbol">;</a> <a id="4961" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="4969" class="Symbol">=</a> <a id="4971" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="4973" class="Number">1</a> <a id="4975" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4977" href="Compiler.Example.html#2919" class="Function">v</a> <a id="4979" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="4989" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="4991" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="4998" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5000" href="Compiler.Example.html#3568" class="Function">K</a> <a id="5002" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="5004" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="5006" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5008" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="5010" class="Number">0</a> <a id="5012" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="5014" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="5020" class="Symbol">;</a> <a id="5022" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="5030" class="Symbol">=</a> <a id="5032" class="Number">0</a> <a id="5034" class="Symbol">}</a>

  <a id="TimedCommitment.T′ᵇ"></a><a id="5039" href="Compiler.Example.html#5039" class="Function">T′ᵇ</a> <a id="5043" class="Symbol">:</a> <a id="5045" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="5048" class="Number">1</a> <a id="5050" class="Number">1</a>
  <a id="5054" href="Compiler.Example.html#5039" class="Function">T′ᵇ</a> <a id="5058" class="Symbol">=</a> <a id="5060" href="Bitcoin.Tx.Crypto.html#1288" class="Function">sig⋆</a> <a id="5065" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5067" href="Compiler.Example.html#4021" class="Function">K⋆</a> <a id="5070" href="Prelude.Membership.Patterns.html#164" class="InductiveConstructor">𝟚</a> <a id="5072" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="5074" class="Keyword">record</a>
    <a id="5085" class="Symbol">{</a> <a id="5087" href="Bitcoin.Tx.Base.html#1011" class="Field">inputs</a>  <a id="5095" class="Symbol">=</a> <a id="5097" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5099" href="Compiler.Example.html#4520" class="Function">Tᵢₙᵢₜ♯</a> <a id="5106" href="Bitcoin.Tx.Base.html#394" class="InductiveConstructor Operator">at</a> <a id="5109" class="Number">0</a> <a id="5111" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="5117" class="Symbol">;</a> <a id="5119" href="Bitcoin.Tx.Base.html#1052" class="Field">wit</a>     <a id="5127" class="Symbol">=</a> <a id="5129" href="Bitcoin.Tx.Crypto.html#800" class="Function">wit⊥</a>
    <a id="5138" class="Symbol">;</a> <a id="5140" href="Bitcoin.Tx.Base.html#1107" class="Field">relLock</a> <a id="5148" class="Symbol">=</a> <a id="5150" href="Data.Vec.Base.html#5793" class="Function">V.replicate</a> <a id="5162" class="Number">0</a>
    <a id="5168" class="Symbol">;</a> <a id="5170" href="Bitcoin.Tx.Base.html#1161" class="Field">outputs</a> <a id="5178" class="Symbol">=</a> <a id="5180" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5182" class="Number">1</a> <a id="5184" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5186" href="Compiler.Example.html#2919" class="Function">v</a> <a id="5188" href="Bitcoin.Tx.Base.html#698" class="InductiveConstructor Operator">locked-by</a> <a id="5198" href="Bitcoin.Script.Base.html#1921" class="InductiveConstructor Operator">ƛ</a> <a id="5200" href="Bitcoin.Script.Base.html#1115" class="InductiveConstructor">versig</a> <a id="5207" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5209" href="Compiler.Example.html#3568" class="Function">K</a> <a id="5211" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="5213" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="5215" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">[</a> <a id="5217" href="Data.Fin.html#739" class="Function Operator">#</a> <a id="5219" class="Number">0</a> <a id="5221" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a> <a id="5223" href="Prelude.Init.html#9874" class="InductiveConstructor Operator">]</a>
    <a id="5229" class="Symbol">;</a> <a id="5231" href="Bitcoin.Tx.Base.html#1203" class="Field">absLock</a> <a id="5239" class="Symbol">=</a> <a id="5241" href="BitML.Example.TimedCommitment.html#726" class="Function">t</a> <a id="5243" class="Symbol">}</a>

  <a id="TimedCommitment.out"></a><a id="5248" href="Compiler.Example.html#5248" class="Function">out</a> <a id="5252" class="Symbol">:</a> <a id="5254" href="Compiler.Outputs.html#224" class="Function">∃Tx¹</a> <a id="5259" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5261" class="Symbol">(</a><a id="5262" href="BitML.Contracts.Subterms.html#656" class="Function">subterms⁺</a> <a id="5272" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a> <a id="5275" href="Prelude.Lists.Mappings.html#627" class="Function Operator">↦′</a> <a id="5278" href="Compiler.Outputs.html#411" class="Function">∃Txᵈ</a><a id="5282" class="Symbol">)</a>
  <a id="5286" href="Compiler.Example.html#5248" class="Function">out</a> <a id="5290" class="Symbol">=</a> <a id="5292" href="Compiler.Translation.html#1196" class="Function">bitml-compiler</a> <a id="5307" class="Symbol">{</a><a id="5308" class="Argument">ad</a> <a id="5311" class="Symbol">=</a> <a id="5313" href="BitML.Example.TimedCommitment.html#795" class="Function">TC</a><a id="5315" class="Symbol">}</a> <a id="5317" href="Prelude.Decidable.Core.html#181" class="Function">auto</a> <a id="5322" href="Compiler.Example.html#3382" class="Function">sechash</a> <a id="5330" href="Compiler.Example.html#3463" class="Function">txout</a> <a id="5336" href="Compiler.Example.html#3568" class="Function">K</a> <a id="5338" href="Compiler.Example.html#3651" class="Function">K²</a>

  <a id="TimedCommitment.outTxs"></a><a id="5344" href="Compiler.Example.html#5344" class="Function">outTxs</a> <a id="5351" class="Symbol">:</a> <a id="5353" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="5356" class="Number">2</a> <a id="5358" class="Number">1</a> <a id="5360" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5362" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="5365" class="Number">1</a> <a id="5367" class="Number">1</a> <a id="5369" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5371" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="5374" class="Number">1</a> <a id="5376" class="Number">1</a> <a id="5378" href="Data.Product.html#1176" class="Function Operator">×</a> <a id="5380" href="Bitcoin.Tx.Base.html#973" class="Record">Tx</a> <a id="5383" class="Number">1</a> <a id="5385" class="Number">1</a>
  <a id="5389" href="Compiler.Example.html#5344" class="Function">outTxs</a> <a id="5396" class="Symbol">=</a> <a id="5398" class="Keyword">let</a> <a id="5402" href="Compiler.Example.html#5402" class="Bound">t₀</a> <a id="5405" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5407" href="Compiler.Example.html#5407" class="Bound">m</a> <a id="5409" class="Symbol">=</a> <a id="5411" href="Compiler.Example.html#5248" class="Function">out</a> <a id="5415" class="Keyword">in</a>
      <a id="5424" href="Compiler.Example.html#5402" class="Bound">t₀</a> <a id="5427" class="Symbol">.</a><a id="5428" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
    <a id="5438" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5440" href="Compiler.Example.html#5407" class="Bound">m</a> <a id="5442" href="Prelude.Membership.Patterns.html#122" class="InductiveConstructor">𝟘</a> <a id="5444" class="Symbol">.</a><a id="5445" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
    <a id="5455" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5457" href="Compiler.Example.html#5407" class="Bound">m</a> <a id="5459" href="Prelude.Membership.Patterns.html#144" class="InductiveConstructor">𝟙</a> <a id="5461" class="Symbol">.</a><a id="5462" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>
    <a id="5472" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5474" href="Compiler.Example.html#5407" class="Bound">m</a> <a id="5476" href="Prelude.Membership.Patterns.html#164" class="InductiveConstructor">𝟚</a> <a id="5478" class="Symbol">.</a><a id="5479" href="Agda.Builtin.Sigma.html#246" class="Field">proj₂</a>

  <a id="5488" href="Compiler.Example.html#5488" class="Function">_</a> <a id="5490" class="Symbol">=</a> <a id="5492" href="Compiler.Example.html#5344" class="Function">outTxs</a> <a id="5499" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5501" class="Symbol">(</a><a id="5502" href="Compiler.Example.html#4088" class="Function">Tᵢₙᵢₜ</a> <a id="5508" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5510" href="Compiler.Example.html#4554" class="Function">T′</a> <a id="5513" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5515" href="Compiler.Example.html#4816" class="Function">T′ᵃ</a> <a id="5519" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="5521" href="Compiler.Example.html#5039" class="Function">T′ᵇ</a><a id="5524" class="Symbol">)</a>
    <a id="5530" href="Function.Base.html#4571" class="Function Operator">∋</a> <a id="5532" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
</pre></body></html>