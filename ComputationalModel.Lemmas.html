<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ComputationalModel.Lemmas</title><link rel="stylesheet" href="css/Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- Lemmas related to BitML&#39;s computational model.</a>
<a id="124" class="Comment">------------------------------------------------------------------------</a>
<a id="197" class="Symbol">{-#</a> <a id="201" class="Keyword">OPTIONS</a> <a id="209" class="Pragma">--allow-unsolved-metas</a> <a id="232" class="Symbol">#-}</a>

<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Data.Product.html" class="Module">Data.Product</a> <a id="262" class="Keyword">using</a> <a id="268" class="Symbol">(</a><a id="269" href="Data.Product.html#1788" class="Function">∃-syntax</a><a id="277" class="Symbol">;</a> <a id="279" href="Data.Product.html#916" class="Function">Σ-syntax</a><a id="287" class="Symbol">;</a> <a id="289" href="Data.Product.html#1167" class="Function Operator">_×_</a><a id="292" class="Symbol">;</a> <a id="294" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.Nat.html" class="Module">Data.Nat</a>     <a id="324" class="Keyword">using</a> <a id="330" class="Symbol">(</a><a id="331" href="Data.Nat.Base.html#1111" class="Function Operator">_&gt;_</a><a id="334" class="Symbol">)</a>
<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Data.List.html" class="Module">Data.List</a>    <a id="361" class="Keyword">using</a> <a id="367" class="Symbol">(</a><a id="368" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="372" class="Symbol">;</a> <a id="374" href="Data.List.Base.html#4297" class="Function">length</a><a id="380" class="Symbol">)</a>

<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="430" class="Keyword">using</a> <a id="436" class="Symbol">(</a><a id="437" href="Data.List.Membership.Setoid.html#931" class="Function Operator">_∉_</a><a id="440" class="Symbol">)</a>

<a id="443" class="Keyword">open</a> <a id="448" class="Keyword">import</a> <a id="455" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>                      <a id="493" class="Keyword">using</a> <a id="499" class="Symbol">(</a><a id="500" href="Relation.Nullary.html#653" class="Function Operator">¬_</a><a id="502" class="Symbol">)</a>
<a id="504" class="Keyword">open</a> <a id="509" class="Keyword">import</a> <a id="516" href="Relation.Binary.html" class="Module">Relation.Binary</a>                       <a id="554" class="Keyword">using</a> <a id="560" class="Symbol">(</a><a id="561" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a><a id="570" class="Symbol">)</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="622" class="Keyword">using</a> <a id="628" class="Symbol">(</a><a id="629" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="632" class="Symbol">)</a>

<a id="635" class="Keyword">open</a> <a id="640" class="Keyword">import</a> <a id="647" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>

<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Bitcoin.Crypto.html" class="Module">Bitcoin.Crypto</a> <a id="689" class="Keyword">using</a> <a id="695" class="Symbol">(</a><a id="696" href="Bitcoin.Crypto.html#320" class="Record">KeyPair</a><a id="703" class="Symbol">)</a>

<a id="706" class="Keyword">module</a> <a id="713" href="ComputationalModel.Lemmas.html" class="Module">ComputationalModel.Lemmas</a>
  <a id="741" class="Symbol">(</a><a id="742" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a> <a id="754" class="Symbol">:</a> <a id="756" class="PrimitiveType">Set</a><a id="759" class="Symbol">)</a>
  <a id="763" class="Symbol">(</a><a id="764" href="ComputationalModel.Lemmas.html#764" class="Bound Operator">_≟ₚ_</a> <a id="769" class="Symbol">:</a> <a id="771" href="Relation.Binary.Definitions.html#4575" class="Function">Decidable</a> <a id="781" class="Symbol">{</a><a id="782" class="Argument">A</a> <a id="784" class="Symbol">=</a> <a id="786" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a><a id="797" class="Symbol">}</a> <a id="799" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="802" class="Symbol">)</a>
  <a id="806" class="Symbol">(</a><a id="807" href="ComputationalModel.Lemmas.html#807" class="Bound">Honest</a> <a id="814" class="Symbol">:</a> <a id="816" href="Data.Product.html#916" class="Function">Σ[</a> <a id="819" href="ComputationalModel.Lemmas.html#819" class="Bound">ps</a> <a id="822" href="Data.Product.html#916" class="Function">∈</a> <a id="824" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="829" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a> <a id="841" href="Data.Product.html#916" class="Function">]</a> <a id="843" class="Symbol">(</a><a id="844" href="Data.List.Base.html#4297" class="Function">length</a> <a id="851" href="ComputationalModel.Lemmas.html#819" class="Bound">ps</a> <a id="854" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="856" class="Number">0</a><a id="857" class="Symbol">))</a>

  <a id="863" class="Symbol">(</a><a id="864" href="ComputationalModel.Lemmas.html#864" class="Bound">finPart</a> <a id="872" class="Symbol">:</a> <a id="874" href="Prelude.Lists.html#19289" class="Function">Finite</a> <a id="881" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a><a id="892" class="Symbol">)</a>
  <a id="896" class="Symbol">(</a><a id="897" href="ComputationalModel.Lemmas.html#897" class="Bound">keypairs</a> <a id="906" class="Symbol">:</a> <a id="908" class="Symbol">∀</a> <a id="910" class="Symbol">(</a><a id="911" href="ComputationalModel.Lemmas.html#911" class="Bound">A</a> <a id="913" class="Symbol">:</a> <a id="915" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a><a id="926" class="Symbol">)</a> <a id="928" class="Symbol">→</a> <a id="930" href="Bitcoin.Crypto.html#320" class="Record">KeyPair</a> <a id="938" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="940" href="Bitcoin.Crypto.html#320" class="Record">KeyPair</a><a id="947" class="Symbol">)</a>
  <a id="951" class="Keyword">where</a>

<a id="958" class="Keyword">open</a> <a id="963" class="Keyword">import</a> <a id="970" href="ComputationalModel.Strategy.html" class="Module">ComputationalModel.Strategy</a> <a id="998" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a> <a id="1010" href="ComputationalModel.Lemmas.html#764" class="Bound Operator">_≟ₚ_</a> <a id="1015" href="ComputationalModel.Lemmas.html#807" class="Bound">Honest</a> <a id="1022" href="ComputationalModel.Lemmas.html#864" class="Bound">finPart</a> <a id="1030" href="ComputationalModel.Lemmas.html#897" class="Bound">keypairs</a>

<a id="1040" class="Comment">----------------------------------------</a>
<a id="1081" class="Comment">-- Lemma 5</a>

<a id="1093" class="Keyword">module</a> <a id="1100" href="ComputationalModel.Lemmas.html#1100" class="Module">_</a> <a id="1102" class="Symbol">(</a><a id="1103" href="ComputationalModel.Lemmas.html#1103" class="Bound">Adv</a> <a id="1107" class="Symbol">:</a> <a id="1109" href="ComputationalModel.Lemmas.html#742" class="Bound">Participant</a><a id="1120" class="Symbol">)</a> <a id="1122" class="Symbol">(</a><a id="1123" href="ComputationalModel.Lemmas.html#1123" class="Bound">Adv∉</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="ComputationalModel.Lemmas.html#1103" class="Bound">Adv</a> <a id="1134" href="Data.List.Membership.Setoid.html#931" class="Function Operator">∉</a> <a id="1136" href="ComputationalModel.Strategy.html#2395" class="Function">Hon</a><a id="1139" class="Symbol">)</a> <a id="1141" class="Keyword">where</a>
  <a id="1149" class="Keyword">open</a> <a id="1154" href="ComputationalModel.Strategy.html#6279" class="Module">AdvM</a> <a id="1159" href="ComputationalModel.Lemmas.html#1103" class="Bound">Adv</a> <a id="1163" href="ComputationalModel.Lemmas.html#1123" class="Bound">Adv∉</a>

  <a id="1171" href="ComputationalModel.Lemmas.html#1171" class="Function">MaximalRun</a> <a id="1182" class="Symbol">:</a> <a id="1184" href="ComputationalModel.Strategy.html#7111" class="Function">Strategies</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="ComputationalModel.Strategy.html#3065" class="Function">Run</a> <a id="1201" class="Symbol">→</a> <a id="1203" class="PrimitiveType">Set</a>
  <a id="1209" href="ComputationalModel.Lemmas.html#1171" class="Function">MaximalRun</a> <a id="1220" href="ComputationalModel.Lemmas.html#1220" class="Bound">SS</a> <a id="1223" href="ComputationalModel.Lemmas.html#1223" class="Bound">R</a> <a id="1225" class="Symbol">=</a> <a id="1227" class="Symbol">(</a><a id="1228" href="ComputationalModel.Lemmas.html#1223" class="Bound">R</a> <a id="1230" href="ComputationalModel.Strategy.html#9514" class="Function Operator">-conforms-to-</a> <a id="1244" href="ComputationalModel.Lemmas.html#1220" class="Bound">SS</a><a id="1246" class="Symbol">)</a>
                  <a id="1266" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1268" class="Symbol">(</a><a id="1269" href="Relation.Nullary.html#653" class="Function Operator">¬</a> <a id="1271" href="Data.Product.html#1788" class="Function">∃[</a> <a id="1274" href="ComputationalModel.Lemmas.html#1274" class="Bound">R′</a> <a id="1277" href="Data.Product.html#1788" class="Function">]</a> <a id="1279" class="Symbol">(</a> <a id="1281" class="Symbol">(</a><a id="1282" href="ComputationalModel.Lemmas.html#1274" class="Bound">R′</a> <a id="1285" href="ComputationalModel.Strategy.html#9514" class="Function Operator">-conforms-to-</a> <a id="1299" href="ComputationalModel.Lemmas.html#1220" class="Bound">SS</a><a id="1301" class="Symbol">)</a>
                               <a id="1334" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="1336" class="Symbol">(</a><a id="1337" href="Data.List.Base.html#4297" class="Function">length</a> <a id="1344" href="ComputationalModel.Lemmas.html#1274" class="Bound">R′</a> <a id="1347" href="Data.Nat.Base.html#1111" class="Function Operator">&gt;</a> <a id="1349" href="Data.List.Base.html#4297" class="Function">length</a> <a id="1356" href="ComputationalModel.Lemmas.html#1223" class="Bound">R</a><a id="1357" class="Symbol">)</a> <a id="1359" class="Symbol">))</a>

  <a id="1365" href="ComputationalModel.Lemmas.html#1365" class="Function">unique-maximal-run</a> <a id="1384" class="Symbol">:</a>
      <a id="1392" href="ComputationalModel.Lemmas.html#1171" class="Function">MaximalRun</a> <a id="1403" href="ComputationalModel.Strategy.html#7260" class="Generalizable">SS</a> <a id="1406" href="ComputationalModel.Strategy.html#3117" class="Generalizable">R</a>
    <a id="1412" class="Symbol">→</a> <a id="1414" href="ComputationalModel.Lemmas.html#1171" class="Function">MaximalRun</a> <a id="1425" href="ComputationalModel.Strategy.html#7260" class="Generalizable">SS</a> <a id="1428" href="ComputationalModel.Strategy.html#3119" class="Generalizable">R′</a>
      <a id="1437" class="Comment">----------------</a>
    <a id="1458" class="Symbol">→</a> <a id="1460" href="ComputationalModel.Strategy.html#3117" class="Generalizable">R</a> <a id="1462" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1464" href="ComputationalModel.Strategy.html#3119" class="Generalizable">R′</a>
  <a id="1469" href="ComputationalModel.Lemmas.html#1365" class="Function">unique-maximal-run</a> <a id="1488" class="Symbol">=</a> <a id="1490" class="Symbol">{!!}</a>
</pre></body></html>