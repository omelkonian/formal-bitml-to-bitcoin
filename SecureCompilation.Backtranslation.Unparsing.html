<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>SecureCompilation.Backtranslation.Unparsing</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/formal-bitml-to-bitcoin/tree/master/SecureCompilation/Backtranslation/Unparsing.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">---------------------------------------------------</a>
<a id="53" class="Comment">-- Converting symbolic moves to computational ones.</a>
<a id="105" class="Comment">---------------------------------------------------</a>

<a id="158" class="Comment">-- {-# OPTIONS --allow-unsolved-metas #-}</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Prelude.Init.html" class="Module">Prelude.Init</a> <a id="225" class="Keyword">hiding</a> <a id="232" class="Symbol">(</a><a id="233" href="Data.Bool.Base.html#1460" class="Function">T</a><a id="234" class="Symbol">)</a>
<a id="236" class="Keyword">open</a> <a id="241" href="Prelude.Init.html#7254" class="Module">L.Mem</a> <a id="247" class="Keyword">using</a> <a id="253" class="Symbol">(</a><a id="254" href="Data.List.Membership.Setoid.html#896" class="Function Operator">_âˆˆ_</a><a id="257" class="Symbol">;</a> <a id="259" href="Data.List.Membership.Propositional.Properties.html#3491" class="Function">âˆˆ-mapâ»</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Prelude.Lists.html" class="Module">Prelude.Lists</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Prelude.Lists.Dec.html" class="Module">Prelude.Lists.Dec</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Prelude.DecEq.html" class="Module">Prelude.DecEq</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Prelude.Traces.html" class="Module">Prelude.Traces</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Prelude.Membership.html" class="Module">Prelude.Membership</a> <a id="407" class="Keyword">hiding</a> <a id="414" class="Symbol">(</a><a id="415" href="Prelude.Membership.html#428" class="Field Operator">_âˆˆ_</a><a id="418" class="Symbol">)</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Prelude.Ord.html" class="Module">Prelude.Ord</a>
<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Prelude.Decidable.html" class="Module">Prelude.Decidable</a>
<a id="474" class="Keyword">open</a> <a id="479" class="Keyword">import</a> <a id="486" href="Prelude.Validity.html" class="Module">Prelude.Validity</a>
<a id="503" class="Keyword">open</a> <a id="508" class="Keyword">import</a> <a id="515" href="Prelude.Setoid.html" class="Module">Prelude.Setoid</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Prelude.InferenceRules.html" class="Module">Prelude.InferenceRules</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Prelude.Lists.Collections.html" class="Module">Prelude.Lists.Collections</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Prelude.Semigroup.html" class="Module">Prelude.Semigroup</a>
<a id="633" class="Keyword">open</a> <a id="638" class="Keyword">import</a> <a id="645" href="Prelude.ToList.html" class="Module">Prelude.ToList</a>
<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Prelude.Functor.html" class="Module">Prelude.Functor</a>
<a id="688" class="Keyword">open</a> <a id="693" class="Keyword">import</a> <a id="700" href="Prelude.Nary.html" class="Module">Prelude.Nary</a> <a id="713" class="Keyword">hiding</a> <a id="720" class="Symbol">(</a><a id="721" href="Prelude.Nary.html#246" class="Function Operator">âŸ¦_âŸ§</a><a id="724" class="Symbol">)</a>
<a id="726" class="Keyword">open</a> <a id="731" class="Keyword">import</a> <a id="738" href="Prelude.General.html" class="Module">Prelude.General</a>

<a id="755" class="Keyword">open</a> <a id="760" class="Keyword">import</a> <a id="767" href="SecureCompilation.ModuleParameters.html" class="Module">SecureCompilation.ModuleParameters</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="SecureCompilation.ModuleParameters.html#209" class="Record">â‹¯</a><a id="810" class="Symbol">)</a>

<a id="813" class="Keyword">module</a> <a id="820" href="SecureCompilation.Backtranslation.Unparsing.html" class="Module">SecureCompilation.Backtranslation.Unparsing</a>
  <a id="866" class="Symbol">(</a><a id="867" href="SecureCompilation.Backtranslation.Unparsing.html#867" class="Bound">â‹¯</a> <a id="869" class="Symbol">:</a> <a id="871" href="SecureCompilation.ModuleParameters.html#209" class="Record">â‹¯</a><a id="872" class="Symbol">)</a> <a id="874" class="Symbol">(</a><a id="875" class="Keyword">let</a> <a id="879" class="Keyword">open</a> <a id="884" href="SecureCompilation.ModuleParameters.html#209" class="Module">â‹¯</a> <a id="886" href="SecureCompilation.Backtranslation.Unparsing.html#867" class="Bound">â‹¯</a><a id="887" class="Symbol">)</a>
  <a id="891" class="Symbol">(</a><a id="892" href="SecureCompilation.Backtranslation.Unparsing.html#892" class="Bound">Aâ‚€</a> <a id="895" class="Symbol">:</a> <a id="897" href="BitML.BasicTypes.html#675" class="Function">Participant</a><a id="908" class="Symbol">)</a> <a id="910" class="Comment">-- whose strategy we are currently translating</a>
  <a id="959" class="Keyword">where</a>

<a id="966" class="Keyword">open</a> <a id="971" class="Keyword">import</a> <a id="978" href="Compiler.html" class="Module">Compiler</a> <a id="987" href="SecureCompilation.ModuleParameters.html#282" class="Field">â‹¯â€²</a> <a id="990" href="SecureCompilation.ModuleParameters.html#357" class="Field">Î·</a>
<a id="992" class="Keyword">open</a> <a id="997" class="Keyword">import</a> <a id="1004" href="SymbolicModel.html" class="Module">SymbolicModel</a> <a id="1018" href="SecureCompilation.ModuleParameters.html#282" class="Field">â‹¯â€²</a> as <a id="S"></a><a id="1024" href="SecureCompilation.Backtranslation.Unparsing.html#1024" class="Module">S</a>
  <a id="1028" class="Keyword">hiding</a> <a id="1035" class="Symbol">(</a><a id="1036" href="SymbolicModel.Run.Base.html#468" class="Generalizable">RË¢â€²</a><a id="1039" class="Symbol">;</a> <a id="1041" href="BitML.Contracts.Types.html#1222" class="Generalizable">d</a><a id="1042" class="Symbol">)</a>
<a id="1044" class="Keyword">open</a> <a id="1049" class="Keyword">import</a> <a id="1056" href="ComputationalModel.html" class="Module">ComputationalModel</a> <a id="1075" href="SecureCompilation.ModuleParameters.html#282" class="Field">â‹¯â€²</a> <a id="1078" href="SecureCompilation.ModuleParameters.html#450" class="Field">finPart</a> <a id="1086" href="SecureCompilation.ModuleParameters.html#487" class="Field">keypairs</a> as <a id="C"></a><a id="1098" href="SecureCompilation.Backtranslation.Unparsing.html#1098" class="Module">C</a>
  <a id="1102" class="Keyword">hiding</a> <a id="1109" class="Symbol">(</a><a id="1110" href="ComputationalModel.Strategy.html#1317" class="Field">Î£</a><a id="1111" class="Symbol">;</a> <a id="1113" href="Bitcoin.BasicTypes.html#429" class="Generalizable">t</a><a id="1114" class="Symbol">;</a> <a id="1116" href="Bitcoin.BasicTypes.html#431" class="Generalizable">tâ€²</a><a id="1118" class="Symbol">;</a> <a id="1120" href="Bitcoin.Script.Base.html#821" class="InductiveConstructor">`</a><a id="1121" class="Symbol">;</a> <a id="1123" href="Bitcoin.Script.Base.html#1071" class="InductiveConstructor Operator">âˆ£_âˆ£</a><a id="1126" class="Symbol">;</a> <a id="1128" href="Bitcoin.BasicTypes.html#418" class="Generalizable">n</a><a id="1129" class="Symbol">)</a>
<a id="1131" class="Keyword">open</a> <a id="1136" class="Keyword">import</a> <a id="1143" href="Coherence.html" class="Module">Coherence</a> <a id="1153" href="SecureCompilation.Backtranslation.Unparsing.html#867" class="Bound">â‹¯</a>

<a id="1156" class="Keyword">postulate</a>
  <a id="unparseMove"></a><a id="1168" href="SecureCompilation.Backtranslation.Unparsing.html#1168" class="Postulate">unparseMove</a> <a id="1180" class="Symbol">:</a>
    <a id="1186" href="Prelude.InferenceRules.html#56141" class="Function Operator">âˆ™</a> <a id="1188" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="1191" href="Coherence.Relation.html#5522" class="Function Operator">~</a> <a id="1193" href="ComputationalModel.Run.html#4351" class="Generalizable">Rá¶œ</a>
    <a id="1200" href="Prelude.InferenceRules.html#56072" class="Function Operator">âˆ™</a> <a id="1202" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="1205" href="SymbolicModel.Run.Base.html#1301" class="Function Operator">â€”â€”[</a> <a id="1209" href="BitML.Semantics.Label.html#1651" class="Generalizable">Î±</a> <a id="1211" href="SymbolicModel.Run.Base.html#1301" class="Function Operator">]â†’</a> <a id="1214" href="BitML.Semantics.Configurations.Types.html#1456" class="Generalizable">Î“â‚œ</a>
      <a id="1223" href="Prelude.InferenceRules.html#13868" class="Function Operator">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</a>
      <a id="1259" href="Data.Product.html#1378" class="Function">âˆƒ</a> <a id="1261" class="Symbol">Î»</a> <a id="1263" href="SecureCompilation.Backtranslation.Unparsing.html#1263" class="Bound">Î»á¶œ</a> <a id="1266" class="Symbol">â†’</a> <a id="1268" href="Data.Product.html#1378" class="Function">âˆƒ</a> <a id="1270" class="Symbol">Î»</a> <a id="1272" class="Symbol">(</a><a id="1273" href="SecureCompilation.Backtranslation.Unparsing.html#1273" class="Bound">ğ•’</a> <a id="1275" class="Symbol">:</a> <a id="1277" href="SymbolicModel.Run.Base.html#2285" class="Function">ğ”¸</a> <a id="1279" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="1282" href="BitML.Semantics.Configurations.Types.html#1456" class="Generalizable">Î“â‚œ</a><a id="1284" class="Symbol">)</a> <a id="1286" class="Symbol">â†’</a>
        <a id="1296" class="Symbol">(</a><a id="1297" href="BitML.Semantics.Configurations.Types.html#1456" class="Generalizable">Î“â‚œ</a> <a id="1300" href="SymbolicModel.Run.Base.html#2412" class="Function Operator">âˆ·</a> <a id="1302" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="1305" href="SymbolicModel.Run.Base.html#2412" class="Function Operator">âŠ£</a> <a id="1307" href="SecureCompilation.Backtranslation.Unparsing.html#1273" class="Bound">ğ•’</a><a id="1308" class="Symbol">)</a> <a id="1310" href="Coherence.Relation.html#5522" class="Function Operator">~</a> <a id="1312" class="Symbol">(</a><a id="1313" href="SecureCompilation.Backtranslation.Unparsing.html#1263" class="Bound">Î»á¶œ</a> <a id="1316" href="ComputationalModel.Run.html#4314" class="InductiveConstructor Operator">âˆ·</a> <a id="1318" href="ComputationalModel.Run.html#4351" class="Generalizable">Rá¶œ</a> <a id="1321" href="ComputationalModel.Run.html#4314" class="InductiveConstructor Operator">âœ“</a><a id="1322" class="Symbol">)</a>
<a id="1324" class="Comment">-- ** too slow</a>
<a id="1339" class="Comment">{-
unparseMove
  {RË¢@(record {end = Î“â‚œ@(Î“ at t)})}
  {Rá¶œ}
  {advertiseâ¦… âŸ¨GâŸ©C â¦†}
  {Î“â‚œâ€²@(Î“â€²@(` .âŸ¨GâŸ©C âˆ£ .Î“) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([C-Advertise] vad hon dâŠ†) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L1] mkâ„ {mk {âŸ¨GâŸ©C}{Î“}{t} vad hon dâŠ†
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                {A = ?})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(` .âŸ¨GâŸ©C âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-commitâ¦… A , âŸ¨GâŸ©C , Î” â¦†}
  {Î“â‚œâ€²@(Î“â€²@(.Î“ âˆ£ Î”á¶œ âˆ£ .A auth[ â™¯â–· .âŸ¨GâŸ©C ]) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([C-AuthCommit] asâ‰¡ Allâˆ‰ Honâ‡’) refl) =
  let
    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L2] mkâ„ {mk {âŸ¨GâŸ©C}{Î“â‚€}{t}{A} ? ? asâ‰¡ Allâˆ‰ Honâ‡’
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                ? ? ? ? ? ? ?)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(` .ad âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-initâ¦… A , ad , x â¦†}
  {Î“â‚œâ€²@(Î“â€²@(` .ad âˆ£ .Î“â‚€ âˆ£ .A auth[ .x â–·Ë¢ .ad ]) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([C-AuthInit] committedA Aâˆˆper) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L3] mkâ„ {mk {ad}{Î“â‚€}{t}{A}{x} committedA Aâˆˆper
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                ? ?)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@( .(` (âŸ¨ G âŸ© C)) âˆ£ Î“â‚€ âˆ£ _ âˆ£ _)
    at t)})}
  {Rá¶œ}
  {initâ¦… G , C â¦†}
  {Î“â‚œâ€²@(Î“â€²@(_) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([C-Init] fresh-z) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L4] mkâ„ {mk {âŸ¨ G âŸ© C}{Î“â‚€}{t} fresh-z
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ c , v âŸ©at .x âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-controlâ¦… A , x â–· d â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .c , .v âŸ©at .x âˆ£ A auth[ .x â–· d ] âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([C-AuthControl] dâ‰¡) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L5] mkâ„ {mk {c}{v}{x}{Î“â‚€}{t}{A}{i = ?} dâ‰¡
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                ? ?)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(_)
    at t)})}
  {Rá¶œ}
  {putâ¦… xs , as , y â¦†}
  {Î“â‚œâ€²@(Î“â€²@(_) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  stepâ‚œ@([Timeout] Asâ‰¡âˆ… âˆ€â‰¤t _ refl)
  with ds , ss , p , c , v , Î“â‚€ , z , dâ‰¡ , refl , refl , refl , refl , refl , refl
     , fresh-z , pâ‰¡
     â† match-putâ‚œ stepâ‚œ tt =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L6] mkâ„ {mk {_}{v}{y}{c}{z}{Î“â‚€ = Î“â‚€}{_}{p}{ds}{ss}{i = ?}
                    (âˆ€â‰¤â‡’â‰¡max âˆ€â‰¤t) dâ‰¡ fresh-z pâ‰¡ Asâ‰¡âˆ…
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ .A âˆ¶ .a â™¯ just n âŸ© âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-revâ¦… A , a â¦†}
  {Î“â‚œâ€²@(Î“â€²@(.A âˆ¶ .a â™¯ .n âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] [C-AuthRev] refl) =
  -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L7] mkâ„ {mk {ad = ?}{A}{a}{n}{Î“â‚€}{t} ? ?
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)
                    ?}
                ? ? ? ? ?)
  -- ([L] [7] {Î“â‚€ = Î“â‚€} {B = Aâ‚€} mâ‰¤ Râ‰ˆ âˆƒÎ“â‰ˆ âˆƒB âˆƒÎ± aâˆˆG âˆƒÎ» first-Î»á¶œ)
  where
    postulate
      _m : Message
      mâ‰¤ : âˆ£ _m âˆ£áµ â‰¤ Î·
      Î”Ã—hÌ… : List (Secret Ã— Maybe â„• Ã— â„¤)
      âŸ¨GâŸ©C : Ad
      kâƒ— : ğ•‚Â²â€² âŸ¨GâŸ©C

    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl

    ğ•£ = â„âˆ—â‡’â„ ğ•£âˆ—; open â„ ğ•£

    aâˆˆ : a âˆˆ namesË¡ RË¢
    aâˆˆ = namesË¡â¦…endâ¦†âŠ† RË¢
       $ âˆˆnamesË¡-resp-â‰ˆ a {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ) (here refl)

    _Î” : List (Secret Ã— Maybe â„•)
    _Î” = map (Î»{ (s , mn , _) â†’ s , mn }) Î”Ã—hÌ…

    _C : Message
    _C = encodeAd âŸ¨GâŸ©C {!!} -- (txoutG , txoutC)

    -- hÌ… : Message
    -- hÌ… = map (projâ‚‚ âˆ˜ projâ‚‚) Î”Ã—hÌ…

    -- kÌ… : Message
    -- kÌ… = concatMap (map pub âˆ˜ codom) (codom kâƒ—)

    -- C,hÌ…,kÌ… : Message
    -- C,hÌ…,kÌ… = _C â—‡ hÌ… â—‡ kÌ…

    -- postulate
    --   âˆƒB : âˆƒ Î» B â†’ (B , _m , [ sechashâ€² {a} aâˆˆ ]) âˆˆ oracleInteractionsá¶œ Rá¶œ
    --   âˆƒÎ± : auth-commitâ¦… A , âŸ¨GâŸ©C , _Î” â¦† âˆˆ labels RË¢
    --   aâˆˆG : a âˆˆ namesË¡ (âŸ¨GâŸ©C .G)

    --   âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ C,hÌ…,kÌ…) (toList Rá¶œ)
    --   first-Î»á¶œ : All (Î» l â†’ âˆ€ X â†’ l â‰¢ X â†’âˆ—âˆ¶ _m) (Any-tail âˆƒÎ»)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ c , v âŸ©at .y âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {splitâ¦… y â¦†}
  {Î“â‚œâ€²@(Î“â€²@(_) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  stepâ‚œ@([Timeout] Asâ‰¡âˆ… âˆ€â‰¤t _ refl)
  with vcis , Î“â‚€ , y , dâ‰¡ , refl , refl , refl , refl , fresh-xs â† match-splitâ‚œ stepâ‚œ tt =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L8] mkâ„ {mk {c}{y}{Î“â‚€}{i = ?}{vcis} (âˆ€â‰¤â‡’â‰¡max âˆ€â‰¤t) dâ‰¡ fresh-xs Asâ‰¡âˆ…
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(_)
    at t)})}
  {Rá¶œ}
  {withdrawâ¦… A , v , y â¦†}
  {Î“â‚œâ€²@(Î“â€²@(_) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  stepâ‚œ@([Timeout] Asâ‰¡âˆ… âˆ€â‰¤t _ refl)
  with Î“â‚€ , x , dâ‰¡ , refl , refl , refl , refl , fresh-x â† match-withdrawâ‚œ stepâ‚œ tt =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L9] mkâ„ {mk {Î“â‚€ = Î“â‚€} dâ‰¡ fresh-x Asâ‰¡âˆ… âˆ€â‰¤t
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(Î“@(âŸ¨ A has v âŸ©at .x âˆ£ âŸ¨ A has vâ€² âŸ©at .xâ€² âˆ£ Î“â‚€) at t)})}
  {Rá¶œ}
  {auth-joinâ¦… A , x â†” xâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .A has .v âŸ©at .x âˆ£ âŸ¨ .A has .vâ€² âŸ©at .xâ€² âˆ£ .A auth[ .x â†” .xâ€² â–·âŸ¨ .A , .(v + vâ€²) âŸ© ] âˆ£ Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] [DEP-AuthJoin] refl) =
  let
    ğ•£ = â„âˆ—â‡’â„ ğ•£âˆ—; open â„ ğ•£

    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl

    nâŠ† : Î“ âŠ†â¦… namesÊ³ â¦† RË¢
    nâŠ†  = namesÊ³â¦…endâ¦†âŠ† RË¢ âˆ˜ âˆˆnamesÊ³-resp-â‰ˆ _ {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ)
    xâˆˆ  = nâŠ† (here refl)
    xâˆˆâ€² = nâŠ† (there $â€² here refl)

    -- âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
    --      â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
    --      Ã— (inputs  T â‰¡ hashTxâ± (txoutâ€² {x} xâˆˆ) âˆ· hashTxâ± (txoutâ€² {xâ€²} xâˆˆâ€²) âˆ· [])
    --      Ã— (outputs T â‰¡ [ 1 , record {value = v + vâ€²; validator = Æ› (versig [ KÌ‚ A ] [ # 0 ])} ])
    --      ) (toList Rá¶œ)
    -- âˆƒÎ» = {!!}

    -- T : âˆƒTx
    -- T = 2 , 1 , (L.Any.satisfied âˆƒÎ» .projâ‚‚ .projâ‚‚ .projâ‚)

    -- mâ€² = [ SIG (KÌ‚ A) T ]

    -- first-Î»á¶œ : All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
    -- first-Î»á¶œ = {!!}
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L10] mkâ„ {mk {Î“â‚€ = Î“â‚€}
                     (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                 ? ?)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ A has v âŸ©at x âˆ£ âŸ¨ A has vâ€² âŸ©at xâ€² âˆ£ .A auth[ .x â†” .xâ€² â–·âŸ¨ .A , .(v + vâ€²) âŸ© ] âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {Î±@(joinâ¦… x â†” xâ€² â¦†)}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .A has .(v + vâ€²) âŸ©at y âˆ£ .Î“â‚€) at tâ€²@(.t))}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  Î“â†’Î“â€²@([Action] ([DEP-Join] fresh-y) refl) =
  let
    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L11] mkâ„ {mk {Î“â‚€ = Î“â‚€} fresh-y
                     (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(Î“@(âŸ¨ .A has .(v + vâ€²) âŸ©at .x âˆ£ Î“â‚€) at t)})}
  {Rá¶œ}
  {auth-divideâ¦… A , x â–· v , vâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .A has .(v + vâ€²) âŸ©at .x âˆ£ .A auth[ .x â–·âŸ¨ .A , .v , .vâ€² âŸ© ] âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  Î“â†’Î“â€²@([Action] [DEP-AuthDivide] refl) =
  let
    ğ•£ = â„âˆ—â‡’â„ ğ•£âˆ—; open â„ ğ•£

    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl

    nâŠ† : Î“ âŠ†â¦… namesÊ³ â¦† RË¢
    nâŠ†  = namesÊ³â¦…endâ¦†âŠ† RË¢ âˆ˜ âˆˆnamesÊ³-resp-â‰ˆ _ {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ)
    xâˆˆ  = nâŠ† (here refl)

    -- âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
    --      â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
    --      Ã— (inputs  T â‰¡ [ hashTxâ± (txoutâ€² {x} xâˆˆ) ])
    --      Ã— (outputs T â‰¡ (v redeemable-by KÌ‚ A) âˆ· (vâ€² redeemable-by KÌ‚ A) âˆ· [])
    --      ) (toList Rá¶œ)
    -- âˆƒÎ» = {!!}

    -- T : âˆƒTx
    -- T = 1 , 2 , (L.Any.satisfied âˆƒÎ» .projâ‚‚ .projâ‚‚ .projâ‚)

    -- mâ€² = [ SIG (KÌ‚ A) T ]

    -- first-Î»á¶œ : All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
    -- first-Î»á¶œ = {!!}
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L12] mkâ„ {mk {Î“â‚€ = Î“â‚€}
                    (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                ? ?)
 -- ([L] [12] {Î“â‚€ = Î“â‚€} {B = {!!}} Râ‰ˆ âˆƒÎ“â‰ˆ âˆƒÎ» first-Î»á¶œ)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ A has .(v + vâ€²) âŸ©at .x âˆ£ .A auth[ .x â–·âŸ¨ .A , .v , .vâ€² âŸ© ] âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {divideâ¦… x â–· v , vâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .A has .v âŸ©at y âˆ£ âŸ¨ .A has .vâ€² âŸ©at yâ€² âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([DEP-Divide] fresh-ys) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L13] mkâ„ {mk {Î“â‚€ = Î“â‚€} fresh-ys (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ .A has v âŸ©at .x âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-donateâ¦… A , x â–·áµˆ Bâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .A has .v âŸ©at .x âˆ£ .A auth[ .x â–·áµˆ .Bâ€² ] âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] [DEP-AuthDonate] refl) =
  let
    ğ•£ = â„âˆ—â‡’â„ ğ•£âˆ—; open â„ ğ•£

    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl

    nâŠ† : Î“ âŠ†â¦… namesÊ³ â¦† RË¢
    nâŠ†  = namesÊ³â¦…endâ¦†âŠ† RË¢ âˆ˜ âˆˆnamesÊ³-resp-â‰ˆ _ {Î“}{cfg (RË¢ .end)} (â†­-sym $ projâ‚‚ Râ‰ˆ)
    xâˆˆ  = nâŠ† (here refl)

    -- âˆƒÎ» : Any (Î» l â†’ âˆƒ Î» B â†’ âˆƒ Î» T
    --          â†’ (l â‰¡ B â†’âˆ—âˆ¶ [ T â™¯ ])
    --          Ã— (inputs  T â‰¡ [ hashTxâ± (txoutâ€² {x} xâˆˆ) ])
    --          Ã— (outputs T â‰¡ [ v redeemable-by KÌ‚ Bâ€² ])
    --          ) (toList Rá¶œ)
    -- âˆƒÎ» = {!!}

    -- T : âˆƒTx
    -- T = 1 , 1 , (projâ‚ $ projâ‚‚ $ projâ‚‚ $ L.Any.satisfied âˆƒÎ»)

    -- mâ€² = [ SIG (KÌ‚ A) T ]

    -- first-Î»á¶œ : All (Î» l â†’ Â¬ âˆƒ Î» B â†’ l â‰¡ B â†’âˆ—âˆ¶ mâ€²) (Any-tail âˆƒÎ»)
    -- first-Î»á¶œ = {!!}
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L14] mkâ„ {mk {Î“â‚€ = Î“â‚€} (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                 ? ?)
    -- ([L] [14] {Î“â‚€ = Î“â‚€} {B = {!!}} Râ‰ˆ âˆƒÎ“â‰ˆ âˆƒÎ» first-Î»á¶œ)
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(âŸ¨ A has v âŸ©at .x âˆ£ A auth[ .x â–·áµˆ .Bâ€² ] âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {donateâ¦… x â–·áµˆ Bâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(âŸ¨ .Bâ€² has .v âŸ©at y âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([DEP-Donate] fresh-y) refl) =
  let
    Râ‰ˆ : RË¢ â‰ˆâ‹¯ Î“â‚œ
    Râ‰ˆ = refl , â†­-refl

    âˆƒÎ“â‰ˆ : âˆƒ (_â‰ˆ Î“â€²)
    âˆƒÎ“â‰ˆ = Î“â€² , â†­-refl
  in
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L15] mkâ„ {mk {Î“â‚€ = Î“â‚€} fresh-y
                 (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
-- ** unification errors for `destroy` actions, T0D0: fording view
{-
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(Î” âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {auth-destroyâ¦… A , xs , jâ€² â¦†}
  {Î“â‚œâ€²@(Î“â€²@(.Î” âˆ£ .A auth[ .xs , .jâ€² â–·áµˆË¢ y ] âˆ£ .Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([DEP-AuthDestroy] {y}{Î“â‚€}{ds}{j} fresh-y) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([R16âŠ£ ? ] mkâ„ {mk {y}{Î“â‚€}{t}{ds} j fresh-y
                         (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
                     ? ?)
      -- {Î“â‚€ = Î“â‚€} {i = {!!}} {B = Aâ‚€} {ds = ds}
unparseMove
  {RË¢@(record {end = Î“â‚œ@(
    Î“@(_ âˆ£ Î“â‚€)
    at t)})}
  {Rá¶œ}
  {destroyâ¦… xs â¦†}
  {Î“â‚œâ€²@(Î“â€²@(.Î“â‚€) at .t)}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Action] ([DEP-Destroy] {y = y} {Î“ = Î“â‚€} {ds = ds}) refl) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([R17âŠ£ {!!} ]
        mkâ„ {mk {Î“â‚€}{y}{t}{ds} (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)}
            {!!} {!!})
-}
unparseMove
  {RË¢@(record {end = Î“â‚œ@(Î“ at t)})}
  {Rá¶œ}
  {delayâ¦… Î´ â¦†}
  {Î“â‚œâ€²@(Î“â€²@.Î“ at .(t + Î´))}
  (ğ•£âˆ— , RË¢~Rá¶œ)
  ([Delay] Î´&gt;0) =
    -, -, -, stepâ‚ RË¢~Rá¶œ
      ([L18] mkâ„ {mk {Î“} Î´&gt;0 (Rá¶œ â¨¾ RË¢ â¨¾ ğ•£âˆ— âŠ£ refl , â†­-refl â‰ˆ Î“â€² âŠ£ â†­-refl)})
-- ** unification errors for `C-Control` rules, T0D0: fording view
-- unparseMove {Î± = delayâ¦… _ â¦†} _ ([Action] ([C-Control] _ _ _ ()) _)
-}</a>
<a id="unparseMoves"></a><a id="12249" href="SecureCompilation.Backtranslation.Unparsing.html#12249" class="Function">unparseMoves</a> <a id="12262" class="Symbol">:</a> <a id="12264" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="12267" href="Coherence.Relation.html#5522" class="Function Operator">~</a> <a id="12269" href="ComputationalModel.Run.html#4351" class="Generalizable">Rá¶œ</a> <a id="12272" class="Symbol">â†’</a> <a id="12274" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="12279" class="Symbol">(</a><a id="12280" href="Data.Product.html#1378" class="Function">âˆƒ</a> <a id="12282" class="Symbol">Î»</a> <a id="12284" href="SecureCompilation.Backtranslation.Unparsing.html#12284" class="Bound">Î±</a> <a id="12286" class="Symbol">â†’</a> <a id="12288" href="Data.Product.html#1378" class="Function">âˆƒ</a> <a id="12290" class="Symbol">(</a><a id="12291" href="SymbolicModel.Run.Base.html#465" class="Generalizable">RË¢</a> <a id="12294" href="SymbolicModel.Run.Base.html#1301" class="Function Operator">â€”â€”[</a> <a id="12298" href="SecureCompilation.Backtranslation.Unparsing.html#12284" class="Bound">Î±</a> <a id="12300" href="SymbolicModel.Run.Base.html#1301" class="Function Operator">]â†’_</a><a id="12303" class="Symbol">))</a> <a id="12306" class="Symbol">â†’</a> <a id="12308" href="ComputationalModel.Run.html#1329" class="Function">C.Labels</a>
<a id="12317" href="SecureCompilation.Backtranslation.Unparsing.html#12249" class="Function">unparseMoves</a> <a id="12330" href="SecureCompilation.Backtranslation.Unparsing.html#12330" class="Bound">RË¢~Rá¶œ</a> <a id="12336" class="Symbol">=</a> <a id="12338" href="Data.List.Base.html#1553" class="Function">map</a> <a id="12342" class="Symbol">Î»</a> <a id="12344" class="Keyword">where</a>
  <a id="12352" class="Symbol">(</a><a id="12353" href="SecureCompilation.Backtranslation.Unparsing.html#12353" class="Bound">Î±</a> <a id="12355" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12357" href="SecureCompilation.Backtranslation.Unparsing.html#12357" class="Bound">Î“â‚œ</a> <a id="12360" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="12362" href="SecureCompilation.Backtranslation.Unparsing.html#12362" class="Bound">Râ†’</a><a id="12364" class="Symbol">)</a> <a id="12366" class="Symbol">â†’</a> <a id="12368" href="SecureCompilation.Backtranslation.Unparsing.html#1168" class="Postulate">unparseMove</a> <a id="12380" href="SecureCompilation.Backtranslation.Unparsing.html#12330" class="Bound">RË¢~Rá¶œ</a> <a id="12386" href="SecureCompilation.Backtranslation.Unparsing.html#12362" class="Bound">Râ†’</a> <a id="12389" class="Symbol">.</a><a id="12390" href="Agda.Builtin.Sigma.html#234" class="Field">projâ‚</a>
</pre></body></html>